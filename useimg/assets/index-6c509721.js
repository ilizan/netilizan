(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))v(_);new MutationObserver(_=>{for(const C of _)if(C.type==="childList")for(const w of C.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&v(w)}).observe(document,{childList:!0,subtree:!0});function g(_){const C={};return _.integrity&&(C.integrity=_.integrity),_.referrerPolicy&&(C.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?C.credentials="include":_.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function v(_){if(_.ep)return;_.ep=!0;const C=g(_);fetch(_.href,C)}})();/**
* @vue/shared v3.5.8
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ln(s){const t=Object.create(null);for(const g of s.split(","))t[g]=1;return g=>g in t}const _t={},Te=[],Ht=()=>{},eo=()=>!1,_i=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&(s.charCodeAt(2)>122||s.charCodeAt(2)<97),cn=s=>s.startsWith("onUpdate:"),Tt=Object.assign,hn=(s,t)=>{const g=s.indexOf(t);g>-1&&s.splice(g,1)},io=Object.prototype.hasOwnProperty,gt=(s,t)=>io.call(s,t),ut=Array.isArray,Oe=s=>yi(s)==="[object Map]",Er=s=>yi(s)==="[object Set]",dt=s=>typeof s=="function",xt=s=>typeof s=="string",ue=s=>typeof s=="symbol",yt=s=>s!==null&&typeof s=="object",Ar=s=>(yt(s)||dt(s))&&dt(s.then)&&dt(s.catch),Dr=Object.prototype.toString,yi=s=>Dr.call(s),no=s=>yi(s).slice(8,-1),Mr=s=>yi(s)==="[object Object]",un=s=>xt(s)&&s!=="NaN"&&s[0]!=="-"&&""+parseInt(s,10)===s,je=ln(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ci=s=>{const t=Object.create(null);return g=>t[g]||(t[g]=s(g))},ro=/-(\w)/g,ye=Ci(s=>s.replace(ro,(t,g)=>g?g.toUpperCase():"")),so=/\B([A-Z])/g,be=Ci(s=>s.replace(so,"-$1").toLowerCase()),kr=Ci(s=>s.charAt(0).toUpperCase()+s.slice(1)),Di=Ci(s=>s?`on${kr(s)}`:""),he=(s,t)=>!Object.is(s,t),Mi=(s,...t)=>{for(let g=0;g<s.length;g++)s[g](...t)},Fr=(s,t,g,v=!1)=>{Object.defineProperty(s,t,{configurable:!0,enumerable:!1,writable:v,value:g})},oo=s=>{const t=parseFloat(s);return isNaN(t)?s:t};let Rn;const Rr=()=>Rn||(Rn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function fn(s){if(ut(s)){const t={};for(let g=0;g<s.length;g++){const v=s[g],_=xt(v)?ho(v):fn(v);if(_)for(const C in _)t[C]=_[C]}return t}else if(xt(s)||yt(s))return s}const ao=/;(?![^(]*\))/g,lo=/:([^]+)/,co=/\/\*[^]*?\*\//g;function ho(s){const t={};return s.replace(co,"").split(ao).forEach(g=>{if(g){const v=g.split(lo);v.length>1&&(t[v[0].trim()]=v[1].trim())}}),t}function dn(s){let t="";if(xt(s))t=s;else if(ut(s))for(let g=0;g<s.length;g++){const v=dn(s[g]);v&&(t+=v+" ")}else if(yt(s))for(const g in s)s[g]&&(t+=g+" ");return t.trim()}const uo="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",fo=ln(uo);function Lr(s){return!!s||s===""}const Ir=s=>!!(s&&s.__v_isRef===!0),jr=s=>xt(s)?s:s==null?"":ut(s)||yt(s)&&(s.toString===Dr||!dt(s.toString))?Ir(s)?jr(s.value):JSON.stringify(s,Br,2):String(s),Br=(s,t)=>Ir(t)?Br(s,t.value):Oe(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((g,[v,_],C)=>(g[ki(v,C)+" =>"]=_,g),{})}:Er(t)?{[`Set(${t.size})`]:[...t.values()].map(g=>ki(g))}:ue(t)?ki(t):yt(t)&&!ut(t)&&!Mr(t)?String(t):t,ki=(s,t="")=>{var g;return ue(s)?`Symbol(${(g=s.description)!=null?g:t})`:s};/**
* @vue/reactivity v3.5.8
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Lt;class Xr{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Lt,!t&&Lt&&(this.index=(Lt.scopes||(Lt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,g;if(this.scopes)for(t=0,g=this.scopes.length;t<g;t++)this.scopes[t].pause();for(t=0,g=this.effects.length;t<g;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,g;if(this.scopes)for(t=0,g=this.scopes.length;t<g;t++)this.scopes[t].resume();for(t=0,g=this.effects.length;t<g;t++)this.effects[t].resume()}}run(t){if(this._active){const g=Lt;try{return Lt=this,t()}finally{Lt=g}}}on(){Lt=this}off(){Lt=this.parent}stop(t){if(this._active){let g,v;for(g=0,v=this.effects.length;g<v;g++)this.effects[g].stop();for(g=0,v=this.cleanups.length;g<v;g++)this.cleanups[g]();if(this.scopes)for(g=0,v=this.scopes.length;g<v;g++)this.scopes[g].stop(!0);if(!this.detached&&this.parent&&!t){const _=this.parent.scopes.pop();_&&_!==this&&(this.parent.scopes[this.index]=_,_.index=this.index)}this.parent=void 0,this._active=!1}}}function go(s){return new Xr(s)}function po(){return Lt}let vt;const Fi=new WeakSet;class Wr{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Lt&&Lt.active&&Lt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Fi.has(this)&&(Fi.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Yr(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ln(this),Nr(this);const t=vt,g=Yt;vt=this,Yt=!0;try{return this.fn()}finally{Ur(this),vt=t,Yt=g,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)mn(t);this.deps=this.depsTail=void 0,Ln(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Fi.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Gi(this)&&this.run()}get dirty(){return Gi(this)}}let Hr=0,Be;function Yr(s){s.flags|=8,s.next=Be,Be=s}function gn(){Hr++}function pn(){if(--Hr>0)return;let s;for(;Be;){let t=Be;for(Be=void 0;t;){const g=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(v){s||(s=v)}t=g}}if(s)throw s}function Nr(s){for(let t=s.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ur(s,t=!1){let g,v=s.depsTail,_=v;for(;_;){const C=_.prevDep;_.version===-1?(_===v&&(v=C),mn(_,t),mo(_)):g=_,_.dep.activeLink=_.prevActiveLink,_.prevActiveLink=void 0,_=C}s.deps=g,s.depsTail=v}function Gi(s){for(let t=s.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(zr(t.dep.computed)||t.dep.version!==t.version))return!0;return!!s._dirty}function zr(s){if(s.flags&4&&!(s.flags&16)||(s.flags&=-17,s.globalVersion===Ue))return;s.globalVersion=Ue;const t=s.dep;if(s.flags|=2,t.version>0&&!s.isSSR&&s.deps&&!Gi(s)){s.flags&=-3;return}const g=vt,v=Yt;vt=s,Yt=!0;try{Nr(s);const _=s.fn(s._value);(t.version===0||he(_,s._value))&&(s._value=_,t.version++)}catch(_){throw t.version++,_}finally{vt=g,Yt=v,Ur(s,!0),s.flags&=-3}}function mn(s,t=!1){const{dep:g,prevSub:v,nextSub:_}=s;if(v&&(v.nextSub=_,s.prevSub=void 0),_&&(_.prevSub=v,s.nextSub=void 0),g.subs===s&&(g.subs=v),!g.subs)if(g.computed){g.computed.flags&=-5;for(let C=g.computed.deps;C;C=C.nextDep)mn(C,!0)}else g.map&&!t&&(g.map.delete(g.key),g.map.size||fi.delete(g.target))}function mo(s){const{prevDep:t,nextDep:g}=s;t&&(t.nextDep=g,s.prevDep=void 0),g&&(g.prevDep=t,s.nextDep=void 0)}let Yt=!0;const Vr=[];function fe(){Vr.push(Yt),Yt=!1}function de(){const s=Vr.pop();Yt=s===void 0?!0:s}function Ln(s){const{cleanup:t}=s;if(s.cleanup=void 0,t){const g=vt;vt=void 0;try{t()}finally{vt=g}}}let Ue=0;class vo{constructor(t,g){this.sub=t,this.dep=g,this.version=g.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class vn{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.target=void 0,this.map=void 0,this.key=void 0}track(t){if(!vt||!Yt||vt===this.computed)return;let g=this.activeLink;if(g===void 0||g.sub!==vt)g=this.activeLink=new vo(vt,this),vt.deps?(g.prevDep=vt.depsTail,vt.depsTail.nextDep=g,vt.depsTail=g):vt.deps=vt.depsTail=g,vt.flags&4&&Gr(g);else if(g.version===-1&&(g.version=this.version,g.nextDep)){const v=g.nextDep;v.prevDep=g.prevDep,g.prevDep&&(g.prevDep.nextDep=v),g.prevDep=vt.depsTail,g.nextDep=void 0,vt.depsTail.nextDep=g,vt.depsTail=g,vt.deps===g&&(vt.deps=v)}return g}trigger(t){this.version++,Ue++,this.notify(t)}notify(t){gn();try{for(let g=this.subs;g;g=g.prevSub)g.sub.notify()&&g.sub.dep.notify()}finally{pn()}}}function Gr(s){const t=s.dep.computed;if(t&&!s.dep.subs){t.flags|=20;for(let v=t.deps;v;v=v.nextDep)Gr(v)}const g=s.dep.subs;g!==s&&(s.prevSub=g,g&&(g.nextSub=s)),s.dep.subs=s}const fi=new WeakMap,ve=Symbol(""),Ki=Symbol(""),ze=Symbol("");function Et(s,t,g){if(Yt&&vt){let v=fi.get(s);v||fi.set(s,v=new Map);let _=v.get(g);_||(v.set(g,_=new vn),_.target=s,_.map=v,_.key=g),_.track()}}function te(s,t,g,v,_,C){const w=fi.get(s);if(!w){Ue++;return}const u=r=>{r&&r.trigger()};if(gn(),t==="clear")w.forEach(u);else{const r=ut(s),c=r&&un(g);if(r&&g==="length"){const l=Number(v);w.forEach((i,n)=>{(n==="length"||n===ze||!ue(n)&&n>=l)&&u(i)})}else switch(g!==void 0&&u(w.get(g)),c&&u(w.get(ze)),t){case"add":r?c&&u(w.get("length")):(u(w.get(ve)),Oe(s)&&u(w.get(Ki)));break;case"delete":r||(u(w.get(ve)),Oe(s)&&u(w.get(Ki)));break;case"set":Oe(s)&&u(w.get(ve));break}}pn()}function Se(s){const t=pt(s);return t===s?t:(Et(t,"iterate",ze),Xt(s)?t:t.map(Ot))}function bi(s){return Et(s=pt(s),"iterate",ze),s}const _o={__proto__:null,[Symbol.iterator](){return Ri(this,Symbol.iterator,Ot)},concat(...s){return Se(this).concat(...s.map(t=>ut(t)?Se(t):t))},entries(){return Ri(this,"entries",s=>(s[1]=Ot(s[1]),s))},every(s,t){return Jt(this,"every",s,t,void 0,arguments)},filter(s,t){return Jt(this,"filter",s,t,g=>g.map(Ot),arguments)},find(s,t){return Jt(this,"find",s,t,Ot,arguments)},findIndex(s,t){return Jt(this,"findIndex",s,t,void 0,arguments)},findLast(s,t){return Jt(this,"findLast",s,t,Ot,arguments)},findLastIndex(s,t){return Jt(this,"findLastIndex",s,t,void 0,arguments)},forEach(s,t){return Jt(this,"forEach",s,t,void 0,arguments)},includes(...s){return Li(this,"includes",s)},indexOf(...s){return Li(this,"indexOf",s)},join(s){return Se(this).join(s)},lastIndexOf(...s){return Li(this,"lastIndexOf",s)},map(s,t){return Jt(this,"map",s,t,void 0,arguments)},pop(){return Fe(this,"pop")},push(...s){return Fe(this,"push",s)},reduce(s,...t){return In(this,"reduce",s,t)},reduceRight(s,...t){return In(this,"reduceRight",s,t)},shift(){return Fe(this,"shift")},some(s,t){return Jt(this,"some",s,t,void 0,arguments)},splice(...s){return Fe(this,"splice",s)},toReversed(){return Se(this).toReversed()},toSorted(s){return Se(this).toSorted(s)},toSpliced(...s){return Se(this).toSpliced(...s)},unshift(...s){return Fe(this,"unshift",s)},values(){return Ri(this,"values",Ot)}};function Ri(s,t,g){const v=bi(s),_=v[t]();return v!==s&&!Xt(s)&&(_._next=_.next,_.next=()=>{const C=_._next();return C.value&&(C.value=g(C.value)),C}),_}const yo=Array.prototype;function Jt(s,t,g,v,_,C){const w=bi(s),u=w!==s&&!Xt(s),r=w[t];if(r!==yo[t]){const i=r.apply(s,C);return u?Ot(i):i}let c=g;w!==s&&(u?c=function(i,n){return g.call(this,Ot(i),n,s)}:g.length>2&&(c=function(i,n){return g.call(this,i,n,s)}));const l=r.call(w,c,v);return u&&_?_(l):l}function In(s,t,g,v){const _=bi(s);let C=g;return _!==s&&(Xt(s)?g.length>3&&(C=function(w,u,r){return g.call(this,w,u,r,s)}):C=function(w,u,r){return g.call(this,w,Ot(u),r,s)}),_[t](C,...v)}function Li(s,t,g){const v=pt(s);Et(v,"iterate",ze);const _=v[t](...g);return(_===-1||_===!1)&&bn(g[0])?(g[0]=pt(g[0]),v[t](...g)):_}function Fe(s,t,g=[]){fe(),gn();const v=pt(s)[t].apply(s,g);return pn(),de(),v}const Co=ln("__proto__,__v_isRef,__isVue"),Kr=new Set(Object.getOwnPropertyNames(Symbol).filter(s=>s!=="arguments"&&s!=="caller").map(s=>Symbol[s]).filter(ue));function bo(s){ue(s)||(s=String(s));const t=pt(this);return Et(t,"has",s),t.hasOwnProperty(s)}class qr{constructor(t=!1,g=!1){this._isReadonly=t,this._isShallow=g}get(t,g,v){const _=this._isReadonly,C=this._isShallow;if(g==="__v_isReactive")return!_;if(g==="__v_isReadonly")return _;if(g==="__v_isShallow")return C;if(g==="__v_raw")return v===(_?C?Ro:Zr:C?Qr:Jr).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(v)?t:void 0;const w=ut(t);if(!_){let r;if(w&&(r=_o[g]))return r;if(g==="hasOwnProperty")return bo}const u=Reflect.get(t,g,Pt(t)?t:v);return(ue(g)?Kr.has(g):Co(g))||(_||Et(t,"get",g),C)?u:Pt(u)?w&&un(g)?u:u.value:yt(u)?_?es(u):xi(u):u}}class $r extends qr{constructor(t=!1){super(!1,t)}set(t,g,v,_){let C=t[g];if(!this._isShallow){const r=Ce(C);if(!Xt(v)&&!Ce(v)&&(C=pt(C),v=pt(v)),!ut(t)&&Pt(C)&&!Pt(v))return r?!1:(C.value=v,!0)}const w=ut(t)&&un(g)?Number(g)<t.length:gt(t,g),u=Reflect.set(t,g,v,Pt(t)?t:_);return t===pt(_)&&(w?he(v,C)&&te(t,"set",g,v):te(t,"add",g,v)),u}deleteProperty(t,g){const v=gt(t,g);t[g];const _=Reflect.deleteProperty(t,g);return _&&v&&te(t,"delete",g,void 0),_}has(t,g){const v=Reflect.has(t,g);return(!ue(g)||!Kr.has(g))&&Et(t,"has",g),v}ownKeys(t){return Et(t,"iterate",ut(t)?"length":ve),Reflect.ownKeys(t)}}class So extends qr{constructor(t=!1){super(!0,t)}set(t,g){return!0}deleteProperty(t,g){return!0}}const xo=new $r,wo=new So,To=new $r(!0);const _n=s=>s,Si=s=>Reflect.getPrototypeOf(s);function ei(s,t,g=!1,v=!1){s=s.__v_raw;const _=pt(s),C=pt(t);g||(he(t,C)&&Et(_,"get",t),Et(_,"get",C));const{has:w}=Si(_),u=v?_n:g?Sn:Ot;if(w.call(_,t))return u(s.get(t));if(w.call(_,C))return u(s.get(C));s!==_&&s.get(t)}function ii(s,t=!1){const g=this.__v_raw,v=pt(g),_=pt(s);return t||(he(s,_)&&Et(v,"has",s),Et(v,"has",_)),s===_?g.has(s):g.has(s)||g.has(_)}function ni(s,t=!1){return s=s.__v_raw,!t&&Et(pt(s),"iterate",ve),Reflect.get(s,"size",s)}function jn(s,t=!1){!t&&!Xt(s)&&!Ce(s)&&(s=pt(s));const g=pt(this);return Si(g).has.call(g,s)||(g.add(s),te(g,"add",s,s)),this}function Bn(s,t,g=!1){!g&&!Xt(t)&&!Ce(t)&&(t=pt(t));const v=pt(this),{has:_,get:C}=Si(v);let w=_.call(v,s);w||(s=pt(s),w=_.call(v,s));const u=C.call(v,s);return v.set(s,t),w?he(t,u)&&te(v,"set",s,t):te(v,"add",s,t),this}function Xn(s){const t=pt(this),{has:g,get:v}=Si(t);let _=g.call(t,s);_||(s=pt(s),_=g.call(t,s)),v&&v.call(t,s);const C=t.delete(s);return _&&te(t,"delete",s,void 0),C}function Wn(){const s=pt(this),t=s.size!==0,g=s.clear();return t&&te(s,"clear",void 0,void 0),g}function ri(s,t){return function(v,_){const C=this,w=C.__v_raw,u=pt(w),r=t?_n:s?Sn:Ot;return!s&&Et(u,"iterate",ve),w.forEach((c,l)=>v.call(_,r(c),r(l),C))}}function si(s,t,g){return function(...v){const _=this.__v_raw,C=pt(_),w=Oe(C),u=s==="entries"||s===Symbol.iterator&&w,r=s==="keys"&&w,c=_[s](...v),l=g?_n:t?Sn:Ot;return!t&&Et(C,"iterate",r?Ki:ve),{next(){const{value:i,done:n}=c.next();return n?{value:i,done:n}:{value:u?[l(i[0]),l(i[1])]:l(i),done:n}},[Symbol.iterator](){return this}}}}function re(s){return function(...t){return s==="delete"?!1:s==="clear"?void 0:this}}function Oo(){const s={get(C){return ei(this,C)},get size(){return ni(this)},has:ii,add:jn,set:Bn,delete:Xn,clear:Wn,forEach:ri(!1,!1)},t={get(C){return ei(this,C,!1,!0)},get size(){return ni(this)},has:ii,add(C){return jn.call(this,C,!0)},set(C,w){return Bn.call(this,C,w,!0)},delete:Xn,clear:Wn,forEach:ri(!1,!0)},g={get(C){return ei(this,C,!0)},get size(){return ni(this,!0)},has(C){return ii.call(this,C,!0)},add:re("add"),set:re("set"),delete:re("delete"),clear:re("clear"),forEach:ri(!0,!1)},v={get(C){return ei(this,C,!0,!0)},get size(){return ni(this,!0)},has(C){return ii.call(this,C,!0)},add:re("add"),set:re("set"),delete:re("delete"),clear:re("clear"),forEach:ri(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(C=>{s[C]=si(C,!1,!1),g[C]=si(C,!0,!1),t[C]=si(C,!1,!0),v[C]=si(C,!0,!0)}),[s,g,t,v]}const[Po,Eo,Ao,Do]=Oo();function yn(s,t){const g=t?s?Do:Ao:s?Eo:Po;return(v,_,C)=>_==="__v_isReactive"?!s:_==="__v_isReadonly"?s:_==="__v_raw"?v:Reflect.get(gt(g,_)&&_ in v?g:v,_,C)}const Mo={get:yn(!1,!1)},ko={get:yn(!1,!0)},Fo={get:yn(!0,!1)};const Jr=new WeakMap,Qr=new WeakMap,Zr=new WeakMap,Ro=new WeakMap;function Lo(s){switch(s){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Io(s){return s.__v_skip||!Object.isExtensible(s)?0:Lo(no(s))}function xi(s){return Ce(s)?s:Cn(s,!1,xo,Mo,Jr)}function ts(s){return Cn(s,!1,To,ko,Qr)}function es(s){return Cn(s,!0,wo,Fo,Zr)}function Cn(s,t,g,v,_){if(!yt(s)||s.__v_raw&&!(t&&s.__v_isReactive))return s;const C=_.get(s);if(C)return C;const w=Io(s);if(w===0)return s;const u=new Proxy(s,w===2?v:g);return _.set(s,u),u}function Pe(s){return Ce(s)?Pe(s.__v_raw):!!(s&&s.__v_isReactive)}function Ce(s){return!!(s&&s.__v_isReadonly)}function Xt(s){return!!(s&&s.__v_isShallow)}function bn(s){return s?!!s.__v_raw:!1}function pt(s){const t=s&&s.__v_raw;return t?pt(t):s}function is(s){return!gt(s,"__v_skip")&&Object.isExtensible(s)&&Fr(s,"__v_skip",!0),s}const Ot=s=>yt(s)?xi(s):s,Sn=s=>yt(s)?es(s):s;function Pt(s){return s?s.__v_isRef===!0:!1}function di(s){return ns(s,!1)}function jo(s){return ns(s,!0)}function ns(s,t){return Pt(s)?s:new Bo(s,t)}class Bo{constructor(t,g){this.dep=new vn,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=g?t:pt(t),this._value=g?t:Ot(t),this.__v_isShallow=g}get value(){return this.dep.track(),this._value}set value(t){const g=this._rawValue,v=this.__v_isShallow||Xt(t)||Ce(t);t=v?t:pt(t),he(t,g)&&(this._rawValue=t,this._value=v?t:Ot(t),this.dep.trigger())}}function _e(s){return Pt(s)?s.value:s}const Xo={get:(s,t,g)=>t==="__v_raw"?s:_e(Reflect.get(s,t,g)),set:(s,t,g,v)=>{const _=s[t];return Pt(_)&&!Pt(g)?(_.value=g,!0):Reflect.set(s,t,g,v)}};function rs(s){return Pe(s)?s:new Proxy(s,Xo)}class Wo{constructor(t,g,v){this.fn=t,this.setter=g,this._value=void 0,this.dep=new vn(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ue-1,this.effect=this,this.__v_isReadonly=!g,this.isSSR=v}notify(){if(this.flags|=16,!(this.flags&8)&&vt!==this)return Yr(this),!0}get value(){const t=this.dep.track();return zr(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Ho(s,t,g=!1){let v,_;return dt(s)?v=s:(v=s.get,_=s.set),new Wo(v,_,g)}const oi={},gi=new WeakMap;let me;function Yo(s,t=!1,g=me){if(g){let v=gi.get(g);v||gi.set(g,v=[]),v.push(s)}}function No(s,t,g=_t){const{immediate:v,deep:_,once:C,scheduler:w,augmentJob:u,call:r}=g,c=m=>_?m:Xt(m)||_===!1||_===0?ce(m,1):ce(m);let l,i,n,e,o=!1,h=!1;if(Pt(s)?(i=()=>s.value,o=Xt(s)):Pe(s)?(i=()=>c(s),o=!0):ut(s)?(h=!0,o=s.some(m=>Pe(m)||Xt(m)),i=()=>s.map(m=>{if(Pt(m))return m.value;if(Pe(m))return c(m);if(dt(m))return r?r(m,2):m()})):dt(s)?t?i=r?()=>r(s,2):s:i=()=>{if(n){fe();try{n()}finally{de()}}const m=me;me=l;try{return r?r(s,3,[e]):s(e)}finally{me=m}}:i=Ht,t&&_){const m=i,y=_===!0?1/0:_;i=()=>ce(m(),y)}const a=po(),f=()=>{l.stop(),a&&hn(a.effects,l)};if(C&&t){const m=t;t=(...y)=>{m(...y),f()}}let d=h?new Array(s.length).fill(oi):oi;const p=m=>{if(!(!(l.flags&1)||!l.dirty&&!m))if(t){const y=l.run();if(_||o||(h?y.some((x,P)=>he(x,d[P])):he(y,d))){n&&n();const x=me;me=l;try{const P=[y,d===oi?void 0:h&&d[0]===oi?[]:d,e];r?r(t,3,P):t(...P),d=y}finally{me=x}}}else l.run()};return u&&u(p),l=new Wr(i),l.scheduler=w?()=>w(p,!1):p,e=m=>Yo(m,!1,l),n=l.onStop=()=>{const m=gi.get(l);if(m){if(r)r(m,4);else for(const y of m)y();gi.delete(l)}},t?v?p(!0):d=l.run():w?w(p.bind(null,!0),!0):l.run(),f.pause=l.pause.bind(l),f.resume=l.resume.bind(l),f.stop=f,f}function ce(s,t=1/0,g){if(t<=0||!yt(s)||s.__v_skip||(g=g||new Set,g.has(s)))return s;if(g.add(s),t--,Pt(s))ce(s.value,t,g);else if(ut(s))for(let v=0;v<s.length;v++)ce(s[v],t,g);else if(Er(s)||Oe(s))s.forEach(v=>{ce(v,t,g)});else if(Mr(s)){for(const v in s)ce(s[v],t,g);for(const v of Object.getOwnPropertySymbols(s))Object.prototype.propertyIsEnumerable.call(s,v)&&ce(s[v],t,g)}return s}/**
* @vue/runtime-core v3.5.8
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Qe(s,t,g,v){try{return v?s(...v):s()}catch(_){wi(_,t,g)}}function $t(s,t,g,v){if(dt(s)){const _=Qe(s,t,g,v);return _&&Ar(_)&&_.catch(C=>{wi(C,t,g)}),_}if(ut(s)){const _=[];for(let C=0;C<s.length;C++)_.push($t(s[C],t,g,v));return _}}function wi(s,t,g,v=!0){const _=t?t.vnode:null,{errorHandler:C,throwUnhandledErrorInProduction:w}=t&&t.appContext.config||_t;if(t){let u=t.parent;const r=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${g}`;for(;u;){const l=u.ec;if(l){for(let i=0;i<l.length;i++)if(l[i](s,r,c)===!1)return}u=u.parent}if(C){fe(),Qe(C,null,10,[s,r,c]),de();return}}Uo(s,g,_,v,w)}function Uo(s,t,g,v=!0,_=!1){if(_)throw s;console.error(s)}let Ve=!1,qi=!1;const kt=[];let Vt=0;const Ee=[];let oe=null,xe=0;const ss=Promise.resolve();let xn=null;function os(s){const t=xn||ss;return s?t.then(this?s.bind(this):s):t}function zo(s){let t=Ve?Vt+1:0,g=kt.length;for(;t<g;){const v=t+g>>>1,_=kt[v],C=Ge(_);C<s||C===s&&_.flags&2?t=v+1:g=v}return t}function wn(s){if(!(s.flags&1)){const t=Ge(s),g=kt[kt.length-1];!g||!(s.flags&2)&&t>=Ge(g)?kt.push(s):kt.splice(zo(t),0,s),s.flags|=1,as()}}function as(){!Ve&&!qi&&(qi=!0,xn=ss.then(cs))}function Vo(s){ut(s)?Ee.push(...s):oe&&s.id===-1?oe.splice(xe+1,0,s):s.flags&1||(Ee.push(s),s.flags|=1),as()}function Hn(s,t,g=Ve?Vt+1:0){for(;g<kt.length;g++){const v=kt[g];if(v&&v.flags&2){if(s&&v.id!==s.uid)continue;kt.splice(g,1),g--,v.flags&4&&(v.flags&=-2),v(),v.flags&4||(v.flags&=-2)}}}function ls(s){if(Ee.length){const t=[...new Set(Ee)].sort((g,v)=>Ge(g)-Ge(v));if(Ee.length=0,oe){oe.push(...t);return}for(oe=t,xe=0;xe<oe.length;xe++){const g=oe[xe];g.flags&4&&(g.flags&=-2),g.flags&8||g(),g.flags&=-2}oe=null,xe=0}}const Ge=s=>s.id==null?s.flags&2?-1:1/0:s.id;function cs(s){qi=!1,Ve=!0;const t=Ht;try{for(Vt=0;Vt<kt.length;Vt++){const g=kt[Vt];g&&!(g.flags&8)&&(g.flags&4&&(g.flags&=-2),Qe(g,g.i,g.i?15:14),g.flags&4||(g.flags&=-2))}}finally{for(;Vt<kt.length;Vt++){const g=kt[Vt];g&&(g.flags&=-2)}Vt=0,kt.length=0,ls(),Ve=!1,xn=null,(kt.length||Ee.length)&&cs()}}let qt=null,hs=null;function pi(s){const t=qt;return qt=s,hs=s&&s.type.__scopeId||null,t}function Go(s,t=qt,g){if(!t||s._n)return s;const v=(..._)=>{v._d&&qn(-1);const C=pi(t);let w;try{w=s(..._)}finally{pi(C),v._d&&qn(1)}return w};return v._n=!0,v._c=!0,v._d=!0,v}function ge(s,t,g,v){const _=s.dirs,C=t&&t.dirs;for(let w=0;w<_.length;w++){const u=_[w];C&&(u.oldValue=C[w].value);let r=u.dir[v];r&&(fe(),$t(r,g,8,[s.el,u,s,t]),de())}}const Ko=Symbol("_vte"),qo=s=>s.__isTeleport;function Tn(s,t){s.shapeFlag&6&&s.component?(s.transition=t,Tn(s.component.subTree,t)):s.shapeFlag&128?(s.ssContent.transition=t.clone(s.ssContent),s.ssFallback.transition=t.clone(s.ssFallback)):s.transition=t}/*! #__NO_SIDE_EFFECTS__ */function us(s,t){return dt(s)?(()=>Tt({name:s.name},t,{setup:s}))():s}function fs(s){s.ids=[s.ids[0]+s.ids[2]+++"-",0,0]}function $i(s,t,g,v,_=!1){if(ut(s)){s.forEach((o,h)=>$i(o,t&&(ut(t)?t[h]:t),g,v,_));return}if(Xe(v)&&!_)return;const C=v.shapeFlag&4?An(v.component):v.el,w=_?null:C,{i:u,r}=s,c=t&&t.r,l=u.refs===_t?u.refs={}:u.refs,i=u.setupState,n=pt(i),e=i===_t?()=>!1:o=>gt(n,o);if(c!=null&&c!==r&&(xt(c)?(l[c]=null,e(c)&&(i[c]=null)):Pt(c)&&(c.value=null)),dt(r))Qe(r,u,12,[w,l]);else{const o=xt(r),h=Pt(r);if(o||h){const a=()=>{if(s.f){const f=o?e(r)?i[r]:l[r]:r.value;_?ut(f)&&hn(f,C):ut(f)?f.includes(C)||f.push(C):o?(l[r]=[C],e(r)&&(i[r]=l[r])):(r.value=[C],s.k&&(l[s.k]=r.value))}else o?(l[r]=w,e(r)&&(i[r]=w)):h&&(r.value=w,s.k&&(l[s.k]=w))};w?(a.id=-1,Rt(a,g)):a()}}}const Xe=s=>!!s.type.__asyncLoader,ds=s=>s.type.__isKeepAlive;function $o(s,t){gs(s,"a",t)}function Jo(s,t){gs(s,"da",t)}function gs(s,t,g=Ft){const v=s.__wdc||(s.__wdc=()=>{let _=g;for(;_;){if(_.isDeactivated)return;_=_.parent}return s()});if(Ti(t,v,g),g){let _=g.parent;for(;_&&_.parent;)ds(_.parent.vnode)&&Qo(v,t,g,_),_=_.parent}}function Qo(s,t,g,v){const _=Ti(t,s,v,!0);ms(()=>{hn(v[t],_)},g)}function Ti(s,t,g=Ft,v=!1){if(g){const _=g[s]||(g[s]=[]),C=t.__weh||(t.__weh=(...w)=>{fe();const u=Ze(g),r=$t(t,g,s,w);return u(),de(),r});return v?_.unshift(C):_.push(C),C}}const ie=s=>(t,g=Ft)=>{(!Ei||s==="sp")&&Ti(s,(...v)=>t(...v),g)},Zo=ie("bm"),ps=ie("m"),ta=ie("bu"),ea=ie("u"),ia=ie("bum"),ms=ie("um"),na=ie("sp"),ra=ie("rtg"),sa=ie("rtc");function oa(s,t=Ft){Ti("ec",s,t)}const aa=Symbol.for("v-ndc");function la(s,t,g,v){let _;const C=g&&g[v],w=ut(s);if(w||xt(s)){const u=w&&Pe(s);let r=!1;u&&(r=!Xt(s),s=bi(s)),_=new Array(s.length);for(let c=0,l=s.length;c<l;c++)_[c]=t(r?Ot(s[c]):s[c],c,void 0,C&&C[c])}else if(typeof s=="number"){_=new Array(s);for(let u=0;u<s;u++)_[u]=t(u+1,u,void 0,C&&C[u])}else if(yt(s))if(s[Symbol.iterator])_=Array.from(s,(u,r)=>t(u,r,void 0,C&&C[r]));else{const u=Object.keys(s);_=new Array(u.length);for(let r=0,c=u.length;r<c;r++){const l=u[r];_[r]=t(s[l],l,r,C&&C[r])}}else _=[];return g&&(g[v]=_),_}const Ji=s=>s?Is(s)?An(s):Ji(s.parent):null,We=Tt(Object.create(null),{$:s=>s,$el:s=>s.vnode.el,$data:s=>s.data,$props:s=>s.props,$attrs:s=>s.attrs,$slots:s=>s.slots,$refs:s=>s.refs,$parent:s=>Ji(s.parent),$root:s=>Ji(s.root),$host:s=>s.ce,$emit:s=>s.emit,$options:s=>On(s),$forceUpdate:s=>s.f||(s.f=()=>{wn(s.update)}),$nextTick:s=>s.n||(s.n=os.bind(s.proxy)),$watch:s=>Aa.bind(s)}),Ii=(s,t)=>s!==_t&&!s.__isScriptSetup&&gt(s,t),ca={get({_:s},t){if(t==="__v_skip")return!0;const{ctx:g,setupState:v,data:_,props:C,accessCache:w,type:u,appContext:r}=s;let c;if(t[0]!=="$"){const e=w[t];if(e!==void 0)switch(e){case 1:return v[t];case 2:return _[t];case 4:return g[t];case 3:return C[t]}else{if(Ii(v,t))return w[t]=1,v[t];if(_!==_t&&gt(_,t))return w[t]=2,_[t];if((c=s.propsOptions[0])&&gt(c,t))return w[t]=3,C[t];if(g!==_t&&gt(g,t))return w[t]=4,g[t];Qi&&(w[t]=0)}}const l=We[t];let i,n;if(l)return t==="$attrs"&&Et(s.attrs,"get",""),l(s);if((i=u.__cssModules)&&(i=i[t]))return i;if(g!==_t&&gt(g,t))return w[t]=4,g[t];if(n=r.config.globalProperties,gt(n,t))return n[t]},set({_:s},t,g){const{data:v,setupState:_,ctx:C}=s;return Ii(_,t)?(_[t]=g,!0):v!==_t&&gt(v,t)?(v[t]=g,!0):gt(s.props,t)||t[0]==="$"&&t.slice(1)in s?!1:(C[t]=g,!0)},has({_:{data:s,setupState:t,accessCache:g,ctx:v,appContext:_,propsOptions:C}},w){let u;return!!g[w]||s!==_t&&gt(s,w)||Ii(t,w)||(u=C[0])&&gt(u,w)||gt(v,w)||gt(We,w)||gt(_.config.globalProperties,w)},defineProperty(s,t,g){return g.get!=null?s._.accessCache[t]=0:gt(g,"value")&&this.set(s,t,g.value,null),Reflect.defineProperty(s,t,g)}};function Yn(s){return ut(s)?s.reduce((t,g)=>(t[g]=null,t),{}):s}let Qi=!0;function ha(s){const t=On(s),g=s.proxy,v=s.ctx;Qi=!1,t.beforeCreate&&Nn(t.beforeCreate,s,"bc");const{data:_,computed:C,methods:w,watch:u,provide:r,inject:c,created:l,beforeMount:i,mounted:n,beforeUpdate:e,updated:o,activated:h,deactivated:a,beforeDestroy:f,beforeUnmount:d,destroyed:p,unmounted:m,render:y,renderTracked:x,renderTriggered:P,errorCaptured:B,serverPrefetch:z,expose:q,inheritAttrs:Z,components:rt,directives:ot,filters:et}=t;if(c&&ua(c,v,null),w)for(const st in w){const tt=w[st];dt(tt)&&(v[st]=tt.bind(g))}if(_){const st=_.call(g,g);yt(st)&&(s.data=xi(st))}if(Qi=!0,C)for(const st in C){const tt=C[st],T=dt(tt)?tt.bind(g,g):dt(tt.get)?tt.get.bind(g,g):Ht,R=!dt(tt)&&dt(tt.set)?tt.set.bind(g):Ht,F=Wt({get:T,set:R});Object.defineProperty(v,st,{enumerable:!0,configurable:!0,get:()=>F.value,set:k=>F.value=k})}if(u)for(const st in u)vs(u[st],v,g,st);if(r){const st=dt(r)?r.call(g):r;Reflect.ownKeys(st).forEach(tt=>{ai(tt,st[tt])})}l&&Nn(l,s,"c");function at(st,tt){ut(tt)?tt.forEach(T=>st(T.bind(g))):tt&&st(tt.bind(g))}if(at(Zo,i),at(ps,n),at(ta,e),at(ea,o),at($o,h),at(Jo,a),at(oa,B),at(sa,x),at(ra,P),at(ia,d),at(ms,m),at(na,z),ut(q))if(q.length){const st=s.exposed||(s.exposed={});q.forEach(tt=>{Object.defineProperty(st,tt,{get:()=>g[tt],set:T=>g[tt]=T})})}else s.exposed||(s.exposed={});y&&s.render===Ht&&(s.render=y),Z!=null&&(s.inheritAttrs=Z),rt&&(s.components=rt),ot&&(s.directives=ot),z&&fs(s)}function ua(s,t,g=Ht){ut(s)&&(s=Zi(s));for(const v in s){const _=s[v];let C;yt(_)?"default"in _?C=ee(_.from||v,_.default,!0):C=ee(_.from||v):C=ee(_),Pt(C)?Object.defineProperty(t,v,{enumerable:!0,configurable:!0,get:()=>C.value,set:w=>C.value=w}):t[v]=C}}function Nn(s,t,g){$t(ut(s)?s.map(v=>v.bind(t.proxy)):s.bind(t.proxy),t,g)}function vs(s,t,g,v){let _=v.includes(".")?Ms(g,v):()=>g[v];if(xt(s)){const C=t[s];dt(C)&&li(_,C)}else if(dt(s))li(_,s.bind(g));else if(yt(s))if(ut(s))s.forEach(C=>vs(C,t,g,v));else{const C=dt(s.handler)?s.handler.bind(g):t[s.handler];dt(C)&&li(_,C,s)}}function On(s){const t=s.type,{mixins:g,extends:v}=t,{mixins:_,optionsCache:C,config:{optionMergeStrategies:w}}=s.appContext,u=C.get(t);let r;return u?r=u:!_.length&&!g&&!v?r=t:(r={},_.length&&_.forEach(c=>mi(r,c,w,!0)),mi(r,t,w)),yt(t)&&C.set(t,r),r}function mi(s,t,g,v=!1){const{mixins:_,extends:C}=t;C&&mi(s,C,g,!0),_&&_.forEach(w=>mi(s,w,g,!0));for(const w in t)if(!(v&&w==="expose")){const u=fa[w]||g&&g[w];s[w]=u?u(s[w],t[w]):t[w]}return s}const fa={data:Un,props:zn,emits:zn,methods:Ie,computed:Ie,beforeCreate:Mt,created:Mt,beforeMount:Mt,mounted:Mt,beforeUpdate:Mt,updated:Mt,beforeDestroy:Mt,beforeUnmount:Mt,destroyed:Mt,unmounted:Mt,activated:Mt,deactivated:Mt,errorCaptured:Mt,serverPrefetch:Mt,components:Ie,directives:Ie,watch:ga,provide:Un,inject:da};function Un(s,t){return t?s?function(){return Tt(dt(s)?s.call(this,this):s,dt(t)?t.call(this,this):t)}:t:s}function da(s,t){return Ie(Zi(s),Zi(t))}function Zi(s){if(ut(s)){const t={};for(let g=0;g<s.length;g++)t[s[g]]=s[g];return t}return s}function Mt(s,t){return s?[...new Set([].concat(s,t))]:t}function Ie(s,t){return s?Tt(Object.create(null),s,t):t}function zn(s,t){return s?ut(s)&&ut(t)?[...new Set([...s,...t])]:Tt(Object.create(null),Yn(s),Yn(t??{})):t}function ga(s,t){if(!s)return t;if(!t)return s;const g=Tt(Object.create(null),s);for(const v in t)g[v]=Mt(s[v],t[v]);return g}function _s(){return{app:null,config:{isNativeTag:eo,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let pa=0;function ma(s,t){return function(v,_=null){dt(v)||(v=Tt({},v)),_!=null&&!yt(_)&&(_=null);const C=_s(),w=new WeakSet,u=[];let r=!1;const c=C.app={_uid:pa++,_component:v,_props:_,_container:null,_context:C,_instance:null,version:Ja,get config(){return C.config},set config(l){},use(l,...i){return w.has(l)||(l&&dt(l.install)?(w.add(l),l.install(c,...i)):dt(l)&&(w.add(l),l(c,...i))),c},mixin(l){return C.mixins.includes(l)||C.mixins.push(l),c},component(l,i){return i?(C.components[l]=i,c):C.components[l]},directive(l,i){return i?(C.directives[l]=i,c):C.directives[l]},mount(l,i,n){if(!r){const e=c._ceVNode||Bt(v,_);return e.appContext=C,n===!0?n="svg":n===!1&&(n=void 0),i&&t?t(e,l):s(e,l,n),r=!0,c._container=l,l.__vue_app__=c,An(e.component)}},onUnmount(l){u.push(l)},unmount(){r&&($t(u,c._instance,16),s(null,c._container),delete c._container.__vue_app__)},provide(l,i){return C.provides[l]=i,c},runWithContext(l){const i=Ae;Ae=c;try{return l()}finally{Ae=i}}};return c}}let Ae=null;function ai(s,t){if(Ft){let g=Ft.provides;const v=Ft.parent&&Ft.parent.provides;v===g&&(g=Ft.provides=Object.create(v)),g[s]=t}}function ee(s,t,g=!1){const v=Ft||qt;if(v||Ae){const _=Ae?Ae._context.provides:v?v.parent==null?v.vnode.appContext&&v.vnode.appContext.provides:v.parent.provides:void 0;if(_&&s in _)return _[s];if(arguments.length>1)return g&&dt(t)?t.call(v&&v.proxy):t}}const ys={},Cs=()=>Object.create(ys),bs=s=>Object.getPrototypeOf(s)===ys;function va(s,t,g,v=!1){const _={},C=Cs();s.propsDefaults=Object.create(null),Ss(s,t,_,C);for(const w in s.propsOptions[0])w in _||(_[w]=void 0);g?s.props=v?_:ts(_):s.type.props?s.props=_:s.props=C,s.attrs=C}function _a(s,t,g,v){const{props:_,attrs:C,vnode:{patchFlag:w}}=s,u=pt(_),[r]=s.propsOptions;let c=!1;if((v||w>0)&&!(w&16)){if(w&8){const l=s.vnode.dynamicProps;for(let i=0;i<l.length;i++){let n=l[i];if(Oi(s.emitsOptions,n))continue;const e=t[n];if(r)if(gt(C,n))e!==C[n]&&(C[n]=e,c=!0);else{const o=ye(n);_[o]=tn(r,u,o,e,s,!1)}else e!==C[n]&&(C[n]=e,c=!0)}}}else{Ss(s,t,_,C)&&(c=!0);let l;for(const i in u)(!t||!gt(t,i)&&((l=be(i))===i||!gt(t,l)))&&(r?g&&(g[i]!==void 0||g[l]!==void 0)&&(_[i]=tn(r,u,i,void 0,s,!0)):delete _[i]);if(C!==u)for(const i in C)(!t||!gt(t,i))&&(delete C[i],c=!0)}c&&te(s.attrs,"set","")}function Ss(s,t,g,v){const[_,C]=s.propsOptions;let w=!1,u;if(t)for(let r in t){if(je(r))continue;const c=t[r];let l;_&&gt(_,l=ye(r))?!C||!C.includes(l)?g[l]=c:(u||(u={}))[l]=c:Oi(s.emitsOptions,r)||(!(r in v)||c!==v[r])&&(v[r]=c,w=!0)}if(C){const r=pt(g),c=u||_t;for(let l=0;l<C.length;l++){const i=C[l];g[i]=tn(_,r,i,c[i],s,!gt(c,i))}}return w}function tn(s,t,g,v,_,C){const w=s[g];if(w!=null){const u=gt(w,"default");if(u&&v===void 0){const r=w.default;if(w.type!==Function&&!w.skipFactory&&dt(r)){const{propsDefaults:c}=_;if(g in c)v=c[g];else{const l=Ze(_);v=c[g]=r.call(null,t),l()}}else v=r;_.ce&&_.ce._setProp(g,v)}w[0]&&(C&&!u?v=!1:w[1]&&(v===""||v===be(g))&&(v=!0))}return v}const ya=new WeakMap;function xs(s,t,g=!1){const v=g?ya:t.propsCache,_=v.get(s);if(_)return _;const C=s.props,w={},u=[];let r=!1;if(!dt(s)){const l=i=>{r=!0;const[n,e]=xs(i,t,!0);Tt(w,n),e&&u.push(...e)};!g&&t.mixins.length&&t.mixins.forEach(l),s.extends&&l(s.extends),s.mixins&&s.mixins.forEach(l)}if(!C&&!r)return yt(s)&&v.set(s,Te),Te;if(ut(C))for(let l=0;l<C.length;l++){const i=ye(C[l]);Vn(i)&&(w[i]=_t)}else if(C)for(const l in C){const i=ye(l);if(Vn(i)){const n=C[l],e=w[i]=ut(n)||dt(n)?{type:n}:Tt({},n),o=e.type;let h=!1,a=!0;if(ut(o))for(let f=0;f<o.length;++f){const d=o[f],p=dt(d)&&d.name;if(p==="Boolean"){h=!0;break}else p==="String"&&(a=!1)}else h=dt(o)&&o.name==="Boolean";e[0]=h,e[1]=a,(h||gt(e,"default"))&&u.push(i)}}const c=[w,u];return yt(s)&&v.set(s,c),c}function Vn(s){return s[0]!=="$"&&!je(s)}const ws=s=>s[0]==="_"||s==="$stable",Pn=s=>ut(s)?s.map(Kt):[Kt(s)],Ca=(s,t,g)=>{if(t._n)return t;const v=Go((..._)=>Pn(t(..._)),g);return v._c=!1,v},Ts=(s,t,g)=>{const v=s._ctx;for(const _ in s){if(ws(_))continue;const C=s[_];if(dt(C))t[_]=Ca(_,C,v);else if(C!=null){const w=Pn(C);t[_]=()=>w}}},Os=(s,t)=>{const g=Pn(t);s.slots.default=()=>g},Ps=(s,t,g)=>{for(const v in t)(g||v!=="_")&&(s[v]=t[v])},ba=(s,t,g)=>{const v=s.slots=Cs();if(s.vnode.shapeFlag&32){const _=t._;_?(Ps(v,t,g),g&&Fr(v,"_",_,!0)):Ts(t,v)}else t&&Os(s,t)},Sa=(s,t,g)=>{const{vnode:v,slots:_}=s;let C=!0,w=_t;if(v.shapeFlag&32){const u=t._;u?g&&u===1?C=!1:Ps(_,t,g):(C=!t.$stable,Ts(t,_)),w=t}else t&&(Os(s,t),w={default:1});if(C)for(const u in _)!ws(u)&&w[u]==null&&delete _[u]},Rt=Ia;function xa(s){return wa(s)}function wa(s,t){const g=Rr();g.__VUE__=!0;const{insert:v,remove:_,patchProp:C,createElement:w,createText:u,createComment:r,setText:c,setElementText:l,parentNode:i,nextSibling:n,setScopeId:e=Ht,insertStaticContent:o}=s,h=(S,b,A,L=null,M=null,X=null,N=void 0,K=null,V=!!b.dynamicChildren)=>{if(S===b)return;S&&!Re(S,b)&&(L=E(S),k(S,M,X,!0),S=null),b.patchFlag===-2&&(V=!1,b.dynamicChildren=null);const{type:j,ref:Q,shapeFlag:$}=b;switch(j){case Pi:a(S,b,A,L);break;case Ke:f(S,b,A,L);break;case Xi:S==null&&d(b,A,L,N);break;case Gt:rt(S,b,A,L,M,X,N,K,V);break;default:$&1?y(S,b,A,L,M,X,N,K,V):$&6?ot(S,b,A,L,M,X,N,K,V):($&64||$&128)&&j.process(S,b,A,L,M,X,N,K,V,Y)}Q!=null&&M&&$i(Q,S&&S.ref,X,b||S,!b)},a=(S,b,A,L)=>{if(S==null)v(b.el=u(b.children),A,L);else{const M=b.el=S.el;b.children!==S.children&&c(M,b.children)}},f=(S,b,A,L)=>{S==null?v(b.el=r(b.children||""),A,L):b.el=S.el},d=(S,b,A,L)=>{[S.el,S.anchor]=o(S.children,b,A,L,S.el,S.anchor)},p=({el:S,anchor:b},A,L)=>{let M;for(;S&&S!==b;)M=n(S),v(S,A,L),S=M;v(b,A,L)},m=({el:S,anchor:b})=>{let A;for(;S&&S!==b;)A=n(S),_(S),S=A;_(b)},y=(S,b,A,L,M,X,N,K,V)=>{b.type==="svg"?N="svg":b.type==="math"&&(N="mathml"),S==null?x(b,A,L,M,X,N,K,V):z(S,b,M,X,N,K,V)},x=(S,b,A,L,M,X,N,K)=>{let V,j;const{props:Q,shapeFlag:$,transition:it,dirs:lt}=S;if(V=S.el=w(S.type,X,Q&&Q.is,Q),$&8?l(V,S.children):$&16&&B(S.children,V,null,L,M,ji(S,X),N,K),lt&&ge(S,null,L,"created"),P(V,S,S.scopeId,N,L),Q){for(const ft in Q)ft!=="value"&&!je(ft)&&C(V,ft,null,Q[ft],X,L);"value"in Q&&C(V,"value",null,Q.value,X),(j=Q.onVnodeBeforeMount)&&zt(j,L,S)}lt&&ge(S,null,L,"beforeMount");const ct=Ta(M,it);ct&&it.beforeEnter(V),v(V,b,A),((j=Q&&Q.onVnodeMounted)||ct||lt)&&Rt(()=>{j&&zt(j,L,S),ct&&it.enter(V),lt&&ge(S,null,L,"mounted")},M)},P=(S,b,A,L,M)=>{if(A&&e(S,A),L)for(let X=0;X<L.length;X++)e(S,L[X]);if(M){let X=M.subTree;if(b===X||Fs(X.type)&&(X.ssContent===b||X.ssFallback===b)){const N=M.vnode;P(S,N,N.scopeId,N.slotScopeIds,M.parent)}}},B=(S,b,A,L,M,X,N,K,V=0)=>{for(let j=V;j<S.length;j++){const Q=S[j]=K?ae(S[j]):Kt(S[j]);h(null,Q,b,A,L,M,X,N,K)}},z=(S,b,A,L,M,X,N)=>{const K=b.el=S.el;let{patchFlag:V,dynamicChildren:j,dirs:Q}=b;V|=S.patchFlag&16;const $=S.props||_t,it=b.props||_t;let lt;if(A&&pe(A,!1),(lt=it.onVnodeBeforeUpdate)&&zt(lt,A,b,S),Q&&ge(b,S,A,"beforeUpdate"),A&&pe(A,!0),($.innerHTML&&it.innerHTML==null||$.textContent&&it.textContent==null)&&l(K,""),j?q(S.dynamicChildren,j,K,A,L,ji(b,M),X):N||tt(S,b,K,null,A,L,ji(b,M),X,!1),V>0){if(V&16)Z(K,$,it,A,M);else if(V&2&&$.class!==it.class&&C(K,"class",null,it.class,M),V&4&&C(K,"style",$.style,it.style,M),V&8){const ct=b.dynamicProps;for(let ft=0;ft<ct.length;ft++){const ht=ct[ft],St=$[ht],Ct=it[ht];(Ct!==St||ht==="value")&&C(K,ht,St,Ct,M,A)}}V&1&&S.children!==b.children&&l(K,b.children)}else!N&&j==null&&Z(K,$,it,A,M);((lt=it.onVnodeUpdated)||Q)&&Rt(()=>{lt&&zt(lt,A,b,S),Q&&ge(b,S,A,"updated")},L)},q=(S,b,A,L,M,X,N)=>{for(let K=0;K<b.length;K++){const V=S[K],j=b[K],Q=V.el&&(V.type===Gt||!Re(V,j)||V.shapeFlag&70)?i(V.el):A;h(V,j,Q,null,L,M,X,N,!0)}},Z=(S,b,A,L,M)=>{if(b!==A){if(b!==_t)for(const X in b)!je(X)&&!(X in A)&&C(S,X,b[X],null,M,L);for(const X in A){if(je(X))continue;const N=A[X],K=b[X];N!==K&&X!=="value"&&C(S,X,K,N,M,L)}"value"in A&&C(S,"value",b.value,A.value,M)}},rt=(S,b,A,L,M,X,N,K,V)=>{const j=b.el=S?S.el:u(""),Q=b.anchor=S?S.anchor:u("");let{patchFlag:$,dynamicChildren:it,slotScopeIds:lt}=b;lt&&(K=K?K.concat(lt):lt),S==null?(v(j,A,L),v(Q,A,L),B(b.children||[],A,Q,M,X,N,K,V)):$>0&&$&64&&it&&S.dynamicChildren?(q(S.dynamicChildren,it,A,M,X,N,K),(b.key!=null||M&&b===M.subTree)&&Es(S,b,!0)):tt(S,b,A,Q,M,X,N,K,V)},ot=(S,b,A,L,M,X,N,K,V)=>{b.slotScopeIds=K,S==null?b.shapeFlag&512?M.ctx.activate(b,A,L,N,V):et(b,A,L,M,X,N,V):nt(S,b,V)},et=(S,b,A,L,M,X,N)=>{const K=S.component=za(S,L,M);if(ds(S)&&(K.ctx.renderer=Y),Va(K,!1,N),K.asyncDep){if(M&&M.registerDep(K,at,N),!S.el){const V=K.subTree=Bt(Ke);f(null,V,b,A)}}else at(K,S,b,A,M,X,N)},nt=(S,b,A)=>{const L=b.component=S.component;if(Ra(S,b,A))if(L.asyncDep&&!L.asyncResolved){st(L,b,A);return}else L.next=b,L.update();else b.el=S.el,L.vnode=b},at=(S,b,A,L,M,X,N)=>{const K=()=>{if(S.isMounted){let{next:$,bu:it,u:lt,parent:ct,vnode:ft}=S;{const At=As(S);if(At){$&&($.el=ft.el,st(S,$,N)),At.asyncDep.then(()=>{S.isUnmounted||K()});return}}let ht=$,St;pe(S,!1),$?($.el=ft.el,st(S,$,N)):$=ft,it&&Mi(it),(St=$.props&&$.props.onVnodeBeforeUpdate)&&zt(St,ct,$,ft),pe(S,!0);const Ct=Bi(S),bt=S.subTree;S.subTree=Ct,h(bt,Ct,i(bt.el),E(bt),S,M,X),$.el=Ct.el,ht===null&&La(S,Ct.el),lt&&Rt(lt,M),(St=$.props&&$.props.onVnodeUpdated)&&Rt(()=>zt(St,ct,$,ft),M)}else{let $;const{el:it,props:lt}=b,{bm:ct,m:ft,parent:ht,root:St,type:Ct}=S,bt=Xe(b);if(pe(S,!1),ct&&Mi(ct),!bt&&($=lt&&lt.onVnodeBeforeMount)&&zt($,ht,b),pe(S,!0),it&&J){const At=()=>{S.subTree=Bi(S),J(it,S.subTree,S,M,null)};bt&&Ct.__asyncHydrate?Ct.__asyncHydrate(it,S,At):At()}else{St.ce&&St.ce._injectChildStyle(Ct);const At=S.subTree=Bi(S);h(null,At,A,L,S,M,X),b.el=At.el}if(ft&&Rt(ft,M),!bt&&($=lt&&lt.onVnodeMounted)){const At=b;Rt(()=>zt($,ht,At),M)}(b.shapeFlag&256||ht&&Xe(ht.vnode)&&ht.vnode.shapeFlag&256)&&S.a&&Rt(S.a,M),S.isMounted=!0,b=A=L=null}};S.scope.on();const V=S.effect=new Wr(K);S.scope.off();const j=S.update=V.run.bind(V),Q=S.job=V.runIfDirty.bind(V);Q.i=S,Q.id=S.uid,V.scheduler=()=>wn(Q),pe(S,!0),j()},st=(S,b,A)=>{b.component=S;const L=S.vnode.props;S.vnode=b,S.next=null,_a(S,b.props,L,A),Sa(S,b.children,A),fe(),Hn(S),de()},tt=(S,b,A,L,M,X,N,K,V=!1)=>{const j=S&&S.children,Q=S?S.shapeFlag:0,$=b.children,{patchFlag:it,shapeFlag:lt}=b;if(it>0){if(it&128){R(j,$,A,L,M,X,N,K,V);return}else if(it&256){T(j,$,A,L,M,X,N,K,V);return}}lt&8?(Q&16&&W(j,M,X),$!==j&&l(A,$)):Q&16?lt&16?R(j,$,A,L,M,X,N,K,V):W(j,M,X,!0):(Q&8&&l(A,""),lt&16&&B($,A,L,M,X,N,K,V))},T=(S,b,A,L,M,X,N,K,V)=>{S=S||Te,b=b||Te;const j=S.length,Q=b.length,$=Math.min(j,Q);let it;for(it=0;it<$;it++){const lt=b[it]=V?ae(b[it]):Kt(b[it]);h(S[it],lt,A,null,M,X,N,K,V)}j>Q?W(S,M,X,!0,!1,$):B(b,A,L,M,X,N,K,V,$)},R=(S,b,A,L,M,X,N,K,V)=>{let j=0;const Q=b.length;let $=S.length-1,it=Q-1;for(;j<=$&&j<=it;){const lt=S[j],ct=b[j]=V?ae(b[j]):Kt(b[j]);if(Re(lt,ct))h(lt,ct,A,null,M,X,N,K,V);else break;j++}for(;j<=$&&j<=it;){const lt=S[$],ct=b[it]=V?ae(b[it]):Kt(b[it]);if(Re(lt,ct))h(lt,ct,A,null,M,X,N,K,V);else break;$--,it--}if(j>$){if(j<=it){const lt=it+1,ct=lt<Q?b[lt].el:L;for(;j<=it;)h(null,b[j]=V?ae(b[j]):Kt(b[j]),A,ct,M,X,N,K,V),j++}}else if(j>it)for(;j<=$;)k(S[j],M,X,!0),j++;else{const lt=j,ct=j,ft=new Map;for(j=ct;j<=it;j++){const Dt=b[j]=V?ae(b[j]):Kt(b[j]);Dt.key!=null&&ft.set(Dt.key,j)}let ht,St=0;const Ct=it-ct+1;let bt=!1,At=0;const ne=new Array(Ct);for(j=0;j<Ct;j++)ne[j]=0;for(j=lt;j<=$;j++){const Dt=S[j];if(St>=Ct){k(Dt,M,X,!0);continue}let Ut;if(Dt.key!=null)Ut=ft.get(Dt.key);else for(ht=ct;ht<=it;ht++)if(ne[ht-ct]===0&&Re(Dt,b[ht])){Ut=ht;break}Ut===void 0?k(Dt,M,X,!0):(ne[Ut-ct]=j+1,Ut>=At?At=Ut:bt=!0,h(Dt,b[Ut],A,null,M,X,N,K,V),St++)}const ti=bt?Oa(ne):Te;for(ht=ti.length-1,j=Ct-1;j>=0;j--){const Dt=ct+j,Ut=b[Dt],Fn=Dt+1<Q?b[Dt+1].el:L;ne[j]===0?h(null,Ut,A,Fn,M,X,N,K,V):bt&&(ht<0||j!==ti[ht]?F(Ut,A,Fn,2):ht--)}}},F=(S,b,A,L,M=null)=>{const{el:X,type:N,transition:K,children:V,shapeFlag:j}=S;if(j&6){F(S.component.subTree,b,A,L);return}if(j&128){S.suspense.move(b,A,L);return}if(j&64){N.move(S,b,A,Y);return}if(N===Gt){v(X,b,A);for(let $=0;$<V.length;$++)F(V[$],b,A,L);v(S.anchor,b,A);return}if(N===Xi){p(S,b,A);return}if(L!==2&&j&1&&K)if(L===0)K.beforeEnter(X),v(X,b,A),Rt(()=>K.enter(X),M);else{const{leave:$,delayLeave:it,afterLeave:lt}=K,ct=()=>v(X,b,A),ft=()=>{$(X,()=>{ct(),lt&&lt()})};it?it(X,ct,ft):ft()}else v(X,b,A)},k=(S,b,A,L=!1,M=!1)=>{const{type:X,props:N,ref:K,children:V,dynamicChildren:j,shapeFlag:Q,patchFlag:$,dirs:it,cacheIndex:lt}=S;if($===-2&&(M=!1),K!=null&&$i(K,null,A,S,!0),lt!=null&&(b.renderCache[lt]=void 0),Q&256){b.ctx.deactivate(S);return}const ct=Q&1&&it,ft=!Xe(S);let ht;if(ft&&(ht=N&&N.onVnodeBeforeUnmount)&&zt(ht,b,S),Q&6)O(S.component,A,L);else{if(Q&128){S.suspense.unmount(A,L);return}ct&&ge(S,null,b,"beforeUnmount"),Q&64?S.type.remove(S,b,A,Y,L):j&&!j.hasOnce&&(X!==Gt||$>0&&$&64)?W(j,b,A,!1,!0):(X===Gt&&$&384||!M&&Q&16)&&W(V,b,A),L&&U(S)}(ft&&(ht=N&&N.onVnodeUnmounted)||ct)&&Rt(()=>{ht&&zt(ht,b,S),ct&&ge(S,null,b,"unmounted")},A)},U=S=>{const{type:b,el:A,anchor:L,transition:M}=S;if(b===Gt){D(A,L);return}if(b===Xi){m(S);return}const X=()=>{_(A),M&&!M.persisted&&M.afterLeave&&M.afterLeave()};if(S.shapeFlag&1&&M&&!M.persisted){const{leave:N,delayLeave:K}=M,V=()=>N(A,X);K?K(S.el,X,V):V()}else X()},D=(S,b)=>{let A;for(;S!==b;)A=n(S),_(S),S=A;_(b)},O=(S,b,A)=>{const{bum:L,scope:M,job:X,subTree:N,um:K,m:V,a:j}=S;Gn(V),Gn(j),L&&Mi(L),M.stop(),X&&(X.flags|=8,k(N,S,b,A)),K&&Rt(K,b),Rt(()=>{S.isUnmounted=!0},b),b&&b.pendingBranch&&!b.isUnmounted&&S.asyncDep&&!S.asyncResolved&&S.suspenseId===b.pendingId&&(b.deps--,b.deps===0&&b.resolve())},W=(S,b,A,L=!1,M=!1,X=0)=>{for(let N=X;N<S.length;N++)k(S[N],b,A,L,M)},E=S=>{if(S.shapeFlag&6)return E(S.component.subTree);if(S.shapeFlag&128)return S.suspense.next();const b=n(S.anchor||S.el),A=b&&b[Ko];return A?n(A):b};let H=!1;const I=(S,b,A)=>{S==null?b._vnode&&k(b._vnode,null,null,!0):h(b._vnode||null,S,b,null,null,null,A),b._vnode=S,H||(H=!0,Hn(),ls(),H=!1)},Y={p:h,um:k,m:F,r:U,mt:et,mc:B,pc:tt,pbc:q,n:E,o:s};let G,J;return t&&([G,J]=t(Y)),{render:I,hydrate:G,createApp:ma(I,G)}}function ji({type:s,props:t},g){return g==="svg"&&s==="foreignObject"||g==="mathml"&&s==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:g}function pe({effect:s,job:t},g){g?(s.flags|=32,t.flags|=4):(s.flags&=-33,t.flags&=-5)}function Ta(s,t){return(!s||s&&!s.pendingBranch)&&t&&!t.persisted}function Es(s,t,g=!1){const v=s.children,_=t.children;if(ut(v)&&ut(_))for(let C=0;C<v.length;C++){const w=v[C];let u=_[C];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=_[C]=ae(_[C]),u.el=w.el),!g&&u.patchFlag!==-2&&Es(w,u)),u.type===Pi&&(u.el=w.el)}}function Oa(s){const t=s.slice(),g=[0];let v,_,C,w,u;const r=s.length;for(v=0;v<r;v++){const c=s[v];if(c!==0){if(_=g[g.length-1],s[_]<c){t[v]=_,g.push(v);continue}for(C=0,w=g.length-1;C<w;)u=C+w>>1,s[g[u]]<c?C=u+1:w=u;c<s[g[C]]&&(C>0&&(t[v]=g[C-1]),g[C]=v)}}for(C=g.length,w=g[C-1];C-- >0;)g[C]=w,w=t[w];return g}function As(s){const t=s.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:As(t)}function Gn(s){if(s)for(let t=0;t<s.length;t++)s[t].flags|=8}const Pa=Symbol.for("v-scx"),Ea=()=>ee(Pa);function li(s,t,g){return Ds(s,t,g)}function Ds(s,t,g=_t){const{immediate:v,deep:_,flush:C,once:w}=g,u=Tt({},g);let r;if(Ei)if(C==="sync"){const n=Ea();r=n.__watcherHandles||(n.__watcherHandles=[])}else if(!t||v)u.once=!0;else{const n=()=>{};return n.stop=Ht,n.resume=Ht,n.pause=Ht,n}const c=Ft;u.call=(n,e,o)=>$t(n,c,e,o);let l=!1;C==="post"?u.scheduler=n=>{Rt(n,c&&c.suspense)}:C!=="sync"&&(l=!0,u.scheduler=(n,e)=>{e?n():wn(n)}),u.augmentJob=n=>{t&&(n.flags|=4),l&&(n.flags|=2,c&&(n.id=c.uid,n.i=c))};const i=No(s,t,u);return r&&r.push(i),i}function Aa(s,t,g){const v=this.proxy,_=xt(s)?s.includes(".")?Ms(v,s):()=>v[s]:s.bind(v,v);let C;dt(t)?C=t:(C=t.handler,g=t);const w=Ze(this),u=Ds(_,C.bind(v),g);return w(),u}function Ms(s,t){const g=t.split(".");return()=>{let v=s;for(let _=0;_<g.length&&v;_++)v=v[g[_]];return v}}const Da=(s,t)=>t==="modelValue"||t==="model-value"?s.modelModifiers:s[`${t}Modifiers`]||s[`${ye(t)}Modifiers`]||s[`${be(t)}Modifiers`];function Ma(s,t,...g){if(s.isUnmounted)return;const v=s.vnode.props||_t;let _=g;const C=t.startsWith("update:"),w=C&&Da(v,t.slice(7));w&&(w.trim&&(_=g.map(l=>xt(l)?l.trim():l)),w.number&&(_=g.map(oo)));let u,r=v[u=Di(t)]||v[u=Di(ye(t))];!r&&C&&(r=v[u=Di(be(t))]),r&&$t(r,s,6,_);const c=v[u+"Once"];if(c){if(!s.emitted)s.emitted={};else if(s.emitted[u])return;s.emitted[u]=!0,$t(c,s,6,_)}}function ks(s,t,g=!1){const v=t.emitsCache,_=v.get(s);if(_!==void 0)return _;const C=s.emits;let w={},u=!1;if(!dt(s)){const r=c=>{const l=ks(c,t,!0);l&&(u=!0,Tt(w,l))};!g&&t.mixins.length&&t.mixins.forEach(r),s.extends&&r(s.extends),s.mixins&&s.mixins.forEach(r)}return!C&&!u?(yt(s)&&v.set(s,null),null):(ut(C)?C.forEach(r=>w[r]=null):Tt(w,C),yt(s)&&v.set(s,w),w)}function Oi(s,t){return!s||!_i(t)?!1:(t=t.slice(2).replace(/Once$/,""),gt(s,t[0].toLowerCase()+t.slice(1))||gt(s,be(t))||gt(s,t))}function Bi(s){const{type:t,vnode:g,proxy:v,withProxy:_,propsOptions:[C],slots:w,attrs:u,emit:r,render:c,renderCache:l,props:i,data:n,setupState:e,ctx:o,inheritAttrs:h}=s,a=pi(s);let f,d;try{if(g.shapeFlag&4){const m=_||v,y=m;f=Kt(c.call(y,m,l,i,e,n,o)),d=u}else{const m=t;f=Kt(m.length>1?m(i,{attrs:u,slots:w,emit:r}):m(i,null)),d=t.props?u:ka(u)}}catch(m){He.length=0,wi(m,s,1),f=Bt(Ke)}let p=f;if(d&&h!==!1){const m=Object.keys(d),{shapeFlag:y}=p;m.length&&y&7&&(C&&m.some(cn)&&(d=Fa(d,C)),p=De(p,d,!1,!0))}return g.dirs&&(p=De(p,null,!1,!0),p.dirs=p.dirs?p.dirs.concat(g.dirs):g.dirs),g.transition&&Tn(p,g.transition),f=p,pi(a),f}const ka=s=>{let t;for(const g in s)(g==="class"||g==="style"||_i(g))&&((t||(t={}))[g]=s[g]);return t},Fa=(s,t)=>{const g={};for(const v in s)(!cn(v)||!(v.slice(9)in t))&&(g[v]=s[v]);return g};function Ra(s,t,g){const{props:v,children:_,component:C}=s,{props:w,children:u,patchFlag:r}=t,c=C.emitsOptions;if(t.dirs||t.transition)return!0;if(g&&r>=0){if(r&1024)return!0;if(r&16)return v?Kn(v,w,c):!!w;if(r&8){const l=t.dynamicProps;for(let i=0;i<l.length;i++){const n=l[i];if(w[n]!==v[n]&&!Oi(c,n))return!0}}}else return(_||u)&&(!u||!u.$stable)?!0:v===w?!1:v?w?Kn(v,w,c):!0:!!w;return!1}function Kn(s,t,g){const v=Object.keys(t);if(v.length!==Object.keys(s).length)return!0;for(let _=0;_<v.length;_++){const C=v[_];if(t[C]!==s[C]&&!Oi(g,C))return!0}return!1}function La({vnode:s,parent:t},g){for(;t;){const v=t.subTree;if(v.suspense&&v.suspense.activeBranch===s&&(v.el=s.el),v===s)(s=t.vnode).el=g,t=t.parent;else break}}const Fs=s=>s.__isSuspense;function Ia(s,t){t&&t.pendingBranch?ut(s)?t.effects.push(...s):t.effects.push(s):Vo(s)}const Gt=Symbol.for("v-fgt"),Pi=Symbol.for("v-txt"),Ke=Symbol.for("v-cmt"),Xi=Symbol.for("v-stc"),He=[];let It=null;function ci(s=!1){He.push(It=s?null:[])}function ja(){He.pop(),It=He[He.length-1]||null}let qe=1;function qn(s){qe+=s,s<0&&It&&(It.hasOnce=!0)}function Rs(s){return s.dynamicChildren=qe>0?It||Te:null,ja(),qe>0&&It&&It.push(s),s}function Wi(s,t,g,v,_,C){return Rs(jt(s,t,g,v,_,C,!0))}function Ba(s,t,g,v,_){return Rs(Bt(s,t,g,v,_,!0))}function en(s){return s?s.__v_isVNode===!0:!1}function Re(s,t){return s.type===t.type&&s.key===t.key}const Ls=({key:s})=>s??null,hi=({ref:s,ref_key:t,ref_for:g})=>(typeof s=="number"&&(s=""+s),s!=null?xt(s)||Pt(s)||dt(s)?{i:qt,r:s,k:t,f:!!g}:s:null);function jt(s,t=null,g=null,v=0,_=null,C=s===Gt?0:1,w=!1,u=!1){const r={__v_isVNode:!0,__v_skip:!0,type:s,props:t,key:t&&Ls(t),ref:t&&hi(t),scopeId:hs,slotScopeIds:null,children:g,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:C,patchFlag:v,dynamicProps:_,dynamicChildren:null,appContext:null,ctx:qt};return u?(En(r,g),C&128&&s.normalize(r)):g&&(r.shapeFlag|=xt(g)?8:16),qe>0&&!w&&It&&(r.patchFlag>0||C&6)&&r.patchFlag!==32&&It.push(r),r}const Bt=Xa;function Xa(s,t=null,g=null,v=0,_=null,C=!1){if((!s||s===aa)&&(s=Ke),en(s)){const u=De(s,t,!0);return g&&En(u,g),qe>0&&!C&&It&&(u.shapeFlag&6?It[It.indexOf(s)]=u:It.push(u)),u.patchFlag=-2,u}if($a(s)&&(s=s.__vccOpts),t){t=Wa(t);let{class:u,style:r}=t;u&&!xt(u)&&(t.class=dn(u)),yt(r)&&(bn(r)&&!ut(r)&&(r=Tt({},r)),t.style=fn(r))}const w=xt(s)?1:Fs(s)?128:qo(s)?64:yt(s)?4:dt(s)?2:0;return jt(s,t,g,v,_,w,C,!0)}function Wa(s){return s?bn(s)||bs(s)?Tt({},s):s:null}function De(s,t,g=!1,v=!1){const{props:_,ref:C,patchFlag:w,children:u,transition:r}=s,c=t?Ya(_||{},t):_,l={__v_isVNode:!0,__v_skip:!0,type:s.type,props:c,key:c&&Ls(c),ref:t&&t.ref?g&&C?ut(C)?C.concat(hi(t)):[C,hi(t)]:hi(t):C,scopeId:s.scopeId,slotScopeIds:s.slotScopeIds,children:u,target:s.target,targetStart:s.targetStart,targetAnchor:s.targetAnchor,staticCount:s.staticCount,shapeFlag:s.shapeFlag,patchFlag:t&&s.type!==Gt?w===-1?16:w|16:w,dynamicProps:s.dynamicProps,dynamicChildren:s.dynamicChildren,appContext:s.appContext,dirs:s.dirs,transition:r,component:s.component,suspense:s.suspense,ssContent:s.ssContent&&De(s.ssContent),ssFallback:s.ssFallback&&De(s.ssFallback),el:s.el,anchor:s.anchor,ctx:s.ctx,ce:s.ce};return r&&v&&Tn(l,r.clone(l)),l}function Ha(s=" ",t=0){return Bt(Pi,null,s,t)}function Kt(s){return s==null||typeof s=="boolean"?Bt(Ke):ut(s)?Bt(Gt,null,s.slice()):typeof s=="object"?ae(s):Bt(Pi,null,String(s))}function ae(s){return s.el===null&&s.patchFlag!==-1||s.memo?s:De(s)}function En(s,t){let g=0;const{shapeFlag:v}=s;if(t==null)t=null;else if(ut(t))g=16;else if(typeof t=="object")if(v&65){const _=t.default;_&&(_._c&&(_._d=!1),En(s,_()),_._c&&(_._d=!0));return}else{g=32;const _=t._;!_&&!bs(t)?t._ctx=qt:_===3&&qt&&(qt.slots._===1?t._=1:(t._=2,s.patchFlag|=1024))}else dt(t)?(t={default:t,_ctx:qt},g=32):(t=String(t),v&64?(g=16,t=[Ha(t)]):g=8);s.children=t,s.shapeFlag|=g}function Ya(...s){const t={};for(let g=0;g<s.length;g++){const v=s[g];for(const _ in v)if(_==="class")t.class!==v.class&&(t.class=dn([t.class,v.class]));else if(_==="style")t.style=fn([t.style,v.style]);else if(_i(_)){const C=t[_],w=v[_];w&&C!==w&&!(ut(C)&&C.includes(w))&&(t[_]=C?[].concat(C,w):w)}else _!==""&&(t[_]=v[_])}return t}function zt(s,t,g,v=null){$t(s,t,7,[g,v])}const Na=_s();let Ua=0;function za(s,t,g){const v=s.type,_=(t?t.appContext:s.appContext)||Na,C={uid:Ua++,vnode:s,type:v,parent:t,appContext:_,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Xr(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(_.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:xs(v,_),emitsOptions:ks(v,_),emit:null,emitted:null,propsDefaults:_t,inheritAttrs:v.inheritAttrs,ctx:_t,data:_t,props:_t,attrs:_t,slots:_t,refs:_t,setupState:_t,setupContext:null,suspense:g,suspenseId:g?g.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return C.ctx={_:C},C.root=t?t.root:C,C.emit=Ma.bind(null,C),s.ce&&s.ce(C),C}let Ft=null,vi,nn;{const s=Rr(),t=(g,v)=>{let _;return(_=s[g])||(_=s[g]=[]),_.push(v),C=>{_.length>1?_.forEach(w=>w(C)):_[0](C)}};vi=t("__VUE_INSTANCE_SETTERS__",g=>Ft=g),nn=t("__VUE_SSR_SETTERS__",g=>Ei=g)}const Ze=s=>{const t=Ft;return vi(s),s.scope.on(),()=>{s.scope.off(),vi(t)}},$n=()=>{Ft&&Ft.scope.off(),vi(null)};function Is(s){return s.vnode.shapeFlag&4}let Ei=!1;function Va(s,t=!1,g=!1){t&&nn(t);const{props:v,children:_}=s.vnode,C=Is(s);va(s,v,C,t),ba(s,_,g);const w=C?Ga(s,t):void 0;return t&&nn(!1),w}function Ga(s,t){const g=s.type;s.accessCache=Object.create(null),s.proxy=new Proxy(s.ctx,ca);const{setup:v}=g;if(v){const _=s.setupContext=v.length>1?qa(s):null,C=Ze(s);fe();const w=Qe(v,s,0,[s.props,_]);if(de(),C(),Ar(w)){if(Xe(s)||fs(s),w.then($n,$n),t)return w.then(u=>{Jn(s,u,t)}).catch(u=>{wi(u,s,0)});s.asyncDep=w}else Jn(s,w,t)}else js(s,t)}function Jn(s,t,g){dt(t)?s.type.__ssrInlineRender?s.ssrRender=t:s.render=t:yt(t)&&(s.setupState=rs(t)),js(s,g)}let Qn;function js(s,t,g){const v=s.type;if(!s.render){if(!t&&Qn&&!v.render){const _=v.template||On(s).template;if(_){const{isCustomElement:C,compilerOptions:w}=s.appContext.config,{delimiters:u,compilerOptions:r}=v,c=Tt(Tt({isCustomElement:C,delimiters:u},w),r);v.render=Qn(_,c)}}s.render=v.render||Ht}{const _=Ze(s);fe();try{ha(s)}finally{de(),_()}}}const Ka={get(s,t){return Et(s,"get",""),s[t]}};function qa(s){const t=g=>{s.exposed=g||{}};return{attrs:new Proxy(s.attrs,Ka),slots:s.slots,emit:s.emit,expose:t}}function An(s){return s.exposed?s.exposeProxy||(s.exposeProxy=new Proxy(rs(is(s.exposed)),{get(t,g){if(g in t)return t[g];if(g in We)return We[g](s)},has(t,g){return g in t||g in We}})):s.proxy}function $a(s){return dt(s)&&"__vccOpts"in s}const Wt=(s,t)=>Ho(s,t,Ei);function Bs(s,t,g){const v=arguments.length;return v===2?yt(t)&&!ut(t)?en(t)?Bt(s,null,[t]):Bt(s,t):Bt(s,null,t):(v>3?g=Array.prototype.slice.call(arguments,2):v===3&&en(g)&&(g=[g]),Bt(s,t,g))}const Ja="3.5.8";/**
* @vue/runtime-dom v3.5.8
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let rn;const Zn=typeof window<"u"&&window.trustedTypes;if(Zn)try{rn=Zn.createPolicy("vue",{createHTML:s=>s})}catch{}const Xs=rn?s=>rn.createHTML(s):s=>s,Qa="http://www.w3.org/2000/svg",Za="http://www.w3.org/1998/Math/MathML",Zt=typeof document<"u"?document:null,tr=Zt&&Zt.createElement("template"),tl={insert:(s,t,g)=>{t.insertBefore(s,g||null)},remove:s=>{const t=s.parentNode;t&&t.removeChild(s)},createElement:(s,t,g,v)=>{const _=t==="svg"?Zt.createElementNS(Qa,s):t==="mathml"?Zt.createElementNS(Za,s):g?Zt.createElement(s,{is:g}):Zt.createElement(s);return s==="select"&&v&&v.multiple!=null&&_.setAttribute("multiple",v.multiple),_},createText:s=>Zt.createTextNode(s),createComment:s=>Zt.createComment(s),setText:(s,t)=>{s.nodeValue=t},setElementText:(s,t)=>{s.textContent=t},parentNode:s=>s.parentNode,nextSibling:s=>s.nextSibling,querySelector:s=>Zt.querySelector(s),setScopeId(s,t){s.setAttribute(t,"")},insertStaticContent(s,t,g,v,_,C){const w=g?g.previousSibling:t.lastChild;if(_&&(_===C||_.nextSibling))for(;t.insertBefore(_.cloneNode(!0),g),!(_===C||!(_=_.nextSibling)););else{tr.innerHTML=Xs(v==="svg"?`<svg>${s}</svg>`:v==="mathml"?`<math>${s}</math>`:s);const u=tr.content;if(v==="svg"||v==="mathml"){const r=u.firstChild;for(;r.firstChild;)u.appendChild(r.firstChild);u.removeChild(r)}t.insertBefore(u,g)}return[w?w.nextSibling:t.firstChild,g?g.previousSibling:t.lastChild]}},el=Symbol("_vtc");function il(s,t,g){const v=s[el];v&&(t=(t?[t,...v]:[...v]).join(" ")),t==null?s.removeAttribute("class"):g?s.setAttribute("class",t):s.className=t}const er=Symbol("_vod"),nl=Symbol("_vsh"),rl=Symbol(""),sl=/(^|;)\s*display\s*:/;function ol(s,t,g){const v=s.style,_=xt(g);let C=!1;if(g&&!_){if(t)if(xt(t))for(const w of t.split(";")){const u=w.slice(0,w.indexOf(":")).trim();g[u]==null&&ui(v,u,"")}else for(const w in t)g[w]==null&&ui(v,w,"");for(const w in g)w==="display"&&(C=!0),ui(v,w,g[w])}else if(_){if(t!==g){const w=v[rl];w&&(g+=";"+w),v.cssText=g,C=sl.test(g)}}else t&&s.removeAttribute("style");er in s&&(s[er]=C?v.display:"",s[nl]&&(v.display="none"))}const ir=/\s*!important$/;function ui(s,t,g){if(ut(g))g.forEach(v=>ui(s,t,v));else if(g==null&&(g=""),t.startsWith("--"))s.setProperty(t,g);else{const v=al(s,t);ir.test(g)?s.setProperty(be(v),g.replace(ir,""),"important"):s[v]=g}}const nr=["Webkit","Moz","ms"],Hi={};function al(s,t){const g=Hi[t];if(g)return g;let v=ye(t);if(v!=="filter"&&v in s)return Hi[t]=v;v=kr(v);for(let _=0;_<nr.length;_++){const C=nr[_]+v;if(C in s)return Hi[t]=C}return t}const rr="http://www.w3.org/1999/xlink";function sr(s,t,g,v,_,C=fo(t)){v&&t.startsWith("xlink:")?g==null?s.removeAttributeNS(rr,t.slice(6,t.length)):s.setAttributeNS(rr,t,g):g==null||C&&!Lr(g)?s.removeAttribute(t):s.setAttribute(t,C?"":ue(g)?String(g):g)}function ll(s,t,g,v){if(t==="innerHTML"||t==="textContent"){g!=null&&(s[t]=t==="innerHTML"?Xs(g):g);return}const _=s.tagName;if(t==="value"&&_!=="PROGRESS"&&!_.includes("-")){const w=_==="OPTION"?s.getAttribute("value")||"":s.value,u=g==null?s.type==="checkbox"?"on":"":String(g);(w!==u||!("_value"in s))&&(s.value=u),g==null&&s.removeAttribute(t),s._value=g;return}let C=!1;if(g===""||g==null){const w=typeof s[t];w==="boolean"?g=Lr(g):g==null&&w==="string"?(g="",C=!0):w==="number"&&(g=0,C=!0)}try{s[t]=g}catch{}C&&s.removeAttribute(t)}function cl(s,t,g,v){s.addEventListener(t,g,v)}function hl(s,t,g,v){s.removeEventListener(t,g,v)}const or=Symbol("_vei");function ul(s,t,g,v,_=null){const C=s[or]||(s[or]={}),w=C[t];if(v&&w)w.value=v;else{const[u,r]=fl(t);if(v){const c=C[t]=pl(v,_);cl(s,u,c,r)}else w&&(hl(s,u,w,r),C[t]=void 0)}}const ar=/(?:Once|Passive|Capture)$/;function fl(s){let t;if(ar.test(s)){t={};let v;for(;v=s.match(ar);)s=s.slice(0,s.length-v[0].length),t[v[0].toLowerCase()]=!0}return[s[2]===":"?s.slice(3):be(s.slice(2)),t]}let Yi=0;const dl=Promise.resolve(),gl=()=>Yi||(dl.then(()=>Yi=0),Yi=Date.now());function pl(s,t){const g=v=>{if(!v._vts)v._vts=Date.now();else if(v._vts<=g.attached)return;$t(ml(v,g.value),t,5,[v])};return g.value=s,g.attached=gl(),g}function ml(s,t){if(ut(t)){const g=s.stopImmediatePropagation;return s.stopImmediatePropagation=()=>{g.call(s),s._stopped=!0},t.map(v=>_=>!_._stopped&&v&&v(_))}else return t}const lr=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&s.charCodeAt(2)>96&&s.charCodeAt(2)<123,vl=(s,t,g,v,_,C)=>{const w=_==="svg";t==="class"?il(s,v,w):t==="style"?ol(s,g,v):_i(t)?cn(t)||ul(s,t,g,v,C):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):_l(s,t,v,w))?(ll(s,t,v),!s.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&sr(s,t,v,w,C,t!=="value")):(t==="true-value"?s._trueValue=v:t==="false-value"&&(s._falseValue=v),sr(s,t,v,w))};function _l(s,t,g,v){if(v)return!!(t==="innerHTML"||t==="textContent"||t in s&&lr(t)&&dt(g));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&s.tagName==="INPUT"||t==="type"&&s.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const _=s.tagName;if(_==="IMG"||_==="VIDEO"||_==="CANVAS"||_==="SOURCE")return!1}return lr(t)&&xt(g)?!1:!!(t in s||s._isVueCE&&(/[A-Z]/.test(t)||!xt(g)))}const yl=Tt({patchProp:vl},tl);let cr;function Cl(){return cr||(cr=xa(yl))}const bl=(...s)=>{const t=Cl().createApp(...s),{mount:g}=t;return t.mount=v=>{const _=xl(v);if(!_)return;const C=t._component;!dt(C)&&!C.render&&!C.template&&(C.template=_.innerHTML),_.nodeType===1&&(_.textContent="");const w=g(_,!1,Sl(_));return _ instanceof Element&&(_.removeAttribute("v-cloak"),_.setAttribute("data-v-app","")),w},t};function Sl(s){if(s instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&s instanceof MathMLElement)return"mathml"}function xl(s){return xt(s)?document.querySelector(s):s}var wl=!1;/*!
 * pinia v2.2.2
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */const Tl=Symbol();var hr;(function(s){s.direct="direct",s.patchObject="patch object",s.patchFunction="patch function"})(hr||(hr={}));function Ol(){const s=go(!0),t=s.run(()=>di({}));let g=[],v=[];const _=is({install(C){_._a=C,C.provide(Tl,_),C.config.globalProperties.$pinia=_,v.forEach(w=>g.push(w)),v=[]},use(C){return!this._a&&!wl?v.push(C):g.push(C),this},_p:g,_a:null,_e:s,_s:new Map,state:t});return _}/*!
  * vue-router v4.4.5
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const we=typeof document<"u";function Ws(s){return typeof s=="object"||"displayName"in s||"props"in s||"__vccOpts"in s}function Pl(s){return s.__esModule||s[Symbol.toStringTag]==="Module"||s.default&&Ws(s.default)}const mt=Object.assign;function Ni(s,t){const g={};for(const v in t){const _=t[v];g[v]=Nt(_)?_.map(s):s(_)}return g}const Ye=()=>{},Nt=Array.isArray,Hs=/#/g,El=/&/g,Al=/\//g,Dl=/=/g,Ml=/\?/g,Ys=/\+/g,kl=/%5B/g,Fl=/%5D/g,Ns=/%5E/g,Rl=/%60/g,Us=/%7B/g,Ll=/%7C/g,zs=/%7D/g,Il=/%20/g;function Dn(s){return encodeURI(""+s).replace(Ll,"|").replace(kl,"[").replace(Fl,"]")}function jl(s){return Dn(s).replace(Us,"{").replace(zs,"}").replace(Ns,"^")}function sn(s){return Dn(s).replace(Ys,"%2B").replace(Il,"+").replace(Hs,"%23").replace(El,"%26").replace(Rl,"`").replace(Us,"{").replace(zs,"}").replace(Ns,"^")}function Bl(s){return sn(s).replace(Dl,"%3D")}function Xl(s){return Dn(s).replace(Hs,"%23").replace(Ml,"%3F")}function Wl(s){return s==null?"":Xl(s).replace(Al,"%2F")}function $e(s){try{return decodeURIComponent(""+s)}catch{}return""+s}const Hl=/\/$/,Yl=s=>s.replace(Hl,"");function Ui(s,t,g="/"){let v,_={},C="",w="";const u=t.indexOf("#");let r=t.indexOf("?");return u<r&&u>=0&&(r=-1),r>-1&&(v=t.slice(0,r),C=t.slice(r+1,u>-1?u:t.length),_=s(C)),u>-1&&(v=v||t.slice(0,u),w=t.slice(u,t.length)),v=Vl(v??t,g),{fullPath:v+(C&&"?")+C+w,path:v,query:_,hash:$e(w)}}function Nl(s,t){const g=t.query?s(t.query):"";return t.path+(g&&"?")+g+(t.hash||"")}function ur(s,t){return!t||!s.toLowerCase().startsWith(t.toLowerCase())?s:s.slice(t.length)||"/"}function Ul(s,t,g){const v=t.matched.length-1,_=g.matched.length-1;return v>-1&&v===_&&Me(t.matched[v],g.matched[_])&&Vs(t.params,g.params)&&s(t.query)===s(g.query)&&t.hash===g.hash}function Me(s,t){return(s.aliasOf||s)===(t.aliasOf||t)}function Vs(s,t){if(Object.keys(s).length!==Object.keys(t).length)return!1;for(const g in s)if(!zl(s[g],t[g]))return!1;return!0}function zl(s,t){return Nt(s)?fr(s,t):Nt(t)?fr(t,s):s===t}function fr(s,t){return Nt(t)?s.length===t.length&&s.every((g,v)=>g===t[v]):s.length===1&&s[0]===t}function Vl(s,t){if(s.startsWith("/"))return s;if(!s)return t;const g=t.split("/"),v=s.split("/"),_=v[v.length-1];(_===".."||_===".")&&v.push("");let C=g.length-1,w,u;for(w=0;w<v.length;w++)if(u=v[w],u!==".")if(u==="..")C>1&&C--;else break;return g.slice(0,C).join("/")+"/"+v.slice(w).join("/")}const se={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Je;(function(s){s.pop="pop",s.push="push"})(Je||(Je={}));var Ne;(function(s){s.back="back",s.forward="forward",s.unknown=""})(Ne||(Ne={}));function Gl(s){if(!s)if(we){const t=document.querySelector("base");s=t&&t.getAttribute("href")||"/",s=s.replace(/^\w+:\/\/[^\/]+/,"")}else s="/";return s[0]!=="/"&&s[0]!=="#"&&(s="/"+s),Yl(s)}const Kl=/^[^#]+#/;function ql(s,t){return s.replace(Kl,"#")+t}function $l(s,t){const g=document.documentElement.getBoundingClientRect(),v=s.getBoundingClientRect();return{behavior:t.behavior,left:v.left-g.left-(t.left||0),top:v.top-g.top-(t.top||0)}}const Ai=()=>({left:window.scrollX,top:window.scrollY});function Jl(s){let t;if("el"in s){const g=s.el,v=typeof g=="string"&&g.startsWith("#"),_=typeof g=="string"?v?document.getElementById(g.slice(1)):document.querySelector(g):g;if(!_)return;t=$l(_,s)}else t=s;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function dr(s,t){return(history.state?history.state.position-t:-1)+s}const on=new Map;function Ql(s,t){on.set(s,t)}function Zl(s){const t=on.get(s);return on.delete(s),t}let tc=()=>location.protocol+"//"+location.host;function Gs(s,t){const{pathname:g,search:v,hash:_}=t,C=s.indexOf("#");if(C>-1){let u=_.includes(s.slice(C))?s.slice(C).length:1,r=_.slice(u);return r[0]!=="/"&&(r="/"+r),ur(r,"")}return ur(g,s)+v+_}function ec(s,t,g,v){let _=[],C=[],w=null;const u=({state:n})=>{const e=Gs(s,location),o=g.value,h=t.value;let a=0;if(n){if(g.value=e,t.value=n,w&&w===o){w=null;return}a=h?n.position-h.position:0}else v(e);_.forEach(f=>{f(g.value,o,{delta:a,type:Je.pop,direction:a?a>0?Ne.forward:Ne.back:Ne.unknown})})};function r(){w=g.value}function c(n){_.push(n);const e=()=>{const o=_.indexOf(n);o>-1&&_.splice(o,1)};return C.push(e),e}function l(){const{history:n}=window;n.state&&n.replaceState(mt({},n.state,{scroll:Ai()}),"")}function i(){for(const n of C)n();C=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",l)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",l,{passive:!0}),{pauseListeners:r,listen:c,destroy:i}}function gr(s,t,g,v=!1,_=!1){return{back:s,current:t,forward:g,replaced:v,position:window.history.length,scroll:_?Ai():null}}function ic(s){const{history:t,location:g}=window,v={value:Gs(s,g)},_={value:t.state};_.value||C(v.value,{back:null,current:v.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function C(r,c,l){const i=s.indexOf("#"),n=i>-1?(g.host&&document.querySelector("base")?s:s.slice(i))+r:tc()+s+r;try{t[l?"replaceState":"pushState"](c,"",n),_.value=c}catch(e){console.error(e),g[l?"replace":"assign"](n)}}function w(r,c){const l=mt({},t.state,gr(_.value.back,r,_.value.forward,!0),c,{position:_.value.position});C(r,l,!0),v.value=r}function u(r,c){const l=mt({},_.value,t.state,{forward:r,scroll:Ai()});C(l.current,l,!0);const i=mt({},gr(v.value,r,null),{position:l.position+1},c);C(r,i,!1),v.value=r}return{location:v,state:_,push:u,replace:w}}function nc(s){s=Gl(s);const t=ic(s),g=ec(s,t.state,t.location,t.replace);function v(C,w=!0){w||g.pauseListeners(),history.go(C)}const _=mt({location:"",base:s,go:v,createHref:ql.bind(null,s)},t,g);return Object.defineProperty(_,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(_,"state",{enumerable:!0,get:()=>t.state.value}),_}function rc(s){return s=location.host?s||location.pathname+location.search:"",s.includes("#")||(s+="#"),nc(s)}function sc(s){return typeof s=="string"||s&&typeof s=="object"}function Ks(s){return typeof s=="string"||typeof s=="symbol"}const qs=Symbol("");var pr;(function(s){s[s.aborted=4]="aborted",s[s.cancelled=8]="cancelled",s[s.duplicated=16]="duplicated"})(pr||(pr={}));function ke(s,t){return mt(new Error,{type:s,[qs]:!0},t)}function Qt(s,t){return s instanceof Error&&qs in s&&(t==null||!!(s.type&t))}const mr="[^/]+?",oc={sensitive:!1,strict:!1,start:!0,end:!0},ac=/[.+*?^${}()[\]/\\]/g;function lc(s,t){const g=mt({},oc,t),v=[];let _=g.start?"^":"";const C=[];for(const c of s){const l=c.length?[]:[90];g.strict&&!c.length&&(_+="/");for(let i=0;i<c.length;i++){const n=c[i];let e=40+(g.sensitive?.25:0);if(n.type===0)i||(_+="/"),_+=n.value.replace(ac,"\\$&"),e+=40;else if(n.type===1){const{value:o,repeatable:h,optional:a,regexp:f}=n;C.push({name:o,repeatable:h,optional:a});const d=f||mr;if(d!==mr){e+=10;try{new RegExp(`(${d})`)}catch(m){throw new Error(`Invalid custom RegExp for param "${o}" (${d}): `+m.message)}}let p=h?`((?:${d})(?:/(?:${d}))*)`:`(${d})`;i||(p=a&&c.length<2?`(?:/${p})`:"/"+p),a&&(p+="?"),_+=p,e+=20,a&&(e+=-8),h&&(e+=-20),d===".*"&&(e+=-50)}l.push(e)}v.push(l)}if(g.strict&&g.end){const c=v.length-1;v[c][v[c].length-1]+=.7000000000000001}g.strict||(_+="/?"),g.end?_+="$":g.strict&&(_+="(?:/|$)");const w=new RegExp(_,g.sensitive?"":"i");function u(c){const l=c.match(w),i={};if(!l)return null;for(let n=1;n<l.length;n++){const e=l[n]||"",o=C[n-1];i[o.name]=e&&o.repeatable?e.split("/"):e}return i}function r(c){let l="",i=!1;for(const n of s){(!i||!l.endsWith("/"))&&(l+="/"),i=!1;for(const e of n)if(e.type===0)l+=e.value;else if(e.type===1){const{value:o,repeatable:h,optional:a}=e,f=o in c?c[o]:"";if(Nt(f)&&!h)throw new Error(`Provided param "${o}" is an array but it is not repeatable (* or + modifiers)`);const d=Nt(f)?f.join("/"):f;if(!d)if(a)n.length<2&&(l.endsWith("/")?l=l.slice(0,-1):i=!0);else throw new Error(`Missing required param "${o}"`);l+=d}}return l||"/"}return{re:w,score:v,keys:C,parse:u,stringify:r}}function cc(s,t){let g=0;for(;g<s.length&&g<t.length;){const v=t[g]-s[g];if(v)return v;g++}return s.length<t.length?s.length===1&&s[0]===40+40?-1:1:s.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function $s(s,t){let g=0;const v=s.score,_=t.score;for(;g<v.length&&g<_.length;){const C=cc(v[g],_[g]);if(C)return C;g++}if(Math.abs(_.length-v.length)===1){if(vr(v))return 1;if(vr(_))return-1}return _.length-v.length}function vr(s){const t=s[s.length-1];return s.length>0&&t[t.length-1]<0}const hc={type:0,value:""},uc=/[a-zA-Z0-9_]/;function fc(s){if(!s)return[[]];if(s==="/")return[[hc]];if(!s.startsWith("/"))throw new Error(`Invalid path "${s}"`);function t(e){throw new Error(`ERR (${g})/"${c}": ${e}`)}let g=0,v=g;const _=[];let C;function w(){C&&_.push(C),C=[]}let u=0,r,c="",l="";function i(){c&&(g===0?C.push({type:0,value:c}):g===1||g===2||g===3?(C.length>1&&(r==="*"||r==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),C.push({type:1,value:c,regexp:l,repeatable:r==="*"||r==="+",optional:r==="*"||r==="?"})):t("Invalid state to consume buffer"),c="")}function n(){c+=r}for(;u<s.length;){if(r=s[u++],r==="\\"&&g!==2){v=g,g=4;continue}switch(g){case 0:r==="/"?(c&&i(),w()):r===":"?(i(),g=1):n();break;case 4:n(),g=v;break;case 1:r==="("?g=2:uc.test(r)?n():(i(),g=0,r!=="*"&&r!=="?"&&r!=="+"&&u--);break;case 2:r===")"?l[l.length-1]=="\\"?l=l.slice(0,-1)+r:g=3:l+=r;break;case 3:i(),g=0,r!=="*"&&r!=="?"&&r!=="+"&&u--,l="";break;default:t("Unknown state");break}}return g===2&&t(`Unfinished custom RegExp for param "${c}"`),i(),w(),_}function dc(s,t,g){const v=lc(fc(s.path),g),_=mt(v,{record:s,parent:t,children:[],alias:[]});return t&&!_.record.aliasOf==!t.record.aliasOf&&t.children.push(_),_}function gc(s,t){const g=[],v=new Map;t=br({strict:!1,end:!0,sensitive:!1},t);function _(i){return v.get(i)}function C(i,n,e){const o=!e,h=yr(i);h.aliasOf=e&&e.record;const a=br(t,i),f=[h];if("alias"in i){const m=typeof i.alias=="string"?[i.alias]:i.alias;for(const y of m)f.push(yr(mt({},h,{components:e?e.record.components:h.components,path:y,aliasOf:e?e.record:h})))}let d,p;for(const m of f){const{path:y}=m;if(n&&y[0]!=="/"){const x=n.record.path,P=x[x.length-1]==="/"?"":"/";m.path=n.record.path+(y&&P+y)}if(d=dc(m,n,a),e?e.alias.push(d):(p=p||d,p!==d&&p.alias.push(d),o&&i.name&&!Cr(d)&&w(i.name)),Js(d)&&r(d),h.children){const x=h.children;for(let P=0;P<x.length;P++)C(x[P],d,e&&e.children[P])}e=e||d}return p?()=>{w(p)}:Ye}function w(i){if(Ks(i)){const n=v.get(i);n&&(v.delete(i),g.splice(g.indexOf(n),1),n.children.forEach(w),n.alias.forEach(w))}else{const n=g.indexOf(i);n>-1&&(g.splice(n,1),i.record.name&&v.delete(i.record.name),i.children.forEach(w),i.alias.forEach(w))}}function u(){return g}function r(i){const n=vc(i,g);g.splice(n,0,i),i.record.name&&!Cr(i)&&v.set(i.record.name,i)}function c(i,n){let e,o={},h,a;if("name"in i&&i.name){if(e=v.get(i.name),!e)throw ke(1,{location:i});a=e.record.name,o=mt(_r(n.params,e.keys.filter(p=>!p.optional).concat(e.parent?e.parent.keys.filter(p=>p.optional):[]).map(p=>p.name)),i.params&&_r(i.params,e.keys.map(p=>p.name))),h=e.stringify(o)}else if(i.path!=null)h=i.path,e=g.find(p=>p.re.test(h)),e&&(o=e.parse(h),a=e.record.name);else{if(e=n.name?v.get(n.name):g.find(p=>p.re.test(n.path)),!e)throw ke(1,{location:i,currentLocation:n});a=e.record.name,o=mt({},n.params,i.params),h=e.stringify(o)}const f=[];let d=e;for(;d;)f.unshift(d.record),d=d.parent;return{name:a,path:h,params:o,matched:f,meta:mc(f)}}s.forEach(i=>C(i));function l(){g.length=0,v.clear()}return{addRoute:C,resolve:c,removeRoute:w,clearRoutes:l,getRoutes:u,getRecordMatcher:_}}function _r(s,t){const g={};for(const v of t)v in s&&(g[v]=s[v]);return g}function yr(s){const t={path:s.path,redirect:s.redirect,name:s.name,meta:s.meta||{},aliasOf:s.aliasOf,beforeEnter:s.beforeEnter,props:pc(s),children:s.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in s?s.components||null:s.component&&{default:s.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function pc(s){const t={},g=s.props||!1;if("component"in s)t.default=g;else for(const v in s.components)t[v]=typeof g=="object"?g[v]:g;return t}function Cr(s){for(;s;){if(s.record.aliasOf)return!0;s=s.parent}return!1}function mc(s){return s.reduce((t,g)=>mt(t,g.meta),{})}function br(s,t){const g={};for(const v in s)g[v]=v in t?t[v]:s[v];return g}function vc(s,t){let g=0,v=t.length;for(;g!==v;){const C=g+v>>1;$s(s,t[C])<0?v=C:g=C+1}const _=_c(s);return _&&(v=t.lastIndexOf(_,v-1)),v}function _c(s){let t=s;for(;t=t.parent;)if(Js(t)&&$s(s,t)===0)return t}function Js({record:s}){return!!(s.name||s.components&&Object.keys(s.components).length||s.redirect)}function yc(s){const t={};if(s===""||s==="?")return t;const v=(s[0]==="?"?s.slice(1):s).split("&");for(let _=0;_<v.length;++_){const C=v[_].replace(Ys," "),w=C.indexOf("="),u=$e(w<0?C:C.slice(0,w)),r=w<0?null:$e(C.slice(w+1));if(u in t){let c=t[u];Nt(c)||(c=t[u]=[c]),c.push(r)}else t[u]=r}return t}function Sr(s){let t="";for(let g in s){const v=s[g];if(g=Bl(g),v==null){v!==void 0&&(t+=(t.length?"&":"")+g);continue}(Nt(v)?v.map(C=>C&&sn(C)):[v&&sn(v)]).forEach(C=>{C!==void 0&&(t+=(t.length?"&":"")+g,C!=null&&(t+="="+C))})}return t}function Cc(s){const t={};for(const g in s){const v=s[g];v!==void 0&&(t[g]=Nt(v)?v.map(_=>_==null?null:""+_):v==null?v:""+v)}return t}const bc=Symbol(""),xr=Symbol(""),Mn=Symbol(""),Qs=Symbol(""),an=Symbol("");function Le(){let s=[];function t(v){return s.push(v),()=>{const _=s.indexOf(v);_>-1&&s.splice(_,1)}}function g(){s=[]}return{add:t,list:()=>s.slice(),reset:g}}function le(s,t,g,v,_,C=w=>w()){const w=v&&(v.enterCallbacks[_]=v.enterCallbacks[_]||[]);return()=>new Promise((u,r)=>{const c=n=>{n===!1?r(ke(4,{from:g,to:t})):n instanceof Error?r(n):sc(n)?r(ke(2,{from:t,to:n})):(w&&v.enterCallbacks[_]===w&&typeof n=="function"&&w.push(n),u())},l=C(()=>s.call(v&&v.instances[_],t,g,c));let i=Promise.resolve(l);s.length<3&&(i=i.then(c)),i.catch(n=>r(n))})}function zi(s,t,g,v,_=C=>C()){const C=[];for(const w of s)for(const u in w.components){let r=w.components[u];if(!(t!=="beforeRouteEnter"&&!w.instances[u]))if(Ws(r)){const l=(r.__vccOpts||r)[t];l&&C.push(le(l,g,v,w,u,_))}else{let c=r();C.push(()=>c.then(l=>{if(!l)throw new Error(`Couldn't resolve component "${u}" at "${w.path}"`);const i=Pl(l)?l.default:l;w.mods[u]=l,w.components[u]=i;const e=(i.__vccOpts||i)[t];return e&&le(e,g,v,w,u,_)()}))}}return C}function wr(s){const t=ee(Mn),g=ee(Qs),v=Wt(()=>{const r=_e(s.to);return t.resolve(r)}),_=Wt(()=>{const{matched:r}=v.value,{length:c}=r,l=r[c-1],i=g.matched;if(!l||!i.length)return-1;const n=i.findIndex(Me.bind(null,l));if(n>-1)return n;const e=Tr(r[c-2]);return c>1&&Tr(l)===e&&i[i.length-1].path!==e?i.findIndex(Me.bind(null,r[c-2])):n}),C=Wt(()=>_.value>-1&&Tc(g.params,v.value.params)),w=Wt(()=>_.value>-1&&_.value===g.matched.length-1&&Vs(g.params,v.value.params));function u(r={}){return wc(r)?t[_e(s.replace)?"replace":"push"](_e(s.to)).catch(Ye):Promise.resolve()}return{route:v,href:Wt(()=>v.value.href),isActive:C,isExactActive:w,navigate:u}}const Sc=us({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:wr,setup(s,{slots:t}){const g=xi(wr(s)),{options:v}=ee(Mn),_=Wt(()=>({[Or(s.activeClass,v.linkActiveClass,"router-link-active")]:g.isActive,[Or(s.exactActiveClass,v.linkExactActiveClass,"router-link-exact-active")]:g.isExactActive}));return()=>{const C=t.default&&t.default(g);return s.custom?C:Bs("a",{"aria-current":g.isExactActive?s.ariaCurrentValue:null,href:g.href,onClick:g.navigate,class:_.value},C)}}}),xc=Sc;function wc(s){if(!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)&&!s.defaultPrevented&&!(s.button!==void 0&&s.button!==0)){if(s.currentTarget&&s.currentTarget.getAttribute){const t=s.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return s.preventDefault&&s.preventDefault(),!0}}function Tc(s,t){for(const g in t){const v=t[g],_=s[g];if(typeof v=="string"){if(v!==_)return!1}else if(!Nt(_)||_.length!==v.length||v.some((C,w)=>C!==_[w]))return!1}return!0}function Tr(s){return s?s.aliasOf?s.aliasOf.path:s.path:""}const Or=(s,t,g)=>s??t??g,Oc=us({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(s,{attrs:t,slots:g}){const v=ee(an),_=Wt(()=>s.route||v.value),C=ee(xr,0),w=Wt(()=>{let c=_e(C);const{matched:l}=_.value;let i;for(;(i=l[c])&&!i.components;)c++;return c}),u=Wt(()=>_.value.matched[w.value]);ai(xr,Wt(()=>w.value+1)),ai(bc,u),ai(an,_);const r=di();return li(()=>[r.value,u.value,s.name],([c,l,i],[n,e,o])=>{l&&(l.instances[i]=c,e&&e!==l&&c&&c===n&&(l.leaveGuards.size||(l.leaveGuards=e.leaveGuards),l.updateGuards.size||(l.updateGuards=e.updateGuards))),c&&l&&(!e||!Me(l,e)||!n)&&(l.enterCallbacks[i]||[]).forEach(h=>h(c))},{flush:"post"}),()=>{const c=_.value,l=s.name,i=u.value,n=i&&i.components[l];if(!n)return Pr(g.default,{Component:n,route:c});const e=i.props[l],o=e?e===!0?c.params:typeof e=="function"?e(c):e:null,a=Bs(n,mt({},o,t,{onVnodeUnmounted:f=>{f.component.isUnmounted&&(i.instances[l]=null)},ref:r}));return Pr(g.default,{Component:a,route:c})||a}}});function Pr(s,t){if(!s)return null;const g=s(t);return g.length===1?g[0]:g}const Zs=Oc;function Pc(s){const t=gc(s.routes,s),g=s.parseQuery||yc,v=s.stringifyQuery||Sr,_=s.history,C=Le(),w=Le(),u=Le(),r=jo(se);let c=se;we&&s.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const l=Ni.bind(null,E=>""+E),i=Ni.bind(null,Wl),n=Ni.bind(null,$e);function e(E,H){let I,Y;return Ks(E)?(I=t.getRecordMatcher(E),Y=H):Y=E,t.addRoute(Y,I)}function o(E){const H=t.getRecordMatcher(E);H&&t.removeRoute(H)}function h(){return t.getRoutes().map(E=>E.record)}function a(E){return!!t.getRecordMatcher(E)}function f(E,H){if(H=mt({},H||r.value),typeof E=="string"){const b=Ui(g,E,H.path),A=t.resolve({path:b.path},H),L=_.createHref(b.fullPath);return mt(b,A,{params:n(A.params),hash:$e(b.hash),redirectedFrom:void 0,href:L})}let I;if(E.path!=null)I=mt({},E,{path:Ui(g,E.path,H.path).path});else{const b=mt({},E.params);for(const A in b)b[A]==null&&delete b[A];I=mt({},E,{params:i(b)}),H.params=i(H.params)}const Y=t.resolve(I,H),G=E.hash||"";Y.params=l(n(Y.params));const J=Nl(v,mt({},E,{hash:jl(G),path:Y.path})),S=_.createHref(J);return mt({fullPath:J,hash:G,query:v===Sr?Cc(E.query):E.query||{}},Y,{redirectedFrom:void 0,href:S})}function d(E){return typeof E=="string"?Ui(g,E,r.value.path):mt({},E)}function p(E,H){if(c!==E)return ke(8,{from:H,to:E})}function m(E){return P(E)}function y(E){return m(mt(d(E),{replace:!0}))}function x(E){const H=E.matched[E.matched.length-1];if(H&&H.redirect){const{redirect:I}=H;let Y=typeof I=="function"?I(E):I;return typeof Y=="string"&&(Y=Y.includes("?")||Y.includes("#")?Y=d(Y):{path:Y},Y.params={}),mt({query:E.query,hash:E.hash,params:Y.path!=null?{}:E.params},Y)}}function P(E,H){const I=c=f(E),Y=r.value,G=E.state,J=E.force,S=E.replace===!0,b=x(I);if(b)return P(mt(d(b),{state:typeof b=="object"?mt({},G,b.state):G,force:J,replace:S}),H||I);const A=I;A.redirectedFrom=H;let L;return!J&&Ul(v,Y,I)&&(L=ke(16,{to:A,from:Y}),F(Y,Y,!0,!1)),(L?Promise.resolve(L):q(A,Y)).catch(M=>Qt(M)?Qt(M,2)?M:R(M):tt(M,A,Y)).then(M=>{if(M){if(Qt(M,2))return P(mt({replace:S},d(M.to),{state:typeof M.to=="object"?mt({},G,M.to.state):G,force:J}),H||A)}else M=rt(A,Y,!0,S,G);return Z(A,Y,M),M})}function B(E,H){const I=p(E,H);return I?Promise.reject(I):Promise.resolve()}function z(E){const H=D.values().next().value;return H&&typeof H.runWithContext=="function"?H.runWithContext(E):E()}function q(E,H){let I;const[Y,G,J]=Ec(E,H);I=zi(Y.reverse(),"beforeRouteLeave",E,H);for(const b of Y)b.leaveGuards.forEach(A=>{I.push(le(A,E,H))});const S=B.bind(null,E,H);return I.push(S),W(I).then(()=>{I=[];for(const b of C.list())I.push(le(b,E,H));return I.push(S),W(I)}).then(()=>{I=zi(G,"beforeRouteUpdate",E,H);for(const b of G)b.updateGuards.forEach(A=>{I.push(le(A,E,H))});return I.push(S),W(I)}).then(()=>{I=[];for(const b of J)if(b.beforeEnter)if(Nt(b.beforeEnter))for(const A of b.beforeEnter)I.push(le(A,E,H));else I.push(le(b.beforeEnter,E,H));return I.push(S),W(I)}).then(()=>(E.matched.forEach(b=>b.enterCallbacks={}),I=zi(J,"beforeRouteEnter",E,H,z),I.push(S),W(I))).then(()=>{I=[];for(const b of w.list())I.push(le(b,E,H));return I.push(S),W(I)}).catch(b=>Qt(b,8)?b:Promise.reject(b))}function Z(E,H,I){u.list().forEach(Y=>z(()=>Y(E,H,I)))}function rt(E,H,I,Y,G){const J=p(E,H);if(J)return J;const S=H===se,b=we?history.state:{};I&&(Y||S?_.replace(E.fullPath,mt({scroll:S&&b&&b.scroll},G)):_.push(E.fullPath,G)),r.value=E,F(E,H,I,S),R()}let ot;function et(){ot||(ot=_.listen((E,H,I)=>{if(!O.listening)return;const Y=f(E),G=x(Y);if(G){P(mt(G,{replace:!0}),Y).catch(Ye);return}c=Y;const J=r.value;we&&Ql(dr(J.fullPath,I.delta),Ai()),q(Y,J).catch(S=>Qt(S,12)?S:Qt(S,2)?(P(S.to,Y).then(b=>{Qt(b,20)&&!I.delta&&I.type===Je.pop&&_.go(-1,!1)}).catch(Ye),Promise.reject()):(I.delta&&_.go(-I.delta,!1),tt(S,Y,J))).then(S=>{S=S||rt(Y,J,!1),S&&(I.delta&&!Qt(S,8)?_.go(-I.delta,!1):I.type===Je.pop&&Qt(S,20)&&_.go(-1,!1)),Z(Y,J,S)}).catch(Ye)}))}let nt=Le(),at=Le(),st;function tt(E,H,I){R(E);const Y=at.list();return Y.length?Y.forEach(G=>G(E,H,I)):console.error(E),Promise.reject(E)}function T(){return st&&r.value!==se?Promise.resolve():new Promise((E,H)=>{nt.add([E,H])})}function R(E){return st||(st=!E,et(),nt.list().forEach(([H,I])=>E?I(E):H()),nt.reset()),E}function F(E,H,I,Y){const{scrollBehavior:G}=s;if(!we||!G)return Promise.resolve();const J=!I&&Zl(dr(E.fullPath,0))||(Y||!I)&&history.state&&history.state.scroll||null;return os().then(()=>G(E,H,J)).then(S=>S&&Jl(S)).catch(S=>tt(S,E,H))}const k=E=>_.go(E);let U;const D=new Set,O={currentRoute:r,listening:!0,addRoute:e,removeRoute:o,clearRoutes:t.clearRoutes,hasRoute:a,getRoutes:h,resolve:f,options:s,push:m,replace:y,go:k,back:()=>k(-1),forward:()=>k(1),beforeEach:C.add,beforeResolve:w.add,afterEach:u.add,onError:at.add,isReady:T,install(E){const H=this;E.component("RouterLink",xc),E.component("RouterView",Zs),E.config.globalProperties.$router=H,Object.defineProperty(E.config.globalProperties,"$route",{enumerable:!0,get:()=>_e(r)}),we&&!U&&r.value===se&&(U=!0,m(_.location).catch(G=>{}));const I={};for(const G in se)Object.defineProperty(I,G,{get:()=>r.value[G],enumerable:!0});E.provide(Mn,H),E.provide(Qs,ts(I)),E.provide(an,r);const Y=E.unmount;D.add(E),E.unmount=function(){D.delete(E),D.size<1&&(c=se,ot&&ot(),ot=null,r.value=se,U=!1,st=!1),Y()}}};function W(E){return E.reduce((H,I)=>H.then(()=>z(I)),Promise.resolve())}return O}function Ec(s,t){const g=[],v=[],_=[],C=Math.max(t.matched.length,s.matched.length);for(let w=0;w<C;w++){const u=t.matched[w];u&&(s.matched.find(c=>Me(c,u))?v.push(u):g.push(u));const r=s.matched[w];r&&(t.matched.find(c=>Me(c,r))||_.push(r))}return[g,v,_]}const to=(s,t)=>{const g=s.__vccOpts||s;for(const[v,_]of t)g[v]=_;return g},Ac={__name:"App",setup(s){return(t,g)=>(ci(),Ba(_e(Zs)))}},Dc=to(Ac,[["__scopeId","data-v-190e9293"]]);function Mc(s){if(s.__esModule)return s;var t=s.default;if(typeof t=="function"){var g=function v(){return this instanceof v?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};g.prototype=t.prototype}else g={};return Object.defineProperty(g,"__esModule",{value:!0}),Object.keys(s).forEach(function(v){var _=Object.getOwnPropertyDescriptor(s,v);Object.defineProperty(g,v,_.get?_:{enumerable:!0,get:function(){return s[v]}})}),g}var wt={};const kc={},Fc=Object.freeze(Object.defineProperty({__proto__:null,default:kc},Symbol.toStringTag,{value:"Module"})),Vi=Mc(Fc);(function(s){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.4.0"};if(s.fabric=t,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var g=Vi,v=new g.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=v.document,t.jsdomImplForWrapper=Vi.implForWrapper,t.nodeCanvas=Vi.Canvas,t.window=v,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=t),function(){function u(e,o){if(this.__eventListeners[e]){var h=this.__eventListeners[e];o?h[h.indexOf(o)]=!1:t.util.array.fill(h,!1)}}function r(e,o){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var h in e)this.on(h,e[h]);else this.__eventListeners[e]||(this.__eventListeners[e]=[]),this.__eventListeners[e].push(o);return this}function c(e,o){var h=(function(){o.apply(this,arguments),this.off(e,h)}).bind(this);this.on(e,h)}function l(e,o){if(arguments.length===1)for(var h in e)c.call(this,h,e[h]);else c.call(this,e,o);return this}function i(e,o){if(!this.__eventListeners)return this;if(arguments.length===0)for(e in this.__eventListeners)u.call(this,e);else if(arguments.length===1&&typeof arguments[0]=="object")for(var h in e)u.call(this,h,e[h]);else u.call(this,e,o);return this}function n(e,o){if(!this.__eventListeners)return this;var h=this.__eventListeners[e];if(!h)return this;for(var a=0,f=h.length;a<f;a++)h[a]&&h[a].call(this,o||{});return this.__eventListeners[e]=h.filter(function(d){return d!==!1}),this}t.Observable={fire:n,on:r,once:l,off:i}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var u=0,r=arguments.length;u<r;u++)this._onObjectAdded(arguments[u]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(u,r,c){var l=this._objects;return c?l[r]=u:l.splice(r,0,u),this._onObjectAdded&&this._onObjectAdded(u),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var u=this._objects,r,c=!1,l=0,i=arguments.length;l<i;l++)r=u.indexOf(arguments[l]),r!==-1&&(c=!0,u.splice(r,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[l]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(u,r){for(var c=this.getObjects(),l=0,i=c.length;l<i;l++)u.call(r,c[l],l,c);return this},getObjects:function(u){return typeof u>"u"?this._objects.concat():this._objects.filter(function(r){return r.type===u})},item:function(u){return this._objects[u]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(u,r){return this._objects.indexOf(u)>-1?!0:r?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(u,!0)}):!1},complexity:function(){return this._objects.reduce(function(u,r){return u+=r.complexity?r.complexity():0,u},0)}},t.CommonMethods={_setOptions:function(u){for(var r in u)this.set(r,u[r])},_initGradient:function(u,r){u&&u.colorStops&&!(u instanceof t.Gradient)&&this.set(r,new t.Gradient(u))},_initPattern:function(u,r,c){u&&u.source&&!(u instanceof t.Pattern)?this.set(r,new t.Pattern(u,c)):c&&c()},_setObject:function(u){for(var r in u)this._set(r,u[r])},set:function(u,r){return typeof u=="object"?this._setObject(u):this._set(u,r),this},_set:function(u,r){this[u]=r},toggle:function(u){var r=this.get(u);return typeof r=="boolean"&&this.set(u,!r),this},get:function(u){return this[u]}},function(u){var r=Math.sqrt,c=Math.atan2,l=Math.pow,i=Math.PI/180,n=Math.PI/2;t.util={cos:function(e){if(e===0)return 1;e<0&&(e=-e);var o=e/n;switch(o){case 1:case 3:return 0;case 2:return-1}return Math.cos(e)},sin:function(e){if(e===0)return 0;var o=e/n,h=1;switch(e<0&&(h=-1),o){case 1:return h;case 2:return 0;case 3:return-h}return Math.sin(e)},removeFromArray:function(e,o){var h=e.indexOf(o);return h!==-1&&e.splice(h,1),e},getRandomInt:function(e,o){return Math.floor(Math.random()*(o-e+1))+e},degreesToRadians:function(e){return e*i},radiansToDegrees:function(e){return e/i},rotatePoint:function(e,o,h){var a=new t.Point(e.x-o.x,e.y-o.y),f=t.util.rotateVector(a,h);return new t.Point(f.x,f.y).addEquals(o)},rotateVector:function(e,o){var h=t.util.sin(o),a=t.util.cos(o),f=e.x*a-e.y*h,d=e.x*h+e.y*a;return{x:f,y:d}},createVector:function(e,o){return new t.Point(o.x-e.x,o.y-e.y)},calcAngleBetweenVectors:function(e,o){return Math.acos((e.x*o.x+e.y*o.y)/(Math.hypot(e.x,e.y)*Math.hypot(o.x,o.y)))},getHatVector:function(e){return new t.Point(e.x,e.y).multiply(1/Math.hypot(e.x,e.y))},getBisector:function(e,o,h){var a=t.util.createVector(e,o),f=t.util.createVector(e,h),d=t.util.calcAngleBetweenVectors(a,f),p=t.util.calcAngleBetweenVectors(t.util.rotateVector(a,d),f),m=d*(p===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(a,m)),angle:d}},projectStrokeOnPoints:function(e,o,h){var a=[],f=o.strokeWidth/2,d=o.strokeUniform?new t.Point(1/o.scaleX,1/o.scaleY):new t.Point(1,1),p=function(m){var y=f/Math.hypot(m.x,m.y);return new t.Point(m.x*y*d.x,m.y*y*d.y)};return e.length<=1||e.forEach(function(m,y){var x=new t.Point(m.x,m.y),P,B;y===0?(B=e[y+1],P=h?p(t.util.createVector(B,x)).addEquals(x):e[e.length-1]):y===e.length-1?(P=e[y-1],B=h?p(t.util.createVector(P,x)).addEquals(x):e[0]):(P=e[y-1],B=e[y+1]);var z=t.util.getBisector(x,P,B),q=z.vector,Z=z.angle,rt,ot;if(o.strokeLineJoin==="miter"&&(rt=-f/Math.sin(Z/2),ot=new t.Point(q.x*rt*d.x,q.y*rt*d.y),Math.hypot(ot.x,ot.y)/f<=o.strokeMiterLimit)){a.push(x.add(ot)),a.push(x.subtract(ot));return}rt=-f*Math.SQRT2,ot=new t.Point(q.x*rt*d.x,q.y*rt*d.y),a.push(x.add(ot)),a.push(x.subtract(ot))}),a},transformPoint:function(e,o,h){return h?new t.Point(o[0]*e.x+o[2]*e.y,o[1]*e.x+o[3]*e.y):new t.Point(o[0]*e.x+o[2]*e.y+o[4],o[1]*e.x+o[3]*e.y+o[5])},makeBoundingBoxFromPoints:function(e,o){if(o)for(var h=0;h<e.length;h++)e[h]=t.util.transformPoint(e[h],o);var a=[e[0].x,e[1].x,e[2].x,e[3].x],f=t.util.array.min(a),d=t.util.array.max(a),p=d-f,m=[e[0].y,e[1].y,e[2].y,e[3].y],y=t.util.array.min(m),x=t.util.array.max(m),P=x-y;return{left:f,top:y,width:p,height:P}},invertTransform:function(e){var o=1/(e[0]*e[3]-e[1]*e[2]),h=[o*e[3],-o*e[1],-o*e[2],o*e[0]],a=t.util.transformPoint({x:e[4],y:e[5]},h,!0);return h[4]=-a.x,h[5]=-a.y,h},toFixed:function(e,o){return parseFloat(Number(e).toFixed(o))},parseUnit:function(e,o){var h=/\D{0,2}$/.exec(e),a=parseFloat(e);switch(o||(o=t.Text.DEFAULT_SVG_FONT_SIZE),h[0]){case"mm":return a*t.DPI/25.4;case"cm":return a*t.DPI/2.54;case"in":return a*t.DPI;case"pt":return a*t.DPI/72;case"pc":return a*t.DPI/72*12;case"em":return a*o;default:return a}},falseFunction:function(){return!1},getKlass:function(e,o){return e=t.util.string.camelize(e.charAt(0).toUpperCase()+e.slice(1)),t.util.resolveNamespace(o)[e]},getSvgAttributes:function(e){var o=["instantiated_by_use","style","id","class"];switch(e){case"linearGradient":o=o.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":o=o.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":o=o.concat(["offset","stop-color","stop-opacity"]);break}return o},resolveNamespace:function(e){if(!e)return t;var o=e.split("."),h=o.length,a,f=u||t.window;for(a=0;a<h;++a)f=f[o[a]];return f},loadImage:function(e,o,h,a){if(!e){o&&o.call(h,e);return}var f=t.util.createImage(),d=function(){o&&o.call(h,f,!1),f=f.onload=f.onerror=null};f.onload=d,f.onerror=function(){t.log("Error loading "+f.src),o&&o.call(h,null,!0),f=f.onload=f.onerror=null},e.indexOf("data")!==0&&a!==void 0&&a!==null&&(f.crossOrigin=a),e.substring(0,14)==="data:image/svg"&&(f.onload=null,t.util.loadImageInDom(f,d)),f.src=e},loadImageInDom:function(e,o){var h=t.document.createElement("div");h.style.width=h.style.height="1px",h.style.left=h.style.top="-100%",h.style.position="absolute",h.appendChild(e),t.document.querySelector("body").appendChild(h),e.onload=function(){o(),h.parentNode.removeChild(h),h=null}},enlivenObjects:function(e,o,h,a){e=e||[];var f=[],d=0,p=e.length;function m(){++d===p&&o&&o(f.filter(function(y){return y}))}if(!p){o&&o(f);return}e.forEach(function(y,x){if(!y||!y.type){m();return}var P=t.util.getKlass(y.type,h);P.fromObject(y,function(B,z){z||(f[x]=B),a&&a(y,B,z),m()})})},enlivenObjectEnlivables:function(e,o,h){var a=t.Object.ENLIVEN_PROPS.filter(function(f){return!!e[f]});t.util.enlivenObjects(a.map(function(f){return e[f]}),function(f){var d={};a.forEach(function(p,m){d[p]=f[m],o&&(o[p]=f[m])}),h&&h(d)})},enlivenPatterns:function(e,o){e=e||[];function h(){++f===d&&o&&o(a)}var a=[],f=0,d=e.length;if(!d){o&&o(a);return}e.forEach(function(p,m){p&&p.source?new t.Pattern(p,function(y){a[m]=y,h()}):(a[m]=p,h())})},groupSVGElements:function(e,o,h){var a;return e&&e.length===1?(typeof h<"u"&&(e[0].sourcePath=h),e[0]):(o&&(o.width&&o.height?o.centerPoint={x:o.width/2,y:o.height/2}:(delete o.width,delete o.height)),a=new t.Group(e,o),typeof h<"u"&&(a.sourcePath=h),a)},populateWithProperties:function(e,o,h){if(h&&Array.isArray(h))for(var a=0,f=h.length;a<f;a++)h[a]in e&&(o[h[a]]=e[h[a]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(e){var o=t.util.createCanvasElement();return o.width=e.width,o.height=e.height,o.getContext("2d").drawImage(e,0,0),o},toDataURL:function(e,o,h){return e.toDataURL("image/"+o,h)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(e,o,h){return[e[0]*o[0]+e[2]*o[1],e[1]*o[0]+e[3]*o[1],e[0]*o[2]+e[2]*o[3],e[1]*o[2]+e[3]*o[3],h?0:e[0]*o[4]+e[2]*o[5]+e[4],h?0:e[1]*o[4]+e[3]*o[5]+e[5]]},qrDecompose:function(e){var o=c(e[1],e[0]),h=l(e[0],2)+l(e[1],2),a=r(h),f=(e[0]*e[3]-e[2]*e[1])/a,d=c(e[0]*e[2]+e[1]*e[3],h);return{angle:o/i,scaleX:a,scaleY:f,skewX:d/i,skewY:0,translateX:e[4],translateY:e[5]}},calcRotateMatrix:function(e){if(!e.angle)return t.iMatrix.concat();var o=t.util.degreesToRadians(e.angle),h=t.util.cos(o),a=t.util.sin(o);return[h,a,-a,h,0,0]},calcDimensionsMatrix:function(e){var o=typeof e.scaleX>"u"?1:e.scaleX,h=typeof e.scaleY>"u"?1:e.scaleY,a=[e.flipX?-o:o,0,0,e.flipY?-h:h,0,0],f=t.util.multiplyTransformMatrices,d=t.util.degreesToRadians;return e.skewX&&(a=f(a,[1,0,Math.tan(d(e.skewX)),1],!0)),e.skewY&&(a=f(a,[1,Math.tan(d(e.skewY)),0,1],!0)),a},composeMatrix:function(e){var o=[1,0,0,1,e.translateX||0,e.translateY||0],h=t.util.multiplyTransformMatrices;return e.angle&&(o=h(o,t.util.calcRotateMatrix(e))),(e.scaleX!==1||e.scaleY!==1||e.skewX||e.skewY||e.flipX||e.flipY)&&(o=h(o,t.util.calcDimensionsMatrix(e))),o},resetObjectTransform:function(e){e.scaleX=1,e.scaleY=1,e.skewX=0,e.skewY=0,e.flipX=!1,e.flipY=!1,e.rotate(0)},saveObjectTransform:function(e){return{scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,angle:e.angle,left:e.left,flipX:e.flipX,flipY:e.flipY,top:e.top}},isTransparent:function(e,o,h,a){a>0&&(o>a?o-=a:o=0,h>a?h-=a:h=0);var f=!0,d,p,m=e.getImageData(o,h,a*2||1,a*2||1),y=m.data.length;for(d=3;d<y&&(p=m.data[d],f=p<=0,f!==!1);d+=4);return m=null,f},parsePreserveAspectRatioAttribute:function(e){var o="meet",h="Mid",a="Mid",f=e.split(" "),d;return f&&f.length&&(o=f.pop(),o!=="meet"&&o!=="slice"?(d=o,o="meet"):f.length&&(d=f.pop())),h=d!=="none"?d.slice(1,4):"none",a=d!=="none"?d.slice(5,8):"none",{meetOrSlice:o,alignX:h,alignY:a}},clearFabricFontCache:function(e){e=(e||"").toLowerCase(),e?t.charWidthsCache[e]&&delete t.charWidthsCache[e]:t.charWidthsCache={}},limitDimsByArea:function(e,o){var h=Math.sqrt(o*e),a=Math.floor(o/h);return{x:Math.floor(h),y:a}},capValue:function(e,o,h){return Math.max(e,Math.min(o,h))},findScaleToFit:function(e,o){return Math.min(o.width/e.width,o.height/e.height)},findScaleToCover:function(e,o){return Math.max(o.width/e.width,o.height/e.height)},matrixToSVG:function(e){return"matrix("+e.map(function(o){return t.util.toFixed(o,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(e,o){var h=t.util.invertTransform(o),a=t.util.multiplyTransformMatrices(h,e.calcOwnMatrix());t.util.applyTransformToObject(e,a)},addTransformToObject:function(e,o){t.util.applyTransformToObject(e,t.util.multiplyTransformMatrices(o,e.calcOwnMatrix()))},applyTransformToObject:function(e,o){var h=t.util.qrDecompose(o),a=new t.Point(h.translateX,h.translateY);e.flipX=!1,e.flipY=!1,e.set("scaleX",h.scaleX),e.set("scaleY",h.scaleY),e.skewX=h.skewX,e.skewY=h.skewY,e.angle=h.angle,e.setPositionByOrigin(a,"center","center")},sizeAfterTransform:function(e,o,h){var a=e/2,f=o/2,d=[{x:-a,y:-f},{x:a,y:-f},{x:-a,y:f},{x:a,y:f}],p=t.util.calcDimensionsMatrix(h),m=t.util.makeBoundingBoxFromPoints(d,p);return{x:m.width,y:m.height}},mergeClipPaths:function(e,o){var h=e,a=o;h.inverted&&!a.inverted&&(h=o,a=e),t.util.applyTransformToObject(a,t.util.multiplyTransformMatrices(t.util.invertTransform(h.calcTransformMatrix()),a.calcTransformMatrix()));var f=h.inverted&&a.inverted;return f&&(h.inverted=a.inverted=!1),new t.Group([h],{clipPath:a,inverted:f})},hasStyleChanged:function(e,o,h){return h=h||!1,e.fill!==o.fill||e.stroke!==o.stroke||e.strokeWidth!==o.strokeWidth||e.fontSize!==o.fontSize||e.fontFamily!==o.fontFamily||e.fontWeight!==o.fontWeight||e.fontStyle!==o.fontStyle||e.textBackgroundColor!==o.textBackgroundColor||e.deltaY!==o.deltaY||h&&(e.overline!==o.overline||e.underline!==o.underline||e.linethrough!==o.linethrough)},stylesToArray:function(h,o){for(var h=t.util.object.clone(h,!0),a=o.split(`
`),f=-1,d={},p=[],m=0;m<a.length;m++){if(!h[m]){f+=a[m].length;continue}for(var y=0;y<a[m].length;y++){f++;var x=h[m][y];if(x&&Object.keys(x).length>0){var P=t.util.hasStyleChanged(d,x,!0);P?p.push({start:f,end:f+1,style:x}):p[p.length-1].end++}d=x||{}}}return p},stylesFromArray:function(e,o){if(!Array.isArray(e))return e;for(var h=o.split(`
`),a=-1,f=0,d={},p=0;p<h.length;p++)for(var m=0;m<h[p].length;m++)a++,e[f]&&e[f].start<=a&&a<e[f].end&&(d[p]=d[p]||{},d[p][m]=Object.assign({},e[f].style),a===e[f].end-1&&f++);return d}}}(s),function(){var u=Array.prototype.join,r={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function l(T,R,F,k,U,D,O,W,E,H,I){var Y=t.util.cos(T),G=t.util.sin(T),J=t.util.cos(R),S=t.util.sin(R),b=F*U*J-k*D*S+O,A=k*U*J+F*D*S+W,L=H+E*(-F*U*G-k*D*Y),M=I+E*(-k*U*G+F*D*Y),X=b+E*(F*U*S+k*D*J),N=A+E*(k*U*S-F*D*J);return["C",L,M,X,N,b,A]}function i(T,R,F,k,U,D,O){var W=Math.PI,E=O*W/180,H=t.util.sin(E),I=t.util.cos(E),Y=0,G=0;F=Math.abs(F),k=Math.abs(k);var J=-I*T*.5-H*R*.5,S=-I*R*.5+H*T*.5,b=F*F,A=k*k,L=S*S,M=J*J,X=b*A-b*L-A*M,N=0;if(X<0){var K=Math.sqrt(1-X/(b*A));F*=K,k*=K}else N=(U===D?-1:1)*Math.sqrt(X/(b*L+A*M));var V=N*F*S/k,j=-N*k*J/F,Q=I*V-H*j+T*.5,$=H*V+I*j+R*.5,it=n(1,0,(J-V)/F,(S-j)/k),lt=n((J-V)/F,(S-j)/k,(-J-V)/F,(-S-j)/k);D===0&&lt>0?lt-=2*W:D===1&&lt<0&&(lt+=2*W);for(var ct=Math.ceil(Math.abs(lt/W*2)),ft=[],ht=lt/ct,St=8/3*Math.sin(ht/4)*Math.sin(ht/4)/Math.sin(ht/2),Ct=it+ht,bt=0;bt<ct;bt++)ft[bt]=l(it,Ct,I,H,F,k,Q,$,St,Y,G),Y=ft[bt][5],G=ft[bt][6],it=Ct,Ct+=ht;return ft}function n(T,R,F,k){var U=Math.atan2(R,T),D=Math.atan2(k,F);return D>=U?D-U:2*Math.PI-(U-D)}function e(T,R,F,k,U,D,O,W){var E;if(t.cachesBoundsOfCurve&&(E=u.call(arguments),t.boundsOfCurveCache[E]))return t.boundsOfCurveCache[E];var H=Math.sqrt,I=Math.min,Y=Math.max,G=Math.abs,J=[],S=[[],[]],b,A,L,M,X,N,K,V;A=6*T-12*F+6*U,b=-3*T+9*F-9*U+3*O,L=3*F-3*T;for(var j=0;j<2;++j){if(j>0&&(A=6*R-12*k+6*D,b=-3*R+9*k-9*D+3*W,L=3*k-3*R),G(b)<1e-12){if(G(A)<1e-12)continue;M=-L/A,0<M&&M<1&&J.push(M);continue}K=A*A-4*L*b,!(K<0)&&(V=H(K),X=(-A+V)/(2*b),0<X&&X<1&&J.push(X),N=(-A-V)/(2*b),0<N&&N<1&&J.push(N))}for(var Q,$,it=J.length,lt=it,ct;it--;)M=J[it],ct=1-M,Q=ct*ct*ct*T+3*ct*ct*M*F+3*ct*M*M*U+M*M*M*O,S[0][it]=Q,$=ct*ct*ct*R+3*ct*ct*M*k+3*ct*M*M*D+M*M*M*W,S[1][it]=$;S[0][lt]=T,S[1][lt]=R,S[0][lt+1]=O,S[1][lt+1]=W;var ft=[{x:I.apply(null,S[0]),y:I.apply(null,S[1])},{x:Y.apply(null,S[0]),y:Y.apply(null,S[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[E]=ft),ft}function o(T,R,F){for(var k=F[1],U=F[2],D=F[3],O=F[4],W=F[5],E=F[6],H=F[7],I=i(E-T,H-R,k,U,O,W,D),Y=0,G=I.length;Y<G;Y++)I[Y][1]+=T,I[Y][2]+=R,I[Y][3]+=T,I[Y][4]+=R,I[Y][5]+=T,I[Y][6]+=R;return I}function h(T){var R=0,F=0,k=T.length,U=0,D=0,O,W,E,H=[],I,Y,G;for(W=0;W<k;++W){switch(E=!1,O=T[W].slice(0),O[0]){case"l":O[0]="L",O[1]+=R,O[2]+=F;case"L":R=O[1],F=O[2];break;case"h":O[1]+=R;case"H":O[0]="L",O[2]=F,R=O[1];break;case"v":O[1]+=F;case"V":O[0]="L",F=O[1],O[1]=R,O[2]=F;break;case"m":O[0]="M",O[1]+=R,O[2]+=F;case"M":R=O[1],F=O[2],U=O[1],D=O[2];break;case"c":O[0]="C",O[1]+=R,O[2]+=F,O[3]+=R,O[4]+=F,O[5]+=R,O[6]+=F;case"C":Y=O[3],G=O[4],R=O[5],F=O[6];break;case"s":O[0]="S",O[1]+=R,O[2]+=F,O[3]+=R,O[4]+=F;case"S":I==="C"?(Y=2*R-Y,G=2*F-G):(Y=R,G=F),R=O[3],F=O[4],O[0]="C",O[5]=O[3],O[6]=O[4],O[3]=O[1],O[4]=O[2],O[1]=Y,O[2]=G,Y=O[3],G=O[4];break;case"q":O[0]="Q",O[1]+=R,O[2]+=F,O[3]+=R,O[4]+=F;case"Q":Y=O[1],G=O[2],R=O[3],F=O[4];break;case"t":O[0]="T",O[1]+=R,O[2]+=F;case"T":I==="Q"?(Y=2*R-Y,G=2*F-G):(Y=R,G=F),O[0]="Q",R=O[1],F=O[2],O[1]=Y,O[2]=G,O[3]=R,O[4]=F;break;case"a":O[0]="A",O[6]+=R,O[7]+=F;case"A":E=!0,H=H.concat(o(R,F,O)),R=O[6],F=O[7];break;case"z":case"Z":R=U,F=D;break}E||H.push(O),I=O[0]}return H}function a(T,R,F,k){return Math.sqrt((F-T)*(F-T)+(k-R)*(k-R))}function f(T){return T*T*T}function d(T){return 3*T*T*(1-T)}function p(T){return 3*T*(1-T)*(1-T)}function m(T){return(1-T)*(1-T)*(1-T)}function y(T,R,F,k,U,D,O,W){return function(E){var H=f(E),I=d(E),Y=p(E),G=m(E);return{x:O*H+U*I+F*Y+T*G,y:W*H+D*I+k*Y+R*G}}}function x(T,R,F,k,U,D,O,W){return function(E){var H=1-E,I=3*H*H*(F-T)+6*H*E*(U-F)+3*E*E*(O-U),Y=3*H*H*(k-R)+6*H*E*(D-k)+3*E*E*(W-D);return Math.atan2(Y,I)}}function P(T){return T*T}function B(T){return 2*T*(1-T)}function z(T){return(1-T)*(1-T)}function q(T,R,F,k,U,D){return function(O){var W=P(O),E=B(O),H=z(O);return{x:U*W+F*E+T*H,y:D*W+k*E+R*H}}}function Z(T,R,F,k,U,D){return function(O){var W=1-O,E=2*W*(F-T)+2*O*(U-F),H=2*W*(k-R)+2*O*(D-k);return Math.atan2(H,E)}}function rt(T,R,F){var k={x:R,y:F},U,D=0,O;for(O=1;O<=100;O+=1)U=T(O/100),D+=a(k.x,k.y,U.x,U.y),k=U;return D}function ot(T,R){for(var F=0,k=0,U=T.iterator,D={x:T.x,y:T.y},O,W,E=.01,H=T.angleFinder,I;k<R&&E>1e-4;)O=U(F),I=F,W=a(D.x,D.y,O.x,O.y),W+k>R?(F-=E,E/=2):(D=O,F+=E,k+=W);return O.angle=H(I),O}function et(T){for(var R=0,F=T.length,k,U=0,D=0,O=0,W=0,E=[],H,I,Y,G=0;G<F;G++){switch(k=T[G],I={x:U,y:D,command:k[0]},k[0]){case"M":I.length=0,O=U=k[1],W=D=k[2];break;case"L":I.length=a(U,D,k[1],k[2]),U=k[1],D=k[2];break;case"C":H=y(U,D,k[1],k[2],k[3],k[4],k[5],k[6]),Y=x(U,D,k[1],k[2],k[3],k[4],k[5],k[6]),I.iterator=H,I.angleFinder=Y,I.length=rt(H,U,D),U=k[5],D=k[6];break;case"Q":H=q(U,D,k[1],k[2],k[3],k[4]),Y=Z(U,D,k[1],k[2],k[3],k[4]),I.iterator=H,I.angleFinder=Y,I.length=rt(H,U,D),U=k[3],D=k[4];break;case"Z":case"z":I.destX=O,I.destY=W,I.length=a(U,D,O,W),U=O,D=W;break}R+=I.length,E.push(I)}return E.push({length:R,x:U,y:D}),E}function nt(T,R,F){F||(F=et(T));for(var k=0;R-F[k].length>0&&k<F.length-2;)R-=F[k].length,k++;var U=F[k],D=R/U.length,O=U.command,W=T[k],E;switch(O){case"M":return{x:U.x,y:U.y,angle:0};case"Z":case"z":return E=new t.Point(U.x,U.y).lerp(new t.Point(U.destX,U.destY),D),E.angle=Math.atan2(U.destY-U.y,U.destX-U.x),E;case"L":return E=new t.Point(U.x,U.y).lerp(new t.Point(W[1],W[2]),D),E.angle=Math.atan2(W[2]-U.y,W[1]-U.x),E;case"C":return ot(U,R);case"Q":return ot(U,R)}}function at(T){var R=[],F=[],k,U,D=t.rePathCommand,O="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",W="("+O+")"+t.commaWsp,E="([01])"+t.commaWsp+"?",H=W+"?"+W+"?"+W+E+E+W+"?("+O+")",I=new RegExp(H,"g"),Y,G,J;if(!T||!T.match)return R;J=T.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var S=0,b,A=J.length;S<A;S++){k=J[S],G=k.slice(1).trim(),F.length=0;var L=k.charAt(0);if(b=[L],L.toLowerCase()==="a")for(var M;M=I.exec(G);)for(var X=1;X<M.length;X++)F.push(M[X]);else for(;Y=D.exec(G);)F.push(Y[0]);for(var X=0,N=F.length;X<N;X++)U=parseFloat(F[X]),isNaN(U)||b.push(U);var K=r[L.toLowerCase()],V=c[L]||L;if(b.length-1>K)for(var j=1,Q=b.length;j<Q;j+=K)R.push([L].concat(b.slice(j,j+K))),L=V;else R.push(b)}return R}function st(T,R){var F=[],k,U=new t.Point(T[0].x,T[0].y),D=new t.Point(T[1].x,T[1].y),O=T.length,W=1,E=0,H=O>2;for(R=R||0,H&&(W=T[2].x<D.x?-1:T[2].x===D.x?0:1,E=T[2].y<D.y?-1:T[2].y===D.y?0:1),F.push(["M",U.x-W*R,U.y-E*R]),k=1;k<O;k++){if(!U.eq(D)){var I=U.midPointFrom(D);F.push(["Q",U.x,U.y,I.x,I.y])}U=T[k],k+1<T.length&&(D=T[k+1])}return H&&(W=U.x>T[k-2].x?1:U.x===T[k-2].x?0:-1,E=U.y>T[k-2].y?1:U.y===T[k-2].y?0:-1),F.push(["L",U.x+W*R,U.y+E*R]),F}function tt(T,R,F){return F&&(R=t.util.multiplyTransformMatrices(R,[1,0,0,1,-F.x,-F.y])),T.map(function(k){for(var U=k.slice(0),D={},O=1;O<k.length-1;O+=2)D.x=k[O],D.y=k[O+1],D=t.util.transformPoint(D,R),U[O]=D.x,U[O+1]=D.y;return U})}t.util.joinPath=function(T){return T.map(function(R){return R.join(" ")}).join(" ")},t.util.parsePath=at,t.util.makePathSimpler=h,t.util.getSmoothPathFromPoints=st,t.util.getPathSegmentsInfo=et,t.util.getBoundsOfCurve=e,t.util.getPointOnPath=nt,t.util.transformPath=tt}(),function(){var u=Array.prototype.slice;function r(e,o){for(var h=u.call(arguments,2),a=[],f=0,d=e.length;f<d;f++)a[f]=h.length?e[f][o].apply(e[f],h):e[f][o].call(e[f]);return a}function c(e,o){return n(e,o,function(h,a){return h>=a})}function l(e,o){return n(e,o,function(h,a){return h<a})}function i(e,o){for(var h=e.length;h--;)e[h]=o;return e}function n(e,o,h){if(!(!e||e.length===0)){var a=e.length-1,f=o?e[a][o]:e[a];if(o)for(;a--;)h(e[a][o],f)&&(f=e[a][o]);else for(;a--;)h(e[a],f)&&(f=e[a]);return f}}t.util.array={fill:i,invoke:r,min:l,max:c}}(),function(){function u(c,l,i){if(i)if(!t.isLikelyNode&&l instanceof Element)c=l;else if(l instanceof Array){c=[];for(var n=0,e=l.length;n<e;n++)c[n]=u({},l[n],i)}else if(l&&typeof l=="object")for(var o in l)o==="canvas"||o==="group"?c[o]=null:l.hasOwnProperty(o)&&(c[o]=u({},l[o],i));else c=l;else for(var o in l)c[o]=l[o];return c}function r(c,l){return u({},c,l)}t.util.object={extend:u,clone:r},t.util.object.extend(t.util,t.Observable)}(),function(){function u(n){return n.replace(/-+(.)?/g,function(e,o){return o?o.toUpperCase():""})}function r(n,e){return n.charAt(0).toUpperCase()+(e?n.slice(1):n.slice(1).toLowerCase())}function c(n){return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(n){var e=0,o,h=[];for(e=0,o;e<n.length;e++)(o=i(n,e))!==!1&&h.push(o);return h}function i(n,e){var o=n.charCodeAt(e);if(isNaN(o))return"";if(o<55296||o>57343)return n.charAt(e);if(55296<=o&&o<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";var h=n.charCodeAt(e+1);if(56320>h||h>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";var a=n.charCodeAt(e-1);if(55296>a||a>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:u,capitalize:r,escapeXml:c,graphemeSplit:l}}(),function(){var u=Array.prototype.slice,r=function(){},c=function(){for(var o in{toString:1})if(o==="toString")return!1;return!0}(),l=function(o,h,a){for(var f in h)f in o.prototype&&typeof o.prototype[f]=="function"&&(h[f]+"").indexOf("callSuper")>-1?o.prototype[f]=function(d){return function(){var p=this.constructor.superclass;this.constructor.superclass=a;var m=h[d].apply(this,arguments);if(this.constructor.superclass=p,d!=="initialize")return m}}(f):o.prototype[f]=h[f],c&&(h.toString!==Object.prototype.toString&&(o.prototype.toString=h.toString),h.valueOf!==Object.prototype.valueOf&&(o.prototype.valueOf=h.valueOf))};function i(){}function n(o){for(var h=null,a=this;a.constructor.superclass;){var f=a.constructor.superclass.prototype[o];if(a[o]!==f){h=f;break}a=a.constructor.superclass.prototype}return h?arguments.length>1?h.apply(this,u.call(arguments,1)):h.call(this):console.log("tried to callSuper "+o+", method not found in prototype chain",this)}function e(){var o=null,h=u.call(arguments,0);typeof h[0]=="function"&&(o=h.shift());function a(){this.initialize.apply(this,arguments)}a.superclass=o,a.subclasses=[],o&&(i.prototype=o.prototype,a.prototype=new i,o.subclasses.push(a));for(var f=0,d=h.length;f<d;f++)l(a,h[f],o);return a.prototype.initialize||(a.prototype.initialize=r),a.prototype.constructor=a,a.prototype.callSuper=n,a}t.util.createClass=e}(),function(){var u=!!t.document.createElement("div").attachEvent,r=["touchstart","touchmove","touchend"];t.util.addListener=function(l,i,n,e){l&&l.addEventListener(i,n,u?!1:e)},t.util.removeListener=function(l,i,n,e){l&&l.removeEventListener(i,n,u?!1:e)};function c(l){var i=l.changedTouches;return i&&i[0]?i[0]:l}t.util.getPointer=function(l){var i=l.target,n=t.util.getScrollLeftTop(i),e=c(l);return{x:e.clientX+n.left,y:e.clientY+n.top}},t.util.isTouchEvent=function(l){return r.indexOf(l.type)>-1||l.pointerType==="touch"}}(),function(){function u(e,o){var h=e.style;if(!h)return e;if(typeof o=="string")return e.style.cssText+=";"+o,o.indexOf("opacity")>-1?n(e,o.match(/opacity:\s*(\d?\.?\d*)/)[1]):e;for(var a in o)if(a==="opacity")n(e,o[a]);else{var f=a==="float"||a==="cssFloat"?typeof h.styleFloat>"u"?"cssFloat":"styleFloat":a;h.setProperty(f,o[a])}return e}var r=t.document.createElement("div"),c=typeof r.style.opacity=="string",l=typeof r.style.filter=="string",i=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,n=function(e){return e};c?n=function(e,o){return e.style.opacity=o,e}:l&&(n=function(e,o){var h=e.style;return e.currentStyle&&!e.currentStyle.hasLayout&&(h.zoom=1),i.test(h.filter)?(o=o>=.9999?"":"alpha(opacity="+o*100+")",h.filter=h.filter.replace(i,o)):h.filter+=" alpha(opacity="+o*100+")",e}),t.util.setStyle=u}(),function(){var u=Array.prototype.slice;function r(m){return typeof m=="string"?t.document.getElementById(m):m}var c,l=function(m){return u.call(m,0)};try{c=l(t.document.childNodes)instanceof Array}catch{}c||(l=function(m){for(var y=new Array(m.length),x=m.length;x--;)y[x]=m[x];return y});function i(m,y){var x=t.document.createElement(m);for(var P in y)P==="class"?x.className=y[P]:P==="for"?x.htmlFor=y[P]:x.setAttribute(P,y[P]);return x}function n(m,y){m&&(" "+m.className+" ").indexOf(" "+y+" ")===-1&&(m.className+=(m.className?" ":"")+y)}function e(m,y,x){return typeof y=="string"&&(y=i(y,x)),m.parentNode&&m.parentNode.replaceChild(y,m),y.appendChild(m),y}function o(m){for(var y=0,x=0,P=t.document.documentElement,B=t.document.body||{scrollLeft:0,scrollTop:0};m&&(m.parentNode||m.host)&&(m=m.parentNode||m.host,m===t.document?(y=B.scrollLeft||P.scrollLeft||0,x=B.scrollTop||P.scrollTop||0):(y+=m.scrollLeft||0,x+=m.scrollTop||0),!(m.nodeType===1&&m.style.position==="fixed")););return{left:y,top:x}}function h(m){var y,x=m&&m.ownerDocument,P={left:0,top:0},B={left:0,top:0},z,q={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!x)return B;for(var Z in q)B[q[Z]]+=parseInt(a(m,Z),10)||0;return y=x.documentElement,typeof m.getBoundingClientRect<"u"&&(P=m.getBoundingClientRect()),z=o(m),{left:P.left+z.left-(y.clientLeft||0)+B.left,top:P.top+z.top-(y.clientTop||0)+B.top}}var a;t.document.defaultView&&t.document.defaultView.getComputedStyle?a=function(m,y){var x=t.document.defaultView.getComputedStyle(m,null);return x?x[y]:void 0}:a=function(m,y){var x=m.style[y];return!x&&m.currentStyle&&(x=m.currentStyle[y]),x},function(){var m=t.document.documentElement.style,y="userSelect"in m?"userSelect":"MozUserSelect"in m?"MozUserSelect":"WebkitUserSelect"in m?"WebkitUserSelect":"KhtmlUserSelect"in m?"KhtmlUserSelect":"";function x(B){return typeof B.onselectstart<"u"&&(B.onselectstart=t.util.falseFunction),y?B.style[y]="none":typeof B.unselectable=="string"&&(B.unselectable="on"),B}function P(B){return typeof B.onselectstart<"u"&&(B.onselectstart=null),y?B.style[y]="":typeof B.unselectable=="string"&&(B.unselectable=""),B}t.util.makeElementUnselectable=x,t.util.makeElementSelectable=P}();function f(m){var y=t.jsdomImplForWrapper(m);return y._canvas||y._image}function d(m){if(t.isLikelyNode){var y=t.jsdomImplForWrapper(m);y&&(y._image=null,y._canvas=null,y._currentSrc=null,y._attributes=null,y._classList=null)}}function p(m,y){m.imageSmoothingEnabled=m.imageSmoothingEnabled||m.webkitImageSmoothingEnabled||m.mozImageSmoothingEnabled||m.msImageSmoothingEnabled||m.oImageSmoothingEnabled,m.imageSmoothingEnabled=y}t.util.setImageSmoothing=p,t.util.getById=r,t.util.toArray=l,t.util.addClass=n,t.util.makeElement=i,t.util.wrapElement=e,t.util.getScrollLeftTop=o,t.util.getElementOffset=h,t.util.getNodeCanvas=f,t.util.cleanUpJsdomNode=d}(),function(){function u(l,i){return l+(/\?/.test(l)?"&":"?")+i}function r(){}function c(l,i){i||(i={});var n=i.method?i.method.toUpperCase():"GET",e=i.onComplete||function(){},o=new t.window.XMLHttpRequest,h=i.body||i.parameters;return o.onreadystatechange=function(){o.readyState===4&&(e(o),o.onreadystatechange=r)},n==="GET"&&(h=null,typeof i.parameters=="string"&&(l=u(l,i.parameters))),o.open(n,l,!0),(n==="POST"||n==="PUT")&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(h),o}t.util.request=c}(),t.log=console.log,t.warn=console.warn,function(){var u=t.util.object.extend,r=t.util.object.clone,c=[];t.util.object.extend(c,{cancelAll:function(){var f=this.splice(0);return f.forEach(function(d){d.cancel()}),f},cancelByCanvas:function(f){if(!f)return[];var d=this.filter(function(p){return typeof p.target=="object"&&p.target.canvas===f});return d.forEach(function(p){p.cancel()}),d},cancelByTarget:function(f){var d=this.findAnimationsByTarget(f);return d.forEach(function(p){p.cancel()}),d},findAnimationIndex:function(f){return this.indexOf(this.findAnimation(f))},findAnimation:function(f){return this.find(function(d){return d.cancel===f})},findAnimationsByTarget:function(f){return f?this.filter(function(d){return d.target===f}):[]}});function l(){return!1}function i(f,d,p,m){return-p*Math.cos(f/m*(Math.PI/2))+p+d}function n(f){f||(f={});var d=!1,p,m=function(){var y=t.runningAnimations.indexOf(p);return y>-1&&t.runningAnimations.splice(y,1)[0]};return p=u(r(f),{cancel:function(){return d=!0,m()},currentValue:"startValue"in f?f.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(p),h(function(y){var x=y||+new Date,P=f.duration||500,B=x+P,z,q=f.onChange||l,Z=f.abort||l,rt=f.onComplete||l,ot=f.easing||i,et="startValue"in f?f.startValue.length>0:!1,nt="startValue"in f?f.startValue:0,at="endValue"in f?f.endValue:100,st=f.byValue||(et?nt.map(function(tt,T){return at[T]-nt[T]}):at-nt);f.onStart&&f.onStart(),function tt(T){z=T||+new Date;var R=z>B?P:z-x,F=R/P,k=et?nt.map(function(D,O){return ot(R,nt[O],st[O],P)}):ot(R,nt,st,P),U=Math.abs(et?(k[0]-nt[0])/st[0]:(k-nt)/st);if(p.currentValue=et?k.slice():k,p.completionRate=U,p.durationRate=F,!d){if(Z(k,U,F)){m();return}if(z>B){p.currentValue=et?at.slice():at,p.completionRate=1,p.durationRate=1,q(et?at.slice():at,1,1),rt(at,1,1),m();return}else q(k,U,F),h(tt)}}(x)}),p.cancel}var e=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(f){return t.window.setTimeout(f,1e3/60)},o=t.window.cancelAnimationFrame||t.window.clearTimeout;function h(){return e.apply(t.window,arguments)}function a(){return o.apply(t.window,arguments)}t.util.animate=n,t.util.requestAnimFrame=h,t.util.cancelAnimFrame=a,t.runningAnimations=c}(),function(){function u(c,l,i){var n="rgba("+parseInt(c[0]+i*(l[0]-c[0]),10)+","+parseInt(c[1]+i*(l[1]-c[1]),10)+","+parseInt(c[2]+i*(l[2]-c[2]),10);return n+=","+(c&&l?parseFloat(c[3]+i*(l[3]-c[3])):1),n+=")",n}function r(c,l,i,n){var e=new t.Color(c).getSource(),o=new t.Color(l).getSource(),h=n.onComplete,a=n.onChange;return n=n||{},t.util.animate(t.util.object.extend(n,{duration:i||500,startValue:e,endValue:o,byValue:o,easing:function(f,d,p,m){var y=n.colorEasing?n.colorEasing(f,m):1-Math.cos(f/m*(Math.PI/2));return u(d,p,y)},onComplete:function(f,d,p){if(h)return h(u(o,o,0),d,p)},onChange:function(f,d,p){if(a){if(Array.isArray(f))return a(u(f,f,0),d,p);a(f,d,p)}}}))}t.util.animateColor=r}(),function(){function u(T,R,F,k){return T<Math.abs(R)?(T=R,k=F/4):R===0&&T===0?k=F/(2*Math.PI)*Math.asin(1):k=F/(2*Math.PI)*Math.asin(R/T),{a:T,c:R,p:F,s:k}}function r(T,R,F){return T.a*Math.pow(2,10*(R-=1))*Math.sin((R*F-T.s)*(2*Math.PI)/T.p)}function c(T,R,F,k){return F*((T=T/k-1)*T*T+1)+R}function l(T,R,F,k){return T/=k/2,T<1?F/2*T*T*T+R:F/2*((T-=2)*T*T+2)+R}function i(T,R,F,k){return F*(T/=k)*T*T*T+R}function n(T,R,F,k){return-F*((T=T/k-1)*T*T*T-1)+R}function e(T,R,F,k){return T/=k/2,T<1?F/2*T*T*T*T+R:-F/2*((T-=2)*T*T*T-2)+R}function o(T,R,F,k){return F*(T/=k)*T*T*T*T+R}function h(T,R,F,k){return F*((T=T/k-1)*T*T*T*T+1)+R}function a(T,R,F,k){return T/=k/2,T<1?F/2*T*T*T*T*T+R:F/2*((T-=2)*T*T*T*T+2)+R}function f(T,R,F,k){return-F*Math.cos(T/k*(Math.PI/2))+F+R}function d(T,R,F,k){return F*Math.sin(T/k*(Math.PI/2))+R}function p(T,R,F,k){return-F/2*(Math.cos(Math.PI*T/k)-1)+R}function m(T,R,F,k){return T===0?R:F*Math.pow(2,10*(T/k-1))+R}function y(T,R,F,k){return T===k?R+F:F*(-Math.pow(2,-10*T/k)+1)+R}function x(T,R,F,k){return T===0?R:T===k?R+F:(T/=k/2,T<1?F/2*Math.pow(2,10*(T-1))+R:F/2*(-Math.pow(2,-10*--T)+2)+R)}function P(T,R,F,k){return-F*(Math.sqrt(1-(T/=k)*T)-1)+R}function B(T,R,F,k){return F*Math.sqrt(1-(T=T/k-1)*T)+R}function z(T,R,F,k){return T/=k/2,T<1?-F/2*(Math.sqrt(1-T*T)-1)+R:F/2*(Math.sqrt(1-(T-=2)*T)+1)+R}function q(T,R,F,k){var U=1.70158,D=0,O=F;if(T===0)return R;if(T/=k,T===1)return R+F;D||(D=k*.3);var W=u(O,F,D,U);return-r(W,T,k)+R}function Z(T,R,F,k){var U=1.70158,D=0,O=F;if(T===0)return R;if(T/=k,T===1)return R+F;D||(D=k*.3);var W=u(O,F,D,U);return W.a*Math.pow(2,-10*T)*Math.sin((T*k-W.s)*(2*Math.PI)/W.p)+W.c+R}function rt(T,R,F,k){var U=1.70158,D=0,O=F;if(T===0)return R;if(T/=k/2,T===2)return R+F;D||(D=k*(.3*1.5));var W=u(O,F,D,U);return T<1?-.5*r(W,T,k)+R:W.a*Math.pow(2,-10*(T-=1))*Math.sin((T*k-W.s)*(2*Math.PI)/W.p)*.5+W.c+R}function ot(T,R,F,k,U){return U===void 0&&(U=1.70158),F*(T/=k)*T*((U+1)*T-U)+R}function et(T,R,F,k,U){return U===void 0&&(U=1.70158),F*((T=T/k-1)*T*((U+1)*T+U)+1)+R}function nt(T,R,F,k,U){return U===void 0&&(U=1.70158),T/=k/2,T<1?F/2*(T*T*(((U*=1.525)+1)*T-U))+R:F/2*((T-=2)*T*(((U*=1.525)+1)*T+U)+2)+R}function at(T,R,F,k){return F-st(k-T,0,F,k)+R}function st(T,R,F,k){return(T/=k)<1/2.75?F*(7.5625*T*T)+R:T<2/2.75?F*(7.5625*(T-=1.5/2.75)*T+.75)+R:T<2.5/2.75?F*(7.5625*(T-=2.25/2.75)*T+.9375)+R:F*(7.5625*(T-=2.625/2.75)*T+.984375)+R}function tt(T,R,F,k){return T<k/2?at(T*2,0,F,k)*.5+R:st(T*2-k,0,F,k)*.5+F*.5+R}t.util.ease={easeInQuad:function(T,R,F,k){return F*(T/=k)*T+R},easeOutQuad:function(T,R,F,k){return-F*(T/=k)*(T-2)+R},easeInOutQuad:function(T,R,F,k){return T/=k/2,T<1?F/2*T*T+R:-F/2*(--T*(T-2)-1)+R},easeInCubic:function(T,R,F,k){return F*(T/=k)*T*T+R},easeOutCubic:c,easeInOutCubic:l,easeInQuart:i,easeOutQuart:n,easeInOutQuart:e,easeInQuint:o,easeOutQuint:h,easeInOutQuint:a,easeInSine:f,easeOutSine:d,easeInOutSine:p,easeInExpo:m,easeOutExpo:y,easeInOutExpo:x,easeInCirc:P,easeOutCirc:B,easeInOutCirc:z,easeInElastic:q,easeOutElastic:Z,easeInOutElastic:rt,easeInBack:ot,easeOutBack:et,easeInOutBack:nt,easeInBounce:at,easeOutBounce:st,easeInOutBounce:tt}}(),function(u){var r=u.fabric||(u.fabric={}),c=r.util.object.extend,l=r.util.object.clone,i=r.util.toFixed,n=r.util.parseUnit,e=r.util.multiplyTransformMatrices,o=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],h=["symbol","image","marker","pattern","view","svg"],a=["pattern","defs","symbol","metadata","clipPath","mask","desc"],f=["symbol","g","a","svg","clipPath","defs"],d={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},p={stroke:"strokeOpacity",fill:"fillOpacity"},m="font-size",y="clip-path";r.svgValidTagNamesRegEx=B(o),r.svgViewBoxElementsRegEx=B(h),r.svgInvalidAncestorsRegEx=B(a),r.svgValidParentsRegEx=B(f),r.cssRules={},r.gradientDefs={},r.clipPaths={};function x(D){return D in d?d[D]:D}function P(D,O,W,E){var H=Array.isArray(O),I;if((D==="fill"||D==="stroke")&&O==="none")O="";else{if(D==="strokeUniform")return O==="non-scaling-stroke";if(D==="strokeDashArray")O==="none"?O=null:O=O.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(D==="transformMatrix")W&&W.transformMatrix?O=e(W.transformMatrix,r.parseTransformAttribute(O)):O=r.parseTransformAttribute(O);else if(D==="visible")O=O!=="none"&&O!=="hidden",W&&W.visible===!1&&(O=!1);else if(D==="opacity")O=parseFloat(O),W&&typeof W.opacity<"u"&&(O*=W.opacity);else if(D==="textAnchor")O=O==="start"?"left":O==="end"?"right":"center";else if(D==="charSpacing")I=n(O,E)/E*1e3;else if(D==="paintFirst"){var Y=O.indexOf("fill"),G=O.indexOf("stroke"),O="fill";(Y>-1&&G>-1&&G<Y||Y===-1&&G>-1)&&(O="stroke")}else{if(D==="href"||D==="xlink:href"||D==="font")return O;if(D==="imageSmoothing")return O==="optimizeQuality";I=H?O.map(n):n(O,E)}}return!H&&isNaN(I)?O:I}function B(D){return new RegExp("^("+D.join("|")+")\\b","i")}function z(D){for(var O in p)if(!(typeof D[p[O]]>"u"||D[O]==="")){if(typeof D[O]>"u"){if(!r.Object.prototype[O])continue;D[O]=r.Object.prototype[O]}if(D[O].indexOf("url(")!==0){var W=new r.Color(D[O]);D[O]=W.setAlpha(i(W.getAlpha()*D[p[O]],2)).toRgba()}}return D}function q(D,O){var W,E=[],H,I,Y;for(I=0,Y=O.length;I<Y;I++)W=O[I],H=D.getElementsByTagName(W),E=E.concat(Array.prototype.slice.call(H));return E}r.parseTransformAttribute=function(){function D(j,Q){var $=r.util.cos(Q[0]),it=r.util.sin(Q[0]),lt=0,ct=0;Q.length===3&&(lt=Q[1],ct=Q[2]),j[0]=$,j[1]=it,j[2]=-it,j[3]=$,j[4]=lt-($*lt-it*ct),j[5]=ct-(it*lt+$*ct)}function O(j,Q){var $=Q[0],it=Q.length===2?Q[1]:Q[0];j[0]=$,j[3]=it}function W(j,Q,$){j[$]=Math.tan(r.util.degreesToRadians(Q[0]))}function E(j,Q){j[4]=Q[0],Q.length===2&&(j[5]=Q[1])}var H=r.iMatrix,I=r.reNum,Y=r.commaWsp,G="(?:(skewX)\\s*\\(\\s*("+I+")\\s*\\))",J="(?:(skewY)\\s*\\(\\s*("+I+")\\s*\\))",S="(?:(rotate)\\s*\\(\\s*("+I+")(?:"+Y+"("+I+")"+Y+"("+I+"))?\\s*\\))",b="(?:(scale)\\s*\\(\\s*("+I+")(?:"+Y+"("+I+"))?\\s*\\))",A="(?:(translate)\\s*\\(\\s*("+I+")(?:"+Y+"("+I+"))?\\s*\\))",L="(?:(matrix)\\s*\\(\\s*("+I+")"+Y+"("+I+")"+Y+"("+I+")"+Y+"("+I+")"+Y+"("+I+")"+Y+"("+I+")\\s*\\))",M="(?:"+L+"|"+A+"|"+b+"|"+S+"|"+G+"|"+J+")",X="(?:"+M+"(?:"+Y+"*"+M+")*)",N="^\\s*(?:"+X+"?)\\s*$",K=new RegExp(N),V=new RegExp(M,"g");return function(j){var Q=H.concat(),$=[];if(!j||j&&!K.test(j))return Q;j.replace(V,function(lt){var ct=new RegExp(M).exec(lt).filter(function(St){return!!St}),ft=ct[1],ht=ct.slice(2).map(parseFloat);switch(ft){case"translate":E(Q,ht);break;case"rotate":ht[0]=r.util.degreesToRadians(ht[0]),D(Q,ht);break;case"scale":O(Q,ht);break;case"skewX":W(Q,ht,2);break;case"skewY":W(Q,ht,1);break;case"matrix":Q=ht;break}$.push(Q.concat()),Q=H.concat()});for(var it=$[0];$.length>1;)$.shift(),it=r.util.multiplyTransformMatrices(it,$[0]);return it}}();function Z(D,O){var W,E;D.replace(/;\s*$/,"").split(";").forEach(function(H){var I=H.split(":");W=I[0].trim().toLowerCase(),E=I[1].trim(),O[W]=E})}function rt(D,O){var W,E;for(var H in D)typeof D[H]>"u"||(W=H.toLowerCase(),E=D[H],O[W]=E)}function ot(D,O){var W={};for(var E in r.cssRules[O])if(et(D,E.split(" ")))for(var H in r.cssRules[O][E])W[H]=r.cssRules[O][E][H];return W}function et(D,O){var W,E=!0;return W=at(D,O.pop()),W&&O.length&&(E=nt(D,O)),W&&E&&O.length===0}function nt(D,O){for(var W,E=!0;D.parentNode&&D.parentNode.nodeType===1&&O.length;)E&&(W=O.pop()),D=D.parentNode,E=at(D,W);return O.length===0}function at(D,O){var W=D.nodeName,E=D.getAttribute("class"),H=D.getAttribute("id"),I,Y;if(I=new RegExp("^"+W,"i"),O=O.replace(I,""),H&&O.length&&(I=new RegExp("#"+H+"(?![a-zA-Z\\-]+)","i"),O=O.replace(I,"")),E&&O.length)for(E=E.split(" "),Y=E.length;Y--;)I=new RegExp("\\."+E[Y]+"(?![a-zA-Z\\-]+)","i"),O=O.replace(I,"");return O.length===0}function st(D,O){var W;if(D.getElementById&&(W=D.getElementById(O)),W)return W;var E,H,I,Y=D.getElementsByTagName("*");for(H=0,I=Y.length;H<I;H++)if(E=Y[H],O===E.getAttribute("id"))return E}function tt(D){for(var O=q(D,["use","svg:use"]),W=0;O.length&&W<O.length;){var E=O[W],H=E.getAttribute("xlink:href")||E.getAttribute("href");if(H===null)return;var I=H.slice(1),Y=E.getAttribute("x")||0,G=E.getAttribute("y")||0,J=st(D,I).cloneNode(!0),S=(J.getAttribute("transform")||"")+" translate("+Y+", "+G+")",b,A=O.length,L,M,X,N,K=r.svgNS;if(R(J),/^svg$/i.test(J.nodeName)){var V=J.ownerDocument.createElementNS(K,"g");for(M=0,X=J.attributes,N=X.length;M<N;M++)L=X.item(M),V.setAttributeNS(K,L.nodeName,L.nodeValue);for(;J.firstChild;)V.appendChild(J.firstChild);J=V}for(M=0,X=E.attributes,N=X.length;M<N;M++)L=X.item(M),!(L.nodeName==="x"||L.nodeName==="y"||L.nodeName==="xlink:href"||L.nodeName==="href")&&(L.nodeName==="transform"?S=L.nodeValue+" "+S:J.setAttribute(L.nodeName,L.nodeValue));J.setAttribute("transform",S),J.setAttribute("instantiated_by_use","1"),J.removeAttribute("id"),b=E.parentNode,b.replaceChild(J,E),O.length===A&&W++}}var T=new RegExp("^\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*$");function R(D){if(!r.svgViewBoxElementsRegEx.test(D.nodeName))return{};var O=D.getAttribute("viewBox"),W=1,E=1,H=0,I=0,Y,G,J,S,b=D.getAttribute("width"),A=D.getAttribute("height"),L=D.getAttribute("x")||0,M=D.getAttribute("y")||0,X=D.getAttribute("preserveAspectRatio")||"",N=!O||!(O=O.match(T)),K=!b||!A||b==="100%"||A==="100%",V=N&&K,j={},Q="",$=0,it=0;if(j.width=0,j.height=0,j.toBeParsed=V,N&&(L||M)&&D.parentNode&&D.parentNode.nodeName!=="#document"&&(Q=" translate("+n(L)+" "+n(M)+") ",J=(D.getAttribute("transform")||"")+Q,D.setAttribute("transform",J),D.removeAttribute("x"),D.removeAttribute("y")),V)return j;if(N)return j.width=n(b),j.height=n(A),j;if(H=-parseFloat(O[1]),I=-parseFloat(O[2]),Y=parseFloat(O[3]),G=parseFloat(O[4]),j.minX=H,j.minY=I,j.viewBoxWidth=Y,j.viewBoxHeight=G,K?(j.width=Y,j.height=G):(j.width=n(b),j.height=n(A),W=j.width/Y,E=j.height/G),X=r.util.parsePreserveAspectRatioAttribute(X),X.alignX!=="none"&&(X.meetOrSlice==="meet"&&(E=W=W>E?E:W),X.meetOrSlice==="slice"&&(E=W=W>E?W:E),$=j.width-Y*W,it=j.height-G*W,X.alignX==="Mid"&&($/=2),X.alignY==="Mid"&&(it/=2),X.alignX==="Min"&&($=0),X.alignY==="Min"&&(it=0)),W===1&&E===1&&H===0&&I===0&&L===0&&M===0)return j;if((L||M)&&D.parentNode.nodeName!=="#document"&&(Q=" translate("+n(L)+" "+n(M)+") "),J=Q+" matrix("+W+" 0 0 "+E+" "+(H*W+$)+" "+(I*E+it)+") ",D.nodeName==="svg"){for(S=D.ownerDocument.createElementNS(r.svgNS,"g");D.firstChild;)S.appendChild(D.firstChild);D.appendChild(S)}else S=D,S.removeAttribute("x"),S.removeAttribute("y"),J=S.getAttribute("transform")+J;return S.setAttribute("transform",J),j}function F(D,O){for(;D&&(D=D.parentNode);)if(D.nodeName&&O.test(D.nodeName.replace("svg:",""))&&!D.getAttribute("instantiated_by_use"))return!0;return!1}r.parseSVGDocument=function(D,O,W,E){if(D){tt(D);var H=r.Object.__uid++,I,Y,G=R(D),J=r.util.toArray(D.getElementsByTagName("*"));if(G.crossOrigin=E&&E.crossOrigin,G.svgUid=H,J.length===0&&r.isLikelyNode){J=D.selectNodes('//*[name(.)!="svg"]');var S=[];for(I=0,Y=J.length;I<Y;I++)S[I]=J[I];J=S}var b=J.filter(function(L){return R(L),r.svgValidTagNamesRegEx.test(L.nodeName.replace("svg:",""))&&!F(L,r.svgInvalidAncestorsRegEx)});if(!b||b&&!b.length){O&&O([],{});return}var A={};J.filter(function(L){return L.nodeName.replace("svg:","")==="clipPath"}).forEach(function(L){var M=L.getAttribute("id");A[M]=r.util.toArray(L.getElementsByTagName("*")).filter(function(X){return r.svgValidTagNamesRegEx.test(X.nodeName.replace("svg:",""))})}),r.gradientDefs[H]=r.getGradientDefs(D),r.cssRules[H]=r.getCSSRules(D),r.clipPaths[H]=A,r.parseElements(b,function(L,M){O&&(O(L,G,M,J),delete r.gradientDefs[H],delete r.cssRules[H],delete r.clipPaths[H])},l(G),W,E)}};function k(D,O){var W=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],E="xlink:href",H=O.getAttribute(E).slice(1),I=st(D,H);if(I&&I.getAttribute(E)&&k(D,I),W.forEach(function(G){I&&!O.hasAttribute(G)&&I.hasAttribute(G)&&O.setAttribute(G,I.getAttribute(G))}),!O.children.length)for(var Y=I.cloneNode(!0);Y.firstChild;)O.appendChild(Y.firstChild);O.removeAttribute(E)}var U=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+r.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+r.reNum+"))?\\s+(.*)");c(r,{parseFontDeclaration:function(D,O){var W=D.match(U);if(W){var E=W[1],H=W[3],I=W[4],Y=W[5],G=W[6];E&&(O.fontStyle=E),H&&(O.fontWeight=isNaN(parseFloat(H))?H:parseFloat(H)),I&&(O.fontSize=n(I)),G&&(O.fontFamily=G),Y&&(O.lineHeight=Y==="normal"?1:Y)}},getGradientDefs:function(D){var O=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],W=q(D,O),E,H=0,I={};for(H=W.length;H--;)E=W[H],E.getAttribute("xlink:href")&&k(D,E),I[E.getAttribute("id")]=E;return I},parseAttributes:function(D,O,W){if(D){var E,H={},I,Y;typeof W>"u"&&(W=D.getAttribute("svgUid")),D.parentNode&&r.svgValidParentsRegEx.test(D.parentNode.nodeName)&&(H=r.parseAttributes(D.parentNode,O,W));var G=O.reduce(function(X,N){return E=D.getAttribute(N),E&&(X[N]=E),X},{}),J=c(ot(D,W),r.parseStyleAttribute(D));G=c(G,J),J[y]&&D.setAttribute(y,J[y]),I=Y=H.fontSize||r.Text.DEFAULT_SVG_FONT_SIZE,G[m]&&(G[m]=I=n(G[m],Y));var S,b,A={};for(var L in G)S=x(L),b=P(S,G[L],H,I),A[S]=b;A&&A.font&&r.parseFontDeclaration(A.font,A);var M=c(H,A);return r.svgValidParentsRegEx.test(D.nodeName)?M:z(M)}},parseElements:function(D,O,W,E,H){new r.ElementsParser(D,O,W,E,H).parse()},parseStyleAttribute:function(D){var O={},W=D.getAttribute("style");return W&&(typeof W=="string"?Z(W,O):rt(W,O)),O},parsePointsAttribute:function(D){if(!D)return null;D=D.replace(/,/g," ").trim(),D=D.split(/\s+/);var O=[],W,E;for(W=0,E=D.length;W<E;W+=2)O.push({x:parseFloat(D[W]),y:parseFloat(D[W+1])});return O},getCSSRules:function(D){var O=D.getElementsByTagName("style"),W,E,H={},I;for(W=0,E=O.length;W<E;W++){var Y=O[W].textContent;Y=Y.replace(/\/\*[\s\S]*?\*\//g,""),Y.trim()!==""&&(I=Y.split("}"),I=I.filter(function(G){return G.trim()}),I.forEach(function(G){var J=G.split("{"),S={},b=J[1].trim(),A=b.split(";").filter(function(N){return N.trim()});for(W=0,E=A.length;W<E;W++){var L=A[W].split(":"),M=L[0].trim(),X=L[1].trim();S[M]=X}G=J[0].trim(),G.split(",").forEach(function(N){N=N.replace(/^svg/i,"").trim(),N!==""&&(H[N]?r.util.object.extend(H[N],S):H[N]=r.util.object.clone(S))})}))}return H},loadSVGFromURL:function(D,O,W,E){D=D.replace(/^\n\s*/,"").trim(),new r.util.request(D,{method:"get",onComplete:H});function H(I){var Y=I.responseXML;if(!Y||!Y.documentElement)return O&&O(null),!1;r.parseSVGDocument(Y.documentElement,function(G,J,S,b){O&&O(G,J,S,b)},W,E)}},loadSVGFromString:function(D,O,W,E){var H=new r.window.DOMParser,I=H.parseFromString(D.trim(),"text/xml");r.parseSVGDocument(I.documentElement,function(Y,G,J,S){O(Y,G,J,S)},W,E)}})}(s),t.ElementsParser=function(u,r,c,l,i,n){this.elements=u,this.callback=r,this.options=c,this.reviver=l,this.svgUid=c&&c.svgUid||0,this.parsingOptions=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=n},function(u){u.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},u.createObjects=function(){var r=this;this.elements.forEach(function(c,l){c.setAttribute("svgUid",r.svgUid),r.createObject(c,l)})},u.findTag=function(r){return t[t.util.string.capitalize(r.tagName.replace("svg:",""))]},u.createObject=function(r,c){var l=this.findTag(r);if(l&&l.fromElement)try{l.fromElement(r,this.createCallback(c,r),this.options)}catch(i){t.log(i)}else this.checkIfDone()},u.createCallback=function(r,c){var l=this;return function(i){var n;l.resolveGradient(i,c,"fill"),l.resolveGradient(i,c,"stroke"),i instanceof t.Image&&i._originalElement&&(n=i.parsePreserveAspectRatioAttribute(c)),i._removeTransformMatrix(n),l.resolveClipPath(i,c),l.reviver&&l.reviver(c,i),l.instances[r]=i,l.checkIfDone()}},u.extractPropertyDefinition=function(r,c,l){var i=r[c],n=this.regexUrl;if(n.test(i)){n.lastIndex=0;var e=n.exec(i)[1];return n.lastIndex=0,t[l][this.svgUid][e]}},u.resolveGradient=function(r,c,l){var i=this.extractPropertyDefinition(r,l,"gradientDefs");if(i){var n=c.getAttribute(l+"-opacity"),e=t.Gradient.fromElement(i,r,n,this.options);r.set(l,e)}},u.createClipPathCallback=function(r,c){return function(l){l._removeTransformMatrix(),l.fillRule=l.clipRule,c.push(l)}},u.resolveClipPath=function(r,c){var l=this.extractPropertyDefinition(r,"clipPath","clipPaths"),i,n,e,o,h,a;if(l){o=[],e=t.util.invertTransform(r.calcTransformMatrix());for(var f=l[0].parentNode,d=c;d.parentNode&&d.getAttribute("clip-path")!==r.clipPath;)d=d.parentNode;d.parentNode.appendChild(f);for(var p=0;p<l.length;p++)i=l[p],n=this.findTag(i),n.fromElement(i,this.createClipPathCallback(r,o),this.options);o.length===1?l=o[0]:l=new t.Group(o),h=t.util.multiplyTransformMatrices(e,l.calcTransformMatrix()),l.clipPath&&this.resolveClipPath(l,d);var a=t.util.qrDecompose(h);l.flipX=!1,l.flipY=!1,l.set("scaleX",a.scaleX),l.set("scaleY",a.scaleY),l.angle=a.angle,l.skewX=a.skewX,l.skewY=0,l.setPositionByOrigin({x:a.translateX,y:a.translateY},"center","center"),r.clipPath=l}else delete r.clipPath},u.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(r){return r!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(u){var r=u.fabric||(u.fabric={});if(r.Point){r.warn("fabric.Point is already defined");return}r.Point=c;function c(l,i){this.x=l,this.y=i}c.prototype={type:"point",constructor:c,add:function(l){return new c(this.x+l.x,this.y+l.y)},addEquals:function(l){return this.x+=l.x,this.y+=l.y,this},scalarAdd:function(l){return new c(this.x+l,this.y+l)},scalarAddEquals:function(l){return this.x+=l,this.y+=l,this},subtract:function(l){return new c(this.x-l.x,this.y-l.y)},subtractEquals:function(l){return this.x-=l.x,this.y-=l.y,this},scalarSubtract:function(l){return new c(this.x-l,this.y-l)},scalarSubtractEquals:function(l){return this.x-=l,this.y-=l,this},multiply:function(l){return new c(this.x*l,this.y*l)},multiplyEquals:function(l){return this.x*=l,this.y*=l,this},divide:function(l){return new c(this.x/l,this.y/l)},divideEquals:function(l){return this.x/=l,this.y/=l,this},eq:function(l){return this.x===l.x&&this.y===l.y},lt:function(l){return this.x<l.x&&this.y<l.y},lte:function(l){return this.x<=l.x&&this.y<=l.y},gt:function(l){return this.x>l.x&&this.y>l.y},gte:function(l){return this.x>=l.x&&this.y>=l.y},lerp:function(l,i){return typeof i>"u"&&(i=.5),i=Math.max(Math.min(1,i),0),new c(this.x+(l.x-this.x)*i,this.y+(l.y-this.y)*i)},distanceFrom:function(l){var i=this.x-l.x,n=this.y-l.y;return Math.sqrt(i*i+n*n)},midPointFrom:function(l){return this.lerp(l)},min:function(l){return new c(Math.min(this.x,l.x),Math.min(this.y,l.y))},max:function(l){return new c(Math.max(this.x,l.x),Math.max(this.y,l.y))},toString:function(){return this.x+","+this.y},setXY:function(l,i){return this.x=l,this.y=i,this},setX:function(l){return this.x=l,this},setY:function(l){return this.y=l,this},setFromPoint:function(l){return this.x=l.x,this.y=l.y,this},swap:function(l){var i=this.x,n=this.y;this.x=l.x,this.y=l.y,l.x=i,l.y=n},clone:function(){return new c(this.x,this.y)}}}(s),function(u){var r=u.fabric||(u.fabric={});if(r.Intersection){r.warn("fabric.Intersection is already defined");return}function c(l){this.status=l,this.points=[]}r.Intersection=c,r.Intersection.prototype={constructor:c,appendPoint:function(l){return this.points.push(l),this},appendPoints:function(l){return this.points=this.points.concat(l),this}},r.Intersection.intersectLineLine=function(l,i,n,e){var o,h=(e.x-n.x)*(l.y-n.y)-(e.y-n.y)*(l.x-n.x),a=(i.x-l.x)*(l.y-n.y)-(i.y-l.y)*(l.x-n.x),f=(e.y-n.y)*(i.x-l.x)-(e.x-n.x)*(i.y-l.y);if(f!==0){var d=h/f,p=a/f;0<=d&&d<=1&&0<=p&&p<=1?(o=new c("Intersection"),o.appendPoint(new r.Point(l.x+d*(i.x-l.x),l.y+d*(i.y-l.y)))):o=new c}else h===0||a===0?o=new c("Coincident"):o=new c("Parallel");return o},r.Intersection.intersectLinePolygon=function(l,i,n){var e=new c,o=n.length,h,a,f,d;for(d=0;d<o;d++)h=n[d],a=n[(d+1)%o],f=c.intersectLineLine(l,i,h,a),e.appendPoints(f.points);return e.points.length>0&&(e.status="Intersection"),e},r.Intersection.intersectPolygonPolygon=function(l,i){var n=new c,e=l.length,o;for(o=0;o<e;o++){var h=l[o],a=l[(o+1)%e],f=c.intersectLinePolygon(h,a,i);n.appendPoints(f.points)}return n.points.length>0&&(n.status="Intersection"),n},r.Intersection.intersectPolygonRectangle=function(l,i,n){var e=i.min(n),o=i.max(n),h=new r.Point(o.x,e.y),a=new r.Point(e.x,o.y),f=c.intersectLinePolygon(e,h,l),d=c.intersectLinePolygon(h,o,l),p=c.intersectLinePolygon(o,a,l),m=c.intersectLinePolygon(a,e,l),y=new c;return y.appendPoints(f.points),y.appendPoints(d.points),y.appendPoints(p.points),y.appendPoints(m.points),y.points.length>0&&(y.status="Intersection"),y}}(s),function(u){var r=u.fabric||(u.fabric={});if(r.Color){r.warn("fabric.Color is already defined.");return}function c(i){i?this._tryParsingColor(i):this.setSource([0,0,0,1])}r.Color=c,r.Color.prototype={_tryParsingColor:function(i){var n;i in c.colorNameMap&&(i=c.colorNameMap[i]),i==="transparent"&&(n=[255,255,255,0]),n||(n=c.sourceFromHex(i)),n||(n=c.sourceFromRgb(i)),n||(n=c.sourceFromHsl(i)),n||(n=[0,0,0,1]),n&&this.setSource(n)},_rgbToHsl:function(i,n,e){i/=255,n/=255,e/=255;var o,h,a,f=r.util.array.max([i,n,e]),d=r.util.array.min([i,n,e]);if(a=(f+d)/2,f===d)o=h=0;else{var p=f-d;switch(h=a>.5?p/(2-f-d):p/(f+d),f){case i:o=(n-e)/p+(n<e?6:0);break;case n:o=(e-i)/p+2;break;case e:o=(i-n)/p+4;break}o/=6}return[Math.round(o*360),Math.round(h*100),Math.round(a*100)]},getSource:function(){return this._source},setSource:function(i){this._source=i},toRgb:function(){var i=this.getSource();return"rgb("+i[0]+","+i[1]+","+i[2]+")"},toRgba:function(){var i=this.getSource();return"rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")"},toHsl:function(){var i=this.getSource(),n=this._rgbToHsl(i[0],i[1],i[2]);return"hsl("+n[0]+","+n[1]+"%,"+n[2]+"%)"},toHsla:function(){var i=this.getSource(),n=this._rgbToHsl(i[0],i[1],i[2]);return"hsla("+n[0]+","+n[1]+"%,"+n[2]+"%,"+i[3]+")"},toHex:function(){var i=this.getSource(),n,e,o;return n=i[0].toString(16),n=n.length===1?"0"+n:n,e=i[1].toString(16),e=e.length===1?"0"+e:e,o=i[2].toString(16),o=o.length===1?"0"+o:o,n.toUpperCase()+e.toUpperCase()+o.toUpperCase()},toHexa:function(){var i=this.getSource(),n;return n=Math.round(i[3]*255),n=n.toString(16),n=n.length===1?"0"+n:n,this.toHex()+n.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(i){var n=this.getSource();return n[3]=i,this.setSource(n),this},toGrayscale:function(){var i=this.getSource(),n=parseInt((i[0]*.3+i[1]*.59+i[2]*.11).toFixed(0),10),e=i[3];return this.setSource([n,n,n,e]),this},toBlackWhite:function(i){var n=this.getSource(),e=(n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),o=n[3];return i=i||127,e=Number(e)<Number(i)?0:255,this.setSource([e,e,e,o]),this},overlayWith:function(i){i instanceof c||(i=new c(i));var n=[],e=this.getAlpha(),o=.5,h=this.getSource(),a=i.getSource(),f;for(f=0;f<3;f++)n.push(Math.round(h[f]*(1-o)+a[f]*o));return n[3]=e,this.setSource(n),this}},r.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,r.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,r.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,r.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function l(i,n,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(n-i)*6*e:e<1/2?n:e<2/3?i+(n-i)*(2/3-e)*6:i}r.Color.fromRgb=function(i){return c.fromSource(c.sourceFromRgb(i))},r.Color.sourceFromRgb=function(i){var n=i.match(c.reRGBa);if(n){var e=parseInt(n[1],10)/(/%$/.test(n[1])?100:1)*(/%$/.test(n[1])?255:1),o=parseInt(n[2],10)/(/%$/.test(n[2])?100:1)*(/%$/.test(n[2])?255:1),h=parseInt(n[3],10)/(/%$/.test(n[3])?100:1)*(/%$/.test(n[3])?255:1);return[parseInt(e,10),parseInt(o,10),parseInt(h,10),n[4]?parseFloat(n[4]):1]}},r.Color.fromRgba=c.fromRgb,r.Color.fromHsl=function(i){return c.fromSource(c.sourceFromHsl(i))},r.Color.sourceFromHsl=function(i){var n=i.match(c.reHSLa);if(n){var e=(parseFloat(n[1])%360+360)%360/360,o=parseFloat(n[2])/(/%$/.test(n[2])?100:1),h=parseFloat(n[3])/(/%$/.test(n[3])?100:1),a,f,d;if(o===0)a=f=d=h;else{var p=h<=.5?h*(o+1):h+o-h*o,m=h*2-p;a=l(m,p,e+1/3),f=l(m,p,e),d=l(m,p,e-1/3)}return[Math.round(a*255),Math.round(f*255),Math.round(d*255),n[4]?parseFloat(n[4]):1]}},r.Color.fromHsla=c.fromHsl,r.Color.fromHex=function(i){return c.fromSource(c.sourceFromHex(i))},r.Color.sourceFromHex=function(i){if(i.match(c.reHex)){var n=i.slice(i.indexOf("#")+1),e=n.length===3||n.length===4,o=n.length===8||n.length===4,h=e?n.charAt(0)+n.charAt(0):n.substring(0,2),a=e?n.charAt(1)+n.charAt(1):n.substring(2,4),f=e?n.charAt(2)+n.charAt(2):n.substring(4,6),d=o?e?n.charAt(3)+n.charAt(3):n.substring(6,8):"FF";return[parseInt(h,16),parseInt(a,16),parseInt(f,16),parseFloat((parseInt(d,16)/255).toFixed(2))]}},r.Color.fromSource=function(i){var n=new c;return n.setSource(i),n}}(s),function(u){var r=u.fabric||(u.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],l=["ns","nesw","ew","nwse"],i={},n="left",e="top",o="right",h="bottom",a="center",f={top:h,bottom:e,left:o,right:n,center:a},d=r.util.radiansToDegrees,p=Math.sign||function(S){return(S>0)-(S<0)||+S};function m(S,b){var A=S.angle+d(Math.atan2(b.y,b.x))+360;return Math.round(A%360/45)}function y(S,b){var A=b.transform.target,L=A.canvas,M=r.util.object.clone(b);M.target=A,L&&L.fire("object:"+S,M),A.fire(S,b)}function x(S,b){var A=b.canvas,L=A.uniScaleKey,M=S[L];return A.uniformScaling&&!M||!A.uniformScaling&&M}function P(S){return S.originX===a&&S.originY===a}function B(S,b,A){var L=S.lockScalingX,M=S.lockScalingY;return!!(L&&M||!b&&(L||M)&&A||L&&b==="x"||M&&b==="y")}function z(S,b,A){var L="not-allowed",M=x(S,A),X="";if(b.x!==0&&b.y===0?X="x":b.x===0&&b.y!==0&&(X="y"),B(A,X,M))return L;var N=m(A,b);return c[N]+"-resize"}function q(S,b,A){var L="not-allowed";if(b.x!==0&&A.lockSkewingY||b.y!==0&&A.lockSkewingX)return L;var M=m(A,b)%4;return l[M]+"-resize"}function Z(S,b,A){return S[A.canvas.altActionKey]?i.skewCursorStyleHandler(S,b,A):i.scaleCursorStyleHandler(S,b,A)}function rt(S,b,A){var L=S[A.canvas.altActionKey];if(b.x===0)return L?"skewX":"scaleY";if(b.y===0)return L?"skewY":"scaleX"}function ot(S,b,A){return A.lockRotation?"not-allowed":b.cursorStyle}function et(S,b,A,L){return{e:S,transform:b,pointer:{x:A,y:L}}}function nt(S){return function(b,A,L,M){var X=A.target,N=X.getCenterPoint(),K=X.translateToOriginPoint(N,A.originX,A.originY),V=S(b,A,L,M);return X.setPositionByOrigin(K,A.originX,A.originY),V}}function at(S,b){return function(A,L,M,X){var N=b(A,L,M,X);return N&&y(S,et(A,L,M,X)),N}}function st(S,b,A,L,M){var X=S.target,N=X.controls[S.corner],K=X.canvas.getZoom(),V=X.padding/K,j=X.toLocalPoint(new r.Point(L,M),b,A);return j.x>=V&&(j.x-=V),j.x<=-V&&(j.x+=V),j.y>=V&&(j.y-=V),j.y<=V&&(j.y+=V),j.x-=N.offsetX,j.y-=N.offsetY,j}function tt(S){return S.flipX!==S.flipY}function T(S,b,A,L,M){if(S[b]!==0){var X=S._getTransformedDimensions()[L],N=M/X*S[A];S.set(A,N)}}function R(S,b,A,L){var M=b.target,X=M._getTransformedDimensions(0,M.skewY),N=st(b,b.originX,b.originY,A,L),K=Math.abs(N.x*2)-X.x,V=M.skewX,j;K<2?j=0:(j=d(Math.atan2(K/M.scaleX,X.y/M.scaleY)),b.originX===n&&b.originY===h&&(j=-j),b.originX===o&&b.originY===e&&(j=-j),tt(M)&&(j=-j));var Q=V!==j;if(Q){var $=M._getTransformedDimensions().y;M.set("skewX",j),T(M,"skewY","scaleY","y",$)}return Q}function F(S,b,A,L){var M=b.target,X=M._getTransformedDimensions(M.skewX,0),N=st(b,b.originX,b.originY,A,L),K=Math.abs(N.y*2)-X.y,V=M.skewY,j;K<2?j=0:(j=d(Math.atan2(K/M.scaleY,X.x/M.scaleX)),b.originX===n&&b.originY===h&&(j=-j),b.originX===o&&b.originY===e&&(j=-j),tt(M)&&(j=-j));var Q=V!==j;if(Q){var $=M._getTransformedDimensions().x;M.set("skewY",j),T(M,"skewX","scaleX","x",$)}return Q}function k(S,b,A,L){var M=b.target,X=M.skewX,N,K=b.originY;if(M.lockSkewingX)return!1;if(X===0){var V=st(b,a,a,A,L);V.x>0?N=n:N=o}else X>0&&(N=K===e?n:o),X<0&&(N=K===e?o:n),tt(M)&&(N=N===n?o:n);b.originX=N;var j=at("skewing",nt(R));return j(S,b,A,L)}function U(S,b,A,L){var M=b.target,X=M.skewY,N,K=b.originX;if(M.lockSkewingY)return!1;if(X===0){var V=st(b,a,a,A,L);V.y>0?N=e:N=h}else X>0&&(N=K===n?e:h),X<0&&(N=K===n?h:e),tt(M)&&(N=N===e?h:e);b.originY=N;var j=at("skewing",nt(F));return j(S,b,A,L)}function D(S,b,A,L){var M=b,X=M.target,N=X.translateToOriginPoint(X.getCenterPoint(),M.originX,M.originY);if(X.lockRotation)return!1;var K=Math.atan2(M.ey-N.y,M.ex-N.x),V=Math.atan2(L-N.y,A-N.x),j=d(V-K+M.theta),Q=!0;if(X.snapAngle>0){var $=X.snapAngle,it=X.snapThreshold||$,lt=Math.ceil(j/$)*$,ct=Math.floor(j/$)*$;Math.abs(j-ct)<it?j=ct:Math.abs(j-lt)<it&&(j=lt)}return j<0&&(j=360+j),j%=360,Q=X.angle!==j,X.angle=j,Q}function O(S,b,A,L,M){M=M||{};var X=b.target,N=X.lockScalingX,K=X.lockScalingY,V=M.by,j,Q,$,it,lt=x(S,X),ct=B(X,V,lt),ft,ht,St=b.gestureScale;if(ct)return!1;if(St)Q=b.scaleX*St,$=b.scaleY*St;else{if(j=st(b,b.originX,b.originY,A,L),ft=V!=="y"?p(j.x):1,ht=V!=="x"?p(j.y):1,b.signX||(b.signX=ft),b.signY||(b.signY=ht),X.lockScalingFlip&&(b.signX!==ft||b.signY!==ht))return!1;if(it=X._getTransformedDimensions(),lt&&!V){var Ct=Math.abs(j.x)+Math.abs(j.y),bt=b.original,At=Math.abs(it.x*bt.scaleX/X.scaleX)+Math.abs(it.y*bt.scaleY/X.scaleY),ne=Ct/At;Q=bt.scaleX*ne,$=bt.scaleY*ne}else Q=Math.abs(j.x*X.scaleX/it.x),$=Math.abs(j.y*X.scaleY/it.y);P(b)&&(Q*=2,$*=2),b.signX!==ft&&V!=="y"&&(b.originX=f[b.originX],Q*=-1,b.signX=ft),b.signY!==ht&&V!=="x"&&(b.originY=f[b.originY],$*=-1,b.signY=ht)}var ti=X.scaleX,Dt=X.scaleY;return V?(V==="x"&&X.set("scaleX",Q),V==="y"&&X.set("scaleY",$)):(!N&&X.set("scaleX",Q),!K&&X.set("scaleY",$)),ti!==X.scaleX||Dt!==X.scaleY}function W(S,b,A,L){return O(S,b,A,L)}function E(S,b,A,L){return O(S,b,A,L,{by:"x"})}function H(S,b,A,L){return O(S,b,A,L,{by:"y"})}function I(S,b,A,L){return S[b.target.canvas.altActionKey]?i.skewHandlerX(S,b,A,L):i.scalingY(S,b,A,L)}function Y(S,b,A,L){return S[b.target.canvas.altActionKey]?i.skewHandlerY(S,b,A,L):i.scalingX(S,b,A,L)}function G(S,b,A,L){var M=b.target,X=st(b,b.originX,b.originY,A,L),N=M.strokeWidth/(M.strokeUniform?M.scaleX:1),K=P(b)?2:1,V=M.width,j=Math.abs(X.x*K/M.scaleX)-N;return M.set("width",Math.max(j,0)),V!==j}function J(S,b,A,L){var M=b.target,X=A-b.offsetX,N=L-b.offsetY,K=!M.get("lockMovementX")&&M.left!==X,V=!M.get("lockMovementY")&&M.top!==N;return K&&M.set("left",X),V&&M.set("top",N),(K||V)&&y("moving",et(S,b,A,L)),K||V}i.scaleCursorStyleHandler=z,i.skewCursorStyleHandler=q,i.scaleSkewCursorStyleHandler=Z,i.rotationWithSnapping=at("rotating",nt(D)),i.scalingEqually=at("scaling",nt(W)),i.scalingX=at("scaling",nt(E)),i.scalingY=at("scaling",nt(H)),i.scalingYOrSkewingX=I,i.scalingXOrSkewingY=Y,i.changeWidth=at("resizing",nt(G)),i.skewHandlerX=k,i.skewHandlerY=U,i.dragHandler=J,i.scaleOrSkewActionName=rt,i.rotationStyleHandler=ot,i.fireEvent=y,i.wrapWithFixedAnchor=nt,i.wrapWithFireEvent=at,i.getLocalPoint=st,r.controlsUtils=i}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.degreesToRadians,l=r.controlsUtils;function i(e,o,h,a,f){a=a||{};var d=this.sizeX||a.cornerSize||f.cornerSize,p=this.sizeY||a.cornerSize||f.cornerSize,m=typeof a.transparentCorners<"u"?a.transparentCorners:f.transparentCorners,y=m?"stroke":"fill",x=!m&&(a.cornerStrokeColor||f.cornerStrokeColor),P=o,B=h,z;e.save(),e.fillStyle=a.cornerColor||f.cornerColor,e.strokeStyle=a.cornerStrokeColor||f.cornerStrokeColor,d>p?(z=d,e.scale(1,p/d),B=h*d/p):p>d?(z=p,e.scale(d/p,1),P=o*p/d):z=d,e.lineWidth=1,e.beginPath(),e.arc(P,B,z/2,0,2*Math.PI,!1),e[y](),x&&e.stroke(),e.restore()}function n(e,o,h,a,f){a=a||{};var d=this.sizeX||a.cornerSize||f.cornerSize,p=this.sizeY||a.cornerSize||f.cornerSize,m=typeof a.transparentCorners<"u"?a.transparentCorners:f.transparentCorners,y=m?"stroke":"fill",x=!m&&(a.cornerStrokeColor||f.cornerStrokeColor),P=d/2,B=p/2;e.save(),e.fillStyle=a.cornerColor||f.cornerColor,e.strokeStyle=a.cornerStrokeColor||f.cornerStrokeColor,e.lineWidth=1,e.translate(o,h),e.rotate(c(f.angle)),e[y+"Rect"](-P,-B,d,p),x&&e.strokeRect(-P,-B,d,p),e.restore()}l.renderCircleControl=i,l.renderSquareControl=n}(s),function(u){var r=u.fabric||(u.fabric={});function c(l){for(var i in l)this[i]=l[i]}r.Control=c,r.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(l,i){return i.cursorStyle},getActionName:function(l,i){return i.actionName},getVisibility:function(l,i){var n=l._controlsVisibility;return n&&typeof n[i]<"u"?n[i]:this.visible},setVisibility:function(l){this.visible=l},positionHandler:function(l,i){var n=r.util.transformPoint({x:this.x*l.x+this.offsetX,y:this.y*l.y+this.offsetY},i);return n},calcCornerCoords:function(l,i,n,e,o){var h,a,f,d,p=o?this.touchSizeX:this.sizeX,m=o?this.touchSizeY:this.sizeY;if(p&&m&&p!==m){var y=Math.atan2(m,p),x=Math.sqrt(p*p+m*m)/2,P=y-r.util.degreesToRadians(l),B=Math.PI/2-y-r.util.degreesToRadians(l);h=x*r.util.cos(P),a=x*r.util.sin(P),f=x*r.util.cos(B),d=x*r.util.sin(B)}else{var z=p&&m?p:i;x=z*.7071067812;var P=r.util.degreesToRadians(45-l);h=f=x*r.util.cos(P),a=d=x*r.util.sin(P)}return{tl:{x:n-d,y:e-f},tr:{x:n+h,y:e-a},bl:{x:n-h,y:e+a},br:{x:n+d,y:e+f}}},render:function(l,i,n,e,o){switch(e=e||{},e.cornerStyle||o.cornerStyle){case"circle":r.controlsUtils.renderCircleControl.call(this,l,i,n,e,o);break;default:r.controlsUtils.renderSquareControl.call(this,l,i,n,e,o)}}}}(s),function(){function u(n,e){var o=n.getAttribute("style"),h=n.getAttribute("offset")||0,a,f,d,p;if(h=parseFloat(h)/(/%$/.test(h)?100:1),h=h<0?0:h>1?1:h,o){var m=o.split(/\s*;\s*/);for(m[m.length-1]===""&&m.pop(),p=m.length;p--;){var y=m[p].split(/\s*:\s*/),x=y[0].trim(),P=y[1].trim();x==="stop-color"?a=P:x==="stop-opacity"&&(d=P)}}return a||(a=n.getAttribute("stop-color")||"rgb(0,0,0)"),d||(d=n.getAttribute("stop-opacity")),a=new t.Color(a),f=a.getAlpha(),d=isNaN(parseFloat(d))?1:parseFloat(d),d*=f*e,{offset:h,color:a.toRgb(),opacity:d}}function r(n){return{x1:n.getAttribute("x1")||0,y1:n.getAttribute("y1")||0,x2:n.getAttribute("x2")||"100%",y2:n.getAttribute("y2")||0}}function c(n){return{x1:n.getAttribute("fx")||n.getAttribute("cx")||"50%",y1:n.getAttribute("fy")||n.getAttribute("cy")||"50%",r1:0,x2:n.getAttribute("cx")||"50%",y2:n.getAttribute("cy")||"50%",r2:n.getAttribute("r")||"50%"}}var l=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(n){n||(n={}),n.coords||(n.coords={});var e,o=this;Object.keys(n).forEach(function(h){o[h]=n[h]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,e={x1:n.coords.x1||0,y1:n.coords.y1||0,x2:n.coords.x2||0,y2:n.coords.y2||0},this.type==="radial"&&(e.r1=n.coords.r1||0,e.r2=n.coords.r2||0),this.coords=e,this.colorStops=n.colorStops.slice()},addColorStop:function(n){for(var e in n){var o=new t.Color(n[e]);this.colorStops.push({offset:parseFloat(e),color:o.toRgb(),opacity:o.getAlpha()})}return this},toObject:function(n){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,e,n),e},toSVG:function(n,f){var o=l(this.coords,!0),h,a,f=f||{},d,p,m=l(this.colorStops,!0),y=o.r1>o.r2,x=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),P=-this.offsetX,B=-this.offsetY,z=!!f.additionalTransform,q=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(m.sort(function(nt,at){return nt.offset-at.offset}),q==="objectBoundingBox"?(P/=n.width,B/=n.height):(P+=n.width/2,B+=n.height/2),n.type==="path"&&this.gradientUnits!=="percentage"&&(P-=n.pathOffset.x,B-=n.pathOffset.y),x[4]-=P,x[5]-=B,p='id="SVGID_'+this.id+'" gradientUnits="'+q+'"',p+=' gradientTransform="'+(z?f.additionalTransform+" ":"")+t.util.matrixToSVG(x)+'" ',this.type==="linear"?d=["<linearGradient ",p,' x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,`">
`]:this.type==="radial"&&(d=["<radialGradient ",p,' cx="',y?o.x1:o.x2,'" cy="',y?o.y1:o.y2,'" r="',y?o.r1:o.r2,'" fx="',y?o.x2:o.x1,'" fy="',y?o.y2:o.y1,`">
`]),this.type==="radial"){if(y)for(m=m.concat(),m.reverse(),h=0,a=m.length;h<a;h++)m[h].offset=1-m[h].offset;var Z=Math.min(o.r1,o.r2);if(Z>0){var rt=Math.max(o.r1,o.r2),ot=Z/rt;for(h=0,a=m.length;h<a;h++)m[h].offset+=ot*(1-m[h].offset)}}for(h=0,a=m.length;h<a;h++){var et=m[h];d.push("<stop ",'offset="',et.offset*100+"%",'" style="stop-color:',et.color,typeof et.opacity<"u"?";stop-opacity: "+et.opacity:";",`"/>
`)}return d.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),d.join("")},toLive:function(n){var e,o=t.util.object.clone(this.coords),h,a;if(this.type){for(this.type==="linear"?e=n.createLinearGradient(o.x1,o.y1,o.x2,o.y2):this.type==="radial"&&(e=n.createRadialGradient(o.x1,o.y1,o.r1,o.x2,o.y2,o.r2)),h=0,a=this.colorStops.length;h<a;h++){var f=this.colorStops[h].color,d=this.colorStops[h].opacity,p=this.colorStops[h].offset;typeof d<"u"&&(f=new t.Color(f).setAlpha(d).toRgba()),e.addColorStop(p,f)}return e}}}),t.util.object.extend(t.Gradient,{fromElement:function(n,e,o,h){var a=parseFloat(o)/(/%$/.test(o)?100:1);a=a<0?0:a>1?1:a,isNaN(a)&&(a=1);var f=n.getElementsByTagName("stop"),d,p=n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",m=n.getAttribute("gradientTransform")||"",y=[],x,P,B=0,z=0,q;for(n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?(d="linear",x=r(n)):(d="radial",x=c(n)),P=f.length;P--;)y.push(u(f[P],a));q=t.parseTransformAttribute(m),i(e,x,h,p),p==="pixels"&&(B=-e.left,z=-e.top);var Z=new t.Gradient({id:n.getAttribute("id"),type:d,coords:x,colorStops:y,gradientUnits:p,gradientTransform:q,offsetX:B,offsetY:z});return Z}});function i(n,e,o,h){var a,f;Object.keys(e).forEach(function(d){a=e[d],a==="Infinity"?f=1:a==="-Infinity"?f=0:(f=parseFloat(e[d],10),typeof a=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(a)&&(f*=.01,h==="pixels"&&((d==="x1"||d==="x2"||d==="r2")&&(f*=o.viewBoxWidth||o.width),(d==="y1"||d==="y2")&&(f*=o.viewBoxHeight||o.height)))),e[d]=f})}}(),function(){var u=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(r,c){if(r||(r={}),this.id=t.Object.__uid++,this.setOptions(r),!r.source||r.source&&typeof r.source!="string"){c&&c(this);return}else{var l=this;this.source=t.util.createImage(),t.util.loadImage(r.source,function(i,n){l.source=i,c&&c(l,n)},null,this.crossOrigin)}},toObject:function(r){var c=t.Object.NUM_FRACTION_DIGITS,l,i;return typeof this.source.src=="string"?l=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(l=this.source.toDataURL()),i={type:"pattern",source:l,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:u(this.offsetX,c),offsetY:u(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,i,r),i},toSVG:function(r){var c=typeof this.source=="function"?this.source():this.source,l=c.width/r.width,i=c.height/r.height,n=this.offsetX/r.width,e=this.offsetY/r.height,o="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(i=1,e&&(i+=Math.abs(e))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(l=1,n&&(l+=Math.abs(n))),c.src?o=c.src:c.toDataURL&&(o=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+e+'" width="'+l+'" height="'+i+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+o+`"></image>
</pattern>
`},setOptions:function(r){for(var c in r)this[c]=r[c]},toLive:function(r){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":r.createPattern(c,this.repeat)}})}(),function(u){var r=u.fabric||(u.fabric={}),c=r.util.toFixed;if(r.Shadow){r.warn("fabric.Shadow is already defined.");return}r.Shadow=r.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(l){typeof l=="string"&&(l=this._parseShadow(l));for(var i in l)this[i]=l[i];this.id=r.Object.__uid++},_parseShadow:function(l){var i=l.trim(),n=r.Shadow.reOffsetsAndBlur.exec(i)||[],e=i.replace(r.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:e.trim(),offsetX:parseFloat(n[1],10)||0,offsetY:parseFloat(n[2],10)||0,blur:parseFloat(n[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(l){var i=40,n=40,e=r.Object.NUM_FRACTION_DIGITS,o=r.util.rotateVector({x:this.offsetX,y:this.offsetY},r.util.degreesToRadians(-l.angle)),h=20,a=new r.Color(this.color);return l.width&&l.height&&(i=c((Math.abs(o.x)+this.blur)/l.width,e)*100+h,n=c((Math.abs(o.y)+this.blur)/l.height,e)*100+h),l.flipX&&(o.x*=-1),l.flipY&&(o.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+n+'%" height="'+(100+2*n)+'%" x="-'+i+'%" width="'+(100+2*i)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,e)+`"></feGaussianBlur>
	<feOffset dx="`+c(o.x,e)+'" dy="'+c(o.y,e)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+a.toRgb()+'" flood-opacity="'+a.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var l={},i=r.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(n){this[n]!==i[n]&&(l[n]=this[n])},this),l}}),r.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(s),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var u=t.util.object.extend,r=t.util.getElementOffset,c=t.util.removeFromArray,l=t.util.toFixed,i=t.util.transformPoint,n=t.util.invertTransform,e=t.util.getNodeCanvas,o=t.util.createCanvasElement,h=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(a,f){f||(f={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(a,f)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(a,f){var d=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(a),this._initOptions(f),this.interactive||this._initRetinaScaling(),f.overlayImage&&this.setOverlayImage(f.overlayImage,d),f.backgroundImage&&this.setBackgroundImage(f.backgroundImage,d),f.backgroundColor&&this.setBackgroundColor(f.backgroundColor,d),f.overlayColor&&this.setOverlayColor(f.overlayColor,d),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var a=t.devicePixelRatio;this.__initRetinaScaling(a,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(a,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(a,f,d){f.setAttribute("width",this.width*a),f.setAttribute("height",this.height*a),d.scale(a,a)},calcOffset:function(){return this._offset=r(this.lowerCanvasEl),this},setOverlayImage:function(a,f,d){return this.__setBgOverlayImage("overlayImage",a,f,d)},setBackgroundImage:function(a,f,d){return this.__setBgOverlayImage("backgroundImage",a,f,d)},setOverlayColor:function(a,f){return this.__setBgOverlayColor("overlayColor",a,f)},setBackgroundColor:function(a,f){return this.__setBgOverlayColor("backgroundColor",a,f)},__setBgOverlayImage:function(a,f,d,p){return typeof f=="string"?t.util.loadImage(f,function(m,y){if(m){var x=new t.Image(m,p);this[a]=x,x.canvas=this}d&&d(m,y)},this,p&&p.crossOrigin):(p&&f.setOptions(p),this[a]=f,f&&(f.canvas=this),d&&d(f,!1)),this},__setBgOverlayColor:function(a,f,d){return this[a]=f,this._initGradient(f,a),this._initPattern(f,a,d),this},_createCanvasElement:function(){var a=o();if(!a||(a.style||(a.style={}),typeof a.getContext>"u"))throw h;return a},_initOptions:function(a){var f=this.lowerCanvasEl;this._setOptions(a),this.width=this.width||parseInt(f.width,10)||0,this.height=this.height||parseInt(f.height,10)||0,this.lowerCanvasEl.style&&(f.width=this.width,f.height=this.height,f.style.width=this.width+"px",f.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(a){a&&a.getContext?this.lowerCanvasEl=a:this.lowerCanvasEl=t.util.getById(a)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(a,f){return this.setDimensions({width:a},f)},setHeight:function(a,f){return this.setDimensions({height:a},f)},setDimensions:function(a,f){var d;f=f||{};for(var p in a)d=a[p],f.cssOnly||(this._setBackstoreDimension(p,a[p]),d+="px",this.hasLostContext=!0),f.backstoreOnly||this._setCssDimension(p,d);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),f.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(a,f){return this.lowerCanvasEl[a]=f,this.upperCanvasEl&&(this.upperCanvasEl[a]=f),this.cacheCanvasEl&&(this.cacheCanvasEl[a]=f),this[a]=f,this},_setCssDimension:function(a,f){return this.lowerCanvasEl.style[a]=f,this.upperCanvasEl&&(this.upperCanvasEl.style[a]=f),this.wrapperEl&&(this.wrapperEl.style[a]=f),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(a){var f=this._activeObject,d=this.backgroundImage,p=this.overlayImage,m,y,x;for(this.viewportTransform=a,y=0,x=this._objects.length;y<x;y++)m=this._objects[y],m.group||m.setCoords(!0);return f&&f.setCoords(),d&&d.setCoords(!0),p&&p.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(a,f){var d=a,p=this.viewportTransform.slice(0);a=i(a,n(this.viewportTransform)),p[0]=f,p[3]=f;var m=i(a,p);return p[4]+=d.x-m.x,p[5]+=d.y-m.y,this.setViewportTransform(p)},setZoom:function(a){return this.zoomToPoint(new t.Point(0,0),a),this},absolutePan:function(a){var f=this.viewportTransform.slice(0);return f[4]=-a.x,f[5]=-a.y,this.setViewportTransform(f)},relativePan:function(a){return this.absolutePan(new t.Point(-a.x-this.viewportTransform[4],-a.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(a){this.stateful&&a.setupState(),a._set("canvas",this),a.setCoords(),this.fire("object:added",{target:a}),a.fire("added")},_onObjectRemoved:function(a){this.fire("object:removed",{target:a}),a.fire("removed"),delete a.canvas},clearContext:function(a){return a.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var a=this.contextContainer;return this.renderCanvas(a,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var a={},f=this.width,d=this.height,p=n(this.viewportTransform);return a.tl=i({x:0,y:0},p),a.br=i({x:f,y:d},p),a.tr=new t.Point(a.br.x,a.tl.y),a.bl=new t.Point(a.tl.x,a.br.y),this.vptCoords=a,a},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(a,f){var d=this.viewportTransform,p=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(a),t.util.setImageSmoothing(a,this.imageSmoothingEnabled),this.fire("before:render",{ctx:a}),this._renderBackground(a),a.save(),a.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._renderObjects(a,f),a.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(a),p&&(p.canvas=this,p.shouldCache(),p._transformDone=!0,p.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(a)),this._renderOverlay(a),this.controlsAboveOverlay&&this.interactive&&this.drawControls(a),this.fire("after:render",{ctx:a})},drawClipPathOnCanvas:function(a){var f=this.viewportTransform,d=this.clipPath;a.save(),a.transform(f[0],f[1],f[2],f[3],f[4],f[5]),a.globalCompositeOperation="destination-in",d.transform(a),a.scale(1/d.zoomX,1/d.zoomY),a.drawImage(d._cacheCanvas,-d.cacheTranslationX,-d.cacheTranslationY),a.restore()},_renderObjects:function(a,f){var d,p;for(d=0,p=f.length;d<p;++d)f[d]&&f[d].render(a)},_renderBackgroundOrOverlay:function(a,f){var d=this[f+"Color"],p=this[f+"Image"],m=this.viewportTransform,y=this[f+"Vpt"];if(!(!d&&!p)){if(d){a.save(),a.beginPath(),a.moveTo(0,0),a.lineTo(this.width,0),a.lineTo(this.width,this.height),a.lineTo(0,this.height),a.closePath(),a.fillStyle=d.toLive?d.toLive(a,this):d,y&&a.transform(m[0],m[1],m[2],m[3],m[4],m[5]),a.transform(1,0,0,1,d.offsetX||0,d.offsetY||0);var x=d.gradientTransform||d.patternTransform;x&&a.transform(x[0],x[1],x[2],x[3],x[4],x[5]),a.fill(),a.restore()}if(p){a.save();var P=this.skipOffscreen;this.skipOffscreen=y,y&&a.transform(m[0],m[1],m[2],m[3],m[4],m[5]),p.render(a),this.skipOffscreen=P,a.restore()}}},_renderBackground:function(a){this._renderBackgroundOrOverlay(a,"background")},_renderOverlay:function(a){this._renderBackgroundOrOverlay(a,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(a){return this._centerObject(a,new t.Point(this.getCenterPoint().x,a.getCenterPoint().y))},centerObjectV:function(a){return this._centerObject(a,new t.Point(a.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(a){var f=this.getCenterPoint();return this._centerObject(a,f)},viewportCenterObject:function(a){var f=this.getVpCenter();return this._centerObject(a,f)},viewportCenterObjectH:function(a){var f=this.getVpCenter();return this._centerObject(a,new t.Point(f.x,a.getCenterPoint().y)),this},viewportCenterObjectV:function(a){var f=this.getVpCenter();return this._centerObject(a,new t.Point(a.getCenterPoint().x,f.y))},getVpCenter:function(){var a=this.getCenterPoint(),f=n(this.viewportTransform);return i(a,f)},_centerObject:function(a,f){return a.setPositionByOrigin(f,"center","center"),a.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(a){return this.toDatalessObject(a)},toObject:function(a){return this._toObjectMethod("toObject",a)},toDatalessObject:function(a){return this._toObjectMethod("toDatalessObject",a)},_toObjectMethod:function(a,f){var d=this.clipPath,p={version:t.version,objects:this._toObjects(a,f)};return d&&!d.excludeFromExport&&(p.clipPath=this._toObject(this.clipPath,a,f)),u(p,this.__serializeBgOverlay(a,f)),t.util.populateWithProperties(this,p,f),p},_toObjects:function(a,f){return this._objects.filter(function(d){return!d.excludeFromExport}).map(function(d){return this._toObject(d,a,f)},this)},_toObject:function(a,f,d){var p;this.includeDefaultValues||(p=a.includeDefaultValues,a.includeDefaultValues=!1);var m=a[f](d);return this.includeDefaultValues||(a.includeDefaultValues=p),m},__serializeBgOverlay:function(a,f){var d={},p=this.backgroundImage,m=this.overlayImage,y=this.backgroundColor,x=this.overlayColor;return y&&y.toObject?y.excludeFromExport||(d.background=y.toObject(f)):y&&(d.background=y),x&&x.toObject?x.excludeFromExport||(d.overlay=x.toObject(f)):x&&(d.overlay=x),p&&!p.excludeFromExport&&(d.backgroundImage=this._toObject(p,a,f)),m&&!m.excludeFromExport&&(d.overlayImage=this._toObject(m,a,f)),d},svgViewportTransformation:!0,toSVG:function(a,f){a||(a={}),a.reviver=f;var d=[];return this._setSVGPreamble(d,a),this._setSVGHeader(d,a),this.clipPath&&d.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(d,"background"),this._setSVGBgOverlayImage(d,"backgroundImage",f),this._setSVGObjects(d,f),this.clipPath&&d.push(`</g>
`),this._setSVGBgOverlayColor(d,"overlay"),this._setSVGBgOverlayImage(d,"overlayImage",f),d.push("</svg>"),d.join("")},_setSVGPreamble:function(a,f){f.suppressPreamble||a.push('<?xml version="1.0" encoding="',f.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(a,f){var d=f.width||this.width,p=f.height||this.height,m,y='viewBox="0 0 '+this.width+" "+this.height+'" ',x=t.Object.NUM_FRACTION_DIGITS;f.viewBox?y='viewBox="'+f.viewBox.x+" "+f.viewBox.y+" "+f.viewBox.width+" "+f.viewBox.height+'" ':this.svgViewportTransformation&&(m=this.viewportTransform,y='viewBox="'+l(-m[4]/m[0],x)+" "+l(-m[5]/m[3],x)+" "+l(this.width/m[0],x)+" "+l(this.height/m[3],x)+'" '),a.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',d,'" ','height="',p,'" ',y,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(f),`</defs>
`)},createSVGClipPathMarkup:function(a){var f=this.clipPath;return f?(f.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+f.clipPathId+`" >
`+this.clipPath.toClipPathSVG(a.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var a=this,f=["background","overlay"].map(function(d){var p=a[d+"Color"];if(p&&p.toLive){var m=a[d+"Vpt"],y=a.viewportTransform,x={width:a.width/(m?y[0]:1),height:a.height/(m?y[3]:1)};return p.toSVG(x,{additionalTransform:m?t.util.matrixToSVG(y):""})}});return f.join("")},createSVGFontFacesMarkup:function(){var a="",f={},d,p,m,y,x,P,B,z,q,Z=t.fontPaths,rt=[];for(this._objects.forEach(function et(nt){rt.push(nt),nt._objects&&nt._objects.forEach(et)}),z=0,q=rt.length;z<q;z++)if(d=rt[z],p=d.fontFamily,!(d.type.indexOf("text")===-1||f[p]||!Z[p])&&(f[p]=!0,!!d.styles)){m=d.styles;for(x in m){y=m[x];for(B in y)P=y[B],p=P.fontFamily,!f[p]&&Z[p]&&(f[p]=!0)}}for(var ot in f)a+=[`		@font-face {
`,"			font-family: '",ot,`';
`,"			src: url('",Z[ot],`');
`,`		}
`].join("");return a&&(a=['	<style type="text/css">',`<![CDATA[
`,a,"]]>",`</style>
`].join("")),a},_setSVGObjects:function(a,f){var d,p,m,y=this._objects;for(p=0,m=y.length;p<m;p++)d=y[p],!d.excludeFromExport&&this._setSVGObject(a,d,f)},_setSVGObject:function(a,f,d){a.push(f.toSVG(d))},_setSVGBgOverlayImage:function(a,f,d){this[f]&&!this[f].excludeFromExport&&this[f].toSVG&&a.push(this[f].toSVG(d))},_setSVGBgOverlayColor:function(a,f){var d=this[f+"Color"],p=this.viewportTransform,m=this.width,y=this.height;if(d)if(d.toLive){var x=d.repeat,P=t.util.invertTransform(p),B=this[f+"Vpt"],z=B?t.util.matrixToSVG(P):"";a.push('<rect transform="'+z+" translate(",m/2,",",y/2,')"',' x="',d.offsetX-m/2,'" y="',d.offsetY-y/2,'" ','width="',x==="repeat-y"||x==="no-repeat"?d.source.width:m,'" height="',x==="repeat-x"||x==="no-repeat"?d.source.height:y,'" fill="url(#SVGID_'+d.id+')"',`></rect>
`)}else a.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',d,'"',`></rect>
`)},sendToBack:function(a){if(!a)return this;var f=this._activeObject,d,p,m;if(a===f&&a.type==="activeSelection")for(m=f._objects,d=m.length;d--;)p=m[d],c(this._objects,p),this._objects.unshift(p);else c(this._objects,a),this._objects.unshift(a);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(a){if(!a)return this;var f=this._activeObject,d,p,m;if(a===f&&a.type==="activeSelection")for(m=f._objects,d=0;d<m.length;d++)p=m[d],c(this._objects,p),this._objects.push(p);else c(this._objects,a),this._objects.push(a);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(a,f){if(!a)return this;var d=this._activeObject,p,m,y,x,P,B=0;if(a===d&&a.type==="activeSelection")for(P=d._objects,p=0;p<P.length;p++)m=P[p],y=this._objects.indexOf(m),y>0+B&&(x=y-1,c(this._objects,m),this._objects.splice(x,0,m)),B++;else y=this._objects.indexOf(a),y!==0&&(x=this._findNewLowerIndex(a,y,f),c(this._objects,a),this._objects.splice(x,0,a));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(a,f,d){var p,m;if(d)for(p=f,m=f-1;m>=0;--m){var y=a.intersectsWithObject(this._objects[m])||a.isContainedWithinObject(this._objects[m])||this._objects[m].isContainedWithinObject(a);if(y){p=m;break}}else p=f-1;return p},bringForward:function(a,f){if(!a)return this;var d=this._activeObject,p,m,y,x,P,B=0;if(a===d&&a.type==="activeSelection")for(P=d._objects,p=P.length;p--;)m=P[p],y=this._objects.indexOf(m),y<this._objects.length-1-B&&(x=y+1,c(this._objects,m),this._objects.splice(x,0,m)),B++;else y=this._objects.indexOf(a),y!==this._objects.length-1&&(x=this._findNewUpperIndex(a,y,f),c(this._objects,a),this._objects.splice(x,0,a));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(a,f,d){var p,m,y;if(d)for(p=f,m=f+1,y=this._objects.length;m<y;++m){var x=a.intersectsWithObject(this._objects[m])||a.isContainedWithinObject(this._objects[m])||this._objects[m].isContainedWithinObject(a);if(x){p=m;break}}else p=f+1;return p},moveTo:function(a,f){return c(this._objects,a),this._objects.splice(f,0,a),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(a){a.dispose&&a.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),u(t.StaticCanvas.prototype,t.Observable),u(t.StaticCanvas.prototype,t.Collection),u(t.StaticCanvas.prototype,t.DataURLExporter),u(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(a){var f=o();if(!f||!f.getContext)return null;var d=f.getContext("2d");if(!d)return null;switch(a){case"setLineDash":return typeof d.setLineDash<"u";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var a=e(this.lowerCanvasEl);return a&&a.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(a){var f=e(this.lowerCanvasEl);return f&&f.createJPEGStream(a)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(u){u.strokeStyle=this.color,u.lineWidth=this.width,u.lineCap=this.strokeLineCap,u.miterLimit=this.strokeMiterLimit,u.lineJoin=this.strokeLineJoin,u.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(u){var r=this.canvas.viewportTransform;u.save(),u.transform(r[0],r[1],r[2],r[3],r[4],r[5])},_setShadow:function(){if(this.shadow){var u=this.canvas,r=this.shadow,c=u.contextTop,l=u.getZoom();u&&u._isRetinaScaling()&&(l*=t.devicePixelRatio),c.shadowColor=r.color,c.shadowBlur=r.blur*l,c.shadowOffsetX=r.offsetX*l,c.shadowOffsetY=r.offsetY*l}},needsFullRender:function(){var u=new t.Color(this.color);return u.getAlpha()<1||!!this.shadow},_resetShadow:function(){var u=this.canvas.contextTop;u.shadowColor="",u.shadowBlur=u.shadowOffsetX=u.shadowOffsetY=0},_isOutSideCanvas:function(u){return u.x<0||u.x>this.canvas.getWidth()||u.y<0||u.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(u){this.canvas=u,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(u,r,c){var l=r.midPointFrom(c);return u.quadraticCurveTo(r.x,r.y,l.x,l.y),l},onMouseDown:function(u,r){this.canvas._isMainEvent(r.e)&&(this.drawStraightLine=r.e[this.straightLineKey],this._prepareForDrawing(u),this._captureDrawingPath(u),this._render())},onMouseMove:function(u,r){if(this.canvas._isMainEvent(r.e)&&(this.drawStraightLine=r.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(u))&&this._captureDrawingPath(u)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,l=c.length,i=this.canvas.contextTop;this._saveAndTransform(i),this.oldEnd&&(i.beginPath(),i.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(i,c[l-2],c[l-1],!0),i.stroke(),i.restore()}},onMouseUp:function(u){return this.canvas._isMainEvent(u.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(u){var r=new t.Point(u.x,u.y);this._reset(),this._addPoint(r),this.canvas.contextTop.moveTo(r.x,r.y)},_addPoint:function(u){return this._points.length>1&&u.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(u),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(u){var r=new t.Point(u.x,u.y);return this._addPoint(r)},_render:function(u){var r,c,l=this._points[0],i=this._points[1];if(u=u||this.canvas.contextTop,this._saveAndTransform(u),u.beginPath(),this._points.length===2&&l.x===i.x&&l.y===i.y){var n=this.width/1e3;l=new t.Point(l.x,l.y),i=new t.Point(i.x,i.y),l.x-=n,i.x+=n}for(u.moveTo(l.x,l.y),r=1,c=this._points.length;r<c;r++)this._drawSegment(u,l,i),l=this._points[r],i=this._points[r+1];u.lineTo(l.x,l.y),u.stroke(),u.restore()},convertPointsToSVGPath:function(u){var r=this.width/1e3;return t.util.getSmoothPathFromPoints(u,r)},_isEmptySVGPath:function(u){var r=t.util.joinPath(u);return r==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(u){var r=new t.Path(u,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,r.shadow=new t.Shadow(this.shadow)),r},decimatePoints:function(u,r){if(u.length<=2)return u;var c=this.canvas.getZoom(),l=Math.pow(r/c,2),i,n=u.length-1,e=u[0],o=[e],h;for(i=1;i<n-1;i++)h=Math.pow(e.x-u[i].x,2)+Math.pow(e.y-u[i].y,2),h>=l&&(e=u[i],o.push(e));return o.push(u[n]),o},_finalizeAndAddPath:function(){var u=this.canvas.contextTop;u.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var r=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(r)){this.canvas.requestRenderAll();return}var c=this.createPath(r);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(u){this.canvas=u,this.points=[]},drawDot:function(u){var r=this.addPoint(u),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,r),c.restore()},dot:function(u,r){u.fillStyle=r.fill,u.beginPath(),u.arc(r.x,r.y,r.radius,0,Math.PI*2,!1),u.closePath(),u.fill()},onMouseDown:function(u){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(u)},_render:function(){var u=this.canvas.contextTop,r,c,l=this.points;for(this._saveAndTransform(u),r=0,c=l.length;r<c;r++)this.dot(u,l[r]);u.restore()},onMouseMove:function(u){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(u)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(u),this._render()):this.drawDot(u))},onMouseUp:function(){var u=this.canvas.renderOnAddRemove,r,c;this.canvas.renderOnAddRemove=!1;var l=[];for(r=0,c=this.points.length;r<c;r++){var i=this.points[r],n=new t.Circle({radius:i.radius,left:i.x,top:i.y,originX:"center",originY:"center",fill:i.fill});this.shadow&&(n.shadow=new t.Shadow(this.shadow)),l.push(n)}var e=new t.Group(l);e.canvas=this.canvas,this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.fire("path:created",{path:e}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=u,this.canvas.requestRenderAll()},addPoint:function(u){var r=new t.Point(u.x,u.y),c=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,l=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return r.radius=c,r.fill=l,this.points.push(r),r}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(u){this.canvas=u,this.sprayChunks=[]},onMouseDown:function(u){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(u),this.render(this.sprayChunkPoints)},onMouseMove:function(u){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(u)||(this.addSprayChunk(u),this.render(this.sprayChunkPoints))},onMouseUp:function(){var u=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var r=[],c=0,l=this.sprayChunks.length;c<l;c++)for(var i=this.sprayChunks[c],n=0,e=i.length;n<e;n++){var o=new t.Rect({width:i[n].width,height:i[n].width,left:i[n].x+1,top:i[n].y+1,originX:"center",originY:"center",fill:this.color});r.push(o)}this.optimizeOverlapping&&(r=this._getOptimizedRects(r));var h=new t.Group(r);this.shadow&&h.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:h}),this.canvas.add(h),this.canvas.fire("path:created",{path:h}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=u,this.canvas.requestRenderAll()},_getOptimizedRects:function(u){var r={},c,l,i;for(l=0,i=u.length;l<i;l++)c=u[l].left+""+u[l].top,r[c]||(r[c]=u[l]);var n=[];for(c in r)n.push(r[c]);return n},render:function(u){var r=this.canvas.contextTop,c,l;for(r.fillStyle=this.color,this._saveAndTransform(r),c=0,l=u.length;c<l;c++){var i=u[c];typeof i.opacity<"u"&&(r.globalAlpha=i.opacity),r.fillRect(i.x,i.y,i.width,i.width)}r.restore()},_render:function(){var u=this.canvas.contextTop,r,c;for(u.fillStyle=this.color,this._saveAndTransform(u),r=0,c=this.sprayChunks.length;r<c;r++)this.render(this.sprayChunks[r]);u.restore()},addSprayChunk:function(u){this.sprayChunkPoints=[];var r,c,l,i=this.width/2,n;for(n=0;n<this.density;n++){r=t.util.getRandomInt(u.x-i,u.x+i),c=t.util.getRandomInt(u.y-i,u.y+i),this.dotWidthVariance?l=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):l=this.dotWidth;var e=new t.Point(r,c);e.width=l,this.randomOpacity&&(e.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(e)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var u=20,r=5,c=t.util.createCanvasElement(),l=c.getContext("2d");return c.width=c.height=u+r,l.fillStyle=this.color,l.beginPath(),l.arc(u/2,u/2,u/2,0,Math.PI*2,!1),l.closePath(),l.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(u){return u.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(u){this.callSuper("_setBrushStyles",u),u.strokeStyle=this.getPattern(u)},createPath:function(u){var r=this.callSuper("createPath",u),c=r._getLeftTopCoords().scalarAdd(r.strokeWidth/2);return r.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),r}}),function(){var u=t.util.getPointer,r=t.util.degreesToRadians,c=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(i,n){n||(n={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(i,n),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var i=this.getActiveObjects(),n,e,o;if(i.length>0&&!this.preserveObjectStacking){e=[],o=[];for(var h=0,a=this._objects.length;h<a;h++)n=this._objects[h],i.indexOf(n)===-1?e.push(n):o.push(n);i.length>1&&(this._activeObject._objects=o),e.push.apply(e,o)}else e=this._objects;return e},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var i=this.contextContainer;return this.renderCanvas(i,this._chooseObjectsToRender()),this},renderTopLayer:function(i){i.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(i),this.contextTopDirty=!0),i.restore()},renderTop:function(){var i=this.contextTop;return this.clearContext(i),this.renderTopLayer(i),this.fire("after:render"),this},_normalizePointer:function(i,n){var e=i.calcTransformMatrix(),o=t.util.invertTransform(e),h=this.restorePointerVpt(n);return t.util.transformPoint(h,o)},isTargetTransparent:function(i,n,e){if(i.shouldCache()&&i._cacheCanvas&&i!==this._activeObject){var o=this._normalizePointer(i,{x:n,y:e}),h=Math.max(i.cacheTranslationX+o.x*i.zoomX,0),a=Math.max(i.cacheTranslationY+o.y*i.zoomY,0),m=t.util.isTransparent(i._cacheContext,Math.round(h),Math.round(a),this.targetFindTolerance);return m}var f=this.contextCache,d=i.selectionBackgroundColor,p=this.viewportTransform;i.selectionBackgroundColor="",this.clearContext(f),f.save(),f.transform(p[0],p[1],p[2],p[3],p[4],p[5]),i.render(f),f.restore(),i.selectionBackgroundColor=d;var m=t.util.isTransparent(f,n,e,this.targetFindTolerance);return m},_isSelectionKeyPressed:function(i){var n=!1;return Array.isArray(this.selectionKey)?n=!!this.selectionKey.find(function(e){return i[e]===!0}):n=i[this.selectionKey],n},_shouldClearSelection:function(i,n){var e=this.getActiveObjects(),o=this._activeObject;return!n||n&&o&&e.length>1&&e.indexOf(n)===-1&&o!==n&&!this._isSelectionKeyPressed(i)||n&&!n.evented||n&&!n.selectable&&o&&o!==n},_shouldCenterTransform:function(i,n,e){if(i){var o;return n==="scale"||n==="scaleX"||n==="scaleY"||n==="resizing"?o=this.centeredScaling||i.centeredScaling:n==="rotate"&&(o=this.centeredRotation||i.centeredRotation),o?!e:e}},_getOriginFromCorner:function(i,n){var e={x:i.originX,y:i.originY};return n==="ml"||n==="tl"||n==="bl"?e.x="right":(n==="mr"||n==="tr"||n==="br")&&(e.x="left"),n==="tl"||n==="mt"||n==="tr"?e.y="bottom":(n==="bl"||n==="mb"||n==="br")&&(e.y="top"),e},_getActionFromCorner:function(i,n,e,o){if(!n||!i)return"drag";var h=o.controls[n];return h.getActionName(e,h,o)},_setupCurrentTransform:function(i,n,e){if(n){var o=this.getPointer(i),h=n.__corner,a=n.controls[h],f=e&&h?a.getActionHandler(i,n,a):t.controlsUtils.dragHandler,d=this._getActionFromCorner(e,h,i,n),p=this._getOriginFromCorner(n,h),m=i[this.centeredKey],y={target:n,action:d,actionHandler:f,corner:h,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:o.x-n.left,offsetY:o.y-n.top,originX:p.x,originY:p.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:r(n.angle),width:n.width*n.scaleX,shiftKey:i.shiftKey,altKey:m,original:t.util.saveObjectTransform(n)};this._shouldCenterTransform(n,d,m)&&(y.originX="center",y.originY="center"),y.original.originX=p.x,y.original.originY=p.y,this._currentTransform=y,this._beforeTransform(i)}},setCursor:function(i){this.upperCanvasEl.style.cursor=i},_drawSelection:function(i){var n=this._groupSelector,e=new t.Point(n.ex,n.ey),o=t.util.transformPoint(e,this.viewportTransform),h=new t.Point(n.ex+n.left,n.ey+n.top),a=t.util.transformPoint(h,this.viewportTransform),f=Math.min(o.x,a.x),d=Math.min(o.y,a.y),p=Math.max(o.x,a.x),m=Math.max(o.y,a.y),y=this.selectionLineWidth/2;this.selectionColor&&(i.fillStyle=this.selectionColor,i.fillRect(f,d,p-f,m-d)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(i.lineWidth=this.selectionLineWidth,i.strokeStyle=this.selectionBorderColor,f+=y,d+=y,p-=y,m-=y,t.Object.prototype._setLineDash.call(this,i,this.selectionDashArray),i.strokeRect(f,d,p-f,m-d))},findTarget:function(i,n){if(!this.skipTargetFind){var e=!0,o=this.getPointer(i,e),h=this._activeObject,a=this.getActiveObjects(),f,d,p=c(i),m=a.length>1&&!n||a.length===1;if(this.targets=[],m&&h._findTargetCorner(o,p)||a.length>1&&!n&&h===this._searchPossibleTargets([h],o))return h;if(a.length===1&&h===this._searchPossibleTargets([h],o))if(this.preserveObjectStacking)f=h,d=this.targets,this.targets=[];else return h;var y=this._searchPossibleTargets(this._objects,o);return i[this.altSelectionKey]&&y&&f&&y!==f&&(y=f,this.targets=d),y}},_checkTarget:function(i,n,e){if(n&&n.visible&&n.evented&&n.containsPoint(i))if((this.perPixelTargetFind||n.perPixelTargetFind)&&!n.isEditing){var o=this.isTargetTransparent(n,e.x,e.y);if(!o)return!0}else return!0},_searchPossibleTargets:function(i,n){for(var e,o=i.length,h;o--;){var a=i[o],f=a.group?this._normalizePointer(a.group,n):n;if(this._checkTarget(f,a,n)){e=i[o],e.subTargetCheck&&e instanceof t.Group&&(h=this._searchPossibleTargets(e._objects,n),h&&this.targets.push(h));break}}return e},restorePointerVpt:function(i){return t.util.transformPoint(i,t.util.invertTransform(this.viewportTransform))},getPointer:function(i,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var e=u(i),o=this.upperCanvasEl,h=o.getBoundingClientRect(),a=h.width||0,f=h.height||0,d;(!a||!f)&&("top"in h&&"bottom"in h&&(f=Math.abs(h.top-h.bottom)),"right"in h&&"left"in h&&(a=Math.abs(h.right-h.left))),this.calcOffset(),e.x=e.x-this._offset.left,e.y=e.y-this._offset.top,n||(e=this.restorePointerVpt(e));var p=this.getRetinaScaling();return p!==1&&(e.x/=p,e.y/=p),a===0||f===0?d={width:1,height:1}:d={width:o.width/a,height:o.height/f},{x:e.x*d.width,y:e.y*d.height}},_createUpperCanvas:function(){var i=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),n=this.lowerCanvasEl,e=this.upperCanvasEl;e?e.className="":(e=this._createCanvasElement(),this.upperCanvasEl=e),t.util.addClass(e,"upper-canvas "+i),this.wrapperEl.appendChild(e),this._copyCanvasStyle(n,e),this._applyCanvasStyle(e),this.contextTop=e.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(i){var n=this.width||i.width,e=this.height||i.height;t.util.setStyle(i,{position:"absolute",width:n+"px",height:e+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),i.width=n,i.height=e,t.util.makeElementUnselectable(i)},_copyCanvasStyle:function(i,n){n.style.cssText=i.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var i=this._activeObject;return i?i.type==="activeSelection"&&i._objects?i._objects.slice(0):[i]:[]},_onObjectRemoved:function(i){i===this._activeObject&&(this.fire("before:selection:cleared",{target:i}),this._discardActiveObject(),this.fire("selection:cleared",{target:i}),i.fire("deselected")),i===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",i)},_fireSelectionEvents:function(i,n){var e=!1,o=this.getActiveObjects(),h=[],a=[];i.forEach(function(f){o.indexOf(f)===-1&&(e=!0,f.fire("deselected",{e:n,target:f}),a.push(f))}),o.forEach(function(f){i.indexOf(f)===-1&&(e=!0,f.fire("selected",{e:n,target:f}),h.push(f))}),i.length>0&&o.length>0?e&&this.fire("selection:updated",{e:n,selected:h,deselected:a}):o.length>0?this.fire("selection:created",{e:n,selected:h}):i.length>0&&this.fire("selection:cleared",{e:n,deselected:a})},setActiveObject:function(i,n){var e=this.getActiveObjects();return this._setActiveObject(i,n),this._fireSelectionEvents(e,n),this},_setActiveObject:function(i,n){return this._activeObject===i||!this._discardActiveObject(n,i)||i.onSelect({e:n})?!1:(this._activeObject=i,!0)},_discardActiveObject:function(i,n){var e=this._activeObject;if(e){if(e.onDeselect({e:i,object:n}))return!1;this._activeObject=null}return!0},discardActiveObject:function(i){var n=this.getActiveObjects(),e=this.getActiveObject();return n.length&&this.fire("before:selection:cleared",{target:e,e:i}),this._discardActiveObject(i),this._fireSelectionEvents(n,i),this},dispose:function(){var i=this.wrapperEl;return this.removeListeners(),i.removeChild(this.upperCanvasEl),i.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(n){t.util.cleanUpJsdomNode(this[n]),this[n]=void 0}).bind(this)),i.parentNode&&i.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(i){var n=this._activeObject;n&&n._renderControls(i)},_toObject:function(i,n,e){var o=this._realizeGroupTransformOnObject(i),h=this.callSuper("_toObject",i,n,e);return this._unwindGroupTransformOnObject(i,o),h},_realizeGroupTransformOnObject:function(i){if(i.group&&i.group.type==="activeSelection"&&this._activeObject===i.group){var n=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],e={};return n.forEach(function(o){e[o]=i[o]}),t.util.addTransformToObject(i,this._activeObject.calcOwnMatrix()),e}else return null},_unwindGroupTransformOnObject:function(i,n){n&&i.set(n)},_setSVGObject:function(i,n,e){var o=this._realizeGroupTransformOnObject(n);this.callSuper("_setSVGObject",i,n,e),this._unwindGroupTransformOnObject(n,o)},setViewportTransform:function(i){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,i)}});for(var l in t.StaticCanvas)l!=="prototype"&&(t.Canvas[l]=t.StaticCanvas[l])}(),function(){var u=t.util.addListener,r=t.util.removeListener,c=3,l=2,i=1,n={passive:!1};function e(o,h){return o.button&&o.button===h-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(u,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(o,h){var a=this.upperCanvasEl,f=this._getEventPrefix();o(t.window,"resize",this._onResize),o(a,f+"down",this._onMouseDown),o(a,f+"move",this._onMouseMove,n),o(a,f+"out",this._onMouseOut),o(a,f+"enter",this._onMouseEnter),o(a,"wheel",this._onMouseWheel),o(a,"contextmenu",this._onContextMenu),o(a,"dblclick",this._onDoubleClick),o(a,"dragover",this._onDragOver),o(a,"dragenter",this._onDragEnter),o(a,"dragleave",this._onDragLeave),o(a,"drop",this._onDrop),this.enablePointerEvents||o(a,"touchstart",this._onTouchStart,n),typeof eventjs<"u"&&h in eventjs&&(eventjs[h](a,"gesture",this._onGesture),eventjs[h](a,"drag",this._onDrag),eventjs[h](a,"orientation",this._onOrientationChange),eventjs[h](a,"shake",this._onShake),eventjs[h](a,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(r,"remove");var o=this._getEventPrefix();r(t.document,o+"up",this._onMouseUp),r(t.document,"touchend",this._onTouchEnd,n),r(t.document,o+"move",this._onMouseMove,n),r(t.document,"touchmove",this._onMouseMove,n)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(o,h){this.__onTransformGesture&&this.__onTransformGesture(o,h)},_onDrag:function(o,h){this.__onDrag&&this.__onDrag(o,h)},_onMouseWheel:function(o){this.__onMouseWheel(o)},_onMouseOut:function(o){var h=this._hoveredTarget;this.fire("mouse:out",{target:h,e:o}),this._hoveredTarget=null,h&&h.fire("mouseout",{e:o});var a=this;this._hoveredTargets.forEach(function(f){a.fire("mouse:out",{target:f,e:o}),f&&f.fire("mouseout",{e:o})}),this._hoveredTargets=[]},_onMouseEnter:function(o){!this._currentTransform&&!this.findTarget(o)&&(this.fire("mouse:over",{target:null,e:o}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(o,h){this.__onOrientationChange&&this.__onOrientationChange(o,h)},_onShake:function(o,h){this.__onShake&&this.__onShake(o,h)},_onLongPress:function(o,h){this.__onLongPress&&this.__onLongPress(o,h)},_onDragOver:function(o){o.preventDefault();var h=this._simpleEventHandler("dragover",o);this._fireEnterLeaveEvents(h,o)},_onDrop:function(o){return this._simpleEventHandler("drop:before",o),this._simpleEventHandler("drop",o)},_onContextMenu:function(o){return this.stopContextMenu&&(o.stopPropagation(),o.preventDefault()),!1},_onDoubleClick:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"dblclick"),this._resetTransformEventData(o)},getPointerId:function(o){var h=o.changedTouches;return h?h[0]&&h[0].identifier:this.enablePointerEvents?o.pointerId:-1},_isMainEvent:function(o){return o.isPrimary===!0?!0:o.isPrimary===!1?!1:o.type==="touchend"&&o.touches.length===0?!0:o.changedTouches?o.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(o){o.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(o)),this.__onMouseDown(o),this._resetTransformEventData();var h=this.upperCanvasEl,a=this._getEventPrefix();u(t.document,"touchend",this._onTouchEnd,n),u(t.document,"touchmove",this._onMouseMove,n),r(h,a+"down",this._onMouseDown)},_onMouseDown:function(o){this.__onMouseDown(o),this._resetTransformEventData();var h=this.upperCanvasEl,a=this._getEventPrefix();r(h,a+"move",this._onMouseMove,n),u(t.document,a+"up",this._onMouseUp),u(t.document,a+"move",this._onMouseMove,n)},_onTouchEnd:function(o){if(!(o.touches.length>0)){this.__onMouseUp(o),this._resetTransformEventData(),this.mainTouchId=null;var h=this._getEventPrefix();r(t.document,"touchend",this._onTouchEnd,n),r(t.document,"touchmove",this._onMouseMove,n);var a=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){u(a.upperCanvasEl,h+"down",a._onMouseDown),a._willAddMouseDown=0},400)}},_onMouseUp:function(o){this.__onMouseUp(o),this._resetTransformEventData();var h=this.upperCanvasEl,a=this._getEventPrefix();this._isMainEvent(o)&&(r(t.document,a+"up",this._onMouseUp),r(t.document,a+"move",this._onMouseMove,n),u(h,a+"move",this._onMouseMove,n))},_onMouseMove:function(o){!this.allowTouchScrolling&&o.preventDefault&&o.preventDefault(),this.__onMouseMove(o)},_onResize:function(){this.calcOffset()},_shouldRender:function(o){var h=this._activeObject;return!!h!=!!o||h&&o&&h!==o?!0:(h&&h.isEditing,!1)},__onMouseUp:function(o){var h,a=this._currentTransform,f=this._groupSelector,d=!1,p=!f||f.left===0&&f.top===0;if(this._cacheTransformEventData(o),h=this._target,this._handleEvent(o,"up:before"),e(o,c)){this.fireRightClick&&this._handleEvent(o,"up",c,p);return}if(e(o,l)){this.fireMiddleClick&&this._handleEvent(o,"up",l,p),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(o);return}if(this._isMainEvent(o)){if(a&&(this._finalizeCurrentTransform(o),d=a.actionPerformed),!p){var m=h===this._activeObject;this._maybeGroupObjects(o),d||(d=this._shouldRender(h)||!m&&h===this._activeObject)}var y,x;if(h){if(y=h._findTargetCorner(this.getPointer(o,!0),t.util.isTouchEvent(o)),h.selectable&&h!==this._activeObject&&h.activeOn==="up")this.setActiveObject(h,o),d=!0;else{var P=h.controls[y],B=P&&P.getMouseUpHandler(o,h,P);B&&(x=this.getPointer(o),B(o,a,x.x,x.y))}h.isMoving=!1}if(a&&(a.target!==h||a.corner!==y)){var z=a.target&&a.target.controls[a.corner],q=z&&z.getMouseUpHandler(o,h,P);x=x||this.getPointer(o),q&&q(o,a,x.x,x.y)}this._setCursorFromEvent(o,h),this._handleEvent(o,"up",i,p),this._groupSelector=null,this._currentTransform=null,h&&(h.__corner=0),d?this.requestRenderAll():p||this.renderTop()}},_simpleEventHandler:function(o,h){var a=this.findTarget(h),f=this.targets,d={e:h,target:a,subTargets:f};if(this.fire(o,d),a&&a.fire(o,d),!f)return a;for(var p=0;p<f.length;p++)f[p].fire(o,d);return a},_handleEvent:function(o,h,a,f){var d=this._target,p=this.targets||[],m={e:o,target:d,subTargets:p,button:a||i,isClick:f||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};h==="up"&&(m.currentTarget=this.findTarget(o),m.currentSubTargets=this.targets),this.fire("mouse:"+h,m),d&&d.fire("mouse"+h,m);for(var y=0;y<p.length;y++)p[y].fire("mouse"+h,m)},_finalizeCurrentTransform:function(o){var h=this._currentTransform,a=h.target,f={e:o,target:a,transform:h,action:h.action};a._scaling&&(a._scaling=!1),a.setCoords(),(h.actionPerformed||this.stateful&&a.hasStateChanged())&&this._fire("modified",f)},_onMouseDownInDrawingMode:function(o){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(o).requestRenderAll();var h=this.getPointer(o);this.freeDrawingBrush.onMouseDown(h,{e:o,pointer:h}),this._handleEvent(o,"down")},_onMouseMoveInDrawingMode:function(o){if(this._isCurrentlyDrawing){var h=this.getPointer(o);this.freeDrawingBrush.onMouseMove(h,{e:o,pointer:h})}this.setCursor(this.freeDrawingCursor),this._handleEvent(o,"move")},_onMouseUpInDrawingMode:function(o){var h=this.getPointer(o);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:o,pointer:h}),this._handleEvent(o,"up")},__onMouseDown:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"down:before");var h=this._target;if(e(o,c)){this.fireRightClick&&this._handleEvent(o,"down",c);return}if(e(o,l)){this.fireMiddleClick&&this._handleEvent(o,"down",l);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(o);return}if(this._isMainEvent(o)&&!this._currentTransform){var a=this._pointer;this._previousPointer=a;var f=this._shouldRender(h),d=this._shouldGroup(o,h);if(this._shouldClearSelection(o,h)?this.discardActiveObject(o):d&&(this._handleGrouping(o,h),h=this._activeObject),this.selection&&(!h||!h.selectable&&!h.isEditing&&h!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),h){var p=h===this._activeObject;h.selectable&&h.activeOn==="down"&&this.setActiveObject(h,o);var m=h._findTargetCorner(this.getPointer(o,!0),t.util.isTouchEvent(o));if(h.__corner=m,h===this._activeObject&&(m||!d)){this._setupCurrentTransform(o,h,p);var y=h.controls[m],a=this.getPointer(o),x=y&&y.getMouseDownHandler(o,h,y);x&&x(o,this._currentTransform,a.x,a.y)}}this._handleEvent(o,"down"),(f||d)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(o){this._resetTransformEventData(),this._pointer=this.getPointer(o,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(o)||null},_beforeTransform:function(o){var h=this._currentTransform;this.stateful&&h.target.saveState(),this.fire("before:transform",{e:o,transform:h})},__onMouseMove:function(o){this._handleEvent(o,"move:before"),this._cacheTransformEventData(o);var h,a;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(o);return}if(this._isMainEvent(o)){var f=this._groupSelector;f?(a=this._absolutePointer,f.left=a.x-f.ex,f.top=a.y-f.ey,this.renderTop()):this._currentTransform?this._transformObject(o):(h=this.findTarget(o)||null,this._setCursorFromEvent(o,h),this._fireOverOutEvents(h,o)),this._handleEvent(o,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(o,h){var a=this._hoveredTarget,f=this._hoveredTargets,d=this.targets,p=Math.max(f.length,d.length);this.fireSyntheticInOutEvents(o,h,{oldTarget:a,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var m=0;m<p;m++)this.fireSyntheticInOutEvents(d[m],h,{oldTarget:f[m],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=o,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(o,h){var a=this._draggedoverTarget,f=this._hoveredTargets,d=this.targets,p=Math.max(f.length,d.length);this.fireSyntheticInOutEvents(o,h,{oldTarget:a,evtOut:"dragleave",evtIn:"dragenter"});for(var m=0;m<p;m++)this.fireSyntheticInOutEvents(d[m],h,{oldTarget:f[m],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=o},fireSyntheticInOutEvents:function(o,h,a){var f,d,p=a.oldTarget,m,y,x=p!==o,P=a.canvasEvtIn,B=a.canvasEvtOut;x&&(f={e:h,target:o,previousTarget:p},d={e:h,target:p,nextTarget:o}),y=o&&x,m=p&&x,m&&(B&&this.fire(B,d),p.fire(a.evtOut,d)),y&&(P&&this.fire(P,f),o.fire(a.evtIn,f))},__onMouseWheel:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"wheel"),this._resetTransformEventData()},_transformObject:function(o){var h=this.getPointer(o),a=this._currentTransform;a.reset=!1,a.shiftKey=o.shiftKey,a.altKey=o[this.centeredKey],this._performTransformAction(o,a,h),a.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(o,h,a){var f=a.x,d=a.y,p=h.action,m=!1,y=h.actionHandler;y&&(m=y(o,h,f,d)),p==="drag"&&m&&(h.target.isMoving=!0,this.setCursor(h.target.moveCursor||this.moveCursor)),h.actionPerformed=h.actionPerformed||m},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(o,h){if(!h)return this.setCursor(this.defaultCursor),!1;var a=h.hoverCursor||this.hoverCursor,f=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,d=(!f||!f.contains(h))&&h._findTargetCorner(this.getPointer(o,!0));d?this.setCursor(this.getCornerCursor(d,h,o)):(h.subTargetCheck&&this.targets.concat().reverse().map(function(p){a=p.hoverCursor||a}),this.setCursor(a))},getCornerCursor:function(o,h,a){var f=h.controls[o];return f.cursorStyleHandler(a,f,h)}})}(),function(){var u=Math.min,r=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(c,l){var i=this._activeObject;return i&&this._isSelectionKeyPressed(c)&&l&&l.selectable&&this.selection&&(i!==l||i.type==="activeSelection")&&!l.onSelect({e:c})},_handleGrouping:function(c,l){var i=this._activeObject;i.__corner||l===i&&(l=this.findTarget(c,!0),!l||!l.selectable)||(i&&i.type==="activeSelection"?this._updateActiveSelection(l,c):this._createActiveSelection(l,c))},_updateActiveSelection:function(c,l){var i=this._activeObject,n=i._objects.slice(0);i.contains(c)?(i.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),i.size()===1&&this._setActiveObject(i.item(0),l)):(i.addWithUpdate(c),this._hoveredTarget=i,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(n,l)},_createActiveSelection:function(c,l){var i=this.getActiveObjects(),n=this._createGroup(c);this._hoveredTarget=n,this._setActiveObject(n,l),this._fireSelectionEvents(i,l)},_createGroup:function(c){var l=this._objects,i=l.indexOf(this._activeObject)<l.indexOf(c),n=i?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(n,{canvas:this})},_groupSelectedObjects:function(c){var l=this._collectObjects(c),i;l.length===1?this.setActiveObject(l[0],c):l.length>1&&(i=new t.ActiveSelection(l.reverse(),{canvas:this}),this.setActiveObject(i,c))},_collectObjects:function(c){for(var l=[],i,n=this._groupSelector.ex,e=this._groupSelector.ey,o=n+this._groupSelector.left,h=e+this._groupSelector.top,a=new t.Point(u(n,o),u(e,h)),f=new t.Point(r(n,o),r(e,h)),d=!this.selectionFullyContained,p=n===o&&e===h,m=this._objects.length;m--&&(i=this._objects[m],!(!(!i||!i.selectable||!i.visible)&&(d&&i.intersectsWithRect(a,f,!0)||i.isContainedWithinRect(a,f,!0)||d&&i.containsPoint(a,null,!0)||d&&i.containsPoint(f,null,!0))&&(l.push(i),p))););return l.length>1&&(l=l.filter(function(y){return!y.onSelect({e:c})})),l},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(u){u||(u={});var r=u.format||"png",c=u.quality||1,l=(u.multiplier||1)*(u.enableRetinaScaling?this.getRetinaScaling():1),i=this.toCanvasElement(l,u);return t.util.toDataURL(i,r,c)},toCanvasElement:function(u,r){u=u||1,r=r||{};var c=(r.width||this.width)*u,l=(r.height||this.height)*u,i=this.getZoom(),n=this.width,e=this.height,o=i*u,h=this.viewportTransform,a=(h[4]-(r.left||0))*u,f=(h[5]-(r.top||0))*u,d=this.interactive,p=[o,0,0,o,a,f],m=this.enableRetinaScaling,y=t.util.createCanvasElement(),x=this.contextTop;return y.width=c,y.height=l,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=p,this.width=c,this.height=l,this.calcViewportBoundaries(),this.renderCanvas(y.getContext("2d"),this._objects),this.viewportTransform=h,this.width=n,this.height=e,this.calcViewportBoundaries(),this.interactive=d,this.enableRetinaScaling=m,this.contextTop=x,y}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(u,r,c){if(u){var l=typeof u=="string"?JSON.parse(u):t.util.object.clone(u),i=this,n=l.clipPath,e=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete l.clipPath,this._enlivenObjects(l.objects,function(o){i.clear(),i._setBgOverlay(l,function(){n?i._enlivenObjects([n],function(h){i.clipPath=h[0],i.__setupCanvas.call(i,l,o,e,r)}):i.__setupCanvas.call(i,l,o,e,r)})},c),this}},__setupCanvas:function(u,r,c,l){var i=this;r.forEach(function(n,e){i.insertAt(n,e)}),this.renderOnAddRemove=c,delete u.objects,delete u.backgroundImage,delete u.overlayImage,delete u.background,delete u.overlay,this._setOptions(u),this.renderAll(),l&&l()},_setBgOverlay:function(u,r){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!u.backgroundImage&&!u.overlayImage&&!u.background&&!u.overlay){r&&r();return}var l=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&r&&r()};this.__setBgOverlay("backgroundImage",u.backgroundImage,c,l),this.__setBgOverlay("overlayImage",u.overlayImage,c,l),this.__setBgOverlay("backgroundColor",u.background,c,l),this.__setBgOverlay("overlayColor",u.overlay,c,l)},__setBgOverlay:function(u,r,c,l){var i=this;if(!r){c[u]=!0,l&&l();return}u==="backgroundImage"||u==="overlayImage"?t.util.enlivenObjects([r],function(n){i[u]=n[0],c[u]=!0,l&&l()}):this["set"+t.util.string.capitalize(u,!0)](r,function(){c[u]=!0,l&&l()})},_enlivenObjects:function(u,r,c){if(!u||u.length===0){r&&r([]);return}t.util.enlivenObjects(u,function(l){r&&r(l)},null,c)},_toDataURL:function(u,r){this.clone(function(c){r(c.toDataURL(u))})},_toDataURLWithMultiplier:function(u,r,c){this.clone(function(l){c(l.toDataURLWithMultiplier(u,r))})},clone:function(u,r){var c=JSON.stringify(this.toJSON(r));this.cloneWithoutData(function(l){l.loadFromJSON(c,function(){u&&u(l)})})},cloneWithoutData:function(u){var r=t.util.createCanvasElement();r.width=this.width,r.height=this.height;var c=new t.Canvas(r);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),u&&u(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):u&&u(c)}}),function(u){var r=u.fabric||(u.fabric={}),c=r.util.object.extend,l=r.util.object.clone,i=r.util.toFixed,n=r.util.string.capitalize,e=r.util.degreesToRadians,o=!r.isLikelyNode,h=2;r.Object||(r.Object=r.util.createClass(r.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:o,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(a){a&&this.setOptions(a)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=r.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(a){var f=r.perfLimitSizeTotal,d=a.width,p=a.height,m=r.maxCacheSideLimit,y=r.minCacheSideLimit;if(d<=m&&p<=m&&d*p<=f)return d<y&&(a.width=y),p<y&&(a.height=y),a;var x=d/p,P=r.util.limitDimsByArea(x,f),B=r.util.capValue,z=B(y,P.x,m),q=B(y,P.y,m);return d>z&&(a.zoomX/=d/z,a.width=z,a.capped=!0),p>q&&(a.zoomY/=p/q,a.height=q,a.capped=!0),a},_getCacheCanvasDimensions:function(){var a=this.getTotalObjectScaling(),f=this._getTransformedDimensions(0,0),d=f.x*a.scaleX/this.scaleX,p=f.y*a.scaleY/this.scaleY;return{width:d+h,height:p+h,zoomX:a.scaleX,zoomY:a.scaleY,x:d,y:p}},_updateCacheCanvas:function(){var a=this.canvas;if(this.noScaleCache&&a&&a._currentTransform){var f=a._currentTransform.target,d=a._currentTransform.action;if(this===f&&d.slice&&d.slice(0,5)==="scale")return!1}var p=this._cacheCanvas,m=this._limitCacheSize(this._getCacheCanvasDimensions()),y=r.minCacheSideLimit,x=m.width,P=m.height,B,z,q=m.zoomX,Z=m.zoomY,rt=x!==this.cacheWidth||P!==this.cacheHeight,ot=this.zoomX!==q||this.zoomY!==Z,et=rt||ot,nt=0,at=0,st=!1;if(rt){var tt=this._cacheCanvas.width,T=this._cacheCanvas.height,R=x>tt||P>T,F=(x<tt*.9||P<T*.9)&&tt>y&&T>y;st=R||F,R&&!m.capped&&(x>y||P>y)&&(nt=x*.1,at=P*.1)}return this instanceof r.Text&&this.path&&(et=!0,st=!0,nt+=this.getHeightOfLine(0)*this.zoomX,at+=this.getHeightOfLine(0)*this.zoomY),et?(st?(p.width=Math.ceil(x+nt),p.height=Math.ceil(P+at)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,p.width,p.height)),B=m.x/2,z=m.y/2,this.cacheTranslationX=Math.round(p.width/2-B)+B,this.cacheTranslationY=Math.round(p.height/2-z)+z,this.cacheWidth=x,this.cacheHeight=P,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(q,Z),this.zoomX=q,this.zoomY=Z,!0):!1},setOptions:function(a){this._setOptions(a),this._initGradient(a.fill,"fill"),this._initGradient(a.stroke,"stroke"),this._initPattern(a.fill,"fill"),this._initPattern(a.stroke,"stroke")},transform:function(a){var f=this.group&&!this.group._transformDone||this.group&&this.canvas&&a===this.canvas.contextTop,d=this.calcTransformMatrix(!f);a.transform(d[0],d[1],d[2],d[3],d[4],d[5])},toObject:function(a){var f=r.Object.NUM_FRACTION_DIGITS,d={type:this.type,version:r.version,originX:this.originX,originY:this.originY,left:i(this.left,f),top:i(this.top,f),width:i(this.width,f),height:i(this.height,f),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:i(this.strokeWidth,f),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:i(this.strokeMiterLimit,f),scaleX:i(this.scaleX,f),scaleY:i(this.scaleY,f),angle:i(this.angle,f),flipX:this.flipX,flipY:this.flipY,opacity:i(this.opacity,f),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:i(this.skewX,f),skewY:i(this.skewY,f)};return this.clipPath&&!this.clipPath.excludeFromExport&&(d.clipPath=this.clipPath.toObject(a),d.clipPath.inverted=this.clipPath.inverted,d.clipPath.absolutePositioned=this.clipPath.absolutePositioned),r.util.populateWithProperties(this,d,a),this.includeDefaultValues||(d=this._removeDefaultValues(d)),d},toDatalessObject:function(a){return this.toObject(a)},_removeDefaultValues:function(a){var f=r.util.getKlass(a.type).prototype,d=f.stateProperties;return d.forEach(function(p){p==="left"||p==="top"||(a[p]===f[p]&&delete a[p],Array.isArray(a[p])&&Array.isArray(f[p])&&a[p].length===0&&f[p].length===0&&delete a[p])}),a},toString:function(){return"#<fabric."+n(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var a=r.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(a.scaleX),scaleY:Math.abs(a.scaleY)}},getTotalObjectScaling:function(){var a=this.getObjectScaling(),f=a.scaleX,d=a.scaleY;if(this.canvas){var p=this.canvas.getZoom(),m=this.canvas.getRetinaScaling();f*=p*m,d*=p*m}return{scaleX:f,scaleY:d}},getObjectOpacity:function(){var a=this.opacity;return this.group&&(a*=this.group.getObjectOpacity()),a},_set:function(a,f){var d=a==="scaleX"||a==="scaleY",p=this[a]!==f,m=!1;return d&&(f=this._constrainScale(f)),a==="scaleX"&&f<0?(this.flipX=!this.flipX,f*=-1):a==="scaleY"&&f<0?(this.flipY=!this.flipY,f*=-1):a==="shadow"&&f&&!(f instanceof r.Shadow)?f=new r.Shadow(f):a==="dirty"&&this.group&&this.group.set("dirty",f),this[a]=f,p&&(m=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(a)>-1?(this.dirty=!0,m&&this.group.set("dirty",!0)):m&&this.stateProperties.indexOf(a)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:r.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(a){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(a.save(),this._setupCompositeOperation(a),this.drawSelectionBackground(a),this.transform(a),this._setOpacity(a),this._setShadow(a,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(a)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(a),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),a.restore())},renderCache:function(a){a=a||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,a.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(a,f){if(a.save(),f.inverted?a.globalCompositeOperation="destination-out":a.globalCompositeOperation="destination-in",f.absolutePositioned){var d=r.util.invertTransform(this.calcTransformMatrix());a.transform(d[0],d[1],d[2],d[3],d[4],d[5])}f.transform(a),a.scale(1/f.zoomX,1/f.zoomY),a.drawImage(f._cacheCanvas,-f.cacheTranslationX,-f.cacheTranslationY),a.restore()},drawObject:function(a,f){var d=this.fill,p=this.stroke;f?(this.fill="black",this.stroke="",this._setClippingProperties(a)):this._renderBackground(a),this._render(a),this._drawClipPath(a,this.clipPath),this.fill=d,this.stroke=p},_drawClipPath:function(a,f){f&&(f.canvas=this.canvas,f.shouldCache(),f._transformDone=!0,f.renderCache({forClipping:!0}),this.drawClipPathOnCache(a,f))},drawCacheOnCanvas:function(a){a.scale(1/this.zoomX,1/this.zoomY),a.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(a){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!a&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!a){var f=this.cacheWidth/this.zoomX,d=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-f/2,-d/2,f,d)}return!0}return!1},_renderBackground:function(a){if(this.backgroundColor){var f=this._getNonTransformedDimensions();a.fillStyle=this.backgroundColor,a.fillRect(-f.x/2,-f.y/2,f.x,f.y),this._removeShadow(a)}},_setOpacity:function(a){this.group&&!this.group._transformDone?a.globalAlpha=this.getObjectOpacity():a.globalAlpha*=this.opacity},_setStrokeStyles:function(a,f){var d=f.stroke;d&&(a.lineWidth=f.strokeWidth,a.lineCap=f.strokeLineCap,a.lineDashOffset=f.strokeDashOffset,a.lineJoin=f.strokeLineJoin,a.miterLimit=f.strokeMiterLimit,d.toLive?d.gradientUnits==="percentage"||d.gradientTransform||d.patternTransform?this._applyPatternForTransformedGradient(a,d):(a.strokeStyle=d.toLive(a,this),this._applyPatternGradientTransform(a,d)):a.strokeStyle=f.stroke)},_setFillStyles:function(a,f){var d=f.fill;d&&(d.toLive?(a.fillStyle=d.toLive(a,this),this._applyPatternGradientTransform(a,f.fill)):a.fillStyle=d)},_setClippingProperties:function(a){a.globalAlpha=1,a.strokeStyle="transparent",a.fillStyle="#000000"},_setLineDash:function(a,f){!f||f.length===0||(1&f.length&&f.push.apply(f,f),a.setLineDash(f))},_renderControls:function(a,f){var d=this.getViewportTransform(),p=this.calcTransformMatrix(),m,y,x;f=f||{},y=typeof f.hasBorders<"u"?f.hasBorders:this.hasBorders,x=typeof f.hasControls<"u"?f.hasControls:this.hasControls,p=r.util.multiplyTransformMatrices(d,p),m=r.util.qrDecompose(p),a.save(),a.translate(m.translateX,m.translateY),a.lineWidth=1*this.borderScaleFactor,this.group||(a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(m.angle-=180),a.rotate(e(this.group?m.angle:this.angle)),f.forActiveSelection||this.group?y&&this.drawBordersInGroup(a,m,f):y&&this.drawBorders(a,f),x&&this.drawControls(a,f),a.restore()},_setShadow:function(a){if(this.shadow){var f=this.shadow,d=this.canvas,p,m=d&&d.viewportTransform[0]||1,y=d&&d.viewportTransform[3]||1;f.nonScaling?p={scaleX:1,scaleY:1}:p=this.getObjectScaling(),d&&d._isRetinaScaling()&&(m*=r.devicePixelRatio,y*=r.devicePixelRatio),a.shadowColor=f.color,a.shadowBlur=f.blur*r.browserShadowBlurConstant*(m+y)*(p.scaleX+p.scaleY)/4,a.shadowOffsetX=f.offsetX*m*p.scaleX,a.shadowOffsetY=f.offsetY*y*p.scaleY}},_removeShadow:function(a){this.shadow&&(a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0)},_applyPatternGradientTransform:function(a,f){if(!f||!f.toLive)return{offsetX:0,offsetY:0};var d=f.gradientTransform||f.patternTransform,p=-this.width/2+f.offsetX||0,m=-this.height/2+f.offsetY||0;return f.gradientUnits==="percentage"?a.transform(this.width,0,0,this.height,p,m):a.transform(1,0,0,1,p,m),d&&a.transform(d[0],d[1],d[2],d[3],d[4],d[5]),{offsetX:p,offsetY:m}},_renderPaintInOrder:function(a){this.paintFirst==="stroke"?(this._renderStroke(a),this._renderFill(a)):(this._renderFill(a),this._renderStroke(a))},_render:function(){},_renderFill:function(a){this.fill&&(a.save(),this._setFillStyles(a,this),this.fillRule==="evenodd"?a.fill("evenodd"):a.fill(),a.restore())},_renderStroke:function(a){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a),a.save(),this.strokeUniform&&this.group){var f=this.getObjectScaling();a.scale(1/f.scaleX,1/f.scaleY)}else this.strokeUniform&&a.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(a,this.strokeDashArray),this._setStrokeStyles(a,this),a.stroke(),a.restore()}},_applyPatternForTransformedGradient:function(a,f){var d=this._limitCacheSize(this._getCacheCanvasDimensions()),p=r.util.createCanvasElement(),m,y=this.canvas.getRetinaScaling(),x=d.x/this.scaleX/y,P=d.y/this.scaleY/y;p.width=Math.ceil(x),p.height=Math.ceil(P),m=p.getContext("2d"),m.beginPath(),m.moveTo(0,0),m.lineTo(x,0),m.lineTo(x,P),m.lineTo(0,P),m.closePath(),m.translate(x/2,P/2),m.scale(d.zoomX/this.scaleX/y,d.zoomY/this.scaleY/y),this._applyPatternGradientTransform(m,f),m.fillStyle=f.toLive(a),m.fill(),a.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),a.scale(y*this.scaleX/d.zoomX,y*this.scaleY/d.zoomY),a.strokeStyle=m.createPattern(p,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var a=r.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",a.scaleX),this.set("scaleY",a.scaleY),this.angle=a.angle,this.skewX=a.skewX,this.skewY=0}},_removeTransformMatrix:function(a){var f=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),f=r.util.transformPoint(f,this.transformMatrix)),this.transformMatrix=null,a&&(this.scaleX*=a.scaleX,this.scaleY*=a.scaleY,this.cropX=a.cropX,this.cropY=a.cropY,f.x+=a.offsetLeft,f.y+=a.offsetTop,this.width=a.width,this.height=a.height),this.setPositionByOrigin(f,"center","center")},clone:function(a,f){var d=this.toObject(f);this.constructor.fromObject?this.constructor.fromObject(d,a):r.Object._fromObject("Object",d,a)},cloneAsImage:function(a,f){var d=this.toCanvasElement(f);return a&&a(new r.Image(d)),this},toCanvasElement:function(a){a||(a={});var f=r.util,d=f.saveObjectTransform(this),p=this.group,m=this.shadow,y=Math.abs,x=(a.multiplier||1)*(a.enableRetinaScaling?r.devicePixelRatio:1);delete this.group,a.withoutTransform&&f.resetObjectTransform(this),a.withoutShadow&&(this.shadow=null);var P=r.util.createCanvasElement(),B=this.getBoundingRect(!0,!0),z=this.shadow,q,Z={x:0,y:0},rt,ot,et;z&&(rt=z.blur,z.nonScaling?q={scaleX:1,scaleY:1}:q=this.getObjectScaling(),Z.x=2*Math.round(y(z.offsetX)+rt)*y(q.scaleX),Z.y=2*Math.round(y(z.offsetY)+rt)*y(q.scaleY)),ot=B.width+Z.x,et=B.height+Z.y,P.width=Math.ceil(ot),P.height=Math.ceil(et);var nt=new r.StaticCanvas(P,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});a.format==="jpeg"&&(nt.backgroundColor="#fff"),this.setPositionByOrigin(new r.Point(nt.width/2,nt.height/2),"center","center");var at=this.canvas;nt.add(this);var st=nt.toCanvasElement(x||1,a);return this.shadow=m,this.set("canvas",at),p&&(this.group=p),this.set(d).setCoords(),nt._objects=[],nt.dispose(),nt=null,st},toDataURL:function(a){return a||(a={}),r.util.toDataURL(this.toCanvasElement(a),a.format||"png",a.quality||1)},isType:function(a){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===a},complexity:function(){return 1},toJSON:function(a){return this.toObject(a)},rotate:function(a){var f=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return f&&this._setOriginToCenter(),this.set("angle",a),f&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(a,f){f=f||this.canvas.getPointer(a);var d=new r.Point(f.x,f.y),p=this._getLeftTopCoords();return this.angle&&(d=r.util.rotatePoint(d,p,e(-this.angle))),{x:d.x-p.x,y:d.y-p.y}},_setupCompositeOperation:function(a){this.globalCompositeOperation&&(a.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){r.runningAnimations&&r.runningAnimations.cancelByTarget(this)}}),r.util.createAccessors&&r.util.createAccessors(r.Object),c(r.Object.prototype,r.Observable),r.Object.NUM_FRACTION_DIGITS=2,r.Object.ENLIVEN_PROPS=["clipPath"],r.Object._fromObject=function(a,f,d,p){var m=r[a];f=l(f,!0),r.util.enlivenPatterns([f.fill,f.stroke],function(y){typeof y[0]<"u"&&(f.fill=y[0]),typeof y[1]<"u"&&(f.stroke=y[1]),r.util.enlivenObjectEnlivables(f,f,function(){var x=p?new m(f[p],f):new m(f);d&&d(x)})})},r.Object.__uid=0)}(s),function(){var u=t.util.degreesToRadians,r={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(l,i,n,e,o){var h=l.x,a=l.y,f,d,p;return typeof i=="string"?i=r[i]:i-=.5,typeof e=="string"?e=r[e]:e-=.5,f=e-i,typeof n=="string"?n=c[n]:n-=.5,typeof o=="string"?o=c[o]:o-=.5,d=o-n,(f||d)&&(p=this._getTransformedDimensions(),h=l.x+f*p.x,a=l.y+d*p.y),new t.Point(h,a)},translateToCenterPoint:function(l,i,n){var e=this.translateToGivenOrigin(l,i,n,"center","center");return this.angle?t.util.rotatePoint(e,l,u(this.angle)):e},translateToOriginPoint:function(l,i,n){var e=this.translateToGivenOrigin(l,"center","center",i,n);return this.angle?t.util.rotatePoint(e,l,u(this.angle)):e},getCenterPoint:function(){var l=new t.Point(this.left,this.top);return this.translateToCenterPoint(l,this.originX,this.originY)},getPointByOrigin:function(l,i){var n=this.getCenterPoint();return this.translateToOriginPoint(n,l,i)},toLocalPoint:function(l,i,n){var e=this.getCenterPoint(),o,h;return typeof i<"u"&&typeof n<"u"?o=this.translateToGivenOrigin(e,"center","center",i,n):o=new t.Point(this.left,this.top),h=new t.Point(l.x,l.y),this.angle&&(h=t.util.rotatePoint(h,e,-u(this.angle))),h.subtractEquals(o)},setPositionByOrigin:function(l,i,n){var e=this.translateToCenterPoint(l,i,n),o=this.translateToOriginPoint(e,this.originX,this.originY);this.set("left",o.x),this.set("top",o.y)},adjustPosition:function(l){var i=u(this.angle),n=this.getScaledWidth(),e=t.util.cos(i)*n,o=t.util.sin(i)*n,h,a;typeof this.originX=="string"?h=r[this.originX]:h=this.originX-.5,typeof l=="string"?a=r[l]:a=l-.5,this.left+=e*(a-h),this.top+=o*(a-h),this.setCoords(),this.originX=l},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var l=this.getCenterPoint();this.originX="center",this.originY="center",this.left=l.x,this.top=l.y},_resetOrigin:function(){var l=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=l.x,this.top=l.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function u(n){return[new t.Point(n.tl.x,n.tl.y),new t.Point(n.tr.x,n.tr.y),new t.Point(n.br.x,n.br.y),new t.Point(n.bl.x,n.bl.y)]}var r=t.util,c=r.degreesToRadians,l=r.multiplyTransformMatrices,i=r.transformPoint;r.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(n,e){return e?n?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),n?this.aCoords:this.lineCoords)},getCoords:function(n,e){return u(this._getCoords(n,e))},intersectsWithRect:function(n,e,o,h){var a=this.getCoords(o,h),f=t.Intersection.intersectPolygonRectangle(a,n,e);return f.status==="Intersection"},intersectsWithObject:function(n,e,o){var h=t.Intersection.intersectPolygonPolygon(this.getCoords(e,o),n.getCoords(e,o));return h.status==="Intersection"||n.isContainedWithinObject(this,e,o)||this.isContainedWithinObject(n,e,o)},isContainedWithinObject:function(n,e,o){for(var h=this.getCoords(e,o),a=e?n.aCoords:n.lineCoords,f=0,d=n._getImageLines(a);f<4;f++)if(!n.containsPoint(h[f],d))return!1;return!0},isContainedWithinRect:function(n,e,o,h){var a=this.getBoundingRect(o,h);return a.left>=n.x&&a.left+a.width<=e.x&&a.top>=n.y&&a.top+a.height<=e.y},containsPoint:function(n,f,o,h){var a=this._getCoords(o,h),f=f||this._getImageLines(a),d=this._findCrossPoints(n,f);return d!==0&&d%2===1},isOnScreen:function(n){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,o=this.canvas.vptCoords.br,h=this.getCoords(!0,n);return h.some(function(a){return a.x<=o.x&&a.x>=e.x&&a.y<=o.y&&a.y>=e.y})||this.intersectsWithRect(e,o,!0,n)?!0:this._containsCenterOfCanvas(e,o,n)},_containsCenterOfCanvas:function(n,e,o){var h={x:(n.x+e.x)/2,y:(n.y+e.y)/2};return!!this.containsPoint(h,null,!0,o)},isPartiallyOnScreen:function(n){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,o=this.canvas.vptCoords.br;if(this.intersectsWithRect(e,o,!0,n))return!0;var h=this.getCoords(!0,n).every(function(a){return(a.x>=o.x||a.x<=e.x)&&(a.y>=o.y||a.y<=e.y)});return h&&this._containsCenterOfCanvas(e,o,n)},_getImageLines:function(n){var e={topline:{o:n.tl,d:n.tr},rightline:{o:n.tr,d:n.br},bottomline:{o:n.br,d:n.bl},leftline:{o:n.bl,d:n.tl}};return e},_findCrossPoints:function(n,e){var o,h,a,f,d,p=0,m;for(var y in e)if(m=e[y],!(m.o.y<n.y&&m.d.y<n.y)&&!(m.o.y>=n.y&&m.d.y>=n.y)&&(m.o.x===m.d.x&&m.o.x>=n.x?d=m.o.x:(o=0,h=(m.d.y-m.o.y)/(m.d.x-m.o.x),a=n.y-o*n.x,f=m.o.y-h*m.o.x,d=-(a-f)/(o-h)),d>=n.x&&(p+=1),p===2))break;return p},getBoundingRect:function(n,e){var o=this.getCoords(n,e);return r.makeBoundingBoxFromPoints(o)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(n){return Math.abs(n)<this.minScaleLimit?n<0?-this.minScaleLimit:this.minScaleLimit:n===0?1e-4:n},scale:function(n){return this._set("scaleX",n),this._set("scaleY",n),this.setCoords()},scaleToWidth:function(n,e){var o=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(n/this.width/o)},scaleToHeight:function(n,e){var o=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(n/this.height/o)},calcLineCoords:function(){var n=this.getViewportTransform(),e=this.padding,o=c(this.angle),h=r.cos(o),a=r.sin(o),f=h*e,d=a*e,p=f+d,m=f-d,y=this.calcACoords(),x={tl:i(y.tl,n),tr:i(y.tr,n),bl:i(y.bl,n),br:i(y.br,n)};return e&&(x.tl.x-=m,x.tl.y-=p,x.tr.x+=p,x.tr.y-=m,x.bl.x-=p,x.bl.y+=m,x.br.x+=m,x.br.y+=p),x},calcOCoords:function(){var n=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),o=this.getViewportTransform(),h=l(o,e),a=l(h,n),a=l(a,[1/o[0],0,0,1/o[3],0,0]),f=this._calculateCurrentDimensions(),d={};return this.forEachControl(function(p,m,y){d[m]=p.positionHandler(f,a,y)}),d},calcACoords:function(){var n=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),o=l(e,n),h=this._getTransformedDimensions(),a=h.x/2,f=h.y/2;return{tl:i({x:-a,y:-f},o),tr:i({x:a,y:-f},o),bl:i({x:-a,y:f},o),br:i({x:a,y:f},o)}},setCoords:function(n){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),n?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return r.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var n=this.getCenterPoint();return[1,0,0,1,n.x,n.y]},transformMatrixKey:function(n){var e="_",o="";return!n&&this.group&&(o=this.group.transformMatrixKey(n)+e),o+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.originX+e+this.originY+e+this.width+e+this.height+e+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(n){var e=this.calcOwnMatrix();if(n||!this.group)return e;var o=this.transformMatrixKey(n),h=this.matrixCache||(this.matrixCache={});return h.key===o?h.value:(this.group&&(e=l(this.group.calcTransformMatrix(!1),e)),h.key=o,h.value=e,e)},calcOwnMatrix:function(){var n=this.transformMatrixKey(!0),e=this.ownMatrixCache||(this.ownMatrixCache={});if(e.key===n)return e.value;var o=this._calcTranslateMatrix(),h={angle:this.angle,translateX:o[4],translateY:o[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return e.key=n,e.value=r.composeMatrix(h),e.value},_getNonTransformedDimensions:function(){var n=this.strokeWidth,e=this.width+n,o=this.height+n;return{x:e,y:o}},_getTransformedDimensions:function(n,e){typeof n>"u"&&(n=this.skewX),typeof e>"u"&&(e=this.skewY);var o,h,a,f=n===0&&e===0;if(this.strokeUniform?(h=this.width,a=this.height):(o=this._getNonTransformedDimensions(),h=o.x,a=o.y),f)return this._finalizeDimensions(h*this.scaleX,a*this.scaleY);var d=r.sizeAfterTransform(h,a,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:n,skewY:e});return this._finalizeDimensions(d.x,d.y)},_finalizeDimensions:function(n,e){return this.strokeUniform?{x:n+this.strokeWidth,y:e+this.strokeWidth}:{x:n,y:e}},_calculateCurrentDimensions:function(){var n=this.getViewportTransform(),e=this._getTransformedDimensions(),o=i(e,n,!0);return o.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(u){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,u):this.canvas&&this.canvas.sendBackwards(this,u),this},bringForward:function(u){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,u):this.canvas&&this.canvas.bringForward(this,u),this},moveTo:function(u){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,u):this.canvas&&this.canvas.moveTo(this,u),this}}),function(){function u(c,l){if(l){if(l.toLive)return c+": url(#SVGID_"+l.id+"); ";var i=new t.Color(l),n=c+": "+i.toRgb()+"; ",e=i.getAlpha();return e!==1&&(n+=c+"-opacity: "+e.toString()+"; "),n}else return c+": none; "}var r=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(c){var l=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"none",e=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",h=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",f=typeof this.opacity<"u"?this.opacity:"1",d=this.visible?"":" visibility: hidden;",p=c?"":this.getSvgFilter(),m=u("fill",this.fill),y=u("stroke",this.stroke);return[y,"stroke-width: ",i,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",e,"; ","stroke-linejoin: ",h,"; ","stroke-miterlimit: ",a,"; ",m,"fill-rule: ",l,"; ","opacity: ",f,";",p,d].join("")},getSvgSpanStyles:function(c,l){var i="; ",e=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+i:"",n=c.strokeWidth?"stroke-width: "+c.strokeWidth+i:"",e=e,o=c.fontSize?"font-size: "+c.fontSize+"px"+i:"",h=c.fontStyle?"font-style: "+c.fontStyle+i:"",a=c.fontWeight?"font-weight: "+c.fontWeight+i:"",f=c.fill?u("fill",c.fill):"",d=c.stroke?u("stroke",c.stroke):"",p=this.getSvgTextDecoration(c),m=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return p&&(p="text-decoration: "+p+i),[d,n,e,o,h,a,p,f,m,l?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(l){return c[l.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,l){var i=c?this.calcTransformMatrix():this.calcOwnMatrix(),n='transform="'+t.util.matrixToSVG(i);return n+(l||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var l=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',r(-this.width/2,l),'" y="',r(-this.height/2,l),'" width="',r(this.width,l),'" height="',r(this.height,l),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,l){l=l||{};var i=l.reviver,n=l.additionalTransform||"",e=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),o=c.indexOf("COMMON_PARTS");return c[o]=e,i?i(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,l){l=l||{};var i=l.noStyle,n=l.reviver,e=i?"":'style="'+this.getSvgStyles()+'" ',o=l.withShadow?'style="'+this.getSvgFilter()+'" ':"",h=this.clipPath,a=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",f=h&&h.absolutePositioned,d=this.stroke,p=this.fill,m=this.shadow,y,x=[],P,B=c.indexOf("COMMON_PARTS"),z=l.additionalTransform;return h&&(h.clipPathId="CLIPPATH_"+t.Object.__uid++,P='<clipPath id="'+h.clipPathId+`" >
`+h.toClipPathSVG(n)+`</clipPath>
`),f&&x.push("<g ",o,this.getSvgCommons(),` >
`),x.push("<g ",this.getSvgTransform(!1),f?"":o+this.getSvgCommons(),` >
`),y=[e,a,i?"":this.addPaintOrder()," ",z?'transform="'+z+'" ':""].join(""),c[B]=y,p&&p.toLive&&x.push(p.toSVG(this)),d&&d.toLive&&x.push(d.toSVG(this)),m&&x.push(m.toSVG(this)),h&&x.push(P),x.push(c.join("")),x.push(`</g>
`),f&&x.push(`</g>
`),n?n(x.join("")):x.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var u=t.util.object.extend,r="stateProperties";function c(i,n,e){var o={},h=!0;e.forEach(function(a){o[a]=i[a]}),u(i[n],o,h)}function l(i,n,e){if(i===n)return!0;if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(var o=0,h=i.length;o<h;o++)if(!l(i[o],n[o]))return!1;return!0}else if(i&&typeof i=="object"){var a=Object.keys(i),f;if(!n||typeof n!="object"||!e&&a.length!==Object.keys(n).length)return!1;for(var o=0,h=a.length;o<h;o++)if(f=a[o],!(f==="canvas"||f==="group")&&!l(i[f],n[f]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(i){i=i||r;var n="_"+i;return Object.keys(this[n]).length<this[i].length?!0:!l(this[n],this,!0)},saveState:function(i){var n=i&&i.propertySet||r,e="_"+n;return this[e]?(c(this,e,this[n]),i&&i.stateProperties&&c(this,e,i.stateProperties),this):this.setupState(i)},setupState:function(i){i=i||{};var n=i.propertySet||r;return i.propertySet=n,this["_"+n]={},this.saveState(i),this}})}(),function(){var u=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(r,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var l=r.x,i=r.y,n,e,o=Object.keys(this.oCoords),h=o.length-1,a;for(this.__corner=0;h>=0;h--)if(a=o[h],!!this.isControlVisible(a)&&(e=this._getImageLines(c?this.oCoords[a].touchCorner:this.oCoords[a].corner),n=this._findCrossPoints({x:l,y:i},e),n!==0&&n%2===1))return this.__corner=a,a;return!1},forEachControl:function(r){for(var c in this.controls)r(this.controls[c],c,this)},_setCornerCoords:function(){var r=this.oCoords;for(var c in r){var l=this.controls[c];r[c].corner=l.calcCornerCoords(this.angle,this.cornerSize,r[c].x,r[c].y,!1),r[c].touchCorner=l.calcCornerCoords(this.angle,this.touchCornerSize,r[c].x,r[c].y,!0)}},drawSelectionBackground:function(r){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;r.save();var c=this.getCenterPoint(),l=this._calculateCurrentDimensions(),i=this.canvas.viewportTransform;return r.translate(c.x,c.y),r.scale(1/i[0],1/i[3]),r.rotate(u(this.angle)),r.fillStyle=this.selectionBackgroundColor,r.fillRect(-l.x/2,-l.y/2,l.x,l.y),r.restore(),this},drawBorders:function(r,c){c=c||{};var l=this._calculateCurrentDimensions(),i=this.borderScaleFactor,n=l.x+i,e=l.y+i,o=typeof c.hasControls<"u"?c.hasControls:this.hasControls,h=!1;return r.save(),r.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(r,c.borderDashArray||this.borderDashArray),r.strokeRect(-n/2,-e/2,n,e),o&&(r.beginPath(),this.forEachControl(function(a,f,d){a.withConnection&&a.getVisibility(d,f)&&(h=!0,r.moveTo(a.x*n,a.y*e),r.lineTo(a.x*n+a.offsetX,a.y*e+a.offsetY))}),h&&r.stroke()),r.restore(),this},drawBordersInGroup:function(r,c,l){l=l||{};var i=t.util.sizeAfterTransform(this.width,this.height,c),n=this.strokeWidth,e=this.strokeUniform,o=this.borderScaleFactor,h=i.x+n*(e?this.canvas.getZoom():c.scaleX)+o,a=i.y+n*(e?this.canvas.getZoom():c.scaleY)+o;return r.save(),this._setLineDash(r,l.borderDashArray||this.borderDashArray),r.strokeStyle=l.borderColor||this.borderColor,r.strokeRect(-h/2,-a/2,h,a),r.restore(),this},drawControls:function(r,c){c=c||{},r.save();var l=1,i,n;return this.canvas&&(l=this.canvas.getRetinaScaling()),r.setTransform(l,0,0,l,0,0),r.strokeStyle=r.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(r.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(r,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(i=this.group.calcTransformMatrix()),this.forEachControl(function(e,o,h){n=h.oCoords[o],e.getVisibility(h,o)&&(i&&(n=t.util.transformPoint(n,i)),e.render(r,n.x,n.y,c,h))}),r.restore(),this},isControlVisible:function(r){return this.controls[r]&&this.controls[r].getVisibility(this,r)},setControlVisible:function(r,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[r]=c,this},setControlsVisibility:function(r){r||(r={});for(var c in r)this.setControlVisible(c,r[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(u,r){r=r||{};var c=function(){},l=r.onComplete||c,i=r.onChange||c,n=this;return t.util.animate({target:this,startValue:u.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(e){u.set("left",e),n.requestRenderAll(),i()},onComplete:function(){u.setCoords(),l()}})},fxCenterObjectV:function(u,r){r=r||{};var c=function(){},l=r.onComplete||c,i=r.onChange||c,n=this;return t.util.animate({target:this,startValue:u.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(e){u.set("top",e),n.requestRenderAll(),i()},onComplete:function(){u.setCoords(),l()}})},fxRemove:function(u,r){r=r||{};var c=function(){},l=r.onComplete||c,i=r.onChange||c,n=this;return t.util.animate({target:this,startValue:u.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){u.set("opacity",e),n.requestRenderAll(),i()},onComplete:function(){n.remove(u),l()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var u=[],r,c,l=[];for(r in arguments[0])u.push(r);for(var i=0,n=u.length;i<n;i++)r=u[i],c=i!==n-1,l.push(this._animate(r,arguments[0][r],arguments[1],c));return l}else return this._animate.apply(this,arguments)},_animate:function(u,r,c,l){var i=this,n;r=r.toString(),c?c=t.util.object.clone(c):c={},~u.indexOf(".")&&(n=u.split("."));var e=i.colorProperties.indexOf(u)>-1||n&&i.colorProperties.indexOf(n[1])>-1,o=n?this.get(n[0])[n[1]]:this.get(u);"from"in c||(c.from=o),e||(~r.indexOf("=")?r=o+parseFloat(r.replace("=","")):r=parseFloat(r));var h={target:this,startValue:c.from,endValue:r,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(a,f,d){return c.abort.call(i,a,f,d)},onChange:function(a,f,d){n?i[n[0]][n[1]]=a:i.set(u,a),!l&&c.onChange&&c.onChange(a,f,d)},onComplete:function(a,f,d){l||(i.setCoords(),c.onComplete&&c.onComplete(a,f,d))}};return e?t.util.animateColor(h.startValue,h.endValue,h.duration,h):t.util.animate(h)}}),function(u){var r=u.fabric||(u.fabric={}),c=r.util.object.extend,l=r.util.object.clone,i={x1:1,x2:1,y1:1,y2:1};if(r.Line){r.warn("fabric.Line is already defined");return}r.Line=r.util.createClass(r.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:r.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(e,o){e||(e=[0,0,0,0]),this.callSuper("initialize",o),this.set("x1",e[0]),this.set("y1",e[1]),this.set("x2",e[2]),this.set("y2",e[3]),this._setWidthHeight(o)},_setWidthHeight:function(e){e||(e={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in e?e.left:this._getLeftToOriginX(),this.top="top"in e?e.top:this._getTopToOriginY()},_set:function(e,o){return this.callSuper("_set",e,o),typeof i[e]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:n({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:n({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(e){e.beginPath();var o=this.calcLinePoints();e.moveTo(o.x1,o.y1),e.lineTo(o.x2,o.y2),e.lineWidth=this.strokeWidth;var h=e.strokeStyle;e.strokeStyle=this.stroke||e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=h},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(e){return c(this.callSuper("toObject",e),this.calcLinePoints())},_getNonTransformedDimensions:function(){var e=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e},calcLinePoints:function(){var e=this.x1<=this.x2?-1:1,o=this.y1<=this.y2?-1:1,h=e*this.width*.5,a=o*this.height*.5,f=e*this.width*-.5,d=o*this.height*-.5;return{x1:h,x2:f,y1:a,y2:d}},_toSVG:function(){var e=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',e.x1,'" y1="',e.y1,'" x2="',e.x2,'" y2="',e.y2,`" />
`]}}),r.Line.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),r.Line.fromElement=function(e,o,h){h=h||{};var a=r.parseAttributes(e,r.Line.ATTRIBUTE_NAMES),f=[a.x1||0,a.y1||0,a.x2||0,a.y2||0];o(new r.Line(f,c(a,h)))},r.Line.fromObject=function(e,o){function h(f){delete f.points,o&&o(f)}var a=l(e,!0);a.points=[e.x1,e.y1,e.x2,e.y2],r.Object._fromObject("Line",a,h,"points")};function n(e,o){var h=e.origin,a=e.axis1,f=e.axis2,d=e.dimension,p=o.nearest,m=o.center,y=o.farthest;return function(){switch(this.get(h)){case p:return Math.min(this.get(a),this.get(f));case m:return Math.min(this.get(a),this.get(f))+.5*this.get(d);case y:return Math.max(this.get(a),this.get(f))}}}}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.degreesToRadians;if(r.Circle){r.warn("fabric.Circle is already defined.");return}r.Circle=r.util.createClass(r.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:r.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(i,n){return this.callSuper("_set",i,n),i==="radius"&&this.setRadius(n),this},toObject:function(i){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(i))},_toSVG:function(){var i,n=0,e=0,o=(this.endAngle-this.startAngle)%360;if(o===0)i=["<circle ","COMMON_PARTS",'cx="'+n+'" cy="'+e+'" ','r="',this.radius,`" />
`];else{var h=c(this.startAngle),a=c(this.endAngle),f=this.radius,d=r.util.cos(h)*f,p=r.util.sin(h)*f,m=r.util.cos(a)*f,y=r.util.sin(a)*f,x=o>180?"1":"0";i=['<path d="M '+d+" "+p," A "+f+" "+f," 0 ",+x+" 1"," "+m+" "+y,'" ',"COMMON_PARTS",` />
`]}return i},_render:function(i){i.beginPath(),i.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(i)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(i){return this.radius=i,this.set("width",i*2).set("height",i*2)}}),r.Circle.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),r.Circle.fromElement=function(i,n){var e=r.parseAttributes(i,r.Circle.ATTRIBUTE_NAMES);if(!l(e))throw new Error("value of `r` attribute is required and can not be negative");e.left=(e.left||0)-e.radius,e.top=(e.top||0)-e.radius,n(new r.Circle(e))};function l(i){return"radius"in i&&i.radius>=0}r.Circle.fromObject=function(i,n){r.Object._fromObject("Circle",i,n)}}(s),function(u){var r=u.fabric||(u.fabric={});if(r.Triangle){r.warn("fabric.Triangle is already defined");return}r.Triangle=r.util.createClass(r.Object,{type:"triangle",width:100,height:100,_render:function(c){var l=this.width/2,i=this.height/2;c.beginPath(),c.moveTo(-l,i),c.lineTo(0,-i),c.lineTo(l,i),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,l=this.height/2,i=[-c+" "+l,"0 "+-l,c+" "+l].join(",");return["<polygon ","COMMON_PARTS",'points="',i,'" />']}}),r.Triangle.fromObject=function(c,l){return r.Object._fromObject("Triangle",c,l)}}(s),function(u){var r=u.fabric||(u.fabric={}),c=Math.PI*2;if(r.Ellipse){r.warn("fabric.Ellipse is already defined.");return}r.Ellipse=r.util.createClass(r.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:r.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this.set("rx",l&&l.rx||0),this.set("ry",l&&l.ry||0)},_set:function(l,i){switch(this.callSuper("_set",l,i),l){case"rx":this.rx=i,this.set("width",i*2);break;case"ry":this.ry=i,this.set("height",i*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(l){l.beginPath(),l.save(),l.transform(1,0,0,this.ry/this.rx,0,0),l.arc(0,0,this.rx,0,c,!1),l.restore(),this._renderPaintInOrder(l)}}),r.Ellipse.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),r.Ellipse.fromElement=function(l,i){var n=r.parseAttributes(l,r.Ellipse.ATTRIBUTE_NAMES);n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,i(new r.Ellipse(n))},r.Ellipse.fromObject=function(l,i){r.Object._fromObject("Ellipse",l,i)}}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.object.extend;if(r.Rect){r.warn("fabric.Rect is already defined");return}r.Rect=r.util.createClass(r.Object,{stateProperties:r.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:r.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(l){var i=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,e=this.width,o=this.height,h=-this.width/2,a=-this.height/2,f=i!==0||n!==0,d=1-.5522847498;l.beginPath(),l.moveTo(h+i,a),l.lineTo(h+e-i,a),f&&l.bezierCurveTo(h+e-d*i,a,h+e,a+d*n,h+e,a+n),l.lineTo(h+e,a+o-n),f&&l.bezierCurveTo(h+e,a+o-d*n,h+e-d*i,a+o,h+e-i,a+o),l.lineTo(h+i,a+o),f&&l.bezierCurveTo(h+d*i,a+o,h,a+o-d*n,h,a+o-n),l.lineTo(h,a+n),f&&l.bezierCurveTo(h,a+d*n,h+d*i,a,h+i,a),l.closePath(),this._renderPaintInOrder(l)},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){var l=-this.width/2,i=-this.height/2;return["<rect ","COMMON_PARTS",'x="',l,'" y="',i,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),r.Rect.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),r.Rect.fromElement=function(l,i,n){if(!l)return i(null);n=n||{};var e=r.parseAttributes(l,r.Rect.ATTRIBUTE_NAMES);e.left=e.left||0,e.top=e.top||0,e.height=e.height||0,e.width=e.width||0;var o=new r.Rect(c(n?r.util.object.clone(n):{},e));o.visible=o.visible&&o.width>0&&o.height>0,i(o)},r.Rect.fromObject=function(l,i){return r.Object._fromObject("Rect",l,i)}}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.object.extend,l=r.util.array.min,i=r.util.array.max,n=r.util.toFixed,e=r.util.projectStrokeOnPoints;if(r.Polyline){r.warn("fabric.Polyline is already defined");return}r.Polyline=r.util.createClass(r.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:r.Object.prototype.cacheProperties.concat("points"),initialize:function(o,h){h=h||{},this.points=o||[],this.callSuper("initialize",h),this._setPositionDimensions(h)},_projectStrokeOnPoints:function(){return e(this.points,this,!0)},_setPositionDimensions:function(o){var h=this._calcDimensions(o),a,f=this.exactBoundingBox?this.strokeWidth:0;this.width=h.width-f,this.height=h.height-f,o.fromSVG||(a=this.translateToGivenOrigin({x:h.left-this.strokeWidth/2+f/2,y:h.top-this.strokeWidth/2+f/2},"left","top",this.originX,this.originY)),typeof o.left>"u"&&(this.left=o.fromSVG?h.left:a.x),typeof o.top>"u"&&(this.top=o.fromSVG?h.top:a.y),this.pathOffset={x:h.left+this.width/2+f/2,y:h.top+this.height/2+f/2}},_calcDimensions:function(){var o=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,h=l(o,"x")||0,a=l(o,"y")||0,f=i(o,"x")||0,d=i(o,"y")||0,p=f-h,m=d-a;return{left:h,top:a,width:p,height:m}},toObject:function(o){return c(this.callSuper("toObject",o),{points:this.points.concat()})},_toSVG:function(){for(var o=[],h=this.pathOffset.x,a=this.pathOffset.y,f=r.Object.NUM_FRACTION_DIGITS,d=0,p=this.points.length;d<p;d++)o.push(n(this.points[d].x-h,f),",",n(this.points[d].y-a,f)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',o.join(""),`" />
`]},commonRender:function(o){var h,a=this.points.length,f=this.pathOffset.x,d=this.pathOffset.y;if(!a||isNaN(this.points[a-1].y))return!1;o.beginPath(),o.moveTo(this.points[0].x-f,this.points[0].y-d);for(var p=0;p<a;p++)h=this.points[p],o.lineTo(h.x-f,h.y-d);return!0},_render:function(o){this.commonRender(o)&&this._renderPaintInOrder(o)},complexity:function(){return this.get("points").length}}),r.Polyline.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(),r.Polyline.fromElementGenerator=function(o){return function(h,a,f){if(!h)return a(null);f||(f={});var d=r.parsePointsAttribute(h.getAttribute("points")),p=r.parseAttributes(h,r[o].ATTRIBUTE_NAMES);p.fromSVG=!0,a(new r[o](d,c(p,f)))}},r.Polyline.fromElement=r.Polyline.fromElementGenerator("Polyline"),r.Polyline.fromObject=function(o,h){return r.Object._fromObject("Polyline",o,h,"points")}}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.projectStrokeOnPoints;if(r.Polygon){r.warn("fabric.Polygon is already defined");return}r.Polygon=r.util.createClass(r.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(l){this.commonRender(l)&&(l.closePath(),this._renderPaintInOrder(l))}}),r.Polygon.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(),r.Polygon.fromElement=r.Polyline.fromElementGenerator("Polygon"),r.Polygon.fromObject=function(l,i){r.Object._fromObject("Polygon",l,i,"points")}}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.array.min,l=r.util.array.max,i=r.util.object.extend,n=r.util.object.clone,e=r.util.toFixed;if(r.Path){r.warn("fabric.Path is already defined");return}r.Path=r.util.createClass(r.Object,{type:"path",path:null,cacheProperties:r.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:r.Object.prototype.stateProperties.concat("path"),initialize:function(o,h){h=n(h||{}),delete h.path,this.callSuper("initialize",h),this._setPath(o||[],h)},_setPath:function(o,h){this.path=r.util.makePathSimpler(Array.isArray(o)?o:r.util.parsePath(o)),r.Polyline.prototype._setPositionDimensions.call(this,h||{})},_renderPathCommands:function(o){var h,a=0,f=0,d=0,p=0,m=0,y=0,x=-this.pathOffset.x,P=-this.pathOffset.y;o.beginPath();for(var B=0,z=this.path.length;B<z;++B)switch(h=this.path[B],h[0]){case"L":d=h[1],p=h[2],o.lineTo(d+x,p+P);break;case"M":d=h[1],p=h[2],a=d,f=p,o.moveTo(d+x,p+P);break;case"C":d=h[5],p=h[6],m=h[3],y=h[4],o.bezierCurveTo(h[1]+x,h[2]+P,m+x,y+P,d+x,p+P);break;case"Q":o.quadraticCurveTo(h[1]+x,h[2]+P,h[3]+x,h[4]+P),d=h[3],p=h[4],m=h[1],y=h[2];break;case"z":case"Z":d=a,p=f,o.closePath();break}},_render:function(o){this._renderPathCommands(o),this._renderPaintInOrder(o)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(o){return i(this.callSuper("toObject",o),{path:this.path.map(function(h){return h.slice()})})},toDatalessObject:function(o){var h=this.toObject(["sourcePath"].concat(o));return h.sourcePath&&delete h.path,h},_toSVG:function(){var o=r.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',o,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var o=r.Object.NUM_FRACTION_DIGITS;return" translate("+e(-this.pathOffset.x,o)+", "+e(-this.pathOffset.y,o)+")"},toClipPathSVG:function(o){var h=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:o,additionalTransform:h})},toSVG:function(o){var h=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:o,additionalTransform:h})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var o=[],h=[],a,f=0,d=0,p=0,m=0,y,x=0,P=this.path.length;x<P;++x){switch(a=this.path[x],a[0]){case"L":p=a[1],m=a[2],y=[];break;case"M":p=a[1],m=a[2],f=p,d=m,y=[];break;case"C":y=r.util.getBoundsOfCurve(p,m,a[1],a[2],a[3],a[4],a[5],a[6]),p=a[5],m=a[6];break;case"Q":y=r.util.getBoundsOfCurve(p,m,a[1],a[2],a[1],a[2],a[3],a[4]),p=a[3],m=a[4];break;case"z":case"Z":p=f,m=d;break}y.forEach(function(et){o.push(et.x),h.push(et.y)}),o.push(p),h.push(m)}var B=c(o)||0,z=c(h)||0,q=l(o)||0,Z=l(h)||0,rt=q-B,ot=Z-z;return{left:B,top:z,width:rt,height:ot}}}),r.Path.fromObject=function(o,h){if(typeof o.sourcePath=="string"){var a=o.sourcePath;r.loadSVGFromURL(a,function(f){var d=f[0];d.setOptions(o),o.clipPath?r.util.enlivenObjects([o.clipPath],function(p){d.clipPath=p[0],h&&h(d)}):h&&h(d)})}else r.Object._fromObject("Path",o,h,"path")},r.Path.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(["d"]),r.Path.fromElement=function(o,h,a){var f=r.parseAttributes(o,r.Path.ATTRIBUTE_NAMES);f.fromSVG=!0,h(new r.Path(f.d,i(f,a)))}}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.array.min,l=r.util.array.max;r.Group||(r.Group=r.util.createClass(r.Object,r.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(i,n,e){n=n||{},this._objects=[],e&&this.callSuper("initialize",n),this._objects=i||[];for(var o=this._objects.length;o--;)this._objects[o].group=this;if(e)this._updateObjectsACoords();else{var h=n&&n.centerPoint;n.originX!==void 0&&(this.originX=n.originX),n.originY!==void 0&&(this.originY=n.originY),h||this._calcBounds(),this._updateObjectsCoords(h),delete n.centerPoint,this.callSuper("initialize",n)}this.setCoords()},_updateObjectsACoords:function(){for(var i=!0,n=this._objects.length;n--;)this._objects[n].setCoords(i)},_updateObjectsCoords:function(n){for(var n=n||this.getCenterPoint(),e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],n)},_updateObjectCoords:function(i,n){var e=i.left,o=i.top,h=!0;i.set({left:e-n.x,top:o-n.y}),i.group=this,i.setCoords(h)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(i){var n=!!this.group;return this._restoreObjectsState(),r.util.resetObjectTransform(this),i&&(n&&r.util.removeTransformFromObject(i,this.group.calcTransformMatrix()),this._objects.push(i),i.group=this,i._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,n?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(i){return this._restoreObjectsState(),r.util.resetObjectTransform(this),this.remove(i),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(i){this.dirty=!0,i.group=this,i._set("canvas",this.canvas)},_onObjectRemoved:function(i){this.dirty=!0,delete i.group},_set:function(i,n){var e=this._objects.length;if(this.useSetOnGroup)for(;e--;)this._objects[e].setOnGroup(i,n);if(i==="canvas")for(;e--;)this._objects[e]._set(i,n);r.Object.prototype._set.call(this,i,n)},toObject:function(i){var n=this.includeDefaultValues,e=this._objects.filter(function(h){return!h.excludeFromExport}).map(function(h){var a=h.includeDefaultValues;h.includeDefaultValues=n;var f=h.toObject(i);return h.includeDefaultValues=a,f}),o=r.Object.prototype.toObject.call(this,i);return o.objects=e,o},toDatalessObject:function(i){var n,e=this.sourcePath;if(e)n=e;else{var o=this.includeDefaultValues;n=this._objects.map(function(a){var f=a.includeDefaultValues;a.includeDefaultValues=o;var d=a.toDatalessObject(i);return a.includeDefaultValues=f,d})}var h=r.Object.prototype.toDatalessObject.call(this,i);return h.objects=n,h},render:function(i){this._transformDone=!0,this.callSuper("render",i),this._transformDone=!1},shouldCache:function(){var i=r.Object.prototype.shouldCache.call(this);if(i){for(var n=0,e=this._objects.length;n<e;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1}return i},willDrawShadow:function(){if(r.Object.prototype.willDrawShadow.call(this))return!0;for(var i=0,n=this._objects.length;i<n;i++)if(this._objects[i].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(i){for(var n=0,e=this._objects.length;n<e;n++)this._objects[n].render(i);this._drawClipPath(i,this.clipPath)},isCacheDirty:function(i){if(this.callSuper("isCacheDirty",i))return!0;if(!this.statefullCache)return!1;for(var n=0,e=this._objects.length;n<e;n++)if(this._objects[n].isCacheDirty(!0)){if(this._cacheCanvas){var o=this.cacheWidth/this.zoomX,h=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-o/2,-h/2,o,h)}return!0}return!1},_restoreObjectsState:function(){var i=this.calcOwnMatrix();return this._objects.forEach(function(n){r.util.addTransformToObject(n,i),delete n.group,n.setCoords()}),this},destroy:function(){return this._objects.forEach(function(i){i.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(i){i.dispose&&i.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var i=this._objects,n=this.canvas;this._objects=[];var e=this.toObject();delete e.objects;var o=new r.ActiveSelection([]);return o.set(e),o.type="activeSelection",n.remove(this),i.forEach(function(h){h.group=o,h.dirty=!0,n.add(h)}),o.canvas=n,o._objects=i,n._activeObject=o,o.setCoords(),o}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var i=!0;return this.forEachObject(function(n){n.setCoords(i)}),this},_calcBounds:function(i){for(var n=[],e=[],o,h,a,f=["tr","br","bl","tl"],d=0,p=this._objects.length,m,y=f.length;d<p;++d){for(o=this._objects[d],a=o.calcACoords(),m=0;m<y;m++)h=f[m],n.push(a[h].x),e.push(a[h].y);o.aCoords=a}this._getBounds(n,e,i)},_getBounds:function(i,n,e){var o=new r.Point(c(i),c(n)),h=new r.Point(l(i),l(n)),a=o.y||0,f=o.x||0,d=h.x-o.x||0,p=h.y-o.y||0;this.width=d,this.height=p,e||this.setPositionByOrigin({x:f,y:a},"left","top")},_toSVG:function(i){for(var n=["<g ","COMMON_PARTS",` >
`],e=0,o=this._objects.length;e<o;e++)n.push("		",this._objects[e].toSVG(i));return n.push(`</g>
`),n},getSvgStyles:function(){var i=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",n=this.visible?"":" visibility: hidden;";return[i,this.getSvgFilter(),n].join("")},toClipPathSVG:function(i){for(var n=[],e=0,o=this._objects.length;e<o;e++)n.push("	",this._objects[e].toClipPathSVG(i));return this._createBaseClipPathSVGMarkup(n,{reviver:i})}}),r.Group.fromObject=function(i,n){var e=i.objects,o=r.util.object.clone(i,!0);if(delete o.objects,typeof e=="string"){r.loadSVGFromURL(e,function(h){var a=r.util.groupSVGElements(h,i,e),f=o.clipPath;delete o.clipPath,a.set(o),f?r.util.enlivenObjects([f],function(d){a.clipPath=d[0],n&&n(a)}):n&&n(a)});return}r.util.enlivenObjects(e,function(h){r.util.enlivenObjectEnlivables(i,o,function(){n&&n(new r.Group(h,o,!0))})})})}(s),function(u){var r=u.fabric||(u.fabric={});r.ActiveSelection||(r.ActiveSelection=r.util.createClass(r.Group,{type:"activeSelection",initialize:function(c,l){l=l||{},this._objects=c||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;l.originX&&(this.originX=l.originX),l.originY&&(this.originY=l.originY),this._calcBounds(),this._updateObjectsCoords(),r.Object.prototype.initialize.call(this,l),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var l=r.Object.prototype.toObject.call(this),i=new r.Group([]);if(delete l.type,i.set(l),c.forEach(function(e){e.canvas.remove(e),e.group=i}),i._objects=c,!this.canvas)return i;var n=this.canvas;return n.add(i),n._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,l,i){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,i=i||{},typeof i.hasControls>"u"&&(i.hasControls=!1),i.forActiveSelection=!0;for(var n=0,e=this._objects.length;n<e;n++)this._objects[n]._renderControls(c,i);this.callSuper("_renderControls",c,l),c.restore()}}),r.ActiveSelection.fromObject=function(c,l){r.util.enlivenObjects(c.objects,function(i){delete c.objects,l&&l(new r.ActiveSelection(i,c,!0))})})}(s),function(u){var r=t.util.object.extend;if(u.fabric||(u.fabric={}),u.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,l){l||(l={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",l),this._initElement(c,l)},getElement:function(){return this._element||{}},setElement:function(c,l){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(l),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var l=t.filterBackend;l&&l.evictCachesForKey&&l.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(c){t.util.cleanUpJsdomNode(this[c]),this[c]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var l=this.width/2,i=this.height/2;c.beginPath(),c.moveTo(-l,-i),c.lineTo(l,-i),c.lineTo(l,i),c.lineTo(-l,i),c.lineTo(-l,-i),c.closePath()}},toObject:function(c){var l=[];this.filters.forEach(function(n){n&&l.push(n.toObject())});var i=r(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:l});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],l=[],i,n=this._element,e=-this.width/2,o=-this.height/2,h="",a="";if(!n)return[];if(this.hasCrop()){var f=t.Object.__uid++;c.push('<clipPath id="imageCrop_'+f+`">
`,'	<rect x="'+e+'" y="'+o+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),h=' clip-path="url(#imageCrop_'+f+')" '}if(this.imageSmoothing||(a='" image-rendering="optimizeSpeed'),l.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',e-this.cropX,'" y="',o-this.cropY,'" width="',n.width||n.naturalWidth,'" height="',n.height||n.height,a,'"',h,`></image>
`),this.stroke||this.strokeDashArray){var d=this.fill;this.fill=null,i=["	<rect ",'x="',e,'" y="',o,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=d}return this.paintFirst!=="fill"?c=c.concat(i,l):c=c.concat(l,i),c},getSrc:function(c){var l=c?this._element:this._originalElement;return l?l.toDataURL?l.toDataURL():this.srcFromAttribute?l.getAttribute("src"):l.src:this.src||""},setSrc:function(c,l,i){return t.util.loadImage(c,function(n,e){this.setElement(n,i),this._setWidthHeight(),l&&l(this,e)},this,i&&i.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,l=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),n=i.scaleX,e=i.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||n>l&&e>l){this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,this._lastScaleY=e;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var h=t.util.createCanvasElement(),a=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,f=o.width,d=o.height;h.width=f,h.height=d,this._element=h,this._lastScaleX=c.scaleX=n,this._lastScaleY=c.scaleY=e,t.filterBackend.applyFilters([c],o,f,d,this._element,a),this._filterScalingX=h.width/this._originalElement.width,this._filterScalingY=h.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(o){return o&&!o.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var l=this._originalElement,i=l.naturalWidth||l.width,n=l.naturalHeight||l.height;if(this._element===this._originalElement){var e=t.util.createCanvasElement();e.width=i,e.height=n,this._element=e,this._filteredEl=e}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,n),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(c,this._originalElement,i,n,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var l=this._element;if(l){var i=this._filterScalingX,n=this._filterScalingY,e=this.width,o=this.height,h=Math.min,a=Math.max,f=a(this.cropX,0),d=a(this.cropY,0),p=l.naturalWidth||l.width,m=l.naturalHeight||l.height,y=f*i,x=d*n,P=h(e*i,p-y),B=h(o*n,m-x),z=-e/2,q=-o/2,Z=h(e,p/i-f),rt=h(o,m/n-d);l&&c.drawImage(l,y,x,P,B,z,q,Z,rt)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,l){this.setElement(t.util.getById(c),l),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,l){c&&c.length?t.util.enlivenObjects(c,function(i){l&&l(i)},"fabric.Image.filters"):l&&l()},_setWidthHeight:function(c){c||(c={});var l=this.getElement();this.width=c.width||l.naturalWidth||l.width||0,this.height=c.height||l.naturalHeight||l.height||0},parsePreserveAspectRatioAttribute:function(){var c=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),l=this._element.width,i=this._element.height,n=1,e=1,o=0,h=0,a=0,f=0,d,p=this.width,m=this.height,y={width:p,height:m};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(n=e=t.util.findScaleToFit(this._element,y),d=(p-l*n)/2,c.alignX==="Min"&&(o=-d),c.alignX==="Max"&&(o=d),d=(m-i*e)/2,c.alignY==="Min"&&(h=-d),c.alignY==="Max"&&(h=d)),c.meetOrSlice==="slice"&&(n=e=t.util.findScaleToCover(this._element,y),d=l-p/n,c.alignX==="Mid"&&(a=d/2),c.alignX==="Max"&&(a=d),d=i-m/e,c.alignY==="Mid"&&(f=d/2),c.alignY==="Max"&&(f=d),l=p/n,i=m/e)):(n=p/l,e=m/i),{width:l,height:i,scaleX:n,scaleY:e,offsetLeft:o,offsetTop:h,cropX:a,cropY:f}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(c,l){var i=t.util.object.clone(c);t.util.loadImage(i.src,function(n,e){if(e){l&&l(null,!0);return}t.Image.prototype._initFilters.call(i,i.filters,function(o){i.filters=o||[],t.Image.prototype._initFilters.call(i,[i.resizeFilter],function(h){i.resizeFilter=h[0],t.util.enlivenObjectEnlivables(i,i,function(){var a=new t.Image(n,i);l(a,!1)})})})},null,i.crossOrigin)},t.Image.fromURL=function(c,l,i){t.util.loadImage(c,function(n,e){l&&l(new t.Image(n,i),e)},null,i&&i.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(c,l,i){var n=t.parseAttributes(c,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(n["xlink:href"],l,r(i?t.util.object.clone(i):{},n))}}(s),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var u=this.angle%360;return u>0?Math.round((u-1)/90)*90:Math.round(u/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(u){u=u||{};var r=function(){},c=u.onComplete||r,l=u.onChange||r,i=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(n){i.rotate(n),l()},onComplete:function(){i.setCoords(),c()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(u){return u.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(u){return u.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function u(c,l){var i="precision "+l+` float;
void main(){}`,n=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(n,i),c.compileShader(n),!!c.getShaderParameter(n,c.COMPILE_STATUS)}t.isWebglSupported=function(c){if(t.isLikelyNode)return!1;c=c||t.WebglFilterBackend.prototype.tileSize;var l=document.createElement("canvas"),i=l.getContext("webgl")||l.getContext("experimental-webgl"),n=!1;if(i){t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),n=t.maxTextureSize>=c;for(var e=["highp","mediump","lowp"],o=0;o<3;o++)if(u(i,e[o])){t.webGlPrecision=e[o];break}}return this.isSupported=n,n},t.WebglFilterBackend=r;function r(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}r.prototype={tileSize:2048,resources:{},setupGLContext:function(c,l){this.dispose(),this.createWebGLCanvas(c,l),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,l)},chooseFastestCopyGLTo2DMethod:function(c,l){var i=typeof window.performance<"u",n;try{new ImageData(1,1),n=!0}catch{n=!1}var e=typeof ArrayBuffer<"u",o=typeof Uint8ClampedArray<"u";if(i&&n&&e&&o){var h=t.util.createCanvasElement(),a=new ArrayBuffer(c*l*4);if(t.forceGLPutImageData){this.imageBuffer=a,this.copyGLTo2D=w;return}var f={imageBuffer:a,destinationWidth:c,destinationHeight:l,targetCanvas:h},d,p,m;h.width=c,h.height=l,d=window.performance.now(),C.call(f,this.gl,f),p=window.performance.now()-d,d=window.performance.now(),w.call(f,this.gl,f),m=window.performance.now()-d,p>m?(this.imageBuffer=a,this.copyGLTo2D=w):this.copyGLTo2D=C}},createWebGLCanvas:function(c,l){var i=t.util.createCanvasElement();i.width=c,i.height=l;var n={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},e=i.getContext("webgl",n);e||(e=i.getContext("experimental-webgl",n)),e&&(e.clearColor(0,0,0,0),this.canvas=i,this.gl=e)},applyFilters:function(c,l,i,n,e,o){var h=this.gl,a;o&&(a=this.getCachedTexture(o,l));var f={originalWidth:l.width||l.originalWidth,originalHeight:l.height||l.originalHeight,sourceWidth:i,sourceHeight:n,destinationWidth:i,destinationHeight:n,context:h,sourceTexture:this.createTexture(h,i,n,!a&&l),targetTexture:this.createTexture(h,i,n),originalTexture:a||this.createTexture(h,i,n,!a&&l),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:e},d=h.createFramebuffer();return h.bindFramebuffer(h.FRAMEBUFFER,d),c.forEach(function(p){p&&p.applyTo(f)}),_(f),this.copyGLTo2D(h,f),h.bindTexture(h.TEXTURE_2D,null),h.deleteTexture(f.sourceTexture),h.deleteTexture(f.targetTexture),h.deleteFramebuffer(d),e.getContext("2d").setTransform(1,0,0,1,0,0),f},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,l,i,n,e){var o=c.createTexture();return c.bindTexture(c.TEXTURE_2D,o),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,e||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,e||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),n?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,n):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,l,i,0,c.RGBA,c.UNSIGNED_BYTE,null),o},getCachedTexture:function(c,l){if(this.textureCache[c])return this.textureCache[c];var i=this.createTexture(this.gl,l.width,l.height,l);return this.textureCache[c]=i,i},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:C,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,l={renderer:"",vendor:""};if(!c)return l;var i=c.getExtension("WEBGL_debug_renderer_info");if(i){var n=c.getParameter(i.UNMASKED_RENDERER_WEBGL),e=c.getParameter(i.UNMASKED_VENDOR_WEBGL);n&&(l.renderer=n.toLowerCase()),e&&(l.vendor=e.toLowerCase())}return this.gpuInfo=l,l}}}();function _(u){var r=u.targetCanvas,c=r.width,l=r.height,i=u.destinationWidth,n=u.destinationHeight;(c!==i||l!==n)&&(r.width=i,r.height=n)}function C(u,r){var c=u.canvas,l=r.targetCanvas,i=l.getContext("2d");i.translate(0,l.height),i.scale(1,-1);var n=c.height-l.height;i.drawImage(c,0,n,l.width,l.height,0,0,l.width,l.height)}function w(u,r){var c=r.targetCanvas,l=c.getContext("2d"),i=r.destinationWidth,n=r.destinationHeight,e=i*n*4,o=new Uint8Array(this.imageBuffer,0,e),h=new Uint8ClampedArray(this.imageBuffer,0,e);u.readPixels(0,0,i,n,u.RGBA,u.UNSIGNED_BYTE,o);var a=new ImageData(h,i,n);l.putImageData(a,0,0)}(function(){var u=function(){};t.Canvas2dFilterBackend=r;function r(){}r.prototype={evictCachesForKey:u,dispose:u,clearWebGLCaches:u,resources:{},applyFilters:function(c,l,i,n,e){var o=e.getContext("2d");o.drawImage(l,0,0,i,n);var h=o.getImageData(0,0,i,n),a=o.getImageData(0,0,i,n),f={sourceWidth:i,sourceHeight:n,imageData:h,originalEl:l,originalImageData:a,canvasEl:e,ctx:o,filterBackend:this};return c.forEach(function(d){d.applyTo(f)}),(f.imageData.width!==i||f.imageData.height!==n)&&(e.width=f.imageData.width,e.height=f.imageData.height),o.putImageData(f.imageData,0,0),f}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(u){u&&this.setOptions(u)},setOptions:function(u){for(var r in u)this[r]=u[r]},createProgram:function(u,r,c){r=r||this.fragmentSource,c=c||this.vertexSource,t.webGlPrecision!=="highp"&&(r=r.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var l=u.createShader(u.VERTEX_SHADER);if(u.shaderSource(l,c),u.compileShader(l),!u.getShaderParameter(l,u.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+u.getShaderInfoLog(l));var i=u.createShader(u.FRAGMENT_SHADER);if(u.shaderSource(i,r),u.compileShader(i),!u.getShaderParameter(i,u.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+u.getShaderInfoLog(i));var n=u.createProgram();if(u.attachShader(n,l),u.attachShader(n,i),u.linkProgram(n),!u.getProgramParameter(n,u.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+u.getProgramInfoLog(n));var e=this.getAttributeLocations(u,n),o=this.getUniformLocations(u,n)||{};return o.uStepW=u.getUniformLocation(n,"uStepW"),o.uStepH=u.getUniformLocation(n,"uStepH"),{program:n,attributeLocations:e,uniformLocations:o}},getAttributeLocations:function(u,r){return{aPosition:u.getAttribLocation(r,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(u,r,c){var l=r.aPosition,i=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,i),u.enableVertexAttribArray(l),u.vertexAttribPointer(l,2,u.FLOAT,!1,0,0),u.bufferData(u.ARRAY_BUFFER,c,u.STATIC_DRAW)},_setupFrameBuffer:function(u){var r=u.context,c,l;u.passes>1?(c=u.destinationWidth,l=u.destinationHeight,(u.sourceWidth!==c||u.sourceHeight!==l)&&(r.deleteTexture(u.targetTexture),u.targetTexture=u.filterBackend.createTexture(r,c,l)),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,u.targetTexture,0)):(r.bindFramebuffer(r.FRAMEBUFFER,null),r.finish())},_swapTextures:function(u){u.passes--,u.pass++;var r=u.targetTexture;u.targetTexture=u.sourceTexture,u.sourceTexture=r},isNeutralState:function(){var u=this.mainParameter,r=t.Image.filters[this.type].prototype;if(u)if(Array.isArray(r[u])){for(var c=r[u].length;c--;)if(this[u][c]!==r[u][c])return!1;return!0}else return r[u]===this[u];else return!1},applyTo:function(u){u.webgl?(this._setupFrameBuffer(u),this.applyToWebGL(u),this._swapTextures(u)):this.applyTo2d(u)},retrieveShader:function(u){return u.programCache.hasOwnProperty(this.type)||(u.programCache[this.type]=this.createProgram(u.context)),u.programCache[this.type]},applyToWebGL:function(u){var r=u.context,c=this.retrieveShader(u);u.pass===0&&u.originalTexture?r.bindTexture(r.TEXTURE_2D,u.originalTexture):r.bindTexture(r.TEXTURE_2D,u.sourceTexture),r.useProgram(c.program),this.sendAttributeData(r,c.attributeLocations,u.aPosition),r.uniform1f(c.uniformLocations.uStepW,1/u.sourceWidth),r.uniform1f(c.uniformLocations.uStepH,1/u.sourceHeight),this.sendUniformData(r,c.uniformLocations),r.viewport(0,0,u.destinationWidth,u.destinationHeight),r.drawArrays(r.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(u,r,c){u.activeTexture(c),u.bindTexture(u.TEXTURE_2D,r),u.activeTexture(u.TEXTURE0)},unbindAdditionalTexture:function(u,r){u.activeTexture(r),u.bindTexture(u.TEXTURE_2D,null),u.activeTexture(u.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(u){this[this.mainParameter]=u},sendUniformData:function(){},createHelpLayer:function(u){if(!u.helpLayer){var r=document.createElement("canvas");r.width=u.sourceWidth,r.height=u.sourceHeight,u.helpLayer=r}},toObject:function(){var u={type:this.type},r=this.mainParameter;return r&&(u[r]=this[r]),u},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(u,r){var c=new t.Image.filters[u.type](u);return r&&r(c),c},function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.ColorMatrix=l(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(i){this.callSuper("initialize",i),this.matrix=this.matrix.slice(0)},applyTo2d:function(i){var n=i.imageData,e=n.data,o=e.length,h=this.matrix,a,f,d,p,m,y=this.colorsOnly;for(m=0;m<o;m+=4)a=e[m],f=e[m+1],d=e[m+2],y?(e[m]=a*h[0]+f*h[1]+d*h[2]+h[4]*255,e[m+1]=a*h[5]+f*h[6]+d*h[7]+h[9]*255,e[m+2]=a*h[10]+f*h[11]+d*h[12]+h[14]*255):(p=e[m+3],e[m]=a*h[0]+f*h[1]+d*h[2]+p*h[3]+h[4]*255,e[m+1]=a*h[5]+f*h[6]+d*h[7]+p*h[8]+h[9]*255,e[m+2]=a*h[10]+f*h[11]+d*h[12]+p*h[13]+h[14]*255,e[m+3]=a*h[15]+f*h[16]+d*h[17]+p*h[18]+h[19]*255)},getUniformLocations:function(i,n){return{uColorMatrix:i.getUniformLocation(n,"uColorMatrix"),uConstants:i.getUniformLocation(n,"uConstants")}},sendUniformData:function(i,n){var e=this.matrix,o=[e[0],e[1],e[2],e[3],e[5],e[6],e[7],e[8],e[10],e[11],e[12],e[13],e[15],e[16],e[17],e[18]],h=[e[4],e[9],e[14],e[19]];i.uniformMatrix4fv(n.uColorMatrix,!1,o),i.uniform4fv(n.uConstants,h)}}),r.Image.filters.ColorMatrix.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Brightness=l(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(i){if(this.brightness!==0){var n=i.imageData,e=n.data,o,h=e.length,a=Math.round(this.brightness*255);for(o=0;o<h;o+=4)e[o]=e[o]+a,e[o+1]=e[o+1]+a,e[o+2]=e[o+2]+a}},getUniformLocations:function(i,n){return{uBrightness:i.getUniformLocation(n,"uBrightness")}},sendUniformData:function(i,n){i.uniform1f(n.uBrightness,this.brightness)}}),r.Image.filters.Brightness.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.object.extend,l=r.Image.filters,i=r.util.createClass;l.Convolute=i(l.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(n){var e=Math.sqrt(this.matrix.length),o=this.type+"_"+e+"_"+(this.opaque?1:0),h=this.fragmentSource[o];return n.programCache.hasOwnProperty(o)||(n.programCache[o]=this.createProgram(n.context,h)),n.programCache[o]},applyTo2d:function(n){var e=n.imageData,o=e.data,h=this.matrix,a=Math.round(Math.sqrt(h.length)),f=Math.floor(a/2),d=e.width,p=e.height,m=n.ctx.createImageData(d,p),y=m.data,x=this.opaque?1:0,P,B,z,q,Z,rt,ot,et,nt,at,st,tt,T;for(st=0;st<p;st++)for(at=0;at<d;at++){for(Z=(st*d+at)*4,P=0,B=0,z=0,q=0,T=0;T<a;T++)for(tt=0;tt<a;tt++)ot=st+T-f,rt=at+tt-f,!(ot<0||ot>=p||rt<0||rt>=d)&&(et=(ot*d+rt)*4,nt=h[T*a+tt],P+=o[et]*nt,B+=o[et+1]*nt,z+=o[et+2]*nt,x||(q+=o[et+3]*nt));y[Z]=P,y[Z+1]=B,y[Z+2]=z,x?y[Z+3]=o[Z+3]:y[Z+3]=q}n.imageData=m},getUniformLocations:function(n,e){return{uMatrix:n.getUniformLocation(e,"uMatrix"),uOpaque:n.getUniformLocation(e,"uOpaque"),uHalfSize:n.getUniformLocation(e,"uHalfSize"),uSize:n.getUniformLocation(e,"uSize")}},sendUniformData:function(n,e){n.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),r.Image.filters.Convolute.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Grayscale=l(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(i){var n=i.imageData,e=n.data,o,h=e.length,a,f=this.mode;for(o=0;o<h;o+=4)f==="average"?a=(e[o]+e[o+1]+e[o+2])/3:f==="lightness"?a=(Math.min(e[o],e[o+1],e[o+2])+Math.max(e[o],e[o+1],e[o+2]))/2:f==="luminosity"&&(a=.21*e[o]+.72*e[o+1]+.07*e[o+2]),e[o]=a,e[o+1]=a,e[o+2]=a},retrieveShader:function(i){var n=this.type+"_"+this.mode;if(!i.programCache.hasOwnProperty(n)){var e=this.fragmentSource[this.mode];i.programCache[n]=this.createProgram(i.context,e)}return i.programCache[n]},getUniformLocations:function(i,n){return{uMode:i.getUniformLocation(n,"uMode")}},sendUniformData:function(i,n){var e=1;i.uniform1i(n.uMode,e)},isNeutralState:function(){return!1}}),r.Image.filters.Grayscale.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Invert=l(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(i){var n=i.imageData,e=n.data,o,h=e.length;for(o=0;o<h;o+=4)e[o]=255-e[o],e[o+1]=255-e[o+1],e[o+2]=255-e[o+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(i,n){return{uInvert:i.getUniformLocation(n,"uInvert")}},sendUniformData:function(i,n){i.uniform1i(n.uInvert,this.invert)}}),r.Image.filters.Invert.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.object.extend,l=r.Image.filters,i=r.util.createClass;l.Noise=i(l.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(n){if(this.noise!==0){var e=n.imageData,o=e.data,h,a=o.length,f=this.noise,d;for(h=0,a=o.length;h<a;h+=4)d=(.5-Math.random())*f,o[h]+=d,o[h+1]+=d,o[h+2]+=d}},getUniformLocations:function(n,e){return{uNoise:n.getUniformLocation(e,"uNoise"),uSeed:n.getUniformLocation(e,"uSeed")}},sendUniformData:function(n,e){n.uniform1f(e.uNoise,this.noise/255),n.uniform1f(e.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),r.Image.filters.Noise.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Pixelate=l(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(i){var n=i.imageData,e=n.data,o=n.height,h=n.width,a,f,d,p,m,y,x,P,B,z,q;for(f=0;f<o;f+=this.blocksize)for(d=0;d<h;d+=this.blocksize)for(a=f*4*h+d*4,p=e[a],m=e[a+1],y=e[a+2],x=e[a+3],z=Math.min(f+this.blocksize,o),q=Math.min(d+this.blocksize,h),P=f;P<z;P++)for(B=d;B<q;B++)a=P*4*h+B*4,e[a]=p,e[a+1]=m,e[a+2]=y,e[a+3]=x},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(i,n){return{uBlocksize:i.getUniformLocation(n,"uBlocksize"),uStepW:i.getUniformLocation(n,"uStepW"),uStepH:i.getUniformLocation(n,"uStepH")}},sendUniformData:function(i,n){i.uniform1f(n.uBlocksize,this.blocksize)}}),r.Image.filters.Pixelate.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.object.extend,l=r.Image.filters,i=r.util.createClass;l.RemoveColor=i(l.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(n){var e=n.imageData,o=e.data,h,a=this.distance*255,f,d,p,m=new r.Color(this.color).getSource(),y=[m[0]-a,m[1]-a,m[2]-a],x=[m[0]+a,m[1]+a,m[2]+a];for(h=0;h<o.length;h+=4)f=o[h],d=o[h+1],p=o[h+2],f>y[0]&&d>y[1]&&p>y[2]&&f<x[0]&&d<x[1]&&p<x[2]&&(o[h+3]=0)},getUniformLocations:function(n,e){return{uLow:n.getUniformLocation(e,"uLow"),uHigh:n.getUniformLocation(e,"uHigh")}},sendUniformData:function(n,e){var o=new r.Color(this.color).getSource(),h=parseFloat(this.distance),a=[0+o[0]/255-h,0+o[1]/255-h,0+o[2]/255-h,1],f=[o[0]/255+h,o[1]/255+h,o[2]/255+h,1];n.uniform4fv(e.uLow,a),n.uniform4fv(e.uHigh,f)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),r.Image.filters.RemoveColor.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass,i={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var n in i)c[n]=l(c.ColorMatrix,{type:n,matrix:i[n],mainParameter:!1,colorsOnly:!0}),r.Image.filters[n].fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric,c=r.Image.filters,l=r.util.createClass;c.BlendColor=l(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(i){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[i]+`}
}`},retrieveShader:function(i){var n=this.type+"_"+this.mode,e;return i.programCache.hasOwnProperty(n)||(e=this.buildSource(this.mode),i.programCache[n]=this.createProgram(i.context,e)),i.programCache[n]},applyTo2d:function(i){var n=i.imageData,e=n.data,o=e.length,h,a,f,d,p,m,y,x=1-this.alpha;y=new r.Color(this.color).getSource(),h=y[0]*this.alpha,a=y[1]*this.alpha,f=y[2]*this.alpha;for(var P=0;P<o;P+=4)switch(d=e[P],p=e[P+1],m=e[P+2],this.mode){case"multiply":e[P]=d*h/255,e[P+1]=p*a/255,e[P+2]=m*f/255;break;case"screen":e[P]=255-(255-d)*(255-h)/255,e[P+1]=255-(255-p)*(255-a)/255,e[P+2]=255-(255-m)*(255-f)/255;break;case"add":e[P]=d+h,e[P+1]=p+a,e[P+2]=m+f;break;case"diff":case"difference":e[P]=Math.abs(d-h),e[P+1]=Math.abs(p-a),e[P+2]=Math.abs(m-f);break;case"subtract":e[P]=d-h,e[P+1]=p-a,e[P+2]=m-f;break;case"darken":e[P]=Math.min(d,h),e[P+1]=Math.min(p,a),e[P+2]=Math.min(m,f);break;case"lighten":e[P]=Math.max(d,h),e[P+1]=Math.max(p,a),e[P+2]=Math.max(m,f);break;case"overlay":e[P]=h<128?2*d*h/255:255-2*(255-d)*(255-h)/255,e[P+1]=a<128?2*p*a/255:255-2*(255-p)*(255-a)/255,e[P+2]=f<128?2*m*f/255:255-2*(255-m)*(255-f)/255;break;case"exclusion":e[P]=h+d-2*h*d/255,e[P+1]=a+p-2*a*p/255,e[P+2]=f+m-2*f*m/255;break;case"tint":e[P]=h+d*x,e[P+1]=a+p*x,e[P+2]=f+m*x}},getUniformLocations:function(i,n){return{uColor:i.getUniformLocation(n,"uColor")}},sendUniformData:function(i,n){var e=new r.Color(this.color).getSource();e[0]=this.alpha*e[0]/255,e[1]=this.alpha*e[1]/255,e[2]=this.alpha*e[2]/255,e[3]=this.alpha,i.uniform4fv(n.uColor,e)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),r.Image.filters.BlendColor.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric,c=r.Image.filters,l=r.util.createClass;c.BlendImage=l(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(i){var n=this.type+"_"+this.mode,e=this.fragmentSource[this.mode];return i.programCache.hasOwnProperty(n)||(i.programCache[n]=this.createProgram(i.context,e)),i.programCache[n]},applyToWebGL:function(i){var n=i.context,e=this.createTexture(i.filterBackend,this.image);this.bindAdditionalTexture(n,e,n.TEXTURE1),this.callSuper("applyToWebGL",i),this.unbindAdditionalTexture(n,n.TEXTURE1)},createTexture:function(i,n){return i.getCachedTexture(n.cacheKey,n._element)},calculateMatrix:function(){var i=this.image,n=i._element.width,e=i._element.height;return[1/i.scaleX,0,0,0,1/i.scaleY,0,-i.left/n,-i.top/e,1]},applyTo2d:function(i){var n=i.imageData,e=i.filterBackend.resources,o=n.data,h=o.length,a=n.width,f=n.height,d,p,m,y,x,P,B,z,q,Z,rt=this.image,ot;e.blendImage||(e.blendImage=r.util.createCanvasElement()),q=e.blendImage,Z=q.getContext("2d"),q.width!==a||q.height!==f?(q.width=a,q.height=f):Z.clearRect(0,0,a,f),Z.setTransform(rt.scaleX,0,0,rt.scaleY,rt.left,rt.top),Z.drawImage(rt._element,0,0,a,f),ot=Z.getImageData(0,0,a,f).data;for(var et=0;et<h;et+=4)switch(x=o[et],P=o[et+1],B=o[et+2],z=o[et+3],d=ot[et],p=ot[et+1],m=ot[et+2],y=ot[et+3],this.mode){case"multiply":o[et]=x*d/255,o[et+1]=P*p/255,o[et+2]=B*m/255,o[et+3]=z*y/255;break;case"mask":o[et+3]=y;break}},getUniformLocations:function(i,n){return{uTransformMatrix:i.getUniformLocation(n,"uTransformMatrix"),uImage:i.getUniformLocation(n,"uImage")}},sendUniformData:function(i,n){var e=this.calculateMatrix();i.uniform1i(n.uImage,1),i.uniformMatrix3fv(n.uTransformMatrix,!1,e)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),r.Image.filters.BlendImage.fromObject=function(i,n){r.Image.fromObject(i.image,function(e){var o=r.util.object.clone(i);o.image=e,n(new r.Image.filters.BlendImage(o))})}}(s),function(u){var r=u.fabric||(u.fabric={}),c=Math.pow,l=Math.floor,i=Math.sqrt,n=Math.abs,e=Math.round,o=Math.sin,h=Math.ceil,a=r.Image.filters,f=r.util.createClass;a.Resize=f(a.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(d,p){return{uDelta:d.getUniformLocation(p,"uDelta"),uTaps:d.getUniformLocation(p,"uTaps")}},sendUniformData:function(d,p){d.uniform2fv(p.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),d.uniform1fv(p.uTaps,this.taps)},retrieveShader:function(d){var p=this.getFilterWindow(),m=this.type+"_"+p;if(!d.programCache.hasOwnProperty(m)){var y=this.generateShader(p);d.programCache[m]=this.createProgram(d.context,y)}return d.programCache[m]},getFilterWindow:function(){var d=this.tempScale;return Math.ceil(this.lanczosLobes/d)},getTaps:function(){for(var d=this.lanczosCreate(this.lanczosLobes),p=this.tempScale,m=this.getFilterWindow(),y=new Array(m),x=1;x<=m;x++)y[x-1]=d(x*p);return y},generateShader:function(y){for(var p=new Array(y),m=this.fragmentSourceTOP,y,x=1;x<=y;x++)p[x-1]=x+".0 * uDelta";return m+="uniform float uTaps["+y+`];
`,m+=`void main() {
`,m+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,m+=`  float sum = 1.0;
`,p.forEach(function(P,B){m+="  color += texture2D(uTexture, vTexCoord + "+P+") * uTaps["+B+`];
`,m+="  color += texture2D(uTexture, vTexCoord - "+P+") * uTaps["+B+`];
`,m+="  sum += 2.0 * uTaps["+B+`];
`}),m+=`  gl_FragColor = color / sum;
`,m+="}",m},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(d){d.webgl?(d.passes++,this.width=d.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=d.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),d.destinationWidth=this.dW,this._setupFrameBuffer(d),this.applyToWebGL(d),this._swapTextures(d),d.sourceWidth=d.destinationWidth,this.height=d.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),d.destinationHeight=this.dH,this._setupFrameBuffer(d),this.applyToWebGL(d),this._swapTextures(d),d.sourceHeight=d.destinationHeight):this.applyTo2d(d)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(d){return function(p){if(p>=d||p<=-d)return 0;if(p<11920929e-14&&p>-11920929e-14)return 1;p*=Math.PI;var m=p/d;return o(p)/p*o(m)/m}},applyTo2d:function(d){var p=d.imageData,m=this.scaleX,y=this.scaleY;this.rcpScaleX=1/m,this.rcpScaleY=1/y;var x=p.width,P=p.height,B=e(x*m),z=e(P*y),q;this.resizeType==="sliceHack"?q=this.sliceByTwo(d,x,P,B,z):this.resizeType==="hermite"?q=this.hermiteFastResize(d,x,P,B,z):this.resizeType==="bilinear"?q=this.bilinearFiltering(d,x,P,B,z):this.resizeType==="lanczos"&&(q=this.lanczosResize(d,x,P,B,z)),d.imageData=q},sliceByTwo:function(d,p,m,y,x){var P=d.imageData,B=.5,z=!1,q=!1,Z=p*B,rt=m*B,ot=r.filterBackend.resources,et,nt,at=0,st=0,tt=p,T=0;for(ot.sliceByTwo||(ot.sliceByTwo=document.createElement("canvas")),et=ot.sliceByTwo,(et.width<p*1.5||et.height<m)&&(et.width=p*1.5,et.height=m),nt=et.getContext("2d"),nt.clearRect(0,0,p*1.5,m),nt.putImageData(P,0,0),y=l(y),x=l(x);!z||!q;)p=Z,m=rt,y<l(Z*B)?Z=l(Z*B):(Z=y,z=!0),x<l(rt*B)?rt=l(rt*B):(rt=x,q=!0),nt.drawImage(et,at,st,p,m,tt,T,Z,rt),at=tt,st=T,T+=rt;return nt.getImageData(at,st,y,x)},lanczosResize:function(d,p,m,y,x){function P(F){var k,U,D,O,W,E,H,I,Y,G,J;for(T.x=(F+.5)*rt,R.x=l(T.x),k=0;k<x;k++){for(T.y=(k+.5)*ot,R.y=l(T.y),W=0,E=0,H=0,I=0,Y=0,U=R.x-at;U<=R.x+at;U++)if(!(U<0||U>=p)){G=l(1e3*n(U-T.x)),tt[G]||(tt[G]={});for(var S=R.y-st;S<=R.y+st;S++)S<0||S>=m||(J=l(1e3*n(S-T.y)),tt[G][J]||(tt[G][J]=Z(i(c(G*et,2)+c(J*nt,2))/1e3)),D=tt[G][J],D>0&&(O=(S*p+U)*4,W+=D,E+=D*B[O],H+=D*B[O+1],I+=D*B[O+2],Y+=D*B[O+3]))}O=(k*y+F)*4,q[O]=E/W,q[O+1]=H/W,q[O+2]=I/W,q[O+3]=Y/W}return++F<y?P(F):z}var B=d.imageData.data,z=d.ctx.createImageData(y,x),q=z.data,Z=this.lanczosCreate(this.lanczosLobes),rt=this.rcpScaleX,ot=this.rcpScaleY,et=2/this.rcpScaleX,nt=2/this.rcpScaleY,at=h(rt*this.lanczosLobes/2),st=h(ot*this.lanczosLobes/2),tt={},T={},R={};return P(0)},bilinearFiltering:function(d,p,m,y,x){var P,B,z,q,Z,rt,ot,et,nt,at,st,tt,T=0,R,F=this.rcpScaleX,k=this.rcpScaleY,U=4*(p-1),D=d.imageData,O=D.data,W=d.ctx.createImageData(y,x),E=W.data;for(ot=0;ot<x;ot++)for(et=0;et<y;et++)for(Z=l(F*et),rt=l(k*ot),nt=F*et-Z,at=k*ot-rt,R=4*(rt*p+Z),st=0;st<4;st++)P=O[R+st],B=O[R+4+st],z=O[R+U+st],q=O[R+U+4+st],tt=P*(1-nt)*(1-at)+B*nt*(1-at)+z*at*(1-nt)+q*nt*at,E[T++]=tt;return W},hermiteFastResize:function(d,p,m,y,x){for(var P=this.rcpScaleX,B=this.rcpScaleY,z=h(P/2),q=h(B/2),Z=d.imageData,rt=Z.data,ot=d.ctx.createImageData(y,x),et=ot.data,nt=0;nt<x;nt++)for(var at=0;at<y;at++){for(var st=(at+nt*y)*4,tt=0,T=0,R=0,F=0,k=0,U=0,D=0,O=(nt+.5)*B,W=l(nt*B);W<(nt+1)*B;W++)for(var E=n(O-(W+.5))/q,H=(at+.5)*P,I=E*E,Y=l(at*P);Y<(at+1)*P;Y++){var G=n(H-(Y+.5))/z,J=i(I+G*G);J>1&&J<-1||(tt=2*J*J*J-3*J*J+1,tt>0&&(G=4*(Y+W*p),D+=tt*rt[G+3],R+=tt,rt[G+3]<255&&(tt=tt*rt[G+3]/250),F+=tt*rt[G],k+=tt*rt[G+1],U+=tt*rt[G+2],T+=tt))}et[st]=F/T,et[st+1]=k/T,et[st+2]=U/T,et[st+3]=D/R}return ot},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),r.Image.filters.Resize.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Contrast=l(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(i){if(this.contrast!==0){var n=i.imageData,e,h,o=n.data,h=o.length,a=Math.floor(this.contrast*255),f=259*(a+255)/(255*(259-a));for(e=0;e<h;e+=4)o[e]=f*(o[e]-128)+128,o[e+1]=f*(o[e+1]-128)+128,o[e+2]=f*(o[e+2]-128)+128}},getUniformLocations:function(i,n){return{uContrast:i.getUniformLocation(n,"uContrast")}},sendUniformData:function(i,n){i.uniform1f(n.uContrast,this.contrast)}}),r.Image.filters.Contrast.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Saturation=l(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(i){if(this.saturation!==0){var n=i.imageData,e=n.data,o=e.length,h=-this.saturation,a,f;for(a=0;a<o;a+=4)f=Math.max(e[a],e[a+1],e[a+2]),e[a]+=f!==e[a]?(f-e[a])*h:0,e[a+1]+=f!==e[a+1]?(f-e[a+1])*h:0,e[a+2]+=f!==e[a+2]?(f-e[a+2])*h:0}},getUniformLocations:function(i,n){return{uSaturation:i.getUniformLocation(n,"uSaturation")}},sendUniformData:function(i,n){i.uniform1f(n.uSaturation,-this.saturation)}}),r.Image.filters.Saturation.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Vibrance=l(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(i){if(this.vibrance!==0){var n=i.imageData,e=n.data,o=e.length,h=-this.vibrance,a,f,d,p;for(a=0;a<o;a+=4)f=Math.max(e[a],e[a+1],e[a+2]),d=(e[a]+e[a+1]+e[a+2])/3,p=Math.abs(f-d)*2/255*h,e[a]+=f!==e[a]?(f-e[a])*p:0,e[a+1]+=f!==e[a+1]?(f-e[a+1])*p:0,e[a+2]+=f!==e[a+2]?(f-e[a+2])*p:0}},getUniformLocations:function(i,n){return{uVibrance:i.getUniformLocation(n,"uVibrance")}},sendUniformData:function(i,n){i.uniform1f(n.uVibrance,-this.vibrance)}}),r.Image.filters.Vibrance.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Blur=l(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(i){i.webgl?(this.aspectRatio=i.sourceWidth/i.sourceHeight,i.passes++,this._setupFrameBuffer(i),this.horizontal=!0,this.applyToWebGL(i),this._swapTextures(i),this._setupFrameBuffer(i),this.horizontal=!1,this.applyToWebGL(i),this._swapTextures(i)):this.applyTo2d(i)},applyTo2d:function(i){i.imageData=this.simpleBlur(i)},simpleBlur:function(i){var n=i.filterBackend.resources,e,o,h=i.imageData.width,a=i.imageData.height;n.blurLayer1||(n.blurLayer1=r.util.createCanvasElement(),n.blurLayer2=r.util.createCanvasElement()),e=n.blurLayer1,o=n.blurLayer2,(e.width!==h||e.height!==a)&&(o.width=e.width=h,o.height=e.height=a);var f=e.getContext("2d"),d=o.getContext("2d"),p=15,m,y,x,P,B=this.blur*.06*.5;for(f.putImageData(i.imageData,0,0),d.clearRect(0,0,h,a),P=-p;P<=p;P++)m=(Math.random()-.5)/4,y=P/p,x=B*y*h+m,d.globalAlpha=1-Math.abs(y),d.drawImage(e,x,m),f.drawImage(o,0,0),d.globalAlpha=1,d.clearRect(0,0,o.width,o.height);for(P=-p;P<=p;P++)m=(Math.random()-.5)/4,y=P/p,x=B*y*a+m,d.globalAlpha=1-Math.abs(y),d.drawImage(e,m,x),f.drawImage(o,0,0),d.globalAlpha=1,d.clearRect(0,0,o.width,o.height);i.ctx.drawImage(e,0,0);var z=i.ctx.getImageData(0,0,e.width,e.height);return f.globalAlpha=1,f.clearRect(0,0,e.width,e.height),z},getUniformLocations:function(i,n){return{delta:i.getUniformLocation(n,"uDelta")}},sendUniformData:function(i,n){var e=this.chooseRightDelta();i.uniform2fv(n.delta,e)},chooseRightDelta:function(){var i=1,n=[0,0],e;return this.horizontal?this.aspectRatio>1&&(i=1/this.aspectRatio):this.aspectRatio<1&&(i=this.aspectRatio),e=i*this.blur*.12,this.horizontal?n[0]=e:n[1]=e,n}}),c.Blur.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Gamma=l(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(i){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,i)},applyTo2d:function(i){var n=i.imageData,e=n.data,o=this.gamma,h=e.length,a=1/o[0],f=1/o[1],d=1/o[2],p;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),p=0,h=256;p<h;p++)this.rVals[p]=Math.pow(p/255,a)*255,this.gVals[p]=Math.pow(p/255,f)*255,this.bVals[p]=Math.pow(p/255,d)*255;for(p=0,h=e.length;p<h;p+=4)e[p]=this.rVals[e[p]],e[p+1]=this.gVals[e[p+1]],e[p+2]=this.bVals[e[p+2]]},getUniformLocations:function(i,n){return{uGamma:i.getUniformLocation(n,"uGamma")}},sendUniformData:function(i,n){i.uniform3fv(n.uGamma,this.gamma)}}),r.Image.filters.Gamma.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Composed=l(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(i){this.callSuper("initialize",i),this.subFilters=this.subFilters.slice(0)},applyTo:function(i){i.passes+=this.subFilters.length-1,this.subFilters.forEach(function(n){n.applyTo(i)})},toObject:function(){return r.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(i){return i.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(i){return!i.isNeutralState()})}}),r.Image.filters.Composed.fromObject=function(i,n){var e=i.subFilters||[],o=e.map(function(a){return new r.Image.filters[a.type](a)}),h=new r.Image.filters.Composed({subFilters:o});return n&&n(h),h}}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.Image.filters,l=r.util.createClass;c.HueRotation=l(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var i=this.rotation*Math.PI,n=r.util.cos(i),e=r.util.sin(i),o=1/3,h=Math.sqrt(o)*e,a=1-n;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=n+a/3,this.matrix[1]=o*a-h,this.matrix[2]=o*a+h,this.matrix[5]=o*a+h,this.matrix[6]=n+o*a,this.matrix[7]=o*a-h,this.matrix[10]=o*a-h,this.matrix[11]=o*a+h,this.matrix[12]=n+o*a},isNeutralState:function(i){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,i)},applyTo:function(i){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,i)}}),r.Image.filters.HueRotation.fromObject=r.Image.filters.BaseFilter.fromObject}(s),function(u){var r=u.fabric||(u.fabric={}),c=r.util.object.clone;if(r.Text){r.warn("fabric.Text is already defined");return}var l="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");r.Text=r.util.createClass(r.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:r.Object.prototype.stateProperties.concat(l),cacheProperties:r.Object.prototype.cacheProperties.concat(l),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(i,n){this.styles=n?n.styles||{}:{},this.text=i,this.__skipDimension=!0,this.callSuper("initialize",n),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var i=this.path;i&&(i.segmentsInfo=r.util.getPathSegmentsInfo(i.path))},getMeasuringContext:function(){return r._measuringContext||(r._measuringContext=this.canvas&&this.canvas.contextCache||r.util.createCanvasElement().getContext("2d")),r._measuringContext},_splitText:function(){var i=this._splitTextIntoLines(this.text);return this.textLines=i.lines,this._textLines=i.graphemeLines,this._unwrappedTextLines=i._unwrappedLines,this._text=i.graphemeText,i},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var i,n,e,o,h,a,f,d=0,p=this._textLines.length;d<p;d++)if(!(this.textAlign!=="justify"&&(d===p-1||this.isEndOfWrapping(d)))&&(o=0,h=this._textLines[d],n=this.getLineWidth(d),n<this.width&&(f=this.textLines[d].match(this._reSpacesAndTabs)))){e=f.length,i=(this.width-n)/e;for(var m=0,y=h.length;m<=y;m++)a=this.__charBounds[d][m],this._reSpaceAndTab.test(h[m])?(a.width+=i,a.kernedWidth+=i,a.left+=o,o+=i):a.left+=o}},isEndOfWrapping:function(i){return i===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var i=this.callSuper("_getCacheCanvasDimensions"),n=this.fontSize;return i.width+=n*i.zoomX,i.height+=n*i.zoomY,i},_render:function(i){var n=this.path;n&&!n.isNotVisible()&&n._render(i),this._setTextStyles(i),this._renderTextLinesBackground(i),this._renderTextDecoration(i,"underline"),this._renderText(i),this._renderTextDecoration(i,"overline"),this._renderTextDecoration(i,"linethrough")},_renderText:function(i){this.paintFirst==="stroke"?(this._renderTextStroke(i),this._renderTextFill(i)):(this._renderTextFill(i),this._renderTextStroke(i))},_setTextStyles:function(i,n,e){if(i.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":i.textBaseline="middle";break;case"ascender":i.textBaseline="top";break;case"descender":i.textBaseline="bottom";break}i.font=this._getFontDeclaration(n,e)},calcTextWidth:function(){for(var i=this.getLineWidth(0),n=1,e=this._textLines.length;n<e;n++){var o=this.getLineWidth(n);o>i&&(i=o)}return i},_renderTextLine:function(i,n,e,o,h,a){this._renderChars(i,n,e,o,h,a)},_renderTextLinesBackground:function(i){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var n,e,o=i.fillStyle,h,a,f=this._getLeftOffset(),d=this._getTopOffset(),p=0,m=0,y,x,P=this.path,B,z=0,q=this._textLines.length;z<q;z++){if(n=this.getHeightOfLine(z),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",z)){d+=n;continue}h=this._textLines[z],e=this._getLineLeftOffset(z),m=0,p=0,a=this.getValueOfPropertyAt(z,0,"textBackgroundColor");for(var Z=0,rt=h.length;Z<rt;Z++)y=this.__charBounds[z][Z],x=this.getValueOfPropertyAt(z,Z,"textBackgroundColor"),P?(i.save(),i.translate(y.renderLeft,y.renderTop),i.rotate(y.angle),i.fillStyle=x,x&&i.fillRect(-y.width/2,-n/this.lineHeight*(1-this._fontSizeFraction),y.width,n/this.lineHeight),i.restore()):x!==a?(B=f+e+p,this.direction==="rtl"&&(B=this.width-B-m),i.fillStyle=a,a&&i.fillRect(B,d,m,n/this.lineHeight),p=y.left,m=y.width,a=x):m+=y.kernedWidth;x&&!P&&(B=f+e+p,this.direction==="rtl"&&(B=this.width-B-m),i.fillStyle=x,i.fillRect(B,d,m,n/this.lineHeight)),d+=n}i.fillStyle=o,this._removeShadow(i)}},getFontCache:function(i){var n=i.fontFamily.toLowerCase();r.charWidthsCache[n]||(r.charWidthsCache[n]={});var e=r.charWidthsCache[n],o=i.fontStyle.toLowerCase()+"_"+(i.fontWeight+"").toLowerCase();return e[o]||(e[o]={}),e[o]},_measureChar:function(i,n,e,o){var h=this.getFontCache(n),a=this._getFontDeclaration(n),f=this._getFontDeclaration(o),d=e+i,p=a===f,m,y,x,P=n.fontSize/this.CACHE_FONT_SIZE,B;if(e&&h[e]!==void 0&&(x=h[e]),h[i]!==void 0&&(B=m=h[i]),p&&h[d]!==void 0&&(y=h[d],B=y-x),m===void 0||x===void 0||y===void 0){var z=this.getMeasuringContext();this._setTextStyles(z,n,!0)}return m===void 0&&(B=m=z.measureText(i).width,h[i]=m),x===void 0&&p&&e&&(x=z.measureText(e).width,h[e]=x),p&&y===void 0&&(y=z.measureText(d).width,h[d]=y,B=y-x),{width:m*P,kernedWidth:B*P}},getHeightOfChar:function(i,n){return this.getValueOfPropertyAt(i,n,"fontSize")},measureLine:function(i){var n=this._measureLine(i);return this.charSpacing!==0&&(n.width-=this._getWidthOfCharSpacing()),n.width<0&&(n.width=0),n},_measureLine:function(i){var n=0,e,o,h=this._textLines[i],a,f,d=0,p=new Array(h.length),m=0,y,x,P=this.path,B=this.pathSide==="right";for(this.__charBounds[i]=p,e=0;e<h.length;e++)o=h[e],f=this._getGraphemeBox(o,i,e,a),p[e]=f,n+=f.kernedWidth,a=o;if(p[e]={left:f?f.left+f.width:0,width:0,kernedWidth:0,height:this.fontSize},P){switch(x=P.segmentsInfo[P.segmentsInfo.length-1].length,y=r.util.getPointOnPath(P.path,0,P.segmentsInfo),y.x+=P.pathOffset.x,y.y+=P.pathOffset.y,this.textAlign){case"left":m=B?x-n:0;break;case"center":m=(x-n)/2;break;case"right":m=B?0:x-n;break}for(m+=this.pathStartOffset*(B?-1:1),e=B?h.length-1:0;B?e>=0:e<h.length;B?e--:e++)f=p[e],m>x?m%=x:m<0&&(m+=x),this._setGraphemeOnPath(m,f,y),m+=f.kernedWidth}return{width:n,numOfSpaces:d}},_setGraphemeOnPath:function(i,n,e){var o=i+n.kernedWidth/2,h=this.path,a=r.util.getPointOnPath(h.path,o,h.segmentsInfo);n.renderLeft=a.x-e.x,n.renderTop=a.y-e.y,n.angle=a.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(i,n,e,o,h){var a=this.getCompleteStyleDeclaration(n,e),f=o?this.getCompleteStyleDeclaration(n,e-1):{},d=this._measureChar(i,a,o,f),p=d.kernedWidth,m=d.width,y;this.charSpacing!==0&&(y=this._getWidthOfCharSpacing(),m+=y,p+=y);var x={width:m,left:0,height:a.fontSize,kernedWidth:p,deltaY:a.deltaY};if(e>0&&!h){var P=this.__charBounds[n][e-1];x.left=P.left+P.width+d.kernedWidth-d.width}return x},getHeightOfLine:function(i){if(this.__lineHeights[i])return this.__lineHeights[i];for(var n=this._textLines[i],e=this.getHeightOfChar(i,0),o=1,h=n.length;o<h;o++)e=Math.max(this.getHeightOfChar(i,o),e);return this.__lineHeights[i]=e*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var i,n=0,e=0,o=this._textLines.length;e<o;e++)i=this.getHeightOfLine(e),n+=e===o-1?i/this.lineHeight:i;return n},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(i,n){i.save();for(var e=0,o=this._getLeftOffset(),h=this._getTopOffset(),a=0,f=this._textLines.length;a<f;a++){var d=this.getHeightOfLine(a),p=d/this.lineHeight,m=this._getLineLeftOffset(a);this._renderTextLine(n,i,this._textLines[a],o+m,h+e+p,a),e+=d}i.restore()},_renderTextFill:function(i){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(i,"fillText")},_renderTextStroke:function(i){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(i),i.save(),this._setLineDash(i,this.strokeDashArray),i.beginPath(),this._renderTextCommon(i,"strokeText"),i.closePath(),i.restore())},_renderChars:function(i,n,e,o,h,a){var f=this.getHeightOfLine(a),d=this.textAlign.indexOf("justify")!==-1,p,m,y="",x,P=0,B,z=this.path,q=!d&&this.charSpacing===0&&this.isEmptyStyles(a)&&!z,Z=this.direction==="ltr",rt=this.direction==="ltr"?1:-1,ot,et=n.canvas.getAttribute("dir");if(n.save(),et!==this.direction&&(n.canvas.setAttribute("dir",Z?"ltr":"rtl"),n.direction=Z?"ltr":"rtl",n.textAlign=Z?"left":"right"),h-=f*this._fontSizeFraction/this.lineHeight,q){this._renderChar(i,n,a,0,e.join(""),o,h,f),n.restore();return}for(var nt=0,at=e.length-1;nt<=at;nt++)B=nt===at||this.charSpacing||z,y+=e[nt],x=this.__charBounds[a][nt],P===0?(o+=rt*(x.kernedWidth-x.width),P+=x.width):P+=x.kernedWidth,d&&!B&&this._reSpaceAndTab.test(e[nt])&&(B=!0),B||(p=p||this.getCompleteStyleDeclaration(a,nt),m=this.getCompleteStyleDeclaration(a,nt+1),B=r.util.hasStyleChanged(p,m,!1)),B&&(z?(n.save(),n.translate(x.renderLeft,x.renderTop),n.rotate(x.angle),this._renderChar(i,n,a,nt,y,-P/2,0,f),n.restore()):(ot=o,this._renderChar(i,n,a,nt,y,ot,h,f)),y="",p=m,o+=rt*P,P=0);n.restore()},_applyPatternGradientTransformText:function(i){var n=r.util.createCanvasElement(),e,o=this.width+this.strokeWidth,h=this.height+this.strokeWidth;return n.width=o,n.height=h,e=n.getContext("2d"),e.beginPath(),e.moveTo(0,0),e.lineTo(o,0),e.lineTo(o,h),e.lineTo(0,h),e.closePath(),e.translate(o/2,h/2),e.fillStyle=i.toLive(e),this._applyPatternGradientTransform(e,i),e.fill(),e.createPattern(n,"no-repeat")},handleFiller:function(i,n,e){var o,h;return e.toLive?e.gradientUnits==="percentage"||e.gradientTransform||e.patternTransform?(o=-this.width/2,h=-this.height/2,i.translate(o,h),i[n]=this._applyPatternGradientTransformText(e),{offsetX:o,offsetY:h}):(i[n]=e.toLive(i,this),this._applyPatternGradientTransform(i,e)):(i[n]=e,{offsetX:0,offsetY:0})},_setStrokeStyles:function(i,n){return i.lineWidth=n.strokeWidth,i.lineCap=this.strokeLineCap,i.lineDashOffset=this.strokeDashOffset,i.lineJoin=this.strokeLineJoin,i.miterLimit=this.strokeMiterLimit,this.handleFiller(i,"strokeStyle",n.stroke)},_setFillStyles:function(i,n){return this.handleFiller(i,"fillStyle",n.fill)},_renderChar:function(i,n,e,o,h,a,f){var d=this._getStyleDeclaration(e,o),p=this.getCompleteStyleDeclaration(e,o),m=i==="fillText"&&p.fill,y=i==="strokeText"&&p.stroke&&p.strokeWidth,x,P;!y&&!m||(n.save(),m&&(x=this._setFillStyles(n,p)),y&&(P=this._setStrokeStyles(n,p)),n.font=this._getFontDeclaration(p),d&&d.textBackgroundColor&&this._removeShadow(n),d&&d.deltaY&&(f+=d.deltaY),m&&n.fillText(h,a-x.offsetX,f-x.offsetY),y&&n.strokeText(h,a-P.offsetX,f-P.offsetY),n.restore())},setSuperscript:function(i,n){return this._setScript(i,n,this.superscript)},setSubscript:function(i,n){return this._setScript(i,n,this.subscript)},_setScript:function(i,n,e){var o=this.get2DCursorLocation(i,!0),h=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"fontSize"),a=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"deltaY"),f={fontSize:h*e.size,deltaY:a+h*e.baseline};return this.setSelectionStyles(f,i,n),this},_getLineLeftOffset:function(i){var n=this.getLineWidth(i),e=this.width-n,o=this.textAlign,h=this.direction,f,a=0,f=this.isEndOfWrapping(i);return o==="justify"||o==="justify-center"&&!f||o==="justify-right"&&!f||o==="justify-left"&&!f?0:(o==="center"&&(a=e/2),o==="right"&&(a=e),o==="justify-center"&&(a=e/2),o==="justify-right"&&(a=e),h==="rtl"&&(a-=e),a)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var i=this._forceClearCache;return i||(i=this.hasStateChanged("_dimensionAffectingProps")),i&&(this.dirty=!0,this._forceClearCache=!1),i},getLineWidth:function(i){if(this.__lineWidths[i]!==void 0)return this.__lineWidths[i];var n=this.measureLine(i),e=n.width;return this.__lineWidths[i]=e,e},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(i,n,e){var o=this._getStyleDeclaration(i,n);return o&&typeof o[e]<"u"?o[e]:this[e]},_renderTextDecoration:function(i,n){if(!(!this[n]&&!this.styleHas(n))){i.save(),(n==="overline"||n==="linethrough")&&this._removeShadow(i);for(var e,o,h,a,f,d,p,m,y=this._getLeftOffset(),x=this._getTopOffset(),P,B,z,q,Z,rt,ot,et,nt=this.path,at=this._getWidthOfCharSpacing(),st=this.offsets[n],tt=0,T=this._textLines.length;tt<T;tt++){if(e=this.getHeightOfLine(tt),!this[n]&&!this.styleHas(n,tt)){x+=e;continue}p=this._textLines[tt],rt=e/this.lineHeight,a=this._getLineLeftOffset(tt),B=0,z=0,m=this.getValueOfPropertyAt(tt,0,n),et=this.getValueOfPropertyAt(tt,0,"fill"),P=x+rt*(1-this._fontSizeFraction),o=this.getHeightOfChar(tt,0),f=this.getValueOfPropertyAt(tt,0,"deltaY");for(var R=0,F=p.length;R<F;R++)if(q=this.__charBounds[tt][R],Z=this.getValueOfPropertyAt(tt,R,n),ot=this.getValueOfPropertyAt(tt,R,"fill"),h=this.getHeightOfChar(tt,R),d=this.getValueOfPropertyAt(tt,R,"deltaY"),nt&&Z&&ot)i.save(),i.fillStyle=et,i.translate(q.renderLeft,q.renderTop),i.rotate(q.angle),i.fillRect(-q.kernedWidth/2,st*h+d,q.kernedWidth,this.fontSize/15),i.restore();else if((Z!==m||ot!==et||h!==o||d!==f)&&z>0){var k=y+a+B;this.direction==="rtl"&&(k=this.width-k-z),m&&et&&(i.fillStyle=et,i.fillRect(k,P+st*o+f,z,this.fontSize/15)),B=q.left,z=q.width,m=Z,et=ot,o=h,f=d}else z+=q.kernedWidth;var k=y+a+B;this.direction==="rtl"&&(k=this.width-k-z),i.fillStyle=ot,Z&&ot&&i.fillRect(k,P+st*o+f,z-at,this.fontSize/15),x+=e}i.restore()}},_getFontDeclaration:function(i,n){var e=i||this,o=this.fontFamily,h=r.Text.genericFonts.indexOf(o.toLowerCase())>-1,a=o===void 0||o.indexOf("'")>-1||o.indexOf(",")>-1||o.indexOf('"')>-1||h?e.fontFamily:'"'+e.fontFamily+'"';return[r.isLikelyNode?e.fontWeight:e.fontStyle,r.isLikelyNode?e.fontStyle:e.fontWeight,n?this.CACHE_FONT_SIZE+"px":e.fontSize+"px",a].join(" ")},render:function(i){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",i)))},_splitTextIntoLines:function(i){for(var n=i.split(this._reNewline),e=new Array(n.length),o=[`
`],h=[],a=0;a<n.length;a++)e[a]=r.util.string.graphemeSplit(n[a]),h=h.concat(e[a],o);return h.pop(),{_unwrappedLines:e,lines:n,graphemeText:h,graphemeLines:e}},toObject:function(i){var n=l.concat(i),e=this.callSuper("toObject",n);return e.styles=r.util.stylesToArray(this.styles,this.text),e.path&&(e.path=this.path.toObject()),e},set:function(i,n){this.callSuper("set",i,n);var e=!1,o=!1;if(typeof i=="object")for(var h in i)h==="path"&&this.setPathInfo(),e=e||this._dimensionAffectingProps.indexOf(h)!==-1,o=o||h==="path";else e=this._dimensionAffectingProps.indexOf(i)!==-1,o=i==="path";return o&&this.setPathInfo(),e&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),r.Text.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),r.Text.DEFAULT_SVG_FONT_SIZE=16,r.Text.fromElement=function(i,n,e){if(!i)return n(null);var o=r.parseAttributes(i,r.Text.ATTRIBUTE_NAMES),h=o.textAnchor||"left";if(e=r.util.object.extend(e?c(e):{},o),e.top=e.top||0,e.left=e.left||0,o.textDecoration){var a=o.textDecoration;a.indexOf("underline")!==-1&&(e.underline=!0),a.indexOf("overline")!==-1&&(e.overline=!0),a.indexOf("line-through")!==-1&&(e.linethrough=!0),delete e.textDecoration}"dx"in o&&(e.left+=o.dx),"dy"in o&&(e.top+=o.dy),"fontSize"in e||(e.fontSize=r.Text.DEFAULT_SVG_FONT_SIZE);var f="";"textContent"in i?f=i.textContent:"firstChild"in i&&i.firstChild!==null&&"data"in i.firstChild&&i.firstChild.data!==null&&(f=i.firstChild.data),f=f.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var d=e.strokeWidth;e.strokeWidth=0;var p=new r.Text(f,e),m=p.getScaledHeight()/p.height,y=(p.height+p.strokeWidth)*p.lineHeight-p.height,x=y*m,P=p.getScaledHeight()+x,B=0;h==="center"&&(B=p.getScaledWidth()/2),h==="right"&&(B=p.getScaledWidth()),p.set({left:p.left-B,top:p.top-(P-p.fontSize*(.07+p._fontSizeFraction))/p.lineHeight,strokeWidth:typeof d<"u"?d:1}),n(p)},r.Text.fromObject=function(i,n){var e=c(i),o=i.path;return delete e.path,r.Object._fromObject("Text",e,function(h){h.styles=r.util.stylesFromArray(i.styles,i.text),o?r.Object._fromObject("Path",o,function(a){h.set("path",a),n(h)},"path"):n(h)},"text")},r.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],r.util.createAccessors&&r.util.createAccessors(r.Text)}(s),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(u){if(!this.styles||typeof u<"u"&&!this.styles[u])return!0;var r=typeof u>"u"?this.styles:{line:this.styles[u]};for(var c in r)for(var l in r[c])for(var i in r[c][l])return!1;return!0},styleHas:function(u,r){if(!this.styles||!u||u===""||typeof r<"u"&&!this.styles[r])return!1;var c=typeof r>"u"?this.styles:{0:this.styles[r]};for(var l in c)for(var i in c[l])if(typeof c[l][i][u]<"u")return!0;return!1},cleanStyle:function(u){if(!this.styles||!u||u==="")return!1;var r=this.styles,c=0,l,i,n=!0,e=0,o;for(var h in r){l=0;for(var a in r[h]){var o=r[h][a],f=o.hasOwnProperty(u);c++,f?(i?o[u]!==i&&(n=!1):i=o[u],o[u]===this[u]&&delete o[u]):n=!1,Object.keys(o).length!==0?l++:delete r[h][a]}l===0&&delete r[h]}for(var d=0;d<this._textLines.length;d++)e+=this._textLines[d].length;n&&c===e&&(this[u]=i,this.removeStyle(u))},removeStyle:function(u){if(!(!this.styles||!u||u==="")){var r=this.styles,c,l,i;for(l in r){c=r[l];for(i in c)delete c[i][u],Object.keys(c[i]).length===0&&delete c[i];Object.keys(c).length===0&&delete r[l]}}},_extendStyles:function(u,r){var c=this.get2DCursorLocation(u);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),r)},get2DCursorLocation:function(u,r){typeof u>"u"&&(u=this.selectionStart);for(var c=r?this._unwrappedTextLines:this._textLines,l=c.length,i=0;i<l;i++){if(u<=c[i].length)return{lineIndex:i,charIndex:u};u-=c[i].length+this.missingNewlineOffset(i,r)}return{lineIndex:i-1,charIndex:c[i-1].length<u?c[i-1].length:u}},getSelectionStyles:function(u,r,c){typeof u>"u"&&(u=this.selectionStart||0),typeof r>"u"&&(r=this.selectionEnd||u);for(var l=[],i=u;i<r;i++)l.push(this.getStyleAtPosition(i,c));return l},getStyleAtPosition:function(u,r){var c=this.get2DCursorLocation(u),l=r?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return l||{}},setSelectionStyles:function(u,r,c){typeof r>"u"&&(r=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||r);for(var l=r;l<c;l++)this._extendStyles(l,u);return this._forceClearCache=!0,this},_getStyleDeclaration:function(u,r){var c=this.styles&&this.styles[u];return c?c[r]:null},getCompleteStyleDeclaration:function(u,r){for(var c=this._getStyleDeclaration(u,r)||{},l={},i,n=0;n<this._styleProperties.length;n++)i=this._styleProperties[n],l[i]=typeof c[i]>"u"?this[i]:c[i];return l},_setStyleDeclaration:function(u,r,c){this.styles[u][r]=c},_deleteStyleDeclaration:function(u,r){delete this.styles[u][r]},_getLineStyle:function(u){return!!this.styles[u]},_setLineStyle:function(u){this.styles[u]={}},_deleteLineStyle:function(u){delete this.styles[u]}})}(),function(){function u(r){r.textDecoration&&(r.textDecoration.indexOf("underline")>-1&&(r.underline=!0),r.textDecoration.indexOf("line-through")>-1&&(r.linethrough=!0),r.textDecoration.indexOf("overline")>-1&&(r.overline=!0),delete r.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(r,c){this.callSuper("initialize",r,c),this.initBehavior()},setSelectionStart:function(r){r=Math.max(r,0),this._updateAndFire("selectionStart",r)},setSelectionEnd:function(r){r=Math.min(r,this.text.length),this._updateAndFire("selectionEnd",r)},_updateAndFire:function(r,c){this[r]!==c&&(this._fireSelectionChanged(),this[r]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(r){this.clearContextTop(),this.callSuper("render",r),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(r){this.callSuper("_render",r)},clearContextTop:function(r){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,l=this.canvas.viewportTransform;c.save(),c.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this.transform(c),this._clearTextArea(c),r||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var r=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(r,c):this.renderSelection(r,c),c.restore()}},_clearTextArea:function(r){var c=this.width+4,l=this.height+4;r.clearRect(-c/2,-l/2,c,l)},_getCursorBoundaries:function(r){typeof r>"u"&&(r=this.selectionStart);var c=this._getLeftOffset(),l=this._getTopOffset(),i=this._getCursorBoundariesOffsets(r);return{left:c,top:l,leftOffset:i.left,topOffset:i.top}},_getCursorBoundariesOffsets:function(r){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,l,i,n=0,e=0,o,h=this.get2DCursorLocation(r);i=h.charIndex,l=h.lineIndex;for(var a=0;a<l;a++)n+=this.getHeightOfLine(a);c=this._getLineLeftOffset(l);var f=this.__charBounds[l][i];return f&&(e=f.left),this.charSpacing!==0&&i===this._textLines[l].length&&(e-=this._getWidthOfCharSpacing()),o={top:n,left:c+(e>0?e:0)},this.direction==="rtl"&&(o.left*=-1),this.cursorOffsetCache=o,this.cursorOffsetCache},renderCursor:function(r,c){var l=this.get2DCursorLocation(),i=l.lineIndex,n=l.charIndex>0?l.charIndex-1:0,e=this.getValueOfPropertyAt(i,n,"fontSize"),o=this.scaleX*this.canvas.getZoom(),h=this.cursorWidth/o,a=r.topOffset,f=this.getValueOfPropertyAt(i,n,"deltaY");a+=(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-e*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(r,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(i,n,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(r.left+r.leftOffset-h/2,a+r.top+f,h,e)},renderSelection:function(r,c){for(var l=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,i=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,n=this.textAlign.indexOf("justify")!==-1,e=this.get2DCursorLocation(l),o=this.get2DCursorLocation(i),h=e.lineIndex,a=o.lineIndex,f=e.charIndex<0?0:e.charIndex,d=o.charIndex<0?0:o.charIndex,p=h;p<=a;p++){var m=this._getLineLeftOffset(p)||0,y=this.getHeightOfLine(p),x=0,P=0,B=0;if(p===h&&(P=this.__charBounds[h][f].left),p>=h&&p<a)B=n&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===a)if(d===0)B=this.__charBounds[a][d].left;else{var z=this._getWidthOfCharSpacing();B=this.__charBounds[a][d-1].left+this.__charBounds[a][d-1].width-z}x=y,(this.lineHeight<1||p===a&&this.lineHeight>1)&&(y/=this.lineHeight);var q=r.left+m+P,Z=B-P,rt=y,ot=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",rt=1,ot=y):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(q=this.width-q-Z),c.fillRect(q,r.top+r.topOffset+ot,Z,rt),r.topOffset+=x}},getCurrentCharFontSize:function(){var r=this._getCurrentCharIndex();return this.getValueOfPropertyAt(r.l,r.c,"fontSize")},getCurrentCharColor:function(){var r=this._getCurrentCharIndex();return this.getValueOfPropertyAt(r.l,r.c,"fill")},_getCurrentCharIndex:function(){var r=this.get2DCursorLocation(this.selectionStart,!0),c=r.charIndex>0?r.charIndex-1:0;return{l:r.lineIndex,c}}}),t.IText.fromObject=function(r,c){var l=t.util.stylesFromArray(r.styles,r.text),i=Object.assign({},r,{styles:l});if(delete i.path,u(i),i.styles)for(var n in i.styles)for(var e in i.styles[n])u(i.styles[n][e]);t.Object._fromObject("IText",i,function(o){r.path?t.Object._fromObject("Path",r.path,function(h){o.set("path",h),c(o)},"path"):c(o)},"text")}}(),function(){var u=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var r=this;this.on("added",function(){var c=r.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,r._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(r))})},initRemovedHandler:function(){var r=this;this.on("removed",function(){var c=r.canvas;c&&(c._iTextInstances=c._iTextInstances||[],t.util.removeFromArray(c._iTextInstances,r),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,r._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(r){r._mouseUpITextHandler=function(){r._iTextInstances&&r._iTextInstances.forEach(function(c){c.__isMousedown=!1})},r.on("mouse:up",r._mouseUpITextHandler)},_removeCanvasHandlers:function(r){r.off("mouse:up",r._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(r,c,l,i){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},r.animate("_currentCursorOpacity",c,{duration:l,onComplete:function(){n.isAborted||r[i]()},onChange:function(){r.canvas&&r.selectionStart===r.selectionEnd&&r.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var r=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){r._currentTickCompleteState=r._animateCursor(r,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(r){var c=this,l=r?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},l)},abortCursorAnimation:function(){var r=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,r&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(r){var c=0,l=r-1;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)c++,l--;for(;/\S/.test(this._text[l])&&l>-1;)c++,l--;return r-c},findWordBoundaryRight:function(r){var c=0,l=r;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)c++,l++;for(;/\S/.test(this._text[l])&&l<this._text.length;)c++,l++;return r+c},findLineBoundaryLeft:function(r){for(var c=0,l=r-1;!/\n/.test(this._text[l])&&l>-1;)c++,l--;return r-c},findLineBoundaryRight:function(r){for(var c=0,l=r;!/\n/.test(this._text[l])&&l<this._text.length;)c++,l++;return r+c},searchWordBoundary:function(r,c){for(var l=this._text,i=this._reSpace.test(l[r])?r-1:r,n=l[i],e=t.reNonWord;!e.test(n)&&i>0&&i<l.length;)i+=c,n=l[i];return e.test(n)&&(i+=c===1?0:1),i},selectWord:function(r){r=r||this.selectionStart;var c=this.searchWordBoundary(r,-1),l=this.searchWordBoundary(r,1);this.selectionStart=c,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(r){r=r||this.selectionStart;var c=this.findLineBoundaryLeft(r),l=this.findLineBoundaryRight(r);return this.selectionStart=c,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(r){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(r),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(r){r._iTextInstances&&r._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(r){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(r.e),l=this.selectionStart,i=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||l===i)&&(l===c||i===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==l||this.selectionEnd!==i)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(r,c,l){var i=l.slice(0,r),n=t.util.string.graphemeSplit(i).length;if(r===c)return{selectionStart:n,selectionEnd:n};var e=l.slice(r,c),o=t.util.string.graphemeSplit(e).length;return{selectionStart:n,selectionEnd:n+o}},fromGraphemeToStringSelection:function(r,c,l){var i=l.slice(0,r),n=i.join("").length;if(r===c)return{selectionStart:n,selectionEnd:n};var e=l.slice(r,c),o=e.join("").length;return{selectionStart:n,selectionEnd:n+o}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var r=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=r.selectionStart,this.hiddenTextarea.selectionEnd=r.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var r=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=r.selectionEnd,this.inCompositionMode||(this.selectionStart=r.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var r=this._calcTextareaPosition();this.hiddenTextarea.style.left=r.left,this.hiddenTextarea.style.top=r.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var r=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(r),l=this.get2DCursorLocation(r),i=l.lineIndex,n=l.charIndex,e=this.getValueOfPropertyAt(i,n,"fontSize")*this.lineHeight,o=c.leftOffset,h=this.calcTransformMatrix(),a={x:c.left+o,y:c.top+c.topOffset+e},f=this.canvas.getRetinaScaling(),d=this.canvas.upperCanvasEl,p=d.width/f,m=d.height/f,y=p-e,x=m-e,P=d.clientWidth/p,B=d.clientHeight/m;return a=t.util.transformPoint(a,h),a=t.util.transformPoint(a,this.canvas.viewportTransform),a.x*=P,a.y*=B,a.x<0&&(a.x=0),a.x>y&&(a.x=y),a.y<0&&(a.y=0),a.y>x&&(a.y=x),a.x+=this.canvas._offset.left,a.y+=this.canvas._offset.top,{left:a.x+"px",top:a.y+"px",fontSize:e+"px",charHeight:e}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var r=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),r&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),r&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var r in this.styles)this._textLines[r]||delete this.styles[r]},removeStyleFromTo:function(r,c){var l=this.get2DCursorLocation(r,!0),i=this.get2DCursorLocation(c,!0),n=l.lineIndex,e=l.charIndex,o=i.lineIndex,h=i.charIndex,a,f;if(n!==o){if(this.styles[n])for(a=e;a<this._unwrappedTextLines[n].length;a++)delete this.styles[n][a];if(this.styles[o])for(a=h;a<this._unwrappedTextLines[o].length;a++)f=this.styles[o][a],f&&(this.styles[n]||(this.styles[n]={}),this.styles[n][e+a-h]=f);for(a=n+1;a<=o;a++)delete this.styles[a];this.shiftLineStyles(o,n-o)}else if(this.styles[n]){f=this.styles[n];var d=h-e,p,m;for(a=e;a<h;a++)delete f[a];for(m in this.styles[n])p=parseInt(m,10),p>=h&&(f[p-d]=f[m],delete f[m])}},shiftLineStyles:function(r,c){var l=u(this.styles);for(var i in this.styles){var n=parseInt(i,10);n>r&&(this.styles[n+c]=l[n],l[n-c]||delete this.styles[n])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(r,c,l,i){var n,e={},o=!1,h=this._unwrappedTextLines[r].length,a=h===c;l||(l=1),this.shiftLineStyles(r,l),this.styles[r]&&(n=this.styles[r][c===0?c:c-1]);for(var f in this.styles[r]){var d=parseInt(f,10);d>=c&&(o=!0,e[d-c]=this.styles[r][f],a&&c===0||delete this.styles[r][f])}var p=!1;for(o&&!a&&(this.styles[r+l]=e,p=!0),(p||h>c)&&l--;l>0;)i&&i[l-1]?this.styles[r+l]={0:u(i[l-1])}:n?this.styles[r+l]={0:u(n)}:delete this.styles[r+l],l--;this._forceClearCache=!0},insertCharStyleObject:function(r,c,l,i){this.styles||(this.styles={});var n=this.styles[r],e=n?u(n):{};l||(l=1);for(var o in e){var h=parseInt(o,10);h>=c&&(n[h+l]=e[h],e[h-l]||delete n[h])}if(this._forceClearCache=!0,i){for(;l--;)Object.keys(i[l]).length&&(this.styles[r]||(this.styles[r]={}),this.styles[r][c+l]=u(i[l]));return}if(n)for(var a=n[c?c-1:1];a&&l--;)this.styles[r][c+l]=u(a)},insertNewStyleBlock:function(r,c,l){for(var i=this.get2DCursorLocation(c,!0),n=[0],e=0,o=0;o<r.length;o++)r[o]===`
`?(e++,n[e]=0):n[e]++;n[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,n[0],l),l=l&&l.slice(n[0]+1)),e&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+n[0],e);for(var o=1;o<e;o++)n[o]>0?this.insertCharStyleObject(i.lineIndex+o,0,n[o],l):l&&this.styles[i.lineIndex+o]&&l[0]&&(this.styles[i.lineIndex+o][0]=l[0]),l=l&&l.slice(n[o]+1);n[o]>0&&this.insertCharStyleObject(i.lineIndex+o,0,n[o],l)},setSelectionStartEndWithShift:function(r,c,l){l<=r?(c===r?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=r),this.selectionStart=l):l>r&&l<c?this._selectionDirection==="right"?this.selectionEnd=l:this.selectionStart=l:(c===r?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=l)},setSelectionInBoundaries:function(){var r=this.text.length;this.selectionStart>r?this.selectionStart=r:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>r?this.selectionEnd=r:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(u){if(this.canvas){this.__newClickTime=+new Date;var r=u.pointer;this.isTripleClick(r)&&(this.fire("tripleclick",u),this._stopEvent(u.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=r,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(u){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===u.x&&this.__lastPointer.y===u.y},_stopEvent:function(u){u.preventDefault&&u.preventDefault(),u.stopPropagation&&u.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(u){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(u.e))},tripleClickHandler:function(u){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(u.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(u){!this.canvas||!this.editable||u.e.button&&u.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(u.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(u){!this.canvas||!this.editable||u.e.button&&u.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(u){if(this.__isMousedown=!1,!(!this.editable||this.group||u.transform&&u.transform.actionPerformed||u.e.button&&u.e.button!==1)){if(this.canvas){var r=this.canvas._activeObject;if(r&&r!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(u.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(u){var r=this.getSelectionStartFromPointer(u),c=this.selectionStart,l=this.selectionEnd;u.shiftKey?this.setSelectionStartEndWithShift(c,l,r):(this.selectionStart=r,this.selectionEnd=r),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(u){for(var r=this.getLocalPointer(u),c=0,l=0,i=0,n=0,e=0,o,h,a=0,f=this._textLines.length;a<f&&i<=r.y;a++)i+=this.getHeightOfLine(a)*this.scaleY,e=a,a>0&&(n+=this._textLines[a-1].length+this.missingNewlineOffset(a-1));o=this._getLineLeftOffset(e),l=o*this.scaleX,h=this._textLines[e],this.direction==="rtl"&&(r.x=this.width*this.scaleX-r.x+l);for(var d=0,p=h.length;d<p&&(c=l,l+=this.__charBounds[e][d].kernedWidth*this.scaleX,l<=r.x);d++)n++;return this._getNewSelectionStartFromOffset(r,c,l,n,p)},_getNewSelectionStartFromOffset:function(u,r,c,l,i){var n=u.x-r,e=c-u.x,o=e>n||e<0?0:1,h=l+o;return this.flipX&&(h=i-h),h>this._text.length&&(h=this._text.length),h}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var u=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+u.top+"; left: "+u.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+u.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(u){if(this.isEditing){var r=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(u.keyCode in r)this[r[u.keyCode]](u);else if(u.keyCode in this.ctrlKeysMapDown&&(u.ctrlKey||u.metaKey))this[this.ctrlKeysMapDown[u.keyCode]](u);else return;u.stopImmediatePropagation(),u.preventDefault(),u.keyCode>=33&&u.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(u){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(u.keyCode in this.ctrlKeysMapUp&&(u.ctrlKey||u.metaKey))this[this.ctrlKeysMapUp[u.keyCode]](u);else return;u.stopImmediatePropagation(),u.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(u){var r=this.fromPaste;if(this.fromPaste=!1,u&&u.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,l=this._text.length,i=c.length,n,e,o=i-l,h=this.selectionStart,a=this.selectionEnd,f=h!==a,d,p,m;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var y=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),x=h>y.selectionStart;f?(n=this._text.slice(h,a),o+=a-h):i<l&&(x?n=this._text.slice(a+o,a):n=this._text.slice(h,h-o)),e=c.slice(y.selectionEnd-o,y.selectionEnd),n&&n.length&&(e.length&&(d=this.getSelectionStyles(h,h+1,!1),d=e.map(function(){return d[0]})),f?(p=h,m=a):x?(p=a-n.length,m=a):(p=a,m=a+n.length),this.removeStyleFromTo(p,m)),e.length&&(r&&e.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(d=t.copiedTextStyle),this.insertNewStyleBlock(e,h,d)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(u){this.compositionStart=u.target.selectionStart,this.compositionEnd=u.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(u){return u&&u.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(u,r){var c=this._getLineLeftOffset(u),l;return r>0&&(l=this.__charBounds[u][r-1],c+=l.left+l.width),c},getDownCursorOffset:function(u,r){var c=this._getSelectionForOffset(u,r),l=this.get2DCursorLocation(c),i=l.lineIndex;if(i===this._textLines.length-1||u.metaKey||u.keyCode===34)return this._text.length-c;var n=l.charIndex,e=this._getWidthBeforeCursor(i,n),o=this._getIndexOnLine(i+1,e),h=this._textLines[i].slice(n);return h.length+o+1+this.missingNewlineOffset(i)},_getSelectionForOffset:function(u,r){return u.shiftKey&&this.selectionStart!==this.selectionEnd&&r?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(u,r){var c=this._getSelectionForOffset(u,r),l=this.get2DCursorLocation(c),i=l.lineIndex;if(i===0||u.metaKey||u.keyCode===33)return-c;var n=l.charIndex,e=this._getWidthBeforeCursor(i,n),o=this._getIndexOnLine(i-1,e),h=this._textLines[i].slice(0,n),a=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+o-h.length+(1-a)},_getIndexOnLine:function(u,r){for(var c=this._textLines[u],l=this._getLineLeftOffset(u),i=l,n=0,e,o,h=0,a=c.length;h<a;h++)if(e=this.__charBounds[u][h].width,i+=e,i>r){o=!0;var f=i-e,d=i,p=Math.abs(f-r),m=Math.abs(d-r);n=m<p?h:h-1;break}return o||(n=c.length-1),n},moveCursorDown:function(u){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",u)},moveCursorUp:function(u){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",u)},_moveCursorUpOrDown:function(u,r){var c="get"+u+"CursorOffset",l=this[c](r,this._selectionDirection==="right");r.shiftKey?this.moveCursorWithShift(l):this.moveCursorWithoutShift(l),l!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(u){var r=this._selectionDirection==="left"?this.selectionStart+u:this.selectionEnd+u;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,r),u!==0},moveCursorWithoutShift:function(u){return u<0?(this.selectionStart+=u,this.selectionEnd=this.selectionStart):(this.selectionEnd+=u,this.selectionStart=this.selectionEnd),u!==0},moveCursorLeft:function(u){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",u)},_move:function(u,r,c){var l;if(u.altKey)l=this["findWordBoundary"+c](this[r]);else if(u.metaKey||u.keyCode===35||u.keyCode===36)l=this["findLineBoundary"+c](this[r]);else return this[r]+=c==="Left"?-1:1,!0;if(typeof l<"u"&&this[r]!==l)return this[r]=l,!0},_moveLeft:function(u,r){return this._move(u,r,"Left")},_moveRight:function(u,r){return this._move(u,r,"Right")},moveCursorLeftWithoutShift:function(u){var r=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(r=this._moveLeft(u,"selectionStart")),this.selectionEnd=this.selectionStart,r},moveCursorLeftWithShift:function(u){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(u,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(u,"selectionStart")},moveCursorRight:function(u){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",u)},_moveCursorLeftOrRight:function(u,r){var c="moveCursor"+u+"With";this._currentCursorOpacity=1,r.shiftKey?c+="Shift":c+="outShift",this[c](r)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(u){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(u,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(u,"selectionEnd")},moveCursorRightWithoutShift:function(u){var r=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(r=this._moveRight(u,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,r},removeChars:function(u,r){typeof r>"u"&&(r=u+1),this.removeStyleFromTo(u,r),this._text.splice(u,r-u),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(u,r,c,l){typeof l>"u"&&(l=c),l>c&&this.removeStyleFromTo(c,l);var i=t.util.string.graphemeSplit(u);this.insertNewStyleBlock(i,c,r),this._text=[].concat(this._text.slice(0,c),i,this._text.slice(l)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var u=t.util.toFixed,r=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var c=this._getSVGLeftTopOffsets(),l=this._getSVGTextAndBg(c.textTop,c.textLeft);return this._wrapSVGTextAndBg(l)},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(),{reviver:c,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(c){var l=!0,i=this.getSvgTextDecoration(this);return[c.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",i?'text-decoration="'+i+'" ':"",'style="',this.getSvgStyles(l),'"',this.addPaintOrder()," >",c.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(c,l){var i=[],n=[],e=c,o;this._setSVGBg(n);for(var h=0,a=this._textLines.length;h<a;h++)o=this._getLineLeftOffset(h),(this.textBackgroundColor||this.styleHas("textBackgroundColor",h))&&this._setSVGTextLineBg(n,h,l+o,e),this._setSVGTextLineText(i,h,l+o,e),e+=this.getHeightOfLine(h);return{textSpans:i,textBgRects:n}},_createTextCharSpan:function(c,l,i,n){var e=c!==c.trim()||c.match(r),o=this.getSvgSpanStyles(l,e),h=o?'style="'+o+'"':"",a=l.deltaY,f="",d=t.Object.NUM_FRACTION_DIGITS;return a&&(f=' dy="'+u(a,d)+'" '),['<tspan x="',u(i,d),'" y="',u(n,d),'" ',f,h,">",t.util.string.escapeXml(c),"</tspan>"].join("")},_setSVGTextLineText:function(c,l,i,n){var e=this.getHeightOfLine(l),o=this.textAlign.indexOf("justify")!==-1,h,a,f="",d,p,m=0,y=this._textLines[l],x;n+=e*(1-this._fontSizeFraction)/this.lineHeight;for(var P=0,B=y.length-1;P<=B;P++)x=P===B||this.charSpacing,f+=y[P],d=this.__charBounds[l][P],m===0?(i+=d.kernedWidth-d.width,m+=d.width):m+=d.kernedWidth,o&&!x&&this._reSpaceAndTab.test(y[P])&&(x=!0),x||(h=h||this.getCompleteStyleDeclaration(l,P),a=this.getCompleteStyleDeclaration(l,P+1),x=t.util.hasStyleChanged(h,a,!0)),x&&(p=this._getStyleDeclaration(l,P)||{},c.push(this._createTextCharSpan(f,p,i,n)),f="",h=a,i+=m,m=0)},_pushTextBgRect:function(c,l,i,n,e,o){var h=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(l),' x="',u(i,h),'" y="',u(n,h),'" width="',u(e,h),'" height="',u(o,h),`"></rect>
`)},_setSVGTextLineBg:function(c,l,i,n){for(var e=this._textLines[l],o=this.getHeightOfLine(l)/this.lineHeight,h=0,a=0,f,d,p=this.getValueOfPropertyAt(l,0,"textBackgroundColor"),m=0,y=e.length;m<y;m++)f=this.__charBounds[l][m],d=this.getValueOfPropertyAt(l,m,"textBackgroundColor"),d!==p?(p&&this._pushTextBgRect(c,p,i+a,n,h,o),a=f.left,h=f.width,p=d):h+=f.kernedWidth;d&&this._pushTextBgRect(c,d,i+a,n,h,o)},_getFillAttributes:function(c){var l=c&&typeof c=="string"?new t.Color(c):"";return!l||!l.getSource()||l.getAlpha()===1?'fill="'+c+'"':'opacity="'+l.getAlpha()+'" fill="'+l.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(c){for(var l=0,i=0,n=0;n<c;n++)l+=this.getHeightOfLine(n);return i=this.getHeightOfLine(n),{lineTop:l,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(c){var l=t.Object.prototype.getSvgStyles.call(this,c);return l+" white-space: pre;"}})}(),function(u){var r=u.fabric||(u.fabric={});r.Textbox=r.util.createClass(r.IText,r.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:r.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var l=0,i=0,n=0,e={},o=0;o<c.graphemeLines.length;o++)c.graphemeText[n]===`
`&&o>0?(i=0,n++,l++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[n])&&o>0&&(i++,n++),e[o]={line:l,offset:i},n+=c.graphemeLines[o].length,i+=c.graphemeLines[o].length;return e},styleHas:function(c,l){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[l];i&&(l=i.line)}return r.Text.prototype.styleHas.call(this,c,l)},isEmptyStyles:function(c){if(!this.styles)return!0;var l=0,i=c+1,n,e,o=!1,h=this._styleMap[c],a=this._styleMap[c+1];h&&(c=h.line,l=h.offset),a&&(i=a.line,o=i===c,n=a.offset),e=typeof c>"u"?this.styles:{line:this.styles[c]};for(var f in e)for(var d in e[f])if(d>=l&&(!o||d<n))for(var p in e[f][d])return!1;return!0},_getStyleDeclaration:function(c,l){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[c];if(!i)return null;c=i.line,l=i.offset+l}return this.callSuper("_getStyleDeclaration",c,l)},_setStyleDeclaration:function(c,l,i){var n=this._styleMap[c];c=n.line,l=n.offset+l,this.styles[c][l]=i},_deleteStyleDeclaration:function(c,l){var i=this._styleMap[c];c=i.line,l=i.offset+l,delete this.styles[c][l]},_getLineStyle:function(c){var l=this._styleMap[c];return!!this.styles[l.line]},_setLineStyle:function(c){var l=this._styleMap[c];this.styles[l.line]={}},_wrapText:function(c,l){var i=[],n;for(this.isWrapping=!0,n=0;n<c.length;n++)i=i.concat(this._wrapLine(c[n],n,l));return this.isWrapping=!1,i},_measureWord:function(c,l,i){var n=0,e,o=!0;i=i||0;for(var h=0,a=c.length;h<a;h++){var f=this._getGraphemeBox(c[h],l,h+i,e,o);n+=f.kernedWidth,e=c[h]}return n},_wrapLine:function(c,l,i,q){var e=0,o=this.splitByGrapheme,h=[],a=[],f=o?r.util.string.graphemeSplit(c):c.split(this._wordJoiners),d="",p=0,m=o?"":" ",y=0,x=0,P=0,B=!0,z=this._getWidthOfCharSpacing(),q=q||0;f.length===0&&f.push([]),i-=q;for(var Z=0;Z<f.length;Z++)d=o?f[Z]:r.util.string.graphemeSplit(f[Z]),y=this._measureWord(d,l,p),p+=d.length,e+=x+y-z,e>i&&!B?(h.push(a),a=[],e=y,B=!0):e+=z,!B&&!o&&a.push(m),a=a.concat(d),x=o?0:this._measureWord([m],l,p),p++,B=!1,y>P&&(P=y);return Z&&h.push(a),P+q>this.dynamicMinWidth&&(this.dynamicMinWidth=P-z+q),h},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c,l){return this.splitByGrapheme&&!l?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var l=r.Text.prototype._splitTextIntoLines.call(this,c),i=this._wrapText(l.lines,this.width),n=new Array(i.length),e=0;e<i.length;e++)n[e]=i[e].join("");return l.lines=n,l.graphemeLines=i,l},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var l in this._styleMap)this._textLines[l]&&(c[this._styleMap[l].line]=1);for(var l in this.styles)c[l]||delete this.styles[l]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),r.Textbox.fromObject=function(c,l){var i=r.util.stylesFromArray(c.styles,c.text),n=Object.assign({},c,{styles:i});return delete n.path,r.Object._fromObject("Textbox",n,function(e){c.path?r.Object._fromObject("Path",c.path,function(o){e.set("path",o),l(e)},"path"):l(e)},"text")}}(s),function(){var u=t.controlsUtils,r=u.scaleSkewCursorStyleHandler,c=u.scaleCursorStyleHandler,l=u.scalingEqually,i=u.scalingYOrSkewingX,n=u.scalingXOrSkewingY,e=u.scaleOrSkewActionName,o=t.Object.prototype.controls;if(o.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:r,actionHandler:n,getActionName:e}),o.mr=new t.Control({x:.5,y:0,cursorStyleHandler:r,actionHandler:n,getActionName:e}),o.mb=new t.Control({x:0,y:.5,cursorStyleHandler:r,actionHandler:i,getActionName:e}),o.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:r,actionHandler:i,getActionName:e}),o.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:l}),o.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:l}),o.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:l}),o.br=new t.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:l}),o.mtr=new t.Control({x:0,y:-.5,actionHandler:u.rotationWithSnapping,cursorStyleHandler:u.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var h=t.Textbox.prototype.controls={};h.mtr=o.mtr,h.tr=o.tr,h.br=o.br,h.tl=o.tl,h.bl=o.bl,h.mt=o.mt,h.mb=o.mb,h.mr=new t.Control({x:.5,y:0,actionHandler:u.changeWidth,cursorStyleHandler:r,actionName:"resizing"}),h.ml=new t.Control({x:-.5,y:0,actionHandler:u.changeWidth,cursorStyleHandler:r,actionName:"resizing"})}}()})(wt);const Rc=""+new URL("mohu-8a8db77a.png",import.meta.url).href;const Lc={class:"home"},Ic={class:"canvasMain"},jc={class:"btnBox"},Bc=["onClick"],Xc={__name:"HomeView",setup(s){let t={};const g=di("brush"),v=di([{name:"画笔",label:"brush"},{name:"文字",label:"text"},{name:"选择元素",label:"move"},{name:"选择图片",label:"imgs"},{name:"模糊遮盖形状",label:"imgs1"},{name:"清空",label:"empty"},{name:"下载导出",label:"download"}]),_=n=>{switch(n){case"imgs":const o=document.getElementById("image-upload");o.click(),o.onchange=function(f){var d=f.target.files[0];if(d){var p=new FileReader;p.onload=function(m){wt.fabric.Image.fromURL(m.target.result,function(y){console.log(y);var x=y.scale(.5).set({left:t.width/2-y.width/4,top:t.height/2-y.height/4});t.add(x),t.renderAll(),g.value="move",_("move")},null,{crossOrigin:"anonymous"})},p.readAsDataURL(d)}};break;case"imgs1":wt.fabric.Image.fromURL(Rc,function(f){console.log(f);var d=f.scale(.5).set({left:t.width/2-f.width/4,top:t.height/2-f.height/4});t.add(d),t.renderAll(),g.value="move",_("move")},null,{crossOrigin:"anonymous"});break;case"move":t.isDrawingMode=!1,t.on("mouse:down",function(f){f.e,this.isDragging=!1,this.selection=!0});break;case"brush":t.off("mouse:down"),t.off("mouse:move"),t.off("mouse:up"),t.isDrawingMode=!0,t.selection=!1,t.freeDrawingBrush=new wt.fabric.PencilBrush(t),t.freeDrawingBrush.width=5,t.fill="#fff",console.log(t.freeDrawingBrush),t.freeDrawingBrush.color="#8df";break;case"text":const h=new wt.fabric.IText("点击这里编辑文本",{left:100,top:100,fontSize:30,fontFamily:"arial",fill:"#333",editingBorderColor:"#FF0099",borderColor:"#D3D3D3",cornerColor:"#009900",cornerStyle:"circle",padding:10});t.add(h),t.renderAll(),g.value="move",_("move");break;case"restore":t.zoomToPoint({x:t.width/2,y:t.height/2},1),zoom.value=t.getZoom()*100;break;case"revocation":t.undoDraw(),g.value="brush",_("brush");break;case"advance":t.redoDraw(),g.value="brush",_("brush");break;case"empty":t.getObjects().forEach(function(f){f!==t.backgroundImage&&f!==w&&t.remove(f)}),t.renderAll(),g.value="brush",_("brush");break;case"download":t.isDrawingMode=!1,w.visible=!1;const a=t.toDataURL({format:"png",quality:1});var e=document.createElement("a");e.href=a,w.visible=!0,e.download="canvas_image.png",e.addEventListener("click",()=>{_("brush"),g.value="brush"}),e.click();break;case"eraser":t.freeDrawingBrush=new wt.fabric.EraserBrush(t),t.freeDrawingBrush.width=20,t.isDrawingMode=!0;break}},C=()=>{const n=document.getElementById("canvasBox");t=new wt.fabric.Canvas("canvasId",{backgroundColor:"#fff",isDrawingMode:!0,selection:!0,allowTouchScrolling:!0,preserveObjectStacking:!0,enableRetinaScaling:!0,perPixelTargetFind:!0,width:n.clientWidth,height:n.clientHeight}),t.setCursor("auto"),_("brush"),u(),i(),l()};let w="";const u=()=>{var n=new wt.fabric.StaticCanvas(null,{width:2,height:2,backgroundColor:"rgba(255, 255, 255, 0.1)"});w=new wt.fabric.Image(n.getElement(),{left:t.width/2-n.width/2,top:t.height/2-n.height/2,selectable:!1,hasControls:!1,stroke:"blue",strokeWidth:0,erasable:!1,hasBorders:!1,perPixelTargetFind:!0},null,{crossOrigin:"anonymous"});var e=new wt.fabric.Gradient({type:"linear",coords:{x1:w.width/2,y1:0,x2:0,y2:w.width/3},colorStops:[{offset:0,color:"#2e528c"},{offset:1,color:"#793252"}]});w.stroke=e,t.add(w),w.set("excludeFromScaling",!0),w.on("mouseover",function(o){o.target.selectable=!0}),w.on("mousedown",function(o){o.target.selectable=!0}),w.on("mouseout",function(o){o.target.selectable=!1}),w.on("mouseup",function(o){o.target.selectable=!1})};let r=!1,c=[];const l=()=>{wt.fabric.Canvas.prototype.undoDraw=()=>{if(t._objects.length>1){const o=t._objects.length-2,h=t._objects.splice(o,1)[0];h&&(c.push(h),console.log(t._objects,"撤销"),t.renderAll())}},wt.fabric.Canvas.prototype.redoDraw=()=>{c.length>0&&(r=!0,t.add(c.pop()),t.renderAll())};let n=null;wt.fabric.Canvas.prototype.Copy=()=>{t.getActiveObject().clone(function(o){n=o}),console.log(t.getActiveObject())},wt.fabric.Canvas.prototype.Paste=()=>{n.clone(function(o){t.discardActiveObject(),o.set({left:o.left+10,top:o.top+10,evented:!0}),o.type==="activeSelection"?(o.canvas=t,o.forEachObject(function(h){t.add(h)}),o.setCoords()):t.add(o),n.top+=10,n.left+=10,t.setActiveObject(o),t.requestRenderAll()})},wt.fabric.Canvas.prototype.deleteObject=(o,h)=>{var a=t.getActiveObjects();t.remove.apply(t,a),t.discardActiveObject(),t.renderAll(),e=!1};let e=!1;wt.fabric.Canvas.prototype.allselect=()=>{if(e)t.discardActiveObject(),e=!1;else{var o=new wt.fabric.ActiveSelection(t.getObjects(),{canvas:t});t.setActiveObject(o),e=!0}t.requestRenderAll()}},i=()=>{let n="";window.addEventListener("keydown",e=>{n=e.keyCode,wt.fabric.Canvas.prototype._keyCode=e.keyCode}),window.addEventListener("wheel",function(e){e.ctrlKey===!0&&(e.preventDefault(),e.stopPropagation())},{passive:!1}),t.on("mouse:wheel",function(e){var o=e.e;if(o.ctrlKey===!0){var h=e.e.deltaY,a=t.getZoom();a*=.999**h,a>50&&(a=50),a<.1&&(a=.1),t.zoomToPoint({x:e.e.offsetX,y:e.e.offsetY},a),zoomFN()}},{passive:!1}),t.on("mouse:down",function(e){var o=e.e;(o.altKey===!0||n===32)&&(t.isDrawingMode=!1,this.isDragging=!0,this.selection=!1,this.lastPosX=o.clientX,this.lastPosY=o.clientY)}),t.on("mouse:move",function(e){if(this.isDragging){var o=e.e,h=this.viewportTransform;h[4]+=o.clientX-this.lastPosX,h[5]+=o.clientY-this.lastPosY,this.requestRenderAll(),this.lastPosX=o.clientX,this.lastPosY=o.clientY}}),t.on("mouse:up",function(e){this.setViewportTransform(this.viewportTransform),this.isDragging=!1,this.selection=!0}),t.on("object:moving",e=>{e.target.getBoundingRect()}),t.on("object:scaling",e=>{}),t.on("object:added",e=>{console.log("改变监听added",e),t.bringToFront(w),r==!1&&(c=[])}),t.on("selection:created",function(e){console.log(e)}),t.on("object:selected",function(e){console.log("单选事件触发了")}),t.on("selection:cleared",function(e){}),t.on("erasing:end",function(e){console.log(e)})};return ps(()=>{C()}),(n,e)=>(ci(),Wi("div",Lc,[jt("div",Ic,[e[0]||(e[0]=jt("div",{class:"canvasBox",id:"canvasBox"},[jt("canvas",{id:"canvasId",style:{width:"100%",height:"100%"}})],-1)),jt("div",jc,[(ci(!0),Wi(Gt,null,la(v.value,o=>(ci(),Wi("button",{type:"button",key:o.label,onClick:h=>_(o.label)},jr(o.name),9,Bc))),128))]),e[1]||(e[1]=jt("input",{type:"file",id:"image-upload",name:"image",style:{display:"none"},accept:"image/png, image/jpeg, image/gif,image/webp"},null,-1))]),e[2]||(e[2]=jt("div",{class:"tipBox"},[jt("h2",null,"待解决问题："),jt("p",null,"重点标注形状，重点批注形状"),jt("p",null,"图层层级排列"),jt("p",null,"元素选中后删除(跟输入文字删除冲突，暂时去掉删除功能)")],-1))]))}},Wc=to(Xc,[["__scopeId","data-v-101beff8"]]),Hc=Pc({history:rc(),routes:[{path:"/",name:"home",component:Wc}]}),kn=bl(Dc);kn.use(Ol());kn.use(Hc);kn.mount("#app");
