import{bO as ut,aS as O,q as Se,u as F,v as g,at as Wt,b9 as Ee,s as fe,t as ct,bH as K,I as b,aX as z,H as ke,aK as U,as as pe}from"./index-BAi-_Ng5.js";const ft=typeof window<"u"&&typeof window.document<"u",L=ft?window:{},vt=ft?"ontouchstart"in L.document.documentElement:!1,bt=ft?"PointerEvent"in L:!1,B="cropper",nt=`${B}-canvas`,Te=`${B}-crosshair`,Ae=`${B}-grid`,xe=`${B}-handle`,pt=`${B}-image`,H=`${B}-selection`,Re=`${B}-shade`,Ie=`${B}-viewer`,lt="select",ge="move",J="scale",$t="rotate",ht="transform",Y="none",Lt="n-resize",Ut="e-resize",Xt="s-resize",Yt="w-resize",tt="ne-resize",et="nw-resize",st="se-resize",it="sw-resize",Oe="action",Pe=vt?"touchend touchcancel":"mouseup",Ne=vt?"touchmove":"mousemove",ze=vt?"touchstart":"mousedown",Ht=bt?"pointerdown":ze,jt=bt?"pointermove":Ne,Bt=bt?"pointerup pointercancel":Pe,Ft="error",Kt="keydown",V="load",Zt="wheel",Q="action",Z="actionend",Me="actionmove",q="actionstart",j="change",mt="transform";function De(d){return typeof d=="string"}const $e=Number.isNaN||L.isNaN;function R(d){return typeof d=="number"&&!$e(d)}function W(d){return R(d)&&d>0&&d<1/0}function We(d){return typeof d>"u"}function me(d){return typeof d=="object"&&d!==null}const{hasOwnProperty:Le}=Object.prototype;function dt(d){if(!me(d))return!1;try{const{constructor:t}=d,{prototype:e}=t;return t&&e&&Le.call(e,"isPrototypeOf")}catch{return!1}}function wt(d){return typeof d=="function"}function _t(d){return typeof d=="object"&&d!==null&&d.nodeType===1}const Ue=/([a-z\d])([A-Z])/g;function qt(d){return String(d).replace(Ue,"$1-$2").toLowerCase()}const Xe=/-[A-z\d]/g;function Gt(d){return d.replace(Xe,t=>t.slice(1).toUpperCase())}const ve=/\s\s*/;function M(d,t,e,s){t.trim().split(ve).forEach(i=>{d.removeEventListener(i,e,s)})}function D(d,t,e,s){t.trim().split(ve).forEach(i=>{d.addEventListener(i,e,s)})}function Vt(d,t,e,s){D(d,t,e,Object.assign(Object.assign({},s),{once:!0}))}const Ye={bubbles:!0,cancelable:!0,composed:!0};function He(d,t,e,s){return d.dispatchEvent(new CustomEvent(t,Object.assign(Object.assign(Object.assign({},Ye),{detail:e}),s)))}function je(d){return typeof d.composedPath=="function"&&d.composedPath().find(_t)||d.target}const Jt=Promise.resolve();function Be(d,t){return t?Jt.then(d?t.bind(d):t):Jt}function Fe(d){const t=d.getRootNode();switch(t.nodeType){case 1:return t.ownerDocument;case 9:return t;case 11:return t}return null}function Qt(d){const{documentElement:t}=d.ownerDocument,e=d.getBoundingClientRect();return{left:e.left+(L.pageXOffset-t.clientLeft),top:e.top+(L.pageYOffset-t.clientTop)}}const Ke=/deg|g?rad|turn$/i;function gt(d){const t=parseFloat(d)||0;if(t!==0){const[e="rad"]=String(d).match(Ke)||[];switch(e.toLowerCase()){case"deg":return t/360*(Math.PI*2);case"grad":return t/400*(Math.PI*2);case"turn":return t*(Math.PI*2)}}return t}const te="contain",Ze="cover";function rt(d,t=te){const{aspectRatio:e}=d;let{width:s,height:i}=d;const n=W(s),o=W(i);if(n&&o){const r=i*e;t===te&&r>s||t===Ze&&r<s?i=s/e:s=i*e}else n?i=s/e:o&&(s=i*e);return{width:s,height:i}}function be(d,...t){if(t.length===0)return d;const[e,s,i,n,o,r]=d,[l,c,a,w,_,k]=t[0];return d=[e*l+i*c,s*l+n*c,e*a+i*w,s*a+n*w,e*_+i*k+o,s*_+n*k+r],be(d,...t.slice(1))}var qe=":host([hidden]){display:none!important}";const Ge=/left|top|width|height/i,ee="open",ot=new WeakMap,at=new WeakMap,se=new Map,ie=L.document&&Array.isArray(L.document.adoptedStyleSheets)&&"replaceSync"in L.CSSStyleSheet.prototype;class X extends HTMLElement{get $sharedStyle(){return`${this.themeColor?`:host{--theme-color: ${this.themeColor};}`:""}${qe}`}constructor(){var t,e;super(),this.shadowRootMode=ee,this.slottable=!0;const s=(e=(t=Object.getPrototypeOf(this))===null||t===void 0?void 0:t.constructor)===null||e===void 0?void 0:e.$name;s&&se.set(s,this.tagName.toLowerCase())}static get observedAttributes(){return["shadow-root-mode","slottable","theme-color"]}attributeChangedCallback(t,e,s){if(Object.is(s,e))return;const i=Gt(t),n=this[i];let o=s;switch(typeof n){case"boolean":o=s!==null&&s!=="false";break;case"number":o=Number(s);break}switch(this[i]=o,t){case"theme-color":{const r=at.get(this),l=this.$sharedStyle;r&&l&&(ie?r.replaceSync(l):r.textContent=l);break}}}$propertyChangedCallback(t,e,s){if(!Object.is(s,e))switch(t=qt(t),typeof s){case"boolean":s===!0?this.hasAttribute(t)||this.setAttribute(t,""):this.removeAttribute(t);break;case"number":$e(s)?s="":s=String(s);default:s?this.getAttribute(t)!==s&&this.setAttribute(t,s):this.removeAttribute(t)}}connectedCallback(){Object.getPrototypeOf(this).constructor.observedAttributes.forEach(e=>{const s=Gt(e);let i=this[s];We(i)||this.$propertyChangedCallback(s,void 0,i),Object.defineProperty(this,s,{enumerable:!0,configurable:!0,get(){return i},set(n){const o=i;i=n,this.$propertyChangedCallback(s,o,n)}})});const t=this.shadowRoot||this.attachShadow({mode:this.shadowRootMode||ee});if(ot.set(this,t),at.set(this,this.$addStyles(this.$sharedStyle)),this.$style&&this.$addStyles(this.$style),this.$template){const e=document.createElement("template");e.innerHTML=this.$template,t.appendChild(e.content)}if(this.slottable){const e=document.createElement("slot");t.appendChild(e)}}disconnectedCallback(){at.has(this)&&at.delete(this),ot.has(this)&&ot.delete(this)}$getTagNameOf(t){var e;return(e=se.get(t))!==null&&e!==void 0?e:t}$setStyles(t){return Object.keys(t).forEach(e=>{let s=t[e];R(s)&&(s!==0&&Ge.test(e)?s=`${s}px`:s=String(s)),this.style[e]=s}),this}$getShadowRoot(){return this.shadowRoot||ot.get(this)}$addStyles(t){let e;const s=this.$getShadowRoot();return ie?(e=new CSSStyleSheet,e.replaceSync(t),s.adoptedStyleSheets=s.adoptedStyleSheets.concat(e)):(e=document.createElement("style"),e.textContent=t,s.appendChild(e)),e}$emit(t,e,s){return He(this,t,e,s)}$nextTick(t){return Be(this,t)}static $define(t,e){me(t)&&(e=t,t=""),t||(t=this.$name||this.name),t=qt(t),ft&&L.customElements&&!L.customElements.get(t)&&customElements.define(t,this,e)}}X.$version="2.1.0";var Ve=':host{display:block;min-height:100px;min-width:200px;overflow:hidden;position:relative;touch-action:none;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}:host([background]){background-color:#fff;background-image:repeating-linear-gradient(45deg,#ccc 25%,transparent 0,transparent 75%,#ccc 0,#ccc),repeating-linear-gradient(45deg,#ccc 25%,transparent 0,transparent 75%,#ccc 0,#ccc);background-image:repeating-conic-gradient(#ccc 0 25%,#fff 0 50%);background-position:0 0,.5rem .5rem;background-size:1rem 1rem}:host([disabled]){pointer-events:none}:host([disabled]):after{bottom:0;content:"";cursor:not-allowed;display:block;left:0;pointer-events:none;position:absolute;right:0;top:0}';class Ct extends X{constructor(){super(...arguments),this.$onPointerDown=null,this.$onPointerMove=null,this.$onPointerUp=null,this.$onWheel=null,this.$wheeling=!1,this.$pointers=new Map,this.$style=Ve,this.$action=Y,this.background=!1,this.disabled=!1,this.scaleStep=.1,this.themeColor="#39f"}static get observedAttributes(){return super.observedAttributes.concat(["background","disabled","scale-step"])}connectedCallback(){super.connectedCallback(),this.disabled||this.$bind()}disconnectedCallback(){this.disabled||this.$unbind(),super.disconnectedCallback()}$propertyChangedCallback(t,e,s){if(!Object.is(s,e))switch(super.$propertyChangedCallback(t,e,s),t){case"disabled":s?this.$unbind():this.$bind();break}}$bind(){this.$onPointerDown||(this.$onPointerDown=this.$handlePointerDown.bind(this),D(this,Ht,this.$onPointerDown)),this.$onPointerMove||(this.$onPointerMove=this.$handlePointerMove.bind(this),D(this.ownerDocument,jt,this.$onPointerMove)),this.$onPointerUp||(this.$onPointerUp=this.$handlePointerUp.bind(this),D(this.ownerDocument,Bt,this.$onPointerUp)),this.$onWheel||(this.$onWheel=this.$handleWheel.bind(this),D(this,Zt,this.$onWheel,{passive:!1,capture:!0}))}$unbind(){this.$onPointerDown&&(M(this,Ht,this.$onPointerDown),this.$onPointerDown=null),this.$onPointerMove&&(M(this.ownerDocument,jt,this.$onPointerMove),this.$onPointerMove=null),this.$onPointerUp&&(M(this.ownerDocument,Bt,this.$onPointerUp),this.$onPointerUp=null),this.$onWheel&&(M(this,Zt,this.$onWheel,{capture:!0}),this.$onWheel=null)}$handlePointerDown(t){const{buttons:e,button:s,type:i}=t;if(this.disabled||(i==="pointerdown"&&t.pointerType==="mouse"||i==="mousedown")&&(R(e)&&e!==1||R(s)&&s!==0||t.ctrlKey))return;const{$pointers:n}=this;let o="";if(t.changedTouches)Array.from(t.changedTouches).forEach(({identifier:r,pageX:l,pageY:c})=>{n.set(r,{startX:l,startY:c,endX:l,endY:c})});else{const{pointerId:r=0,pageX:l,pageY:c}=t;n.set(r,{startX:l,startY:c,endX:l,endY:c})}n.size>1?o=ht:_t(t.target)&&(o=t.target.action||t.target.getAttribute(Oe)||""),this.$emit(q,{action:o,relatedEvent:t})!==!1&&(t.preventDefault(),this.$action=o,this.style.willChange="transform")}$handlePointerMove(t){const{$action:e,$pointers:s}=this;if(this.disabled||e===Y||s.size===0||this.$emit(Me,{action:e,relatedEvent:t})===!1)return;if(t.preventDefault(),t.changedTouches)Array.from(t.changedTouches).forEach(({identifier:n,pageX:o,pageY:r})=>{const l=s.get(n);l&&Object.assign(l,{endX:o,endY:r})});else{const{pointerId:n=0,pageX:o,pageY:r}=t,l=s.get(n);l&&Object.assign(l,{endX:o,endY:r})}const i={action:e,relatedEvent:t};if(e===ht){const n=new Map(s);let o=0,r=0,l=0,c=0,a=t.pageX,w=t.pageY;s.forEach((u,T)=>{n.delete(T),n.forEach(S=>{let C=S.startX-u.startX,p=S.startY-u.startY,y=S.endX-u.endX,m=S.endY-u.endY,x=0,I=0,h=0,f=0;if(C===0?p<0?h=Math.PI*2:p>0&&(h=Math.PI):C>0?h=Math.PI/2+Math.atan(p/C):C<0&&(h=Math.PI*1.5+Math.atan(p/C)),y===0?m<0?f=Math.PI*2:m>0&&(f=Math.PI):y>0?f=Math.PI/2+Math.atan(m/y):y<0&&(f=Math.PI*1.5+Math.atan(m/y)),f>0||h>0){const $=f-h,v=Math.abs($);v>o&&(o=v,l=$,a=(u.startX+S.startX)/2,w=(u.startY+S.startY)/2)}if(C=Math.abs(C),p=Math.abs(p),y=Math.abs(y),m=Math.abs(m),C>0&&p>0?x=Math.sqrt(C*C+p*p):C>0?x=C:p>0&&(x=p),y>0&&m>0?I=Math.sqrt(y*y+m*m):y>0?I=y:m>0&&(I=m),x>0&&I>0){const $=(I-x)/x,v=Math.abs($);v>r&&(r=v,c=$,a=(u.startX+S.startX)/2,w=(u.startY+S.startY)/2)}})});const _=o>0,k=r>0;_&&k?(i.rotate=l,i.scale=c,i.centerX=a,i.centerY=w):_?(i.action=$t,i.rotate=l,i.centerX=a,i.centerY=w):k?(i.action=J,i.scale=c,i.centerX=a,i.centerY=w):i.action=Y}else{const[n]=Array.from(s.values());Object.assign(i,n)}s.forEach(n=>{n.startX=n.endX,n.startY=n.endY}),i.action!==Y&&this.$emit(Q,i,{cancelable:!1})}$handlePointerUp(t){const{$action:e,$pointers:s}=this;if(!(this.disabled||e===Y)&&this.$emit(Z,{action:e,relatedEvent:t})!==!1){if(t.preventDefault(),t.changedTouches)Array.from(t.changedTouches).forEach(({identifier:i})=>{s.delete(i)});else{const{pointerId:i=0}=t;s.delete(i)}s.size===0&&(this.style.willChange="",this.$action=Y)}}$handleWheel(t){if(this.disabled||(t.preventDefault(),this.$wheeling))return;this.$wheeling=!0,setTimeout(()=>{this.$wheeling=!1},50);const s=(t.deltaY>0?-1:1)*this.scaleStep;this.$emit(Q,{action:J,scale:s,relatedEvent:t},{cancelable:!1})}$setAction(t){return De(t)&&(this.$action=t),this}$toCanvas(t){return new Promise((e,s)=>{if(!this.isConnected){s(new Error("The current element is not connected to the DOM."));return}const i=document.createElement("canvas");let n=this.offsetWidth,o=this.offsetHeight,r=1;dt(t)&&(W(t.width)||W(t.height))&&({width:n,height:o}=rt({aspectRatio:n/o,width:t.width,height:t.height}),r=n/this.offsetWidth),i.width=n,i.height=o;const l=this.querySelector(this.$getTagNameOf(pt));if(!l){e(i);return}l.$ready().then(c=>{const a=i.getContext("2d");if(a){const[w,_,k,u,T,S]=l.$getTransform();let C=T,p=S,y=c.naturalWidth,m=c.naturalHeight;r!==1&&(C*=r,p*=r,y*=r,m*=r);const x=y/2,I=m/2;a.fillStyle="transparent",a.fillRect(0,0,n,o),dt(t)&&wt(t.beforeDraw)&&t.beforeDraw.call(this,a,i),a.save(),a.translate(x,I),a.transform(w,_,k,u,C,p),a.translate(-x,-I),a.drawImage(c,0,0,y,m),a.restore()}e(i)}).catch(s)})}}Ct.$name=nt;Ct.$version="2.1.0";var Je=":host{display:inline-block}img{display:block;height:100%;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;width:100%}";const ne=new WeakMap,oe=["alt","crossorigin","decoding","elementtiming","fetchpriority","loading","referrerpolicy","sizes","src","srcset"];class yt extends X{constructor(){super(...arguments),this.$matrix=[1,0,0,1,0,0],this.$onLoad=null,this.$onCanvasAction=null,this.$onCanvasActionEnd=null,this.$onCanvasActionStart=null,this.$actionStartTarget=null,this.$style=Je,this.$image=new Image,this.initialCenterSize="contain",this.rotatable=!1,this.scalable=!1,this.skewable=!1,this.slottable=!1,this.translatable=!1,this.alt="",this.crossorigin="",this.decoding="",this.elementtiming="",this.fetchpriority="",this.loading="",this.referrerpolicy="",this.sizes="",this.src="",this.srcset=""}set $canvas(t){ne.set(this,t)}get $canvas(){return ne.get(this)}static get observedAttributes(){return super.observedAttributes.concat(oe,["initial-center-size","rotatable","scalable","skewable","translatable"])}attributeChangedCallback(t,e,s){Object.is(s,e)||(super.attributeChangedCallback(t,e,s),oe.includes(t)&&this.$image.setAttribute(t,s))}$propertyChangedCallback(t,e,s){if(!Object.is(s,e))switch(super.$propertyChangedCallback(t,e,s),t){case"initialCenterSize":this.$nextTick(()=>{this.$center(s)});break}}connectedCallback(){super.connectedCallback();const{$image:t}=this,e=this.closest(this.$getTagNameOf(nt));e&&(this.$canvas=e,this.$setStyles({display:"block",position:"absolute"}),this.$onCanvasActionStart=s=>{var i,n;this.$actionStartTarget=(n=(i=s.detail)===null||i===void 0?void 0:i.relatedEvent)===null||n===void 0?void 0:n.target},this.$onCanvasActionEnd=()=>{this.$actionStartTarget=null},this.$onCanvasAction=this.$handleAction.bind(this),D(e,q,this.$onCanvasActionStart),D(e,Z,this.$onCanvasActionEnd),D(e,Q,this.$onCanvasAction)),this.$onLoad=this.$handleLoad.bind(this),D(t,V,this.$onLoad),this.$getShadowRoot().appendChild(t)}disconnectedCallback(){const{$image:t,$canvas:e}=this;e&&(this.$onCanvasActionStart&&(M(e,q,this.$onCanvasActionStart),this.$onCanvasActionStart=null),this.$onCanvasActionEnd&&(M(e,Z,this.$onCanvasActionEnd),this.$onCanvasActionEnd=null),this.$onCanvasAction&&(M(e,Q,this.$onCanvasAction),this.$onCanvasAction=null)),t&&this.$onLoad&&(M(t,V,this.$onLoad),this.$onLoad=null),this.$getShadowRoot().removeChild(t),super.disconnectedCallback()}$handleLoad(){const{$image:t}=this;this.$setStyles({width:t.naturalWidth,height:t.naturalHeight}),this.$canvas&&this.$center(this.initialCenterSize)}$handleAction(t){if(this.hidden||!(this.rotatable||this.scalable||this.translatable))return;const{$canvas:e}=this,{detail:s}=t;if(s){const{relatedEvent:i}=s;let{action:n}=s;switch(n===ht&&(!this.rotatable||!this.scalable)&&(this.rotatable?n=$t:this.scalable?n=J:n=Y),n){case ge:if(this.translatable){let o=null;i&&(o=i.target.closest(this.$getTagNameOf(H))),o||(o=e.querySelector(this.$getTagNameOf(H))),o&&o.multiple&&!o.active&&(o=e.querySelector(`${this.$getTagNameOf(H)}[active]`)),(!o||o.hidden||!o.movable||o.dynamic||!(this.$actionStartTarget&&o.contains(this.$actionStartTarget)))&&this.$move(s.endX-s.startX,s.endY-s.startY)}break;case $t:if(this.rotatable)if(i){const{x:o,y:r}=this.getBoundingClientRect();this.$rotate(s.rotate,i.clientX-o,i.clientY-r)}else this.$rotate(s.rotate);break;case J:if(this.scalable)if(i){const o=i.target.closest(this.$getTagNameOf(H));if(!o||!o.zoomable||o.zoomable&&o.dynamic){const{x:r,y:l}=this.getBoundingClientRect();this.$zoom(s.scale,i.clientX-r,i.clientY-l)}}else this.$zoom(s.scale);break;case ht:if(this.rotatable&&this.scalable){const{rotate:o}=s;let{scale:r}=s;r<0?r=1/(1-r):r+=1;const l=Math.cos(o),c=Math.sin(o),[a,w,_,k]=[l*r,c*r,-c*r,l*r];if(i){const u=this.getBoundingClientRect(),T=i.clientX-u.x,S=i.clientY-u.y,[C,p,y,m]=this.$matrix,x=u.width/2,I=u.height/2,h=T-x,f=S-I,$=(h*m-y*f)/(C*m-y*p),v=(f*C-p*h)/(C*m-y*p);this.$transform(a,w,_,k,$*(1-a)+v*_,v*(1-k)+$*w)}else this.$transform(a,w,_,k,0,0)}break}}}$ready(t){const{$image:e}=this,s=new Promise((i,n)=>{const o=new Error("Failed to load the image source");if(e.complete)e.naturalWidth>0&&e.naturalHeight>0?i(e):n(o);else{const r=()=>{M(e,Ft,l),setTimeout(()=>{i(e)})},l=()=>{M(e,V,r),n(o)};Vt(e,V,r),Vt(e,Ft,l)}});return wt(t)&&s.then(i=>(t(i),i)),s}$center(t){const{parentElement:e}=this;if(!e)return this;const s=e.getBoundingClientRect(),i=s.width,n=s.height,{x:o,y:r,width:l,height:c}=this.getBoundingClientRect(),a=o+l/2,w=r+c/2,_=s.x+i/2,k=s.y+n/2;if(this.$move(_-a,k-w),t&&(l!==i||c!==n)){const u=i/l,T=n/c;switch(t){case"cover":this.$scale(Math.max(u,T));break;case"contain":this.$scale(Math.min(u,T));break}}return this}$move(t,e=t){if(this.translatable&&R(t)&&R(e)){const[s,i,n,o]=this.$matrix,r=(t*o-n*e)/(s*o-n*i),l=(e*s-i*t)/(s*o-n*i);this.$translate(r,l)}return this}$moveTo(t,e=t){if(this.translatable&&R(t)&&R(e)){const[s,i,n,o]=this.$matrix,r=(t*o-n*e)/(s*o-n*i),l=(e*s-i*t)/(s*o-n*i);this.$setTransform(s,i,n,o,r,l)}return this}$rotate(t,e,s){if(this.rotatable){const i=gt(t),n=Math.cos(i),o=Math.sin(i),[r,l,c,a]=[n,o,-o,n];if(R(e)&&R(s)){const[w,_,k,u]=this.$matrix,{width:T,height:S}=this.getBoundingClientRect(),C=T/2,p=S/2,y=e-C,m=s-p,x=(y*u-k*m)/(w*u-k*_),I=(m*w-_*y)/(w*u-k*_);this.$transform(r,l,c,a,x*(1-r)-I*c,I*(1-a)-x*l)}else this.$transform(r,l,c,a,0,0)}return this}$zoom(t,e,s){if(!this.scalable||t===0)return this;if(t<0?t=1/(1-t):t+=1,R(e)&&R(s)){const[i,n,o,r]=this.$matrix,{width:l,height:c}=this.getBoundingClientRect(),a=l/2,w=c/2,_=e-a,k=s-w,u=(_*r-o*k)/(i*r-o*n),T=(k*i-n*_)/(i*r-o*n);this.$transform(t,0,0,t,u*(1-t),T*(1-t))}else this.$scale(t);return this}$scale(t,e=t){return this.scalable&&this.$transform(t,0,0,e,0,0),this}$skew(t,e=0){if(this.skewable){const s=gt(t),i=gt(e);this.$transform(1,Math.tan(i),Math.tan(s),1,0,0)}return this}$translate(t,e=t){return this.translatable&&R(t)&&R(e)&&this.$transform(1,0,0,1,t,e),this}$transform(t,e,s,i,n,o){return R(t)&&R(e)&&R(s)&&R(i)&&R(n)&&R(o)?this.$setTransform(be(this.$matrix,[t,e,s,i,n,o])):this}$setTransform(t,e,s,i,n,o){if((this.rotatable||this.scalable||this.skewable||this.translatable)&&(Array.isArray(t)&&([t,e,s,i,n,o]=t),R(t)&&R(e)&&R(s)&&R(i)&&R(n)&&R(o))){const r=[...this.$matrix],l=[t,e,s,i,n,o];if(this.$emit(mt,{matrix:l,oldMatrix:r})===!1)return this;this.$matrix=l,this.style.transform=`matrix(${l.join(", ")})`}return this}$getTransform(){return this.$matrix.slice()}$resetTransform(){return this.$setTransform([1,0,0,1,0,0])}}yt.$name=pt;yt.$version="2.1.0";var Qe=":host{display:block;height:0;left:0;outline:var(--theme-color) solid 1px;position:relative;top:0;width:0}:host([transparent]){outline-color:transparent}";const ae=new WeakMap;class St extends X{constructor(){super(...arguments),this.$onCanvasActionEnd=null,this.$onCanvasActionStart=null,this.$onSelectionChange=null,this.$style=Qe,this.x=0,this.y=0,this.width=0,this.height=0,this.slottable=!1,this.themeColor="rgba(0, 0, 0, 0.65)"}set $canvas(t){ae.set(this,t)}get $canvas(){return ae.get(this)}static get observedAttributes(){return super.observedAttributes.concat(["height","width","x","y"])}connectedCallback(){super.connectedCallback();const t=this.closest(this.$getTagNameOf(nt));if(t){this.$canvas=t,this.style.position="absolute";const e=t.querySelector(this.$getTagNameOf(H));e&&(this.$onCanvasActionStart=s=>{e.hidden&&s.detail.action===lt&&(this.hidden=!1)},this.$onCanvasActionEnd=s=>{e.hidden&&s.detail.action===lt&&(this.hidden=!0)},this.$onSelectionChange=s=>{const{x:i,y:n,width:o,height:r}=s.defaultPrevented?e:s.detail;this.$change(i,n,o,r),(e.hidden||i===0&&n===0&&o===0&&r===0)&&(this.hidden=!0)},D(t,q,this.$onCanvasActionStart),D(t,Z,this.$onCanvasActionEnd),D(t,j,this.$onSelectionChange))}this.$render()}disconnectedCallback(){const{$canvas:t}=this;t&&(this.$onCanvasActionStart&&(M(t,q,this.$onCanvasActionStart),this.$onCanvasActionStart=null),this.$onCanvasActionEnd&&(M(t,Z,this.$onCanvasActionEnd),this.$onCanvasActionEnd=null),this.$onSelectionChange&&(M(t,j,this.$onSelectionChange),this.$onSelectionChange=null)),super.disconnectedCallback()}$change(t,e,s=this.width,i=this.height){return!R(t)||!R(e)||!R(s)||!R(i)||t===this.x&&e===this.y&&s===this.width&&i===this.height?this:(this.hidden&&(this.hidden=!1),this.x=t,this.y=e,this.width=s,this.height=i,this.$render())}$reset(){return this.$change(0,0,0,0)}$render(){return this.$setStyles({transform:`translate(${this.x}px, ${this.y}px)`,width:this.width,height:this.height,outlineWidth:L.innerWidth})}}St.$name=Re;St.$version="2.1.0";var ts=':host{background-color:var(--theme-color);display:block}:host([action=move]),:host([action=select]){height:100%;left:0;position:absolute;top:0;width:100%}:host([action=move]){cursor:move}:host([action=select]){cursor:crosshair}:host([action$=-resize]){background-color:transparent;height:15px;position:absolute;width:15px}:host([action$=-resize]):after{background-color:var(--theme-color);content:"";display:block;height:5px;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%);width:5px}:host([action=n-resize]),:host([action=s-resize]){cursor:ns-resize;left:50%;transform:translateX(-50%);width:100%}:host([action=n-resize]){top:-8px}:host([action=s-resize]){bottom:-8px}:host([action=e-resize]),:host([action=w-resize]){cursor:ew-resize;height:100%;top:50%;transform:translateY(-50%)}:host([action=e-resize]){right:-8px}:host([action=w-resize]){left:-8px}:host([action=ne-resize]){cursor:nesw-resize;right:-8px;top:-8px}:host([action=nw-resize]){cursor:nwse-resize;left:-8px;top:-8px}:host([action=se-resize]){bottom:-8px;cursor:nwse-resize;right:-8px}:host([action=se-resize]):after{height:15px;width:15px}@media (pointer:coarse){:host([action=se-resize]):after{height:10px;width:10px}}@media (pointer:fine){:host([action=se-resize]):after{height:5px;width:5px}}:host([action=sw-resize]){bottom:-8px;cursor:nesw-resize;left:-8px}:host([plain]){background-color:transparent}';class Et extends X{constructor(){super(...arguments),this.$onCanvasCropEnd=null,this.$onCanvasCropStart=null,this.$style=ts,this.action=Y,this.plain=!1,this.slottable=!1,this.themeColor="rgba(51, 153, 255, 0.5)"}static get observedAttributes(){return super.observedAttributes.concat(["action","plain"])}}Et.$name=xe;Et.$version="2.1.0";var es=':host{display:block;left:0;position:relative;right:0}:host([outlined]){outline:1px solid var(--theme-color)}:host([multiple]){outline:1px dashed hsla(0,0%,100%,.5)}:host([multiple]):after{bottom:0;content:"";cursor:pointer;display:block;left:0;position:absolute;right:0;top:0}:host([multiple][active]){outline-color:var(--theme-color);z-index:1}:host([multiple])>*{visibility:hidden}:host([multiple][active])>*{visibility:visible}:host([multiple][active]):after{display:none}';const re=new WeakMap;class kt extends X{constructor(){super(...arguments),this.$onCanvasAction=null,this.$onCanvasActionStart=null,this.$onCanvasActionEnd=null,this.$onDocumentKeyDown=null,this.$action="",this.$actionStartTarget=null,this.$changing=!1,this.$style=es,this.$initialSelection={x:0,y:0,width:0,height:0},this.x=0,this.y=0,this.width=0,this.height=0,this.aspectRatio=NaN,this.initialAspectRatio=NaN,this.initialCoverage=NaN,this.active=!1,this.linked=!1,this.dynamic=!1,this.movable=!1,this.resizable=!1,this.zoomable=!1,this.multiple=!1,this.keyboard=!1,this.outlined=!1,this.precise=!1}set $canvas(t){re.set(this,t)}get $canvas(){return re.get(this)}static get observedAttributes(){return super.observedAttributes.concat(["active","aspect-ratio","dynamic","height","initial-aspect-ratio","initial-coverage","keyboard","linked","movable","multiple","outlined","precise","resizable","width","x","y","zoomable"])}$propertyChangedCallback(t,e,s){if(!Object.is(s,e))switch(super.$propertyChangedCallback(t,e,s),t){case"x":case"y":case"width":case"height":this.$changing||this.$nextTick(()=>{this.$change(this.x,this.y,this.width,this.height,this.aspectRatio,!0)});break;case"aspectRatio":case"initialAspectRatio":this.$nextTick(()=>{this.$initSelection()});break;case"initialCoverage":this.$nextTick(()=>{W(s)&&s<=1&&this.$initSelection(!0,!0)});break;case"keyboard":this.$nextTick(()=>{this.$canvas&&(s?this.$onDocumentKeyDown||(this.$onDocumentKeyDown=this.$handleKeyDown.bind(this),D(this.ownerDocument,Kt,this.$onDocumentKeyDown)):this.$onDocumentKeyDown&&(M(this.ownerDocument,Kt,this.$onDocumentKeyDown),this.$onDocumentKeyDown=null))});break;case"multiple":this.$nextTick(()=>{if(this.$canvas){const i=this.$getSelections();s?(i.forEach(n=>{n.active=!1}),this.active=!0,this.$emit(j,{x:this.x,y:this.y,width:this.width,height:this.height})):(this.active=!1,i.slice(1).forEach(n=>{this.$removeSelection(n)}))}});break;case"precise":this.$nextTick(()=>{this.$change(this.x,this.y)});break;case"linked":s&&(this.dynamic=!0);break}}connectedCallback(){super.connectedCallback();const t=this.closest(this.$getTagNameOf(nt));t?(this.$canvas=t,this.$setStyles({position:"absolute",transform:`translate(${this.x}px, ${this.y}px)`}),this.hidden||this.$render(),this.$initSelection(!0),this.$onCanvasActionStart=this.$handleActionStart.bind(this),this.$onCanvasActionEnd=this.$handleActionEnd.bind(this),this.$onCanvasAction=this.$handleAction.bind(this),D(t,q,this.$onCanvasActionStart),D(t,Z,this.$onCanvasActionEnd),D(t,Q,this.$onCanvasAction)):this.$render()}disconnectedCallback(){const{$canvas:t}=this;t&&(this.$onCanvasActionStart&&(M(t,q,this.$onCanvasActionStart),this.$onCanvasActionStart=null),this.$onCanvasActionEnd&&(M(t,Z,this.$onCanvasActionEnd),this.$onCanvasActionEnd=null),this.$onCanvasAction&&(M(t,Q,this.$onCanvasAction),this.$onCanvasAction=null)),super.disconnectedCallback()}$getSelections(){let t=[];return this.parentElement&&(t=Array.from(this.parentElement.querySelectorAll(this.$getTagNameOf(H)))),t}$initSelection(t=!1,e=!1){const{initialCoverage:s,parentElement:i}=this;if(W(s)&&i){const n=this.aspectRatio||this.initialAspectRatio;let o=(e?0:this.width)||i.offsetWidth*s,r=(e?0:this.height)||i.offsetHeight*s;W(n)&&({width:o,height:r}=rt({aspectRatio:n,width:o,height:r})),this.$change(this.x,this.y,o,r),t&&this.$center(),this.$initialSelection={x:this.x,y:this.y,width:this.width,height:this.height}}}$createSelection(){const t=this.cloneNode(!0);return this.hasAttribute("id")&&t.removeAttribute("id"),t.initialCoverage=NaN,this.active=!1,this.parentElement&&this.parentElement.insertBefore(t,this.nextSibling),t}$removeSelection(t=this){if(this.parentElement){const e=this.$getSelections();if(e.length>1){const s=e.indexOf(t),i=e[s+1]||e[s-1];i&&(t.active=!1,this.parentElement.removeChild(t),i.active=!0,i.$emit(j,{x:i.x,y:i.y,width:i.width,height:i.height}))}else this.$clear()}}$handleActionStart(t){var e,s;const i=(s=(e=t.detail)===null||e===void 0?void 0:e.relatedEvent)===null||s===void 0?void 0:s.target;this.$action="",this.$actionStartTarget=i,!this.hidden&&this.multiple&&!this.active&&i===this&&this.parentElement&&(this.$getSelections().forEach(n=>{n.active=!1}),this.active=!0,this.$emit(j,{x:this.x,y:this.y,width:this.width,height:this.height}))}$handleAction(t){const{currentTarget:e,detail:s}=t;if(!e||!s)return;const{relatedEvent:i}=s;let{action:n}=s;const o=i?je(i):null;if(!n&&this.multiple&&(n=this.$action||(o==null?void 0:o.action),this.$action=n),!n||this.hidden&&n!==lt||this.multiple&&!this.active&&n!==J)return;const{width:r,height:l}=this;let c=s.endX-s.startX,a=s.endY-s.startY,{aspectRatio:w}=this;switch(!W(w)&&i.shiftKey&&(w=W(r)&&W(l)?r/l:1),n){case lt:if(c!==0||a!==0){c===0?c=a:a===0&&(a=c);const{$canvas:_}=this,k=Qt(e);(this.multiple&&!this.hidden?this.$createSelection():this).$change(s.startX-k.left,s.startY-k.top,Math.abs(c),Math.abs(a),w),c<0?a<0?n=et:a>0&&(n=it):c>0&&(a<0?n=tt:a>0&&(n=st)),_&&(_.$action=n)}break;case ge:this.movable&&(this.dynamic||this.$actionStartTarget&&this.contains(this.$actionStartTarget))&&this.$move(c,a);break;case J:if(i&&this.zoomable&&(this.dynamic||this.contains(i.target))){const _=Qt(e);this.$zoom(s.scale,i.pageX-_.left,i.pageY-_.top)}break;default:this.$resize(n,c,a,w)}}$handleActionEnd(){this.$action="",this.$actionStartTarget=null}$handleKeyDown(t){if(this.hidden||!this.keyboard||this.multiple&&!this.active||t.defaultPrevented)return;const{activeElement:e}=document;if(!(e&&(["INPUT","TEXTAREA"].includes(e.tagName)||["true","plaintext-only"].includes(e.contentEditable))))switch(t.key){case"Backspace":t.metaKey&&(t.preventDefault(),this.$removeSelection());break;case"Delete":t.preventDefault(),this.$removeSelection();break;case"ArrowLeft":t.preventDefault(),this.$move(-1,0);break;case"ArrowRight":t.preventDefault(),this.$move(1,0);break;case"ArrowUp":t.preventDefault(),this.$move(0,-1);break;case"ArrowDown":t.preventDefault(),this.$move(0,1);break;case"+":t.preventDefault(),this.$zoom(.1);break;case"-":t.preventDefault(),this.$zoom(-.1);break}}$center(){const{parentElement:t}=this;if(!t)return this;const e=(t.offsetWidth-this.width)/2,s=(t.offsetHeight-this.height)/2;return this.$change(e,s)}$move(t,e=t){return this.$moveTo(this.x+t,this.y+e)}$moveTo(t,e=t){return this.movable?this.$change(t,e):this}$resize(t,e=0,s=0,i=this.aspectRatio){if(!this.resizable)return this;const n=W(i),{$canvas:o}=this;let{x:r,y:l,width:c,height:a}=this;switch(t){case Lt:l+=s,a-=s,a<0&&(t=Xt,a=-a,l-=a),n&&(e=s*i,r+=e/2,c-=e,c<0&&(c=-c,r-=c));break;case Ut:c+=e,c<0&&(t=Yt,c=-c,r-=c),n&&(s=e/i,l-=s/2,a+=s,a<0&&(a=-a,l-=a));break;case Xt:a+=s,a<0&&(t=Lt,a=-a,l-=a),n&&(e=s*i,r-=e/2,c+=e,c<0&&(c=-c,r-=c));break;case Yt:r+=e,c-=e,c<0&&(t=Ut,c=-c,r-=c),n&&(s=e/i,l+=s/2,a-=s,a<0&&(a=-a,l-=a));break;case tt:n&&(s=-e/i),l+=s,a-=s,c+=e,c<0&&a<0?(t=it,c=-c,a=-a,r-=c,l-=a):c<0?(t=et,c=-c,r-=c):a<0&&(t=st,a=-a,l-=a);break;case et:n&&(s=e/i),r+=e,l+=s,c-=e,a-=s,c<0&&a<0?(t=st,c=-c,a=-a,r-=c,l-=a):c<0?(t=tt,c=-c,r-=c):a<0&&(t=it,a=-a,l-=a);break;case st:n&&(s=e/i),c+=e,a+=s,c<0&&a<0?(t=et,c=-c,a=-a,r-=c,l-=a):c<0?(t=it,c=-c,r-=c):a<0&&(t=tt,a=-a,l-=a);break;case it:n&&(s=-e/i),r+=e,c-=e,a+=s,c<0&&a<0?(t=tt,c=-c,a=-a,r-=c,l-=a):c<0?(t=st,c=-c,r-=c):a<0&&(t=et,a=-a,l-=a);break}return o&&o.$setAction(t),this.$change(r,l,c,a)}$zoom(t,e,s){if(!this.zoomable||t===0)return this;t<0?t=1/(1-t):t+=1;const{width:i,height:n}=this,o=i*t,r=n*t;let l=this.x,c=this.y;return R(e)&&R(s)?(l-=(o-i)*((e-this.x)/i),c-=(r-n)*((s-this.y)/n)):(l-=(o-i)/2,c-=(r-n)/2),this.$change(l,c,o,r)}$change(t,e,s=this.width,i=this.height,n=this.aspectRatio,o=!1){return this.$changing||!R(t)||!R(e)||!R(s)||!R(i)||s<0||i<0?this:(W(n)&&({width:s,height:i}=rt({aspectRatio:n,width:s,height:i},"cover")),this.precise||(t=Math.round(t),e=Math.round(e),s=Math.round(s),i=Math.round(i)),t===this.x&&e===this.y&&s===this.width&&i===this.height&&Object.is(n,this.aspectRatio)&&!o?this:(this.hidden&&(this.hidden=!1),this.$emit(j,{x:t,y:e,width:s,height:i})===!1?this:(this.$changing=!0,this.x=t,this.y=e,this.width=s,this.height=i,this.$changing=!1,this.$render())))}$reset(){const{x:t,y:e,width:s,height:i}=this.$initialSelection;return this.$change(t,e,s,i)}$clear(){return this.$change(0,0,0,0,NaN,!0),this.hidden=!0,this}$render(){return this.$setStyles({transform:`translate(${this.x}px, ${this.y}px)`,width:this.width,height:this.height})}$toCanvas(t){return new Promise((e,s)=>{if(!this.isConnected){s(new Error("The current element is not connected to the DOM."));return}const i=document.createElement("canvas");let{width:n,height:o}=this,r=1;if(dt(t)&&(W(t.width)||W(t.height))&&({width:n,height:o}=rt({aspectRatio:n/o,width:t.width,height:t.height}),r=n/this.width),i.width=n,i.height=o,!this.$canvas){e(i);return}const l=this.$canvas.querySelector(this.$getTagNameOf(pt));if(!l){e(i);return}l.$ready().then(c=>{const a=i.getContext("2d");if(a){const[w,_,k,u,T,S]=l.$getTransform(),C=-this.x,p=-this.y,y=(C*u-k*p)/(w*u-k*_),m=(p*w-_*C)/(w*u-k*_);let x=w*y+k*m+T,I=_*y+u*m+S,h=c.naturalWidth,f=c.naturalHeight;r!==1&&(x*=r,I*=r,h*=r,f*=r);const $=h/2,v=f/2;a.fillStyle="transparent",a.fillRect(0,0,n,o),dt(t)&&wt(t.beforeDraw)&&t.beforeDraw.call(this,a,i),a.save(),a.translate($,v),a.transform(w,_,k,u,x,I),a.translate(-$,-v),a.drawImage(c,0,0,h,f),a.restore()}e(i)}).catch(s)})}}kt.$name=H;kt.$version="2.1.0";var ss=":host{display:flex;flex-direction:column;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}:host([bordered]){border:1px dashed var(--theme-color)}:host([covered]){bottom:0;left:0;position:absolute;right:0;top:0}:host>span{display:flex;flex:1}:host>span+span{border-top:1px dashed var(--theme-color)}:host>span>span{flex:1}:host>span>span+span{border-left:1px dashed var(--theme-color)}";class Tt extends X{constructor(){super(...arguments),this.$style=ss,this.bordered=!1,this.columns=3,this.covered=!1,this.rows=3,this.slottable=!1,this.themeColor="rgba(238, 238, 238, 0.5)"}static get observedAttributes(){return super.observedAttributes.concat(["bordered","columns","covered","rows"])}$propertyChangedCallback(t,e,s){Object.is(s,e)||(super.$propertyChangedCallback(t,e,s),(t==="rows"||t==="columns")&&this.$nextTick(()=>{this.$render()}))}connectedCallback(){super.connectedCallback(),this.$render()}$render(){const t=this.$getShadowRoot(),e=document.createDocumentFragment();for(let s=0;s<this.rows;s+=1){const i=document.createElement("span");i.setAttribute("role","row");for(let n=0;n<this.columns;n+=1){const o=document.createElement("span");o.setAttribute("role","gridcell"),i.appendChild(o)}e.appendChild(i)}t&&(t.innerHTML="",t.appendChild(e))}}Tt.$name=Ae;Tt.$version="2.1.0";var is=':host{display:inline-block;height:1em;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle;width:1em}:host:after,:host:before{background-color:var(--theme-color);content:"";display:block;position:absolute}:host:before{height:1px;left:0;top:50%;transform:translateY(-50%);width:100%}:host:after{height:100%;left:50%;top:0;transform:translateX(-50%);width:1px}:host([centered]){left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}';class At extends X{constructor(){super(...arguments),this.$style=is,this.centered=!1,this.slottable=!1,this.themeColor="rgba(238, 238, 238, 0.5)"}static get observedAttributes(){return super.observedAttributes.concat(["centered"])}}At.$name=Te;At.$version="2.1.0";var ns=":host{display:block;height:100%;overflow:hidden;position:relative;width:100%}";const ce=new WeakMap,le=new WeakMap,he=new WeakMap,de=new WeakMap,os="both",as="horizontal",ue="vertical",rs="none";class xt extends X{constructor(){super(...arguments),this.$onSelectionChange=null,this.$onSourceImageLoad=null,this.$onSourceImageTransform=null,this.$scale=1,this.$style=ns,this.resize=ue,this.selection="",this.slottable=!1}set $image(t){le.set(this,t)}get $image(){return le.get(this)}set $sourceImage(t){de.set(this,t)}get $sourceImage(){return de.get(this)}set $canvas(t){ce.set(this,t)}get $canvas(){return ce.get(this)}set $selection(t){he.set(this,t)}get $selection(){return he.get(this)}static get observedAttributes(){return super.observedAttributes.concat(["resize","selection"])}connectedCallback(){var t,e;super.connectedCallback();let s=null;if(this.selection?s=(e=(t=Fe(this))===null||t===void 0?void 0:t.querySelector(this.selection))!==null&&e!==void 0?e:null:s=this.closest(this.$getTagNameOf(H)),_t(s)){this.$selection=s,this.$onSelectionChange=this.$handleSelectionChange.bind(this),D(s,j,this.$onSelectionChange);const i=s.closest(this.$getTagNameOf(nt));if(i){this.$canvas=i;const n=i.querySelector(this.$getTagNameOf(pt));n&&(this.$sourceImage=n,this.$image=n.cloneNode(!0),this.$getShadowRoot().appendChild(this.$image),this.$onSourceImageLoad=this.$handleSourceImageLoad.bind(this),this.$onSourceImageTransform=this.$handleSourceImageTransform.bind(this),D(n.$image,V,this.$onSourceImageLoad),D(n,mt,this.$onSourceImageTransform))}this.$render()}}disconnectedCallback(){const{$selection:t,$sourceImage:e}=this;t&&this.$onSelectionChange&&(M(t,j,this.$onSelectionChange),this.$onSelectionChange=null),e&&this.$onSourceImageLoad&&(M(e.$image,V,this.$onSourceImageLoad),this.$onSourceImageLoad=null),e&&this.$onSourceImageTransform&&(M(e,mt,this.$onSourceImageTransform),this.$onSourceImageTransform=null),super.disconnectedCallback()}$handleSelectionChange(t){this.$render(t.defaultPrevented?this.$selection:t.detail)}$handleSourceImageLoad(){const{$image:t,$sourceImage:e}=this,s=t.getAttribute("src"),i=e.getAttribute("src");i&&i!==s&&(t.setAttribute("src",i),t.$ready(()=>{this.$render()}))}$handleSourceImageTransform(t){this.$render(void 0,t.detail.matrix)}$render(t,e){const{$canvas:s,$selection:i}=this;!t&&!i.hidden&&(t=i),(!t||t.x===0&&t.y===0&&t.width===0&&t.height===0)&&(t={x:0,y:0,width:s.offsetWidth,height:s.offsetHeight});const{x:n,y:o,width:r,height:l}=t,c={},{clientWidth:a,clientHeight:w}=this;let _=a,k=w,u=NaN;switch(this.resize){case os:u=1,_=r,k=l,c.width=r,c.height=l;break;case as:u=l>0?w/l:0,_=r*u,c.width=_;break;case ue:u=r>0?a/r:0,k=l*u,c.height=k;break;case rs:default:a>0?u=r>0?a/r:0:w>0&&(u=l>0?w/l:0)}this.$scale=u,this.$setStyles(c),this.$sourceImage&&setTimeout(()=>{this.$transformImageByOffset(e??this.$sourceImage.$getTransform(),-n,-o)})}$transformImageByOffset(t,e,s){const{$image:i,$scale:n,$sourceImage:o}=this;if(o&&i&&n>=0){const[r,l,c,a,w,_]=t,k=(e*a-c*s)/(r*a-c*l),u=(s*r-l*e)/(r*a-c*l),T=r*k+c*u+w,S=l*k+a*u+_;i.$ready(C=>{this.$setStyles.call(i,{width:C.naturalWidth*n,height:C.naturalHeight*n})}),i.$setTransform(r,l,c,a,T*n,S*n)}}}xt.$name=Ie;xt.$version="2.1.0";/*! Cropper.js v2.1.0 | (c) 2015-present Chen Fengyuan | MIT */Ct.$define();At.$define();Tt.$define();Et.$define();yt.$define();kt.$define();St.$define();xt.$define();const cs={class:"basic_container"},ls={class:"tool_wrap"},hs={class:"dialog_wrap"},ds={class:"image_wrap",ref:"imageWrap"},us={class:"info_wrap"},fs={class:"cropper_preview"},ps={class:"btn_wrap"},gs={__name:"basic",emits:["success"],setup(d,{emit:t}){const e=O({}),s=O(),i=O(),n=O(),o=O(!1),r=O(!0),l=Se(()=>r.value?"move":"select");function c(){i.value.$rotate("90deg"),i.value.$center("contain")}function a(){if(r.value=!1,r.value)n.value.$clear();else{const x=s.value.getBoundingClientRect(),h=i.value.getBoundingClientRect(),f={x:h.left-x.left,y:h.top-x.top,width:h.width,height:h.height};console.log(f),n.value.$change(f.x,f.y,f.width,f.height)}}function w(){n.value.$clear(),n.value.$change(5,5,160,90)}function _(){r.value||(r.value=!0)}function k(m){console.log("选区变化",m),m.detail.width&&m.detail.height?o.value=!0:o.value=!1}const u=t;async function T(){if(o.value){const m=await n.value.$toCanvas({beforeDraw:(v,E)=>{v.imageSmoothingQuality="high"}}),x=i.value,I=x.naturalWidth,h=x.naturalHeight;console.log(x),console.log("原图尺寸",I,h);const f=m.toDataURL("image/png"),$=C(f,e.value.name);u("success",{...e.value,file:$,fileShow:f})}}async function S(){}function C(m,x){for(var I=m.split(","),h=I[0].match(/:(.*?);/)[1],f=atob(I[1]),$=f.length,v=new Uint8Array($);$--;)v[$]=f.charCodeAt($);const E=new Blob([v],{type:h});return new File([E],x,{type:h})}const p=O();function y(){const m=p.value.files;m.length&&(e.value={name:m[0].name,file:m[0],fileShow:URL.createObjectURL(m[0])})}return(m,x)=>{const I=z("cropper-image"),h=z("cropper-shade"),f=z("cropper-handle"),$=z("cropper-crosshair"),v=z("cropper-selection"),E=z("cropper-canvas"),A=z("cropper-viewer");return U(),F("div",cs,[g("div",ls,[g("button",{class:Wt({active:r.value}),onClick:_}," 移动 ",2),g("button",{onClick:c},"旋转"),g("button",{class:Wt({active:o.value}),onClick:a},Ee(o.value?"重置选区":"裁剪"),3),g("button",{onClick:w},"裁剪2")]),g("div",hs,[g("div",ds,[e.value.fileShow?(U(),fe(E,{key:0,ref_key:"croppercanvas",ref:s,background:""},{default:K(()=>[b(I,{src:e.value.fileShow,alt:"Picture",ref_key:"cropperimage",ref:i,rotatable:"",scalable:"",skewable:"",translatable:""},null,8,["src"]),b(h,{hidden:"",ref:"cropperShade"},null,512),b(f,{action:l.value,plain:""},null,8,["action"]),b(v,{id:"cropperSelection",ref_key:"cropperselection",ref:n,movable:"",resizable:"",hidden:"",outlined:"",precise:"",onChange:k},{default:K(()=>[b($,{centered:""}),b(f,{action:"move","theme-color":"rgba(255, 255, 255, 0.35)"}),b(f,{action:"n-resize"}),b(f,{action:"e-resize"}),b(f,{action:"s-resize"}),b(f,{action:"w-resize"}),b(f,{action:"ne-resize"}),b(f,{action:"nw-resize"}),b(f,{action:"se-resize"}),b(f,{action:"sw-resize"})]),_:1},512)]),_:1},512)):ct("",!0)],512),g("div",us,[g("div",fs,[b(A,{selection:"#cropperSelection",style:{width:"200px"}})]),g("div",ps,[g("input",{type:"file",ref_key:"input_form",ref:p,onChange:y},null,544),g("button",{type:"primary",onClick:T},"确 认"),g("button",{type:"primary",onClick:S},"确 认2")]),x[0]||(x[0]=ke(" 点击确认后，看控制台，有信息 ",-1))])])])}}},$s=ut(gs,[["__scopeId","data-v-fb50d200"]]),ms={class:"basic_container"},vs={class:"dialog_wrap"},bs={class:"image_wrap",ref:"imageWrap"},ws={class:"info_wrap"},_s={class:"cropper_preview"},Cs={class:"cropper_preview"},ys=["src"],Ss={class:"btn_wrap"},Es={__name:"aspectRatio",emits:["success"],setup(d,{emit:t}){const e=O({}),s=O(),i=O(),n=O();function o(u){}const r=t,l=O(),c=O();async function a(){if(e.value.fileShow){const T=(await n.value.$toCanvas()).toDataURL("image/png");l.value=T;const S=w(T,e.value.name);r("success",{...e.value,file:S,fileShow:T})}}function w(u,T){for(var S=u.split(","),C=S[0].match(/:(.*?);/)[1],p=atob(S[1]),y=p.length,m=new Uint8Array(y);y--;)m[y]=p.charCodeAt(y);const x=new Blob([m],{type:C});return new File([x],T,{type:C})}const _=O();async function k(){const u=_.value.files;u.length&&(e.value={name:u[0].name,file:u[0],fileShow:URL.createObjectURL(u[0])}),await pe(),n.value.$change(0,0,100,100),n.value.$center()}return(u,T)=>{const S=z("cropper-image"),C=z("cropper-shade"),p=z("cropper-handle"),y=z("cropper-crosshair"),m=z("cropper-selection"),x=z("cropper-canvas"),I=z("cropper-viewer");return U(),F("div",ms,[g("div",vs,[g("div",bs,[e.value.fileShow?(U(),fe(x,{key:0,ref_key:"croppercanvas",ref:s,background:""},{default:K(()=>[b(S,{src:e.value.fileShow,alt:"Picture",ref_key:"cropperimage",ref:i,rotatable:"",scalable:"",skewable:"",translatable:""},null,8,["src"]),b(C),b(p,{action:"move",plain:""}),b(m,{id:"cropperSelection2",ref_key:"cropperselection",ref:n,movable:"",resizable:"",outlined:"",aspectRatio:1,onChange:o},{default:K(()=>[b(y,{centered:""}),b(p,{action:"move","theme-color":"rgba(255, 255, 255, 0.35)"}),b(p,{action:"n-resize"}),b(p,{action:"e-resize"}),b(p,{action:"s-resize"}),b(p,{action:"w-resize"}),b(p,{action:"ne-resize"}),b(p,{action:"nw-resize"}),b(p,{action:"se-resize"}),b(p,{action:"sw-resize"})]),_:1},512)]),_:1},512)):ct("",!0)],512),g("div",ws,[g("div",_s,[b(I,{selection:"#cropperSelection2",style:{width:"200px"}})]),g("div",Cs,[T[0]||(T[0]=g("div",null,"实际效果：img/canvas",-1)),g("img",{src:l.value,style:{width:"200px"}},null,8,ys),g("canvas",{ref_key:"resultCanvas",ref:c},null,512)]),g("div",Ss,[g("input",{type:"file",ref_key:"input_form",ref:_,onChange:k},null,544),g("button",{type:"primary",onClick:a},"确 认")])])])])}}},ks=ut(Es,[["__scopeId","data-v-515f58df"]]),Ts={class:"basic_container"},As={class:"dialog_wrap"},xs={class:"image_wrap",ref:"imageWrap"},Rs={class:"info_wrap"},Is={class:"cropper_preview"},Os={class:"cropper_preview"},Ps=["src"],Ns={class:"btn_wrap"},zs={__name:"circle",emits:["success"],setup(d,{emit:t}){const e=O({}),s=O(),i=O(),n=O();function o(u){}const r=t,l=O(),c=O();async function a(u=!1){if(e.value.fileShow){const T=await n.value.$toCanvas();if(u){const S=c.value,C=S.getContext("2d"),p=Math.min(T.width,T.height);S.width=p,S.height=p,C.beginPath(),C.arc(p/2,p/2,p/2,0,Math.PI*2),C.closePath(),C.clip(),C.drawImage(T,0,0,p,p);const y=S.toDataURL("image/png");l.value=y;const m=w(y,e.value.name);r("success",{...e.value,file:m,fileShow:y})}else{const S=T.toDataURL("image/png");l.value=S;const C=w(S,e.value.name);r("success",{...e.value,file:C,fileShow:S})}}}function w(u,T){for(var S=u.split(","),C=S[0].match(/:(.*?);/)[1],p=atob(S[1]),y=p.length,m=new Uint8Array(y);y--;)m[y]=p.charCodeAt(y);const x=new Blob([m],{type:C});return new File([x],T,{type:C})}const _=O();async function k(){const u=_.value.files;u.length&&(e.value={name:u[0].name,file:u[0],fileShow:URL.createObjectURL(u[0])}),await pe(),n.value.$change(0,0,100,100),n.value.$center()}return(u,T)=>{const S=z("cropper-image"),C=z("cropper-shade"),p=z("cropper-handle"),y=z("cropper-crosshair"),m=z("cropper-selection"),x=z("cropper-canvas"),I=z("cropper-viewer");return U(),F("div",Ts,[g("div",As,[g("div",xs,[b(x,{ref_key:"croppercanvas",ref:s,background:""},{default:K(()=>[b(S,{src:e.value.fileShow,alt:"Picture",ref_key:"cropperimage",ref:i,rotatable:"",scalable:"",skewable:"",translatable:""},null,8,["src"]),b(C,{class:"cropper_shade"}),b(p,{action:"move",plain:""}),b(m,{id:"cropperSelection3",ref_key:"cropperselection",ref:n,movable:"",resizable:"",outlined:"",aspectRatio:1,onChange:o},{default:K(()=>[b(y,{centered:""}),b(p,{class:"select_handle_move",action:"move"}),b(p,{action:"n-resize"}),b(p,{action:"e-resize"}),b(p,{action:"s-resize"}),b(p,{action:"w-resize"}),b(p,{action:"ne-resize"}),b(p,{action:"nw-resize"}),b(p,{action:"se-resize"}),b(p,{action:"sw-resize"})]),_:1},512)]),_:1},512)],512),g("div",Rs,[g("div",Is,[b(I,{selection:"#cropperSelection3",style:{width:"200px"}})]),g("div",Os,[T[2]||(T[2]=g("div",null,"实际效果：img/canvas",-1)),g("img",{src:l.value,style:{width:"200px"}},null,8,Ps),g("canvas",{ref_key:"circleCanvas",ref:c},null,512)]),g("div",Ns,[g("input",{type:"file",ref_key:"input_form",ref:_,onChange:k},null,544),g("button",{type:"primary",onClick:T[0]||(T[0]=h=>a(!1))}," 确认矩形图片 "),g("button",{type:"primary",onClick:T[1]||(T[1]=h=>a(!0))}," 确认圆形图片 ")])])])])}}},Ms=ut(zs,[["__scopeId","data-v-a07f7dcc"]]),Ds={class:"basic_container"},Ws={class:"dialog_wrap"},Ls={key:0,class:"image_wrap"},Us={class:"info_wrap"},Xs={class:"cropper_preview"},Ys=["src"],Hs={class:"btn_wrap"},js={__name:"pan",emits:["success"],setup(d,{emit:t}){const e=O({}),s=O(),i=O(),n=O(!1);let o=[];const r=O();let l=!1;async function c(){n.value=!0,o=[],l=!0}function a(h){if(!n.value||!l)return;const f=h.target,$=f.getBoundingClientRect(),v=h.clientX-$.left,E=h.clientY-$.top,A=f.getContext("2d"),P=k(v,E);if(P!==-1)P===0&&o.length>2&&(l=!1,_(A,f,!0));else{if(A.fillStyle="#409EFF",A.beginPath(),A.arc(v,E,5,0,Math.PI*2),A.fill(),o.length>0){const N=o[o.length-1];A.strokeStyle="#409EFF",A.lineWidth=3,A.beginPath(),A.moveTo(N.x,N.y),A.lineTo(v,E),A.stroke()}l=!0,o.push({x:v,y:E})}}function w(h){if(!n.value||!l||o.length===0)return;const f=h.target,$=f.getBoundingClientRect(),v=h.clientX-$.left,E=h.clientY-$.top,A=f.getContext("2d"),P=k(v,E);_(A,f,!1,P);const N=o[o.length-1];A.beginPath(),A.moveTo(N.x,N.y),A.lineTo(v,E),A.stroke()}function _(h,f,$=!1,v=-1){if(h.clearRect(0,0,f.width,f.height),h.fillStyle="#409EFF",h.strokeStyle="#409EFF",h.lineWidth=3,$&&o.length>2){h.fillStyle="rgba(255, 255, 255, .6)",h.beginPath(),h.moveTo(o[0].x,o[0].y);for(let E=1;E<o.length;E++)h.lineTo(o[E].x,o[E].y);h.closePath(),h.fill()}for(let E=0;E<o.length;E++){const A=o[E],P=E===v?8:5;if(h.beginPath(),h.arc(A.x,A.y,P,0,Math.PI*2),h.fill(),E>0){const N=o[E-1];h.beginPath(),h.moveTo(N.x,N.y),h.lineTo(A.x,A.y),h.stroke()}}$&&o.length>1&&(h.beginPath(),h.moveTo(o[o.length-1].x,o[o.length-1].y),h.lineTo(o[0].x,o[0].y),h.stroke())}function k(h,f){for(let $=0;$<o.length;$++){const v=o[$],E=v.x-h,A=v.y-f;if(Math.sqrt(E*E+A*A)<=5)return $}return-1}const u=t,T=O(),S=O();async function C(){const h=p(o),f=await y(h);S.value.width=f.width,S.value.height=f.height;const $=S.value.getContext("2d"),v=o.map(P=>({x:P.x-h.x,y:P.y-h.y}));$.fillStyle="transparent",$.beginPath(),$.moveTo(v[0].x,v[0].y);for(let P=1;P<v.length;P++)$.lineTo(v[P].x,v[P].y);$.closePath(),$.save(),$.clip(),$.drawImage(f,0,0,f.width,f.height);const E=S.value.toDataURL("image/png");T.value=E;const A=m(E,e.value.name);u("success",{...e.value,file:A,fileShow:E})}function p(h){if(h.length===0)return{width:0,height:0,x:0,y:0};let f=h[0].x,$=h[0].x,v=h[0].y,E=h[0].y;for(let N of h)N.x<f&&(f=N.x),N.x>$&&($=N.x),N.y<v&&(v=N.y),N.y>E&&(E=N.y);const A=$-f,P=E-v;return{width:A,height:P,x:f,y:v}}function y(h){return new Promise(f=>{const $=document.createElement("canvas");$.width=h.width,$.height=h.height,i.value.$ready().then(v=>{console.log(v);const E=$.getContext("2d"),[A,P,N,G,we,_e]=i.value.$getTransform();console.log(i.value.$getTransform());const Rt=-h.x,It=-h.y,Ot=(Rt*G-N*It)/(A*G-N*P),Pt=(It*A-P*Rt)/(A*G-N*P);let Ce=A*Ot+N*Pt+we,ye=P*Ot+G*Pt+_e,Nt=v.naturalWidth,zt=v.naturalHeight;const Mt=Nt/2,Dt=zt/2;E.fillStyle="transparent",E.fillRect(0,0,h.width,h.height),E.save(),E.translate(Mt,Dt),E.transform(A,P,N,G,Ce,ye),E.translate(-Mt,-Dt),E.drawImage(v,0,0,Nt,zt),E.restore(),f($)})})}function m(h,f){for(var $=h.split(","),v=$[0].match(/:(.*?);/)[1],E=atob($[1]),A=E.length,P=new Uint8Array(A);A--;)P[A]=E.charCodeAt(A);const N=new Blob([P],{type:v});return new File([N],f,{type:v})}const x=O();async function I(){const h=x.value.files;h.length&&(e.value={name:h[0].name,file:h[0],fileShow:URL.createObjectURL(h[0])})}return setInterval(()=>{console.log(o)},3e3),(h,f)=>{const $=z("cropper-image"),v=z("cropper-canvas");return U(),F("div",Ds,[g("div",{class:"tool"},[g("button",{onClick:c},"钢笔")]),g("div",Ws,[e.value.fileShow?(U(),F("div",Ls,[b(v,{ref_key:"croppercanvas",ref:s,background:""},{default:K(()=>[b($,{src:e.value.fileShow,alt:"Picture",ref_key:"cropperimage",ref:i,rotatable:"",scalable:"",skewable:"",translatable:""},null,8,["src"]),n.value?(U(),F("canvas",{key:0,ref_key:"drawingcanvas",ref:r,class:"drawing_canvas",width:"400",height:"300",onClick:a,onMousemove:w},null,544)):ct("",!0)]),_:1},512)])):ct("",!0),g("div",Us,[g("div",Xs,[f[0]||(f[0]=g("div",null,"实际效果：img/canvas",-1)),g("img",{src:T.value,style:{width:"200px"}},null,8,Ys),g("canvas",{ref_key:"resultCanvas",ref:S},null,512)]),g("div",Hs,[g("input",{type:"file",ref_key:"input_form",ref:x,onChange:I},null,544),g("button",{type:"primary",onClick:C},"确认裁剪")])])])])}}},Bs=ut(js,[["__scopeId","data-v-aba17c11"]]),Fs={id:"app"},Ks={class:"module_wrap"},Zs=["src"],qs={class:"module_wrap"},Gs={class:"module_wrap"},Vs={class:"module_wrap"},Qs={__name:"Cropperjs",setup(d){const t=O("");function e(s){console.log("裁剪成功",s),t.value=s.fileShow}return(s,i)=>(U(),F("div",Fs,[g("div",Ks,[i[0]||(i[0]=g("h1",{class:"title"},"基本实现",-1)),i[1]||(i[1]=g("div",{class:"desc"},"提供功能性按钮，可以最大程度的调整图像",-1)),b($s,{onSuccess:e})]),g("div",null,[g("img",{src:t.value,alt:""},null,8,Zs)]),g("div",qs,[i[2]||(i[2]=g("h1",{class:"title"},"固定纵横比",-1)),i[3]||(i[3]=g("div",{class:"desc"},"纵横比，进入默认裁剪",-1)),b(ks,{onSuccess:e})]),g("div",Gs,[i[4]||(i[4]=g("h1",{class:"title"},"圆形",-1)),i[5]||(i[5]=g("div",{class:"desc"},"圆形纵横比，进入默认裁剪",-1)),b(Ms,{onSuccess:e})]),g("div",Vs,[i[6]||(i[6]=g("h1",{class:"title"},"钢笔",-1)),i[7]||(i[7]=g("div",{class:"desc"},"通过点击，形成一个不规则的闭合区域，自定义形状",-1)),b(Bs,{onSuccess:e})])]))}};export{Qs as default};
