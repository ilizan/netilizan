/*!
 * Pintura v8.95.2 - Test version
 * (c) 2018-2025 Pintura Labs B.V. - All Rights Reserved
 * License: https://pqina.nl/pintura/license/
 * 
 * This version of Pintura is for testing purposes only.
 * Visit https://pqina.nl/pintura/ to obtain a commercial license.
 */const Um=(t,e,r,n,i=!0)=>{const o=[];let a=e;const s=Math.min(t.byteLength,e+r-16);for(;a<s;a+=12){const l=a;t.getUint16(l,i)===n&&o.push(l)}return o};var se=(...t)=>{};const zx=[{value:65504,name:"jfif",getTags:se},{value:65498,name:"sos",getTags:se},{value:65505,subvalue:17784,name:"exif",getTags:(t,e)=>{if(t.getUint16(e)!==65505)return;const r=t.getUint16(e+2);if(e+=4,t.getUint32(e)!==1165519206)return;e+=6;const n=t.getUint16(e);if(n!==18761&&n!==19789)return;const i=n===18761;return e+=2,t.getUint16(e,i)===42?(e+=t.getUint32(e+2,i),{read:o=>{const a=Um(t,e,r,o,i);if(a.length)return t.getUint16(a[0]+8,i)},write:(o,a)=>{const s=Um(t,e,r,o,i);return!!s.length&&(s.forEach(l=>t.setUint16(l+8,a,i)),!0)}}):void 0}},{value:65505,subvalue:26740,name:"xmp",getTags:se},{value:65506,subvalue:19792,name:"mpf",getTags:se},{value:65506,name:"app2",getTags:(t,e)=>{if(t.getUint16(e)!==65506)return;const r=t.getUint16(e+2);if(new TextDecoder().decode(t.buffer.slice(e+4,e+15))!=="ICC_PROFILE")return;function n(c){return String.fromCharCode(o.getUint8(c),o.getUint8(c+1),o.getUint8(c+2),o.getUint8(c+3))}function i(c,u,d){const{buffer:p}=o;let h,f;if(c==="text")h=u+8,f=u+d-7;else if(c==="desc")h=u+12,f=u+o.getUint32(u+8)+12;else{if(c!=="mluc")return;{const g=o.getUint32(u+20),$=o.getUint32(u+24);h=u+$,f=u+$+g}}return new TextDecoder().decode(p.slice(h,f)).replace(/\u0000|\x00/g,"")}e+=18;const o=new DataView(t.buffer.slice(e,e+r)),a=o.getUint32(128),s=[];let l=132;for(let c=0;c<a;c++){const u=o.getUint32(l),d=o.getUint32(l+4);if(d>o.byteLength)break;const p=o.getUint32(l+8),h=n(d),f=i(h,d,p);if(u===b1){s.push({address:u,offset:d,size:p,type:h,value:f});break}l+=12}return{read:c=>{const u=s.find(d=>d.address===c);return u?u.value:void 0},write:(c,u)=>{}}}}],b1=1684370275,Py=t=>{if(t)return(e=>{if(e.getUint16(0)!==65496)return;const r=e.byteLength;let n,i=2,o;for(;i<r&&e.getUint8(i)===255;){n=e.getUint16(i);const a=zx.find(s=>s.value===n&&(!s.subvalue||s.subvalue===e.getUint16(i+2+2)));if(a){const{name:s,getTags:l}=a;if(o||(o={}),!o[s]){let c=i;o[s]={offset:i,size:e.getUint16(i+2),getTags:()=>l(e,c)}}}if(n===65498)break;i+=2+e.getUint16(i+2)}return o})(new DataView(t))},Ry=(t,e)=>{const r=Py(t);if(r)return Object.entries(e).reduce((n,[i,o])=>{if(!r[i])return n;const a=r[i].getTags();if(!a)return n;for(const s of o){const l=a.read(s);n[i]={...n[i],[s]:l}}return n},{})};var Z1=t=>window.__pqina_webapi__?window.__pqina_webapi__[t]:window[t];const Dx={ArrayBuffer:"readAsArrayBuffer"};var X1=(t,e=se,r={})=>new Promise((n,i)=>{const{dataFormat:o=Dx.ArrayBuffer}=r,a=new(Z1("FileReader"));a.onload=()=>n(a.result),a.onerror=()=>i(a.error),a.onprogress=e,a[o](t)}),Bx=async(t,e,r=[0,t.size],n)=>{const i=await(async(o,a=[0,o.size],s)=>await X1(o.slice(...a),s))(t,r,n);return Ry(i,e)};let Ah=null;var ni=()=>(Ah===null&&(Ah=typeof window<"u"&&window.document!==void 0),Ah);let pd=null;var ap=()=>new Promise(t=>{if(pd===null){const e="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";let r=ni()?new Image:{};return r.onload=()=>{pd=r.naturalWidth===1,r=void 0,t(pd)},void(r.src=e)}return t(pd)}),lc=(t,e)=>{const{colorSpace:r="srgb"}=e||{};return t.getContext("2d",{colorSpace:r}).getImageData(0,0,t.width,t.height)},Ge=t=>typeof t=="string";function Iy(t,e){e.split(";").forEach(r=>{const[n,i]=r.split(":");if(!n.length||!i)return;const[o,a]=i.split("!important");t.style.setProperty(n,o,Ge(a)?"important":void 0)})}var yn=(t,e,r=[])=>{const n=document.createElement(t),i=Object.getOwnPropertyDescriptors(n.__proto__);for(const o in e)o==="style"?Iy(n,e[o]):i[o]&&i[o].set||/textContent|innerHTML/.test(o)||typeof e[o]=="function"?n[o]=e[o]:n.setAttribute(o,e[o]);return r.forEach(o=>n.appendChild(o)),n};const Ox={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]};var ti=t=>{t.width=1,t.height=1;const e=t.getContext("2d");e&&e.clearRect(0,0,1,1)},rc=t=>"data"in t,Y1=t=>ni()?RegExp(t).test(window.navigator.userAgent):void 0;let Lh=null;var sp=()=>(Lh===null&&(Lh=Y1(/Android/)),Lh),Ey=(t,e)=>{const r=yn("canvas",{width:t.width,height:t.height});return r.getContext("2d",e).drawImage(t,0,0),r},Sl=async(t,e=1)=>{const r=t instanceof ImageData&&t.colorSpace||"srgb",n=await ap(),[i,o]=n||e<5?[t.width,t.height]:[t.height,t.width],a=yn("canvas",{width:i,height:o}),s=a.getContext("2d",{willReadFrequently:!0,colorSpace:r});if(rc(t)&&!n&&e>1){const l=yn("canvas",{width:t.width,height:t.height});l.getContext("2d",{willReadFrequently:!0,colorSpace:r}).putImageData(t,0,0),t=l}if(!n&&e>1&&s.transform.apply(s,((l,c,u=-1)=>(u===-1&&(u=1),Ox[u](l,c)))(t.width,t.height,e)),rc(t)){if(s.putImageData(t,0,0),sp())return Ey(a)}else s.drawImage(t,0,0);return t instanceof HTMLCanvasElement&&ti(t),a},Ay=async(t,e=1)=>e===1||await ap()?t:lc(await Sl(t,e)),bs=t=>typeof t=="object";const Gm=t=>t instanceof HTMLElement?t:bs(t)?Ly(t):t,Ly=t=>{let e;return Array.isArray(t)?(e=[],t.forEach((r,n)=>{e[n]=Gm(r)})):(e={},t!==null&&Object.keys(t).forEach(r=>{const n=t[r];e[r]=Gm(n)})),e};var Vr=t=>typeof t=="function",Fy=(t,e)=>{const{width:r,height:n,canvasMemoryLimit:i,contextOptions:o}=e||{};let a=r||t.naturalWidth,s=n||t.naturalHeight;a||s||(a=300,s=150);const l=a*s;if(i&&l>i){const u=Math.sqrt(i)/Math.sqrt(l);a=Math.floor(a*u),s=Math.floor(s*u)}const c=yn("canvas");return c.width=a,c.height=s,c.getContext("2d",o).drawImage(t,0,0,a,s),c},Wx=async(t,e)=>{const r=yn("img",{src:URL.createObjectURL(t)}),n=await((i,o)=>new Promise((a,s)=>{const l=()=>a(Fy(i,o));i.complete&&i.width?l():(i.onload=l,i.onerror=()=>s(new Error("Failed to load image")))}))(r,e);return URL.revokeObjectURL(r.src),n},zy=()=>"createImageBitmap"in window,Dy=t=>/svg/.test(t.type),ra=()=>Math.random().toString(36).substring(2,9);const Fh=new Map;var mu=(t,e,r)=>new Promise((n,i)=>{const o=t.toString();let a=Fh.get(o);if(!a){const l=(p=>`function () {self.onmessage = function (message) {(${p.toString()}).apply(null, message.data.content.concat([function (err, response) {
    response = response || {};
    const transfer = 'data' in response ? [response.data.buffer] : 'width' in response ? [response] : [];
    return self.postMessage({ id: message.data.id, content: response, error: err }, transfer);
}]))}}`)(t),c=URL.createObjectURL((p=>new Blob(["(",typeof p=="function"?p.toString():p,")()"],{type:"application/javascript"}))(l)),u=new Map,d=new Worker(c);a={url:c,worker:d,messages:u,terminationTimeout:void 0,terminate:()=>{clearTimeout(a.terminationTimeout),a.worker.terminate(),URL.revokeObjectURL(c),Fh.delete(o)}},d.onmessage=function(p){const{id:h,content:f,error:g}=p.data;if(clearTimeout(a.terminationTimeout),a.terminationTimeout=setTimeout(()=>{u.size>0||a.terminate()},500),!u.has(h))return;const $=u.get(h);u.delete(h),g!=null?$.reject(g):$.resolve(f)},Fh.set(o,a)}const s=ra();a.messages.set(s,{resolve:n,reject:i}),a.worker.postMessage({id:s,content:e},r)});let zh=null;var Aa=()=>(zh===null&&(zh=Y1(/Firefox/)),zh);const Zm=async(t,e)=>{const{canvasMemoryLimit:r,colorSpace:n}=e||{},i=await Wx(t,{canvasMemoryLimit:r,contextOptions:{willReadFrequently:!0,colorSpace:n}}),o=lc(i,{colorSpace:n});return ti(i),o};var By=async(t,e)=>{const{canvasMemoryLimit:r,colorSpace:n}=e||{},i=/p3/i.test(n)?"display-p3":"srgb";if(sp()&&!Aa())return await Zm(t,{canvasMemoryLimit:r,colorSpace:i});let o;if(zy()&&!Dy(t)&&"OffscreenCanvas"in window)try{o=await mu((a,s,l,c)=>{createImageBitmap(a).then(u=>{let d=u.width,p=u.height;const h=d*p;if(s&&h>s){const b=Math.sqrt(s)/Math.sqrt(h);d=Math.floor(d*b),p=Math.floor(p*b)}const f=new OffscreenCanvas(d,p),g=f.getContext("2d",{colorSpace:l,willReadFrequently:!0});g.drawImage(u,0,0,d,p);const $=g.getImageData(0,0,f.width,f.height);c(null,$)}).catch(u=>{c(u)})},[t,r,i])}catch{}return o&&o.width?o:await Zm(t,{canvasMemoryLimit:r,colorSpace:i})},lp=(t,e,r)=>new Promise((n,i)=>{try{t.toBlob(o=>{if(!o)return i(new Error("Failed to create blob"));n(o)},e,r)}catch(o){i(o)}}),_x=async(t,e,r)=>{const n=await Sl(t),i=await lp(n,e,r);return ti(n),i};const Vx={matroska:"mkv"};var Oy=t=>{const e=(t.match(/\/([a-z0-9]+)/)||[])[1];if(/^x/.test(e)){const[,r=""]=t.split("/x-");return Vx[r]}return e},Wy=t=>t.substring(0,t.lastIndexOf("."))||t;const Nx=/avif|bmp|gif|jpg|jpeg|jpe|jif|jfif|png|svg|tiff|webp/;var q1=t=>{return t&&(e=(r=t,r.split(".").pop()).toLowerCase(),Nx.test(e)?"image/"+(/jfif|jif|jpe|jpg/.test(e)?"jpeg":e==="svg"?"svg+xml":e):"");var e,r},ru=(t,e,r)=>{const n=new Date().getTime(),i=t.type.length&&!/null|text/.test(t.type),o=i?t.type:r,a=((s,l)=>{const c=q1(s);if(c===l)return s;const u=Oy(l)||c;return`${Wy(s)}.${u}`})(e,o);try{return new(Z1("File"))([t],a,{lastModified:n,type:i?t.type:o})}catch{const l=i?t.slice():t.slice(0,t.size,o);return l.lastModified=n,l.name=a,l}},ca=(t,e)=>t/e,tn=t=>t;const Dh=Math.PI,ea=Math.PI/2,ua=ea/2;var Xa=t=>{const e=Math.abs(t)%Math.PI;return e>ua&&e<Math.PI-ua};const x1={Top:"t",Right:"r",Bottom:"b",Left:"l",TopLeft:"tl",TopRight:"tr",BottomRight:"br",BottomLeft:"bl"},{Top:Ns,Right:Hs,Bottom:js,Left:Us,TopLeft:ma,TopRight:fa,BottomRight:ga,BottomLeft:$a}=x1;var nu={[Ns]:[.5,0],[Hs]:[1,.5],[js]:[.5,1],[Us]:[0,.5],[ma]:[0,0],[fa]:[1,0],[ga]:[1,1],[$a]:[0,1]},mr=(t,e=12)=>parseFloat(t.toFixed(e));const Ud=(t,e,r)=>r+(t-r)*e,Xm=t=>({x:t.x+.5*t.width,y:t.y+.5*t.height,rx:.5*t.width,ry:.5*t.height}),dn=()=>lt(0,0),lt=(t,e)=>({x:t,y:e}),Ym=t=>lt(t.pageX,t.pageY),He=t=>lt(t.x,t.y),Kl=t=>(t.x=-t.x,t.y=-t.y,t),qi=(t,e,r=dn())=>{const n=Math.cos(e),i=Math.sin(e),o=t.x-r.x,a=t.y-r.y;return t.x=r.x+n*o-i*a,t.y=r.y+i*o+n*a,t},Bs=t=>Math.sqrt(t.x*t.x+t.y*t.y),yo=t=>{const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?dn():(t.x/=e,t.y/=e,t)},hd=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),zs=(t,e)=>t.x===e.x&&t.y===e.y,_o=(t,e)=>(t.x=e(t.x),t.y=e(t.y),t),jn=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Un=(t,e)=>(t.x-=e.x,t.y-=e.y,t),qm=(t,e)=>(t.x/=e,t.y/=e,t),ji=(t,e)=>(t.x*=e,t.y*=e,t),Fd=(t,e)=>t.x*e.x+t.y*e.y,zd=(t,e)=>t.x*e.y-t.y*e.x,Po=(t,e=dn())=>{const r=t.x-e.x,n=t.y-e.y;return r*r+n*n},Ni=(t,e=dn())=>Math.sqrt(Po(t,e)),Hx=(t,e,r)=>(t.x=Ud(t.x,e,r.x),t.y=Ud(t.y,e,r.y),t),Qo=t=>{let e=0,r=0;return t.forEach(n=>{e+=n.x,r+=n.y}),lt(e/t.length,r/t.length)},Jl=(t,e,r,n,i)=>(t.forEach(o=>{o.x=e?n-(o.x-n):o.x,o.y=r?i-(o.y-i):o.y}),t),$s=(t,e,r,n)=>{const i=Math.sin(e),o=Math.cos(e);return t.forEach(a=>{a.x-=r,a.y-=n;const s=a.x*o-a.y*i,l=a.x*i+a.y*o;a.x=r+s,a.y=n+l}),t},cc=(t,e)=>({width:t,height:e}),so=t=>cc(t.width,t.height),ts=t=>cc(t.width,t.height),bl=t=>cc(t.width,t.height),_y=t=>cc(t[0],t[1]),Jc=t=>{return/img/i.test(t.nodeName)?(e=t).naturalWidth||e.naturalHeight?cc(e.naturalWidth,e.naturalHeight):{width:300,height:150}:ts(t);var e},An=(t,e)=>cc(t,e),iu=(t,e,r=tn)=>r(t.width)===r(e.width)&&r(t.height)===r(e.height),md=(t,e)=>(t.width*=e,t.height*=e,t),xl=t=>lt(.5*t.width,.5*t.height),Vy=(t,e)=>{const r=Math.abs(e),n=Math.abs(Math.cos(r)),i=Math.abs(Math.sin(r)),o=n*t.width+i*t.height,a=i*t.width+n*t.height;return t.width=o,t.height=a,t},Gd=(t,e)=>t.width>=e.width&&t.height>=e.height,La=(t,e)=>(t.width=e(t.width),t.height=e(t.height),t),Gs=(t,e)=>({start:t,end:e}),Ny=t=>Gs(He(t.start),He(t.end)),K1=(t,e)=>{if(e===0)return t;const r=lt(t.start.x-t.end.x,t.start.y-t.end.y),n=yo(r),i=ji(n,e);return t.start.x+=i.x,t.start.y+=i.y,t.end.x-=i.x,t.end.y-=i.y,t},jx=[lt(-1,-1),lt(-1,1),lt(1,1),lt(1,-1)],ya=(t,e,r,n)=>({x:t,y:e,width:r,height:n}),Fr=t=>ya(t.x,t.y,t.width,t.height),Os=()=>ya(0,0,0,0),Ui=t=>ya(0,0,t.width,t.height),Ux=t=>ya(t[3],t[0],t[1]-t[3],t[2]-t[0]),Ya=t=>ya(t.x||0,t.y||0,t.width||0,t.height||0),ri=t=>{let e=t[0].x,r=t[0].x,n=t[0].y,i=t[0].y;return t.forEach(o=>{e=Math.min(e,o.x),r=Math.max(r,o.x),n=Math.min(n,o.y),i=Math.max(i,o.y)}),ya(e,n,r-e,i-n)},Dd=t=>Wn(t.x-t.rx,t.y-t.ry,2*t.rx,2*t.ry),Km=(t,e)=>ya(t.x-.5*e.width,t.y-.5*e.height,e.width,e.height),Wn=(t,e,r,n)=>ya(t,e,r,n),Lr=t=>lt(t.x+.5*t.width,t.y+.5*t.height),da=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Ei=(t,e,r)=>(r=r||Lr(t),t.x=e*(t.x-r.x)+r.x,t.y=e*(t.y-r.y)+r.y,t.width=e*t.width,t.height=e*t.height,t),Jm=(t,e,r,n)=>{const i=(n.x-t.x)/t.width,o=(n.y-t.y)/t.height;let a=Math.max(e.width,t.width),s=Math.max(e.height,t.height);return a=Math.min(r.width,a),s=Math.min(r.height,s),t.x=n.x-i*a,t.y=n.y-o*s,t.width=a,t.height=s,t},Qm=(t,e)=>{const[r,n]=nu[e],i=r*t.width,o=n*t.height;return lt(t.x+i,t.y+o)},yl=(t,e)=>(t.x*=e,t.y*=e,t.width*=e,t.height*=e,t),pa=(t,e,r=tn)=>r(t.x)===r(e.x)&&r(t.y)===r(e.y)&&r(t.width)===r(e.width)&&r(t.height)===r(e.height),$i=t=>ca(t.width,t.height),Hy=(t,e,r,n,i)=>(t.x=e,t.y=r,t.width=n,t.height=i,t),cp=(t,e)=>(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t),Ti=(t,e,r)=>(r||(r=Lr(t)),Oo(t).map(n=>qi(n,e,r))),Bd=(t,e)=>ya(.5*t.width-.5*e.width,.5*t.height-.5*e.height,e.width,e.height),Zd=(t,e)=>!(e.x<t.x)&&!(e.y<t.y)&&!(e.x>t.x+t.width)&&!(e.y>t.y+t.height),Zs=(t,e,r=dn())=>{if(t.width===0||t.height===0)return Os();const n=$i(t);e||(e=n);let i=t.width,o=t.height;return e>n?i=o*e:o=i/e,ya(r.x+.5*(t.width-i),r.y+.5*(t.height-o),i,o)},Ki=(t,e=$i(t),r=dn())=>{if(t.width===0||t.height===0)return Os();let n=t.width,i=n/e;return i>t.height&&(i=t.height,n=i*e),ya(r.x+.5*(t.width-n),r.y+.5*(t.height-i),n,i)},vl=t=>[Math.min(t.y,t.y+t.height),Math.max(t.x,t.x+t.width),Math.max(t.y,t.y+t.height),Math.min(t.x,t.x+t.width)],Oo=t=>[lt(t.x,t.y),lt(t.x+t.width,t.y),lt(t.x+t.width,t.y+t.height),lt(t.x,t.y+t.height)],ta=(t,e)=>{if(t)return t.x=e(t.x),t.y=e(t.y),t.width=e(t.width),t.height=e(t.height),t},jy=(t,e,r=Lr(t))=>Oo(t).map((n,i)=>{const o=jx[i];return lt(Ud(n.x,1+o.x*e.x,r.x),Ud(n.y,1+o.y*e.y,r.y))}),ou=t=>(t.x=0,t.y=0,t),tf=t=>{const e=t[0],r=t[t.length-1];t=zs(e,r)?t:[...t,e];const n=e.x,i=e.y;let o,a,s,l=0,c=0,u=0,d=0;const p=t.length;for(;c<p;c++)o=t[c],a=t[c+1>p-1?0:c+1],s=(o.y-i)*(a.x-n)-(a.y-i)*(o.x-n),l+=s,u+=(o.x+a.x-2*n)*s,d+=(o.y+a.y-2*i)*s;return s=3*l,lt(n+u/s,i+d/s)},J1=(t,e)=>Uy(t.start,t.end,e.start,e.end),Uy=(t,e,r,n)=>{const i=(n.y-r.y)*(e.x-t.x)-(n.x-r.x)*(e.y-t.y);if(i===0)return;const o=((n.x-r.x)*(t.y-r.y)-(n.y-r.y)*(t.x-r.x))/i,a=((e.x-t.x)*(t.y-r.y)-(e.y-t.y)*(t.x-r.x))/i;return o<0||o>1||a<0||a>1?void 0:lt(t.x+o*(e.x-t.x),t.y+o*(e.y-t.y))},Gy=(t,e,{ignoreIdenticalLines:r=!1,breakOnIntersection:n=!1}={})=>{const i=e.length,o=[];for(let a=0;a<i-1;a++){if(r&&(zs(t.start,e[a])||zs(t.start,e[a+1])||zs(t.end,e[a])||zs(t.end,e[a+1])))continue;const s=Uy(t.start,t.end,e[a],e[a+1]);if(s){if(n)return[s];o.push(s)}}return o.length?o:void 0},v1=(t,e)=>{let r=0,n=0,i=!1;const o=e.length;for(r=0,n=o-1;r<o;n=r++)e[r].y>t.y!=e[n].y>t.y&&t.x<(e[n].x-e[r].x)*(t.y-e[r].y)/(e[n].y-e[r].y)+e[r].x&&(i=!i);return i},Gx=(t,e,r,n)=>({x:(1-n)*(1-n)*t.x+2*(1-n)*n*e.x+n*n*r.x,y:(1-n)*(1-n)*t.y+2*(1-n)*n*e.y+n*n*r.y}),Zx=(t,e,r,n,i)=>{const o=((s,l,c,u)=>{let d=(l.x-s.x)*u,p=(l.y-s.y)*u;return Ni(c,l)<Ni(l,s)&&(d*=.15,p*=.15),{x:l.x+d,y:l.y+p}})(t,e,r,i),a=[];for(let s=0;s<=n;s++){const l=s/n;a.push(Gx(e,o,r,l))}return a},Zy=t=>{const e=[];for(let r=0;r<t.length;r++){let n=r+1;n===t.length&&(n=0),e.push(Gs(He(t[r]),He(t[n])))}return e},Xy=(t,e=0)=>Zy(t).map(r=>K1(r,e)),Xd=(t,e,r,n=0,i=!1,o=!1,a=12)=>{const s=[];for(let l=0;l<a;l++)s.push(lt(t.x+e*Math.cos(l*(2*Math.PI)/a),t.y+r*Math.sin(l*(2*Math.PI)/a)));return(i||o)&&Jl(s,i,o,t.x,t.y),n&&$s(s,n,t.x,t.y),s},Yd=(t,e,r,n)=>{const i=lt(t.x-r.x,t.y-r.y),o=lt(n.x-r.x,n.y-r.y),a=Fd(o,o);let s=Fd(i,o)/a;s=s<0?0:s,s=s>1?1:s;const l=lt(o.x*s+r.x-t.x,o.y*s+r.y-t.y);return Fd(l,l)<=e*e},Yy=(t,e,r)=>{const n=r.length;for(let i=0;i<n-1;i++)if(Yd(t,e,r[i],r[i+1]))return!0;return!1},w1=(t,e,r)=>!!v1(t,r)||!!Yy(t,e,r)||Yd(t,e,r[0],r[r.length-1]),Bh=(t,e,r,n,i)=>w1(t,e,Ti(r,n,i||Lr(r)));var qy=(t,e)=>{const r=Ui(t),n=Lr(r),i=Ti(r,e,n);return ou(ri(i))},nc=(t,e)=>t instanceof HTMLElement&&(!e||new RegExp(`^${e}$`,"i").test(t.nodeName)),fu=t=>t instanceof File,ef=async(t,e,r)=>{const n=await lp(t,e,r);return ru(n,"canvas")},Q1=t=>t.split("/").pop().split(/\?|\#/).shift();const Xx=ni()&&Node.prototype.replaceChildren?(t,e)=>t.replaceChildren(e):(t,e)=>{for(;t.lastChild;)t.removeChild(t.lastChild);e!==void 0&&t.append(e)},fd=ni()&&yn("div",{class:"PinturaMeasure",style:"position:absolute;left:0;top:0;width:99999px;height:0;pointer-events:none;contain:strict;margin:0;padding:0;"});let rf;var t0=t=>(Xx(fd,t),fd.parentNode||document.body.append(fd),clearTimeout(rf),rf=setTimeout(()=>{fd.remove()},500),t);let Oh=null;var Fa=()=>(Oh===null&&(Oh=ni()&&/^((?!chrome|android).)*(safari|iphone|ipad)/i.test(navigator.userAgent)),Oh),Ky=t=>new Promise((e,r)=>{let n=!1;!t.parentNode&&Fa()&&(n=!0,t.style.cssText="position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;",t0(t));const i=()=>{let a=t.naturalWidth,s=t.naturalHeight;if(!(a&&s)){if(!t.complete)return;a=300,s=150}delete t.onload,n&&t.remove(),clearInterval(o),e({width:a,height:s})};t.onerror=a=>{clearInterval(o),r(a)},t.onload=()=>{clearInterval(o),i()};const o=setInterval(i,1);i()}),Jy=t=>new Promise((e,r)=>{const n=()=>{e({width:t.videoWidth,height:t.videoHeight})};if(t.readyState>=1)return n();t.onloadedmetadata=n,t.onerror=()=>r(t.error)}),gu=t=>/^image/.test(t.type),e0=t=>new Promise(e=>{const r=Ge(t)?t:URL.createObjectURL(t),n=()=>{const o=new Image;o.src=r,e(o)};if(t instanceof Blob&&gu(t))return n();const i=document.createElement("video");i.preload="metadata",i.onloadedmetadata=()=>e(i),i.onerror=n,i.src=r}),au=t=>t.nodeName==="VIDEO",Qy=async t=>{let e,r;e=t.src?t:await e0(t);try{r=au(e)?await Jy(e):await Ky(e)}finally{fu(t)&&URL.revokeObjectURL(e.src)}return r},Yx=async t=>{const e=await Qy(t),r=await(o=>new Promise((a,s)=>{if(o.complete)return a(o);o.onload=()=>a(o),o.onerror=()=>s(new Error("Failed to load image"))}))(t),n=yn("canvas",e);n.getContext("2d",{willReadFrequently:!0}).drawImage(r,0,0);const i=await lp(n);return ru(i,Q1(r.src))},Xl=(t=0,e=!0)=>new(Z1("ProgressEvent"))("progress",{loaded:100*t,total:100,lengthComputable:e}),nf=(t,e,r=n=>n)=>t.getAllResponseHeaders().indexOf(e)>=0?r(t.getResponseHeader(e)):void 0,qx=t=>{if(!t)return null;const e=t.split(/filename=|filename\*=.+''/).splice(1).map(r=>r.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(r=>r.length);return e.length?decodeURI(e[e.length-1]):null};const Kx="URL_REQUEST";class Qc extends Error{constructor(e,r,n){super(e),this.name="EditorError",this.code=r,this.metadata=n}}var t2=(t,e)=>{const{headers:r={},credentials:n}=e||{};Object.entries(r).forEach(([i,o])=>t.setRequestHeader(i,o)),n&&(t.withCredentials=n!=="omit")},Jx=(t,e,r)=>/^data:/.test(t)?(async(n,i="data-uri",o=se)=>{o(Xl(0));const a=await fetch(n);o(Xl(.33));const s=await a.blob();let l;gu(s)||(l="image/"+(n.includes(",/9j/")?"jpeg":"png")),o(Xl(.66));const c=ru(s,i,l);return o(Xl(1)),c})(t,void 0,e):((n,i,o)=>new Promise((a,s)=>{const l=()=>s(new Qc("Error fetching image",Kx,c)),c=new XMLHttpRequest;c.onprogress=i,c.onerror=l,c.onload=()=>{if(!c.response||c.status>=300||c.status<200)return l();const d=nf(c,"Content-Type"),p=nf(c,"Content-Disposition",qx)||Q1(n);a(ru(c.response,p,d||q1(p)))};const{willRequest:u}=o;Promise.resolve(u&&u(n,{resourceType:"image"})).then(d=>{if(d===!1)return s("Image load rejected");c.open("GET",n,!0),t2(c,d),c.responseType="blob",c.send()}).catch(console.error)}))(t,e,r),r0=t=>t instanceof Blob&&!(t instanceof File),e2=t=>"close"in t,Qx=async(t,e,r)=>{if(fu(t)||r0(t))return t;if(Ge(t))return await Jx(t,e,r);if(nc(t,"canvas"))return await ef(t);if(nc(t,"img"))return await Yx(t);if(rc(t)||e2(t))return await ef(await Sl(t));throw new Qc("Invalid image source","invalid-image-source")};let Wh=null;var su=()=>(Wh===null&&(Wh=ni()&&/^mac/i.test(navigator.platform)),Wh);let _h=null;var Vo=()=>(_h===null&&(_h=ni()&&(Y1(/iPhone|iPad|iPod/)||su()&&navigator.maxTouchPoints>=1)),_h),tv=async(t,e=1)=>await ap()||Vo()||e<5?t:An(t.height,t.width),r2=t=>/jpeg/.test(t.type),ev=t=>{return typeof(e=t)!="object"||e.constructor!=Object?t:JSON.stringify(t);var e},n0=(t,e=0,r)=>(e===0||(t.translate(r.x,r.y),t.rotate(e),t.translate(-r.x,-r.y)),t),n2=(t,e,r)=>(t.scale(e,r),t),rv=async(t,e={})=>{const{flipX:r,flipY:n,rotation:i,crop:o}=e,a=ts(t),s=r||n,l=!!i,c=o&&(o.x||o.y||o.width||o.height),u=c&&pa(o,Ui(a)),d=c&&!u;if(!s&&!l&&!d)return t;const p={willReadFrequently:!0,colorSpace:t.colorSpace};let h,f=yn("canvas",{width:t.width,height:t.height});if(f.getContext("2d",p).putImageData(t,0,0),s){const g=yn("canvas",{width:f.width,height:f.height}).getContext("2d",p);n2(g,r?-1:1,n?-1:1),g.drawImage(f,r?-f.width:0,n?-f.height:0),g.restore(),ti(f),f=g.canvas}if(l){const g=La(bl(ri(Ti(Ya(f),i))),Math.floor),$=yn("canvas",{width:o.width,height:o.height}).getContext("2d",p);((b,v,w)=>{b.translate(v,w)})($,-o.x,-o.y),n0($,i,xl(g)),$.drawImage(f,.5*(g.width-f.width),.5*(g.height-f.height)),$.restore(),ti(f),f=$.canvas}else if(d)return h=f.getContext("2d",p).getImageData(o.x,o.y,o.width,o.height),ti(f),h;return h=f.getContext("2d",p).getImageData(0,0,f.width,f.height),ti(f),h},nv=(t,e)=>{const{imageData:r,width:n,height:i}=t,o=r.width,a=r.height,s=r.colorSpace,l=Math.round(n),c=Math.round(i),u=r.data,d=new Uint8ClampedArray(l*c*4),p=o/l,h=a/c,f=Math.ceil(.5*p),g=Math.ceil(.5*h);for(let $=0;$<c;$++)for(let b=0;b<l;b++){const v=4*(b+$*l);let w=0,S=0,P=0,M=0,E=0,C=0,z=0;const V=($+.5)*h;for(let L=Math.floor($*h);L<($+1)*h;L++){const y=Math.abs(V-(L+.5))/g,ct=(b+.5)*p,j=y*y;for(let k=Math.floor(b*p);k<(b+1)*p;k++){let N=Math.abs(ct-(k+.5))/f;const nt=Math.sqrt(j+N*N);if(nt<-1||nt>1||(w=2*nt*nt*nt-3*nt*nt+1,w<=0))continue;N=4*(k+L*o);const ft=u[N+3];z+=w*ft,P+=w,ft<255&&(w=w*ft/250),M+=w*u[N],E+=w*u[N+1],C+=w*u[N+2],S+=w}}d[v]=M/S,d[v+1]=E/S,d[v+2]=C/S,d[v+3]=z/P}e(null,{data:d,width:l,height:c,colorSpace:s})},i0=t=>{if(t instanceof ImageData)return t;let e;try{e=new ImageData(t.width,t.height,{colorSpace:t.colorSpace||"srgb"})}catch{e=yn("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},iv=async(t,e={},r)=>{const{width:n,height:i,fit:o,upscale:a}=e;if(!n&&!i)return t;let s=n,l=i;if(n?i||(l=n):s=i,o!=="force"){const c=s/t.width,u=l/t.height;let d=1;if(o==="cover"?d=Math.max(c,u):o==="contain"&&(d=Math.min(c,u)),d>1&&a===!1)return t;s=Math.round(t.width*d),l=Math.round(t.height*d),n&&i&&(Math.abs(s-n)<=1&&(s=n),Math.abs(l-i)<=1&&(l=i))}return s=Math.max(s,1),l=Math.max(l,1),t.width===s&&t.height===l?t:r?r(t,s,l):(t=await mu(nv,[{imageData:t,width:s,height:l}],[t.data.buffer]),i0(t))},ov=(t,e)=>{const{imageData:r,matrix:n}=t;if(!n||n.length!==20)return e(null,r);const i=r.colorSpace,o=r.data,a=o.length,s=n[0],l=n[1],c=n[2],u=n[3],d=n[4],p=n[5],h=n[6],f=n[7],g=n[8],$=n[9],b=n[10],v=n[11],w=n[12],S=n[13],P=n[14],M=n[15],E=n[16],C=n[17],z=n[18],V=n[19];let L=0,y=0,ct=0,j=0,k=0,N=0,nt=0,ft=0,xt=0;const H=Z=>Math.max(0,Math.min(255,255*Z));for(;L<a;L+=4)y=o[L]/255,ct=o[L+1]/255,j=o[L+2]/255,k=o[L+3]/255,k>0&&(y/=k,ct/=k,j/=k),N=y*s+ct*l+j*c+k*u+d,nt=y*p+ct*h+j*f+k*g+$,ft=y*b+ct*v+j*w+k*S+P,xt=y*M+ct*E+j*C+k*z+V,k>0?(y=N*k,ct=nt*k,j=ft*k):(y=0,ct=0,j=0),o[L]=H(N*xt),o[L+1]=H(nt*xt),o[L+2]=H(ft*xt),o[L+3]=H(k);e(null,{data:o,width:r.width,height:r.height,colorSpace:i})},i2=(t,e)=>{const{imageData:r,matrix:n}=t;if(!n)return e(null,r);let i=n.reduce((z,V)=>z+V);i=i<=0?1:i;const o=r.width,a=r.height,s=r.data,l=r.colorSpace;let c=0,u=0,d=0;const p=Math.round(Math.sqrt(n.length)),h=Math.floor(p/2);let f=0,g=0,$=0,b=0,v=0,w=0,S=0,P=0,M=0,E=0;const C=new Uint8ClampedArray(o*a*4);for(d=0;d<a;d++)for(u=0;u<o;u++){for(f=0,g=0,$=0,b=0,w=0;w<p;w++)for(v=0;v<p;v++)S=d+w-h,P=u+v-h,S<0&&(S=a-1),S>=a&&(S=0),P<0&&(P=o-1),P>=o&&(P=0),M=4*(S*o+P),E=n[w*p+v],f+=s[M]*E,g+=s[M+1]*E,$+=s[M+2]*E,b+=s[M+3]*E;C[c]=f/i,C[c+1]=g/i,C[c+2]=$/i,C[c+3]=b/i,c+=4}e(null,{data:C,width:o,height:a,colorSpace:l})},av=(t,e)=>{let{imageData:r,strength:n}=t;if(!n)return e(null,r);const i=r.colorSpace,o=r.width,a=r.height,s=r.data,l=(ct,j)=>(c=ct-M,u=j-E,Math.sqrt(c*c+u*u));let c,u,d,p,h,f,g,$,b,v,w,S=0,P=0,M=.5*o,E=.5*a,C=l(0,0);for(n>0?(d=0,p=0,h=0):(n=Math.abs(n),d=1,p=1,h=1),P=0;P<a;P++)for(S=0;S<o;S++)z=4*(S+P*o),V=s,L=s,y=l(S,P)*n/C,f=V[z]/255,g=V[z+1]/255,$=V[z+2]/255,b=V[z+3]/255,v=1-y,w=v*b+y,L[z]=(v*b*f+y*d)/w*255,L[z+1]=(v*b*g+y*p)/w*255,L[z+2]=(v*b*$+y*h)/w*255,L[z+3]=255*w;var z,V,L,y;e(null,{data:s,width:r.width,height:r.height,colorSpace:i})},sv=(t,e)=>{const{imageData:r,level:n,monochrome:i=!1}=t;if(!n)return e(null,r);const o=r.colorSpace,a=r.data,s=a.length;let l,c,u,d=0;const p=()=>255*(2*Math.random()-1)*n,h=i?()=>{const f=p();return[f,f,f]}:()=>[p(),p(),p()];for(;d<s;d+=4)[l,c,u]=h(),a[d]=a[d]+l,a[d+1]=a[d+1]+c,a[d+2]=a[d+2]+u;e(null,{data:a,width:r.width,height:r.height,colorSpace:o})},lv=(t,e)=>{const{imageData:r,level:n}=t;if(!n)return e(null,r);const i=r.colorSpace,o=r.data,a=o.length;let s,l,c,u=0;for(;u<a;u+=4)s=o[u]/255,l=o[u+1]/255,c=o[u+2]/255,o[u]=255*Math.pow(s,n),o[u+1]=255*Math.pow(l,n),o[u+2]=255*Math.pow(c,n);e(null,{data:o,width:r.width,height:r.height,colorSpace:i})},o2=async(t,e={})=>{const{colorMatrix:r,convolutionMatrix:n,gamma:i,noise:o,vignette:a}=e,s=[];if(n&&s.push([i2,{matrix:n.clarity}]),i>0&&s.push([lv,{level:1/i}]),r&&!(u=>{const d=u.length;let p;const h=d>=20?6:d>=16?5:3;for(let f=0;f<d;f++)if(p=u[f],p===1&&f%h!=0||p!==0&&p!==1)return!1;return!0})(r)&&s.push([ov,{matrix:r}]),(o>0||o<0)&&s.push([sv,{level:o}]),(a>0||a<0)&&s.push([av,{strength:a}]),!s.length)return t;const l=(u,d)=>`(err, imageData) => {
            (${u[d][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${d}]), 
                ${u[d+1]?l(u,d+1):"done"})
        }`,c=`function (options, done) {
        const filterInstructions = options.filterInstructions;
        const imageData = options.imageData;
        (${l(s,0)})(null, imageData)
    }`;return t=await mu(c,[{imageData:t,filterInstructions:s.map(u=>u[1])}],[t.data.buffer]),i0(t)},_e=t=>typeof t=="number",qd=t=>Ge(t)&&t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g)!==null,Te=(t,e)=>t.hasOwnProperty(e),En=t=>Array.isArray(t);let of=64,Vh=102,af=112,sf=!1;var a2=(t,e)=>(!sf&&ni()&&(/^win/i.test(navigator.platform)&&(Vh=103),(Vo()||su())&&(of=63.5,Vh=110,af=123),sf=!0),`<svg${e?` aria-label="${e}"`:""} width="128" height="128" viewBox="0 0 128 128" preserveAspectRatio="xMinYMin meet" xmlns="http://www.w3.org/2000/svg"><text x="${of}" y="${Vh}" alignment-baseline="text-top" dominant-baseline="text-top" text-anchor="middle" font-size="${af}px">${t}</text></svg>`),ic=t=>t instanceof Blob,$o=(t,e)=>t/e*100+"%",Ai=t=>`rgba(${Math.round(255*t[0])}, ${Math.round(255*t[1])}, ${Math.round(255*t[2])}, ${_e(t[3])?t[3]:1})`,Od=t=>Object.values(t).join("_");const s2=async(t,e=0)=>{const r=yn("canvas",{width:80,height:80}).getContext("2d");return await((n=0)=>new Promise(i=>{setTimeout(i,n)}))(e),r.drawImage(t,0,0,80,80),!((n=>!new Uint32Array(n.getImageData(0,0,n.canvas.width,n.canvas.height).data.buffer).some(i=>i!==0))(r)&&e<=256)||await s2(t,e+16)},lf=new Map;var cv=t=>new Promise((e,r)=>{const n=new FileReader;n.onerror=()=>r(n.error),n.onload=()=>e(n.result),n.readAsDataURL(t)}),Ka=()=>{let t=[];return{sub:(e,r)=>(t.push({event:e,callback:r}),()=>t=t.filter(n=>n.event!==e||n.callback!==r)),pub:(e,r)=>{t.filter(n=>n.event===e).forEach(n=>n.callback(r))}}};const qa=32,o0=({color:t=[0,0,0],fontSize:e=16,fontFamily:r="sans-serif",fontVariant:n="normal",fontWeight:i="normal",fontStyle:o="normal",textAlign:a="left",letterSpacing:s="normal",lineHeight:l=20},c=1)=>`font-size:${e*c}px;font-style:${o};font-weight:${i};font-family:${r};font-variant:${n};line-height:${l*c}px;text-align:${a};letter-spacing:${_e(s)?s+"px":"normal"};color:${Ai(t)};`,a0=(t,e,r=1)=>{const{width:n,height:i,disableNewline:o}=e,a=!n,s=o===!1?((u="")=>u.split(`
`).length)(t):void 0,l=a?"normal":"break-word",c=a&&!s?"nowrap":"pre-line";return`max-width:none;min-width:auto;width:${a?"auto":n*r+"px"};height:${i?i*r+"px":"auto"};margin-top:0;margin-bottom:0;padding-top:${(({fontSize:u=16,lineHeight:d=20}={})=>.5*Math.max(0,u-d))(e)*r}px;word-break:${l};word-wrap:normal;white-space:${c};`},cf=new Map,l2=t=>{const e=[];for(const r of Array.from(t.childNodes))r.nodeType===Node.TEXT_NODE?e.push(uv(r)):e.push(...l2(r));return e},c2="pointer-events:none;visibility:hidden;position:absolute;left:0;top:0;",uv=t=>{const e=t.nodeValue;if(!e)return[];const r=e.length,n=document.createRange();n.selectNodeContents(t);const i=[];for(let a=0;a<r;a++){n.setStart(t,0),n.setEnd(t,a+1);const s=n.getClientRects().length-1,l=e.charAt(a);i[s]?i[s]+=l:i.push(l)}const o=n.getClientRects();return i.map((a,s)=>({rect:o[s],text:a}))},uf=new Map,oo=(t="",e)=>{const{width:r,height:n}=e;if(_e(r)&&_e(n))return An(r,n);let{fontSize:i=16,fontFamily:o,lineHeight:a=20,fontWeight:s,fontStyle:l,fontVariant:c,letterSpacing:u}=e;const d=Od({text:t,fontFamily:o,fontWeight:s,fontStyle:l,fontVariant:c,fontSize:i,letterSpacing:u,lineHeight:a,width:r});let p=uf.get(d);if(p)return p;let h=1;i>1e3&&Aa()&&(h=i/1e3,i=1e3,a/=h);const f=t0(yn("pre",{contenteditable:"true",spellcheck:"false",style:`${c2}${o0({...e,fontSize:i,lineHeight:a})};${a0(t,e)}"`,innerHTML:t})).getBoundingClientRect();return p=ts(f),p=La(p,g=>g*h),r&&(p.width=r),uf.set(d,p),p},df=new Map,dv=(t,e)=>new Promise((r,n)=>{let i=df.get(t);i===void 0&&(i=((o,a)=>{const{sub:s,pub:l}=Ka();let c,u;return Promise.resolve(a&&a(o,{resourceType:"stylesheet"})).then(d=>{if(d===!1)return u="requestPrevented",l("error",u);const{headers:p,credentials:h}=d||{};fetch(o,{headers:p,credentials:h}).then(f=>f.text()).then(f=>{c=f,l("load",c)}).catch(f=>{u=f,l("error",u)})}),{sub:(d,p)=>d==="load"&&c?p(c):d==="error"&&u?p(u):void s(d,p)}})(t,e),df.set(t,i)),i.sub("load",r),i.sub("error",n)}),pf=async(t,e,r)=>{let n;try{n=await dv(t,e)}catch{return[]}const i={innerHTML:n,id:ra()};r&&(i.nonce=r);const o=yn("style",i);document.head.append(o);const a=Array.from(document.styleSheets).find(s=>s.ownerNode.id===o.id);return o.remove(),Array.from(a.cssRules)},Nl=new Map,pv=async(t,e,r)=>{if(Nl.has(t.href))return Nl.get(t.href);let n;try{n=Array.from(t.cssRules);for(const i of(o=>o.filter(a=>a instanceof CSSImportRule))(n)){const o=i.href;if(Nl.has(o)){const s=Nl.get(o);n=[...n,...s];continue}const a=await pf(o,e,r);Nl.set(o,a),n=[...n,...a]}}catch{const o=t.href;n=await pf(o,e,r),Nl.set(o,n)}return(i=>i.filter(o=>o instanceof CSSFontFaceRule))(n)},Wd=(t,e)=>t.style.getPropertyValue(e),hv=(t,e)=>Wd(t,"font-family").replace(/^"|"$/g,"")==e,mv=async(t,e,r)=>{const n=((i,o)=>{const a=[];for(const l of i)(s=l).style&&Wd(s,"src")&&Wd(s,"font-family")&&hv(l,o)&&a.push(l);var s;return a})(await(async(i,o)=>{const a=Array.from(document.styleSheets).map(c=>pv(c,i,o)),s=await Promise.all(a),l=[];return s.forEach(c=>l.push(...c)),l})(e,r),t);return n.length?n.map(i=>{const o=i.parentStyleSheet&&i.parentStyleSheet.href&&new URL(i.parentStyleSheet.href),a=o?o.origin+(c=>c.pathname.split("/").slice(0,-1).join("/"))(o)+"/":"",s=i.style.getPropertyValue("src").match(/url\("?(.*?)"?\)/)[1],l=Array.from(i.style).filter(c=>c!="src").reduce((c,u)=>c+=u+":"+Wd(i,u)+";","");return[/^http/.test(s)?s:a+s,l]}):[]},hf=new Map,mf=new Map;var u2=async(t="",e)=>{if(!t.length)return;let{color:r,imageWidth:n=300,imageHeight:i=150,paddingTop:o=0,paddingRight:a=qa,paddingBottom:s=0,paddingLeft:l=qa,fontFamily:c,fontSize:u,pixelRatio:d=1,willRequest:p,outline:h,blur:f,styleNonce:g}=e,$=1,b="";u>1e3&&Aa()&&($=u/1e3,b=`transform-origin:0 0;transform:scale(${$})`);const v=d/$,w=(n+l+a)*d,S=(i+s+o)*d,P=await(async(y,ct,j)=>{if(hf.get(y))return;let k=mf.get(y);if(!k){const nt=await mv(y,ct,j);if(!nt.length)return void hf.set(y,!0);const ft=[];for(const[xt,H]of nt){const Z=await fetch(xt).then(et=>et.blob()),wt=!(N=Z.type)||/woff2/.test(N)?"woff2":/woff/.test(N)?"woff":/ttf|truetype/.test(N)?"truetype":/otf|opentype/.test(N)?"opentype":/svg/.test(N)?"svg":"woff2",vt=await cv(Z);ft.push(`@font-face { src:url(${vt}) format('${wt}');${H};font-display:block; }`)}k=ft.join(""),mf.set(y,k)}var N;return k})(c,p,g);let M="";P&&(M=`<style${g?` nonce="${g}"`:""}>${P}</style>`);const E=t.replace(/%/g,"%25").replace(/#/g,"%23").replace(/&nbsp;/g,"Â ").replace(/&(?!#\d{4};|[a-z]+;)/gi,"&amp;").replace(/<br>|\n/g,"<br/>"),C=`top:${o*v}px;right:${a*v}px;bottom:${s*v}px;left:${l*v}px`;let z=r,V="",L="";if(h||f){const y=Ai(r);h&&(z=[0,0,0,0],V=`-webkit-text-stroke: ${2*h*v}px ${y}`),f&&(Fa()?L=`filter:blur(${f*v*.4}px)`:(z=[0,0,0,0],L=`text-shadow: 0 0 ${f*v}px ${y}`))}return((y,{safariCacheKey:ct="*"}={})=>new Promise((j,k)=>{const N=new Image;N.onerror=()=>k(new Error("Failed to load SVG")),N.onload=()=>{if(!Fa()||!y.includes("@font-face")||lf.has(ct))return j(N);s2(N).then(()=>{lf.set(ct,!0),j(N)})},N.src="data:image/svg+xml,"+y}))(`<svg xmlns="http://www.w3.org/2000/svg" width="${w}" height="${S}" viewBox="0 0 ${w} ${S}"><foreignObject x="0" y="0" width="${w}" height="${S}"><div xmlns="http://www.w3.org/1999/xhtml">${M}<pre contenteditable="true" spellcheck="false" style="position:absolute;${C};${o0({...e,color:z,fontSize:u},v)};${a0(t,e,v)};${b};${V};${L}">${E}</pre></div></foreignObject></svg>`,{safariCacheKey:c})};const In=t=>{const e={...t};return Ly(e)},ff=(t,e={})=>{const r=$i(t);let n,i;const o=e.width||e.rx,a=e.height||e.ry;if(o&&a)return so(e);if(o||a){n=parseFloat(o||Number.MAX_SAFE_INTEGER),i=parseFloat(a||Number.MAX_SAFE_INTEGER);const s=Math.min(n,i);Ge(o)||Ge(a)?(n=s+"%",i=s*r+"%"):(n=s,i=s)}else n="10%",i=10*r+"%";return{[(e.width?"width":e.rx?"rx":void 0)||"width"]:n,[(e.width?"height":e.rx?"ry":void 0)||"height"]:i}},gf=(t,e={})=>{return{width:void 0,height:void 0,...e,aspectRatio:1,backgroundImage:(r=a2(t),"data:image/svg+xml,"+r.replace("<","%3C").replace(">","%3E"))};var r},$f=(t,e={})=>({backgroundColor:[0,0,0,0],...di(e)?{}:{width:void 0,height:void 0,aspectRatio:void 0},...e,backgroundImage:Ge(t)?t:ic(t)?URL.createObjectURL(t):t}),yf=(t,e)=>{let r;if(Ge(t)||ic(t)){const n={...ff(e),backgroundSize:"contain"};r=qd(t)?gf(t,n):$f(t,n)}else if(t.src){const n=ff(e,t.shape||t),i={...t.shape,...n};if(t.width&&t.height&&!Te(i,"aspectRatio")){const o=I1(n,"width",e),a=I1(n,"height",e);i.aspectRatio=ca(o,a)}i.backgroundSize||t.shape||t.width&&t.height||(i.backgroundSize="contain"),r=qd(t.src)?gf(t.src,i):$f(t.src,i)}else t.shape&&(r=In(t.shape));return Te(r,"backgroundImage")&&(Te(r,"backgroundColor")||(r.backgroundColor=[0,0,0,0]),Te(r,"disableStyle")||(r.disableStyle=["cornerRadius","backgroundColor","strokeColor","strokeWidth"])),e?On(r,e):r},ms=t=>lt(t.x1,t.y1),fs=t=>lt(t.x2,t.y2),Qn=t=>Te(t,"text"),Kd=t=>Qn(t)&&!(up(t)||Te(t,"width")),_d=t=>Qn(t)&&(up(t)||Te(t,"width")),Wo=t=>!Qn(t)&&fv(t),di=t=>Te(t,"rx"),Ii=t=>Te(t,"x1"),Jn=t=>Te(t,"points"),ps=t=>Qn(t)&&t.isEditing,gd=t=>!Te(t,"opacity")||t.opacity>0,Pa=t=>t.isSelected,Nh=t=>t.isEditing,ao=t=>t._isDraft,ml=t=>Te(t,"width")&&Te(t,"height"),d2=t=>{const e=Te(t,"right"),r=Te(t,"bottom");return e||r},up=t=>(Te(t,"x")||Te(t,"left"))&&Te(t,"right")||(Te(t,"y")||Te(t,"top"))&&Te(t,"bottom"),fv=t=>ml(t)||up(t),S1=t=>(t._isDraft=!0,t),bf=t=>(t._isDraft=!1,t),k1=(t,e)=>t.disableStyle!==!0&&(!En(t.disableStyle)||!e||!t.disableStyle.includes(e)),gv=t=>t.disableErase!==!0,Ca=t=>t.disableSelect!==!0,$d=t=>t.disableRemove!==!0,xf=t=>t.disableDuplicate!==!0&&$l(t),$v=t=>!t.disableFlip&&!ao(t)&&!d2(t)&&(e=>Te(e,"backgroundImage")||Te(e,"text"))(t),Hl=(t,e)=>!!Qn(t)&&t.disableInput!==!0&&(Vr(t.disableInput)?t.disableInput(e??t.text):e||!0),cl=(t,e)=>t.disableTextLayout!==!0&&(!En(t.disableTextLayout)||!e||!t.disableTextLayout.includes(e)),Hh=t=>p2(t)&&t.points.length>3,p2=t=>!!Jn(t)&&t.disableAddPoints!==void 0&&t.disableAddPoints!==!0,T1=t=>t.disableManipulate!==!0&&!ao(t)&&!d2(t),$l=t=>T1(t)&&t.disableMove!==!0,C1=t=>(delete t.left,delete t.right,delete t.top,delete t.bottom,t),vf=t=>(delete t.rotation,t),wf=t=>(t.strokeWidth=t.strokeWidth||1,t.strokeColor=t.strokeColor||[0,0,0],t),Sf=t=>(t.backgroundColor=t.backgroundColor?t.backgroundColor:t.strokeWidth||t.backgroundImage?void 0:[0,0,0],t),kf=t=>{let e=t.text;e=e.replace(/&(#[0-9]+|[a-z]+);/gi,(r,n)=>`___${n}___`),e=e.replace(/&/,"&amp;"),t.text=e.replace(/___(#[0-9]+|[a-z]+)___/gi,(r,n)=>`&${n};`)},M1=t=>{if(!t.textShadow)return t;const[e,r,n,i]=t.textShadow;return t.textShadowX=e,t.textShadowY=r,t.textShadowBlur=n,t.textShadowColor=i,delete t.textShadow,t},P1=t=>{if(!t.textOutline)return t;const[e,r]=t.textOutline;t.textOutlineWidth=e,t.textOutlineColor=r,delete t.textOutline},yv=t=>(t.fontSize=t.fontSize||"4%",t.fontFamily=t.fontFamily||"sans-serif",t.fontWeight=t.fontWeight||"normal",t.fontStyle=t.fontStyle||"normal",t.fontVariant=t.fontVariant||"normal",t.lineHeight=t.lineHeight||"120%",t.color=t.color||[0,0,0],t.format=t.format==="html"?"html":"text",M1(t),P1(t),t.format==="html"?kf(t):(e=>{kf(e);let r=e.text;r=r.replace(/</g,"&gt;"),r=r.replace(/>/g,"&lt;"),e.text=r})(t),Kd(t)?bv(t):xv(t)),bv=t=>(t.disableNewline!==!1&&(delete t.textAlign,t.text=t.text.replace(/\n/g," ")),C1(t)),xv=t=>(t.textAlign=t.textAlign||"left",t),h2=t=>((e=>{Ge(e.id)||(e.id=ra()),Te(e,"rotation")||(e.rotation=0),Te(e,"opacity")||(e.opacity=1),Te(e,"disableErase")||(e.disableErase=!0)})(t),Qn(t)?yv(t):Wo(t)?(e=>{e.cornerRadius=e.cornerRadius||0,e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],Sf(e)})(t):Jn(t)?(e=>{wf(e),vf(e),Te(e,"pathClose")||(e.disableResize=!0,Te(e,"disableMove")||(e.disableMove=!0)),C1(e)})(t):Ii(t)?(e=>{wf(e),e.lineStart=e.lineStart||void 0,e.lineEnd=e.lineEnd||void 0,vf(e),C1(e)})(t):di(t)&&(e=>{e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],Sf(e)})(t),t),vv=t=>Qn(t)?"text":Wo(t)?"rectangle":Jn(t)?"path":Ii(t)?"line":di(t)?"ellipse":void 0,Jd=(t,e)=>parseFloat(t)/100*e,wv=new RegExp(/^x|left|right|^width|rx|fontSize|eraseRadius|feather|cornerRadius|strokeWidth|strokeDash/,"i"),Sv=new RegExp(/^y|top|bottom|^height|ry/,"i"),s0=(t,e,{width:r,height:n})=>{if(Array.isArray(e))return e.map(o=>(bs(o)&&m2(o,{width:r,height:n}),Ge(o)&&(o=s0(t,o,{width:r,height:n})),o));if(typeof e!="string"||!e.endsWith("%"))return e;const i=parseFloat(e)/100;return wv.test(t)?mr(r*i,6):Sv.test(t)?mr(n*i,6):e},kv=s0,Tv=["lineHeight","textOutlineWidth","textShadowX","textShadowY","textShadowBlur"],m2=(t,e)=>{Object.entries(t).map(([r,n])=>{t[r]=s0(r,n,e)}),t.text&&Tv.filter(r=>Ge(t[r])).forEach(r=>{var n,i;t[r]=(n=t[r],i=t.fontSize,Math.round(i*(parseFloat(n)/100)))})},On=(t,e)=>(m2(t,e),$2(t,e),t),R1=(t,e)=>{let r;return/^x|width|rx|fontSize|strokeWidth|cornerRadius/.test(t)?r=e.width:/^y|height|ry/.test(t)&&(r=e.height),r},I1=(t,e,r)=>Array.isArray(t[e])?t[e].map(n=>Object.entries(n).reduce((i,[o,a])=>(i[o]=Ge(a)?Jd(a,R1(o,r)):a,i),{})):Ge(t[e])?Jd(t[e],R1(e,r)):t[e],Ql=(t,e,r)=>e.reduce((n,i)=>{const o=I1(t,i,r);return n[i]=o,n},{}),Ia=(t,e,r)=>(Object.keys(e).forEach(n=>((i,o,a,s)=>{if(!Ge(i[o]))return i[o]=a,i;const l=R1(o,s);return i[o]=l===void 0?a:$o(a,l),i})(t,n,e[n],r)),t),f2=(t,e)=>{const r=t.filter(n=>n.x<0||n.y<0||n.x1<0||n.y1<0).reduce((n,i)=>{const[o,a,s,l]=(c=>{const u=Os(),d=c.strokeWidth||0;if(Wo(c))u.x=c.x-.5*d,u.y=c.y-.5*d,u.width=c.width+d,u.height=c.height+d;else if(Ii(c)){const{x1:p,y1:h,x2:f,y2:g}=c,$=Math.abs(Math.min(p,f)),b=Math.abs(Math.max(p,f)),v=Math.abs(Math.min(h,g)),w=Math.abs(Math.min(h,g));u.x=$+.5*d,u.y=b+.5*d,u.width=b-$+d,u.height=w-v+d}else di(c)&&(u.x=c.x-c.rx+.5*d,u.y=c.y-c.ry+.5*d,u.width=2*c.rx+d,u.height=2*c.ry+d);return u&&Te(c,"rotation")&&Ti(u,c.rotation),vl(u)})(i);return n.top=Math.min(o,n.top),n.left=Math.min(l,n.left),n.bottom=Math.max(s,n.bottom),n.right=Math.max(a,n.right),n},{top:0,right:0,bottom:0,left:0});return r.right>0&&(r.right-=e.width),r.bottom>0&&(r.bottom-=e.height),r},g2=(t,e,r)=>{const n=In(t);On(n,e);const i=r(n);return Array.isArray(i)?i:[i]},$2=(t,e)=>{if(Te(t,"left")&&(t.x=t.left),Te(t,"right")&&!Ge(t.right)){const r=e.width-t.right;Te(t,"left")?(t.x=t.left,t.width=Math.max(0,r-t.left)):Te(t,"width")&&(t.x=r-t.width)}if(Te(t,"top")&&(t.y=t.top),Te(t,"bottom")&&!Ge(t.bottom)){const r=e.height-t.bottom;Te(t,"top")?(t.y=t.top,t.height=Math.max(0,r-t.top)):Te(t,"height")&&(t.y=r-t.height)}return t},y2=(t,e)=>(Jn(t)&&t.points.filter(r=>_e(r.x)).forEach(r=>{r.x*=e,r.y*=e}),Ii(t)&&_e(t.x1)&&(t.x1*=e,t.y1*=e,t.x2*=e,t.y2*=e),_e(t.x)&&_e(t.y)&&(t.x*=e,t.y*=e),_e(t.width)&&_e(t.height)&&(t.width*=e,t.height*=e),_e(t.rx)&&_e(t.ry)&&(t.rx*=e,t.ry*=e),(r=>_e(r.strokeWidth)&&r.strokeWidth>0)(t)&&(t.strokeWidth*=e),Qn(t)&&(t._scale=e,_e(t.fontSize)&&(t.fontSize*=e),_e(t.lineHeight)&&(t.lineHeight*=e),_e(t.width)&&!_e(t.height)&&(t.width*=e)),Te(t,"cornerRadius")&&_e(t.cornerRadius)&&(t.cornerRadius*=e),t),b2=t=>{if(Wo(t))return lt(t.x+.5*t.width,t.y+.5*t.height);if(di(t))return lt(t.x,t.y);if(t.text){if(_d(t)){const r=t.height||oo(t.text,t).height;return lt(t.x+.5*t.width,t.y+.5*r)}const e=oo(t.text,t);return lt(t.x+.5*e.width,t.y+.5*e.height)}return Jn(t)?Qo(t.points):Ii(t)?Qo([ms(t),fs(t)]):void 0};var oc=t=>/canvas/i.test(t.nodeName),Cv=(t,e)=>new Promise((r,n)=>{let i=t,o=!1;const a=()=>{o||(o=!0,Vr(e)&&Promise.resolve().then(()=>e(An(i.naturalWidth,i.naturalHeight))))};if(i.src||(i=new Image,Ge(t)&&new URL(t,location.href).origin!==location.origin&&(i.crossOrigin="anonymous"),i.src=Ge(t)?t:URL.createObjectURL(t)),i.complete)return a(),r(i);Vr(e)&&Ky(i).then(a).catch(n),i.onload=()=>{a(),r(i)},i.onerror=()=>n(new Error("Failed to load image"))});const Tf=new Map([]),l0=(t,e={})=>new Promise((r,n)=>{const{onMetadata:i=se,onLoad:o=r,onError:a=n,onComplete:s=se}=e;let l=Tf.get(t);if(l||(l={loading:!1,complete:!1,error:!1,image:void 0,size:void 0,bus:Ka()},Tf.set(t,l)),l.bus.sub("meta",i),l.bus.sub("load",o),l.bus.sub("error",a),l.bus.sub("complete",s),oc(t)){const c=t,u=c.cloneNode();l.complete=!0,l.image=u,l.size=Jc(c)}if(l.complete)return l.bus.pub("meta",{size:l.size}),l.error?l.bus.pub("error",l.error):l.bus.pub("load",l.image),l.bus.pub("complete"),void(l.bus=Ka());l.loading||(l.loading=!0,Cv(t,c=>{l.size=c,l.bus.pub("meta",{size:c})}).then(c=>{l.image=c,l.bus.pub("load",c)}).catch(c=>{l.error=c,l.bus.pub("error",c)}).finally(()=>{l.complete=!0,l.loading=!1,l.bus.pub("complete"),l.bus=Ka()}))}),Mv=(t,e,r,n)=>t.drawImage(e,r.x,r.x,r.width,r.height,n.x,n.y,n.width,n.height);var x2=async(t,e,r,n,i=Mv,o)=>{t.save(),t.clip(),await i(t,e,r,n,o),t.restore()};const Qd=(t,e,r,n,i)=>{const o=Fr(t);if(n){const s=ta(ri(n),mr);return s.x*=r.width,s.width*=r.width,s.y*=r.height,s.height*=r.height,{srcRect:s,destRect:o}}const a=Wn(0,0,r.width,r.height);if(e==="contain"){const s=Ki(t,$i(a));o.width=s.width,o.height=s.height,i?(o.x+=i.x,o.y+=i.y):(o.x+=s.x,o.y+=s.y)}else if(e==="cover"){const s=Zs(o,a.width/a.height);o.width=s.width,o.height=s.height,i?(o.x+=i.x,o.y+=i.y):(o.x+=s.x,o.y+=s.y)}else e?(o.width=e.width,o.height=e.height,i&&(o.x+=i.x,o.y+=i.y)):i&&(o.width=r.width,o.height=r.height,o.x+=i.x,o.y+=i.y);return{srcRect:a,destRect:o}},jh=(t,e)=>(e.cornerRadius>0?((r,n,i,o,a,s)=>{o<2*s&&(s=o/2),a<2*s&&(s=a/2),r.beginPath(),r.moveTo(n+s,i),r.arcTo(n+o,i,n+o,i+a,s),r.arcTo(n+o,i+a,n,i+a,s),r.arcTo(n,i+a,n,i,s),r.arcTo(n,i,n+o,i,s),r.closePath()})(t,e.x,e.y,e.width,e.height,e.cornerRadius):t.rect(e.x,e.y,e.width,e.height),t),Cf=(t,e)=>(e.backgroundColor&&t.fill(),t),Mf=(t,e)=>(e.strokeWidth&&t.stroke(),t);var c0=async(t,e,r={})=>{const{drawImage:n}=r;if(t.lineWidth=e.strokeWidth?e.strokeWidth:1,t.strokeStyle=e.strokeColor?Ai(e.strokeColor):"none",t.fillStyle=e.backgroundColor?Ai(e.backgroundColor):"none",t.globalAlpha=e.opacity,e.backgroundImage){let i;if(i=oc(e.backgroundImage)?e.backgroundImage:await l0(e.backgroundImage),jh(t,e),Cf(t,e),e.backgroundRepeat==="repeat"){const o=e.backgroundPosition||{x:0,y:0},{srcRect:a,destRect:s}=Qd(e,e.backgroundSize||Jc(i),Jc(i),e.backgroundCorners,{x:0,y:0}),l=document.createElement("canvas");l.width=s.width,l.height=s.height;const c=l.getContext("2d",{willReadFrequently:!1,desynchronized:!0});await n(c,i,a,{...s,x:0,y:0});const u=t.createPattern(l,"repeat");t.fillStyle=u,t.save(),t.beginPath(),t.rect(e.x+o.x,e.y+o.y,e.width-o.x,e.height-o.y),t.clip(),t.translate(s.x+o.x,s.y+o.y),t.fill(),ti(l),t.restore()}else{const{srcRect:o,destRect:a}=Qd(e,e.backgroundSize,Jc(i),e.backgroundCorners,e.backgroundPosition);await x2(t,i,o,a,n,{feather:e.feather})}return t.beginPath(),jh(t,e),Mf(t,e),[]}return jh(t,e),Cf(t,e),Mf(t,e),[]},u0=async(t,e,r={})=>new Promise(async(n,i)=>{const{drawImage:o}=r;if(t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?Ai(e.strokeColor):"none",t.fillStyle=e.backgroundColor?Ai(e.backgroundColor):"none",t.globalAlpha=e.opacity,t.ellipse(e.x,e.y,e.rx,e.ry,0,0,2*Math.PI),e.backgroundColor&&t.fill(),e.backgroundImage){let a;try{a=await l0(e.backgroundImage)}catch(u){i(u)}const s=Wn(e.x-e.rx,e.y-e.ry,2*e.rx,2*e.ry),{srcRect:l,destRect:c}=Qd(s,e.backgroundSize,Jc(a),e.backgroundCorners,e.backgroundPosition);await x2(t,a,l,c,o),e.strokeWidth&&t.stroke(),n([])}else e.strokeWidth&&t.stroke(),n([])}),Pv=async(t,e,r)=>{const n=_e(e.width)?Math.floor(e.width):void 0,i=_e(e.height)?Math.floor(e.height):void 0,o=n&&i?ts(e):oo(e.text,{...e,width:n,height:i}),a={x:e.x,y:e.y,width:o.width,height:o.height};if(c0(t,{...e,...a}),!e.text.length)return[];const{textOutlineWidth:s=0,textShadowX:l=0,textShadowY:c=0,textShadowBlur:u=0,textShadowColor:d,outline:p,blur:h,...f}=e,g=!!e.height;if(g&&(t.rect(a.x,a.y,a.width,a.height),t.save(),t.clip()),l||c||u){t.save(),t.translate(l,c);const $={...a};g||($.height+=qa+u),await Uh(t,$,{...e,width:n,height:i},{...r,paddingLeft:qa+u,paddingRight:qa+u,paddingTop:u,paddingBottom:u+(g?-1*c:e.fontSize),shapeExtendedProps:{color:d,blur:u}}),t.restore()}if(s){const $={...a};g||($.height+=qa+s),await Uh(t,$,{...e,width:n,height:i},{...r,paddingLeft:qa+s,paddingRight:qa+s,paddingTop:s,paddingBottom:s+g?0:e.fontSize,shapeExtendedProps:{color:e.textOutlineColor,outline:s}})}return g&&t.restore(),await Uh(t,a,{...f,width:n,height:i},{...r,paddingLeft:qa,paddingRight:qa,paddingTop:0,paddingBottom:g?0:e.fontSize}),[]};const Uh=async(t,e,r,n)=>{const{willRequest:i,shapeExtendedProps:o,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,styleNonce:u}=n,d=_e(r.width)?Math.floor(e.width):void 0,p=_e(r.height)?Math.floor(e.height):void 0,h=Math.ceil(e.width),f=Math.ceil(e.height),g=await u2(r.text,{...r,...o,...e,width:d,height:p,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,imageWidth:h,imageHeight:f,willRequest:i,styleNonce:u});t.drawImage(g,r.x-a,r.y-l,g.width,g.height)};var Rv=async(t,e)=>new Promise(async r=>{t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?Ai(e.strokeColor):"none",t.globalAlpha=e.opacity,e.bitmap&&(t.lineCap=e.strokeCap,t.lineJoin=e.strokeJoin,t.setLineDash(e.strokeDash||[]));let n=ms(e),i=fs(e);t.moveTo(n.x,n.y),t.lineTo(i.x,i.y),e.strokeWidth&&t.stroke(),r([])}),E1=async(t,e)=>new Promise((r,n)=>{if(e.bitmap&&e.points.length===1)return void u0(t,{x:e.points[0].x,y:e.points[0].y,rx:.5*e.strokeWidth,ry:.5*e.strokeWidth,backgroundColor:e.strokeColor}).then(()=>r([]));t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?Ai(e.strokeColor):"transparent",t.fillStyle=e.pathClose&&e.backgroundColor?Ai(e.backgroundColor):"transparent",t.globalAlpha=e.opacity;const{points:i}=e;e.bitmap&&(t.lineCap=e.strokeCap,t.lineJoin=e.strokeJoin,t.setLineDash(e.strokeDash||[])),e.pathClose&&t.beginPath(),t.moveTo(i[0].x,i[0].y);const o=i.length;for(let a=1;a<o;a++)t.lineTo(i[a].x,i[a].y);e.pathClose&&t.closePath(),e.strokeWidth&&t.stroke(),e.backgroundColor&&t.fill(),r([])}),v2=(t,e,r,n)=>((e||r)&&(t.translate(n.x,n.y),t.scale(e?-1:1,r?-1:1),t.translate(-n.x,-n.y)),t);const Iv=async(t,e,r)=>{t.globalCompositeOperation=e.drawMode==="subtract"?"destination-out":"source-over";const n=b2(e);let i;if(n0(t,e.rotation,n),v2(t,e.flipX,e.flipY,n),Wo(e)?i=c0:di(e)?i=u0:Ii(e)?i=Rv:Jn(e)?i=E1:Qn(e)&&(i=Pv),i){const o=await i(t,e,r);return o.length?[e,...await w2(t,o,r)]:[]}return[]};var w2=async(t,e,r)=>{let n=[];for(const i of e)t.save(),t.beginPath(),n=[...n,...await Iv(t,i,r)],t.restore();return n},d0=async(t,e={})=>{const{shapes:r=[],contextBounds:n=t,transform:i=se,drawImage:o,willRequest:a,styleNonce:s,canvasMemoryLimit:l,computeShape:c=tn,preprocessShape:u=tn}=e;if(!r.length)return t;const d={willReadFrequently:!0,colorSpace:t.colorSpace},p=yn("canvas");p.width=n.width,p.height=n.height;const h=p.getContext("2d",d);h.putImageData(t,n.x||0,n.y||0);const f=r.map(In).map(c).map(u).flat().filter(Boolean);i(h),await w2(h,f,{drawImage:o,canvasMemoryLimit:l,willRequest:a,styleNonce:s});const g=h.getImageData(0,0,p.width,p.height);return ti(p),g},Ev=async(t,e={})=>{const{backgroundFilterMode:r,backgroundColor:n,backgroundImage:i}=e,o=!(!n||n&&n[3]===0);if(!i&&!o)return t;const a={willReadFrequently:!0,colorSpace:t.colorSpace},s=yn("canvas");s.width=t.width,s.height=t.height;const l=s.getContext("2d",a);if(l.putImageData(t,0,0),l.globalCompositeOperation="destination-over",o&&(l.fillStyle=Ai(n),l.fillRect(0,0,s.width,s.height)),i){let u,d;if(oc(i)?u=i:(u=await l0(i),r==="image"&&(u=Fy(u,{contextOptions:a}))),r==="image"){const f=lc(u),g=await o2(f,e);d=await Sl(g)}const{srcRect:p,destRect:h}=Qd({x:0,y:0,width:t.width,height:t.height},"cover",{width:u.width||u.naturalWidth,height:u.height||u.naturalHeight});l.drawImage(d||u,p.x,p.y,p.width,p.height,h.x,h.y,h.width,h.height),d&&ti(d),r&&r!=="none"&&u&&!oc(i)&&ti(u)}const c=l.getImageData(0,0,s.width,s.height);return ti(s),c},$u=t=>t.length?t.reduce((e,r)=>((n,i)=>{const o=new Array(20);return o[0]=n[0]*i[0]+n[1]*i[5]+n[2]*i[10]+n[3]*i[15],o[1]=n[0]*i[1]+n[1]*i[6]+n[2]*i[11]+n[3]*i[16],o[2]=n[0]*i[2]+n[1]*i[7]+n[2]*i[12]+n[3]*i[17],o[3]=n[0]*i[3]+n[1]*i[8]+n[2]*i[13]+n[3]*i[18],o[4]=n[0]*i[4]+n[1]*i[9]+n[2]*i[14]+n[3]*i[19]+n[4],o[5]=n[5]*i[0]+n[6]*i[5]+n[7]*i[10]+n[8]*i[15],o[6]=n[5]*i[1]+n[6]*i[6]+n[7]*i[11]+n[8]*i[16],o[7]=n[5]*i[2]+n[6]*i[7]+n[7]*i[12]+n[8]*i[17],o[8]=n[5]*i[3]+n[6]*i[8]+n[7]*i[13]+n[8]*i[18],o[9]=n[5]*i[4]+n[6]*i[9]+n[7]*i[14]+n[8]*i[19]+n[9],o[10]=n[10]*i[0]+n[11]*i[5]+n[12]*i[10]+n[13]*i[15],o[11]=n[10]*i[1]+n[11]*i[6]+n[12]*i[11]+n[13]*i[16],o[12]=n[10]*i[2]+n[11]*i[7]+n[12]*i[12]+n[13]*i[17],o[13]=n[10]*i[3]+n[11]*i[8]+n[12]*i[13]+n[13]*i[18],o[14]=n[10]*i[4]+n[11]*i[9]+n[12]*i[14]+n[13]*i[19]+n[14],o[15]=n[15]*i[0]+n[16]*i[5]+n[17]*i[10]+n[18]*i[15],o[16]=n[15]*i[1]+n[16]*i[6]+n[17]*i[11]+n[18]*i[16],o[17]=n[15]*i[2]+n[16]*i[7]+n[17]*i[12]+n[18]*i[17],o[18]=n[15]*i[3]+n[16]*i[8]+n[17]*i[13]+n[18]*i[18],o[19]=n[15]*i[4]+n[16]*i[9]+n[17]*i[14]+n[18]*i[19]+n[19],o})([...e],r),t.shift()):[],S2=(t,e)=>{const r=t.width*t.height,n=e.reduce((o,a)=>(a.width>o.width&&a.height>o.height&&(o.width=a.width,o.height=a.height),o),{width:0,height:0}),i=n.width*n.height;return((o,a=2)=>Math.round(o*a)/a)(Math.max(.5,.5+(1-i/r)/2),5)};function qe(){}const k2=t=>t;function _n(t,e){for(const r in e)t[r]=e[r];return t}function T2(t){return t()}function Pf(){return Object.create(null)}function Ur(t){t.forEach(T2)}function kr(t){return typeof t=="function"}function cr(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let yd;function Rf(t,e){return yd||(yd=document.createElement("a")),yd.href=e,t===yd.href}function Hi(t,...e){if(t==null)return qe;const r=t.subscribe(...e);return r.unsubscribe?()=>r.unsubscribe():r}function Ea(t){let e;return Hi(t,r=>e=r)(),e}function D(t,e,r){t.$$.on_destroy.push(Hi(e,r))}function yi(t,e,r,n){if(t){const i=C2(t,e,r,n);return t[0](i)}}function C2(t,e,r,n){return t[1]&&n?_n(r.ctx.slice(),t[1](n(e))):r.ctx}function bi(t,e,r,n){if(t[2]&&n){const i=t[2](n(r));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],a=Math.max(e.dirty.length,i.length);for(let s=0;s<a;s+=1)o[s]=e.dirty[s]|i[s];return o}return e.dirty|i}return e.dirty}function xi(t,e,r,n,i,o){if(i){const a=C2(e,r,n,o);t.p(a,i)}}function vi(t){if(t.ctx.length>32){const e=[],r=t.ctx.length/32;for(let n=0;n<r;n++)e[n]=-1;return e}return-1}function lu(t){const e={};for(const r in t)r[0]!=="$"&&(e[r]=t[r]);return e}function If(t,e){const r={};e=new Set(e);for(const n in t)e.has(n)||n[0]==="$"||(r[n]=t[n]);return r}function It(t,e,r){return t.set(r),e}function Tr(t){return t&&kr(t.destroy)?t.destroy:qe}const M2=typeof window<"u";let P2=M2?()=>window.performance.now():()=>Date.now(),p0=M2?t=>requestAnimationFrame(t):qe;const tc=new Set;function R2(t){tc.forEach(e=>{e.c(t)||(tc.delete(e),e.f())}),tc.size!==0&&p0(R2)}function h0(t){let e;return tc.size===0&&p0(R2),{promise:new Promise(r=>{tc.add(e={c:t,f:r})}),abort(){tc.delete(e)}}}const m0=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Lt(t,e){t.appendChild(e)}function I2(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Av(t){const e=mt("style");return function(r,n){Lt(r.head||r,n),n.sheet}(I2(t),e),e.sheet}function tt(t,e,r){t.insertBefore(e,r||null)}function J(t){t.parentNode&&t.parentNode.removeChild(t)}function mt(t){return document.createElement(t)}function Li(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Mn(t){return document.createTextNode(t)}function ue(){return Mn(" ")}function Dn(){return Mn("")}function Tt(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function Lv(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Fv(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function T(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}const zv=["width","height"];function Dv(t,e){const r=Object.getOwnPropertyDescriptors(t.__proto__);for(const n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:r[n]&&r[n].set&&zv.indexOf(n)===-1?t[n]=e[n]:T(t,n,e[n])}function Bv(t,e){Object.keys(e).forEach(r=>{(function(n,i,o){i in n?n[i]=typeof n[i]=="boolean"&&o===""||o:T(n,i,o)})(t,r,e[r])})}function Ef(t){return/-/.test(t)?Bv:Dv}function Gn(t,e){e=""+e,t.data!==e&&(t.data=e)}function Af(t,e){t.value=e??""}function Mt(t,e,r,n){r==null?t.style.removeProperty(e):t.style.setProperty(e,r,"")}function E2(t,e,{bubbles:r=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,r,n,e),i}class f0{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,r,n=null){this.e||(this.is_svg?this.e=Li(r.nodeName):this.e=mt(r.nodeType===11?"TEMPLATE":r.nodeName),this.t=r.tagName!=="TEMPLATE"?r:r.content,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let r=0;r<this.n.length;r+=1)tt(this.t,this.n[r],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(J)}}function tp(t,e){return new t(e)}const ep=new Map;let cu,Vd=0;function Lf(t,e,r,n,i,o,a,s=0){const l=16.666/n;let c=`{
`;for(let $=0;$<=1;$+=l){const b=e+(r-e)*o($);c+=100*$+`%{${a(b,1-b)}}
`}const u=c+`100% {${a(r,1-r)}}
}`,d=`__svelte_${function($){let b=5381,v=$.length;for(;v--;)b=(b<<5)-b^$.charCodeAt(v);return b>>>0}(u)}_${s}`,p=I2(t),{stylesheet:h,rules:f}=ep.get(p)||function($,b){const v={stylesheet:Av(b),rules:{}};return ep.set($,v),v}(p,t);f[d]||(f[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?g+", ":""}${d} ${n}ms linear ${i}ms 1 both`,Vd+=1,d}function Ov(t,e){const r=(t.style.animation||"").split(", "),n=r.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=r.length-n.length;i&&(t.style.animation=n.join(", "),Vd-=i,Vd||p0(()=>{Vd||(ep.forEach(o=>{const{ownerNode:a}=o.stylesheet;a&&J(a)}),ep.clear())}))}function tu(t){cu=t}function kl(){if(!cu)throw new Error("Function called outside component initialization");return cu}function xs(t){kl().$$.on_mount.push(t)}function A2(t){kl().$$.after_update.push(t)}function jo(t){kl().$$.on_destroy.push(t)}function ba(){const t=kl();return(e,r,{cancelable:n=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=E2(e,r,{cancelable:n});return i.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function go(t,e){return kl().$$.context.set(t,e),e}function $n(t){return kl().$$.context.get(t)}function Ji(t,e){const r=t.$$.callbacks[e.type];r&&r.slice().forEach(n=>n.call(this,e))}const Zl=[],jr=[];let ec=[];const A1=[],L2=Promise.resolve();let L1=!1;function F2(){L1||(L1=!0,L2.then(A))}function z2(){return F2(),L2}function wl(t){ec.push(t)}function No(t){A1.push(t)}const Gh=new Set;let _c,jl=0;function A(){if(jl!==0)return;const t=cu;do{try{for(;jl<Zl.length;){const e=Zl[jl];jl++,tu(e),Wv(e.$$)}}catch(e){throw Zl.length=0,jl=0,e}for(tu(null),Zl.length=0,jl=0;jr.length;)jr.pop()();for(let e=0;e<ec.length;e+=1){const r=ec[e];Gh.has(r)||(Gh.add(r),r())}ec.length=0}while(Zl.length);for(;A1.length;)A1.pop()();L1=!1,Gh.clear(),tu(t)}function Wv(t){if(t.fragment!==null){t.update(),Ur(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(wl)}}function Zh(t,e,r){t.dispatchEvent(E2(`${e?"intro":"outro"}${r}`))}const Nd=new Set;let gs;function Fe(){gs={r:0,c:[],p:gs}}function ze(){gs.r||Ur(gs.c),gs=gs.p}function I(t,e){t&&t.i&&(Nd.delete(t),t.i(e))}function B(t,e,r,n){if(t&&t.o){if(Nd.has(t))return;Nd.add(t),gs.c.push(()=>{Nd.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}const _v={duration:0};function Ff(t,e,r,n){const i={direction:"both"};let o=e(t,r,i),a=n?0:1,s=null,l=null,c=null;function u(){c&&Ov(t,c)}function d(h,f){const g=h.b-a;return f*=Math.abs(g),{a,b:h.b,d:g,duration:f,start:h.start,end:h.start+f,group:h.group}}function p(h){const{delay:f=0,duration:g=300,easing:$=k2,tick:b=qe,css:v}=o||_v,w={start:P2()+f,b:h};h||(w.group=gs,gs.r+=1),s||l?l=w:(v&&(u(),c=Lf(t,a,h,g,f,$,v)),h&&b(0,1),s=d(w,g),wl(()=>Zh(t,h,"start")),h0(S=>{if(l&&S>l.start&&(s=d(l,g),l=null,Zh(t,s.b,"start"),v&&(u(),c=Lf(t,a,s.b,s.duration,0,$,o.css))),s){if(S>=s.end)b(a=s.b,1-a),Zh(t,s.b,"end"),l||(s.b?u():--s.group.r||Ur(s.group.c)),s=null;else if(S>=s.start){const P=S-s.start;a=s.a+s.d*$(P/s.duration),b(a,1-a)}}return!(!s&&!l)}))}return{run(h){kr(o)?(_c||(_c=Promise.resolve(),_c.then(()=>{_c=null})),_c).then(()=>{o=o(i),p(h)}):p(h)},end(){u(),s=l=null}}}function D2(t,e){t.d(1),e.delete(t.key)}function Ys(t,e){B(t,1,1,()=>{e.delete(t.key)})}function es(t,e,r,n,i,o,a,s,l,c,u,d){let p=t.length,h=o.length,f=p;const g={};for(;f--;)g[t[f].key]=f;const $=[],b=new Map,v=new Map,w=[];for(f=h;f--;){const E=d(i,o,f),C=r(E);let z=a.get(C);z?w.push(()=>z.p(E,e)):(z=c(C,E),z.c()),b.set(C,$[f]=z),C in g&&v.set(C,Math.abs(f-g[C]))}const S=new Set,P=new Set;function M(E){I(E,1),E.m(s,u),a.set(E.key,E),u=E.first,h--}for(;p&&h;){const E=$[h-1],C=t[p-1],z=E.key,V=C.key;E===C?(u=E.first,p--,h--):b.has(V)?!a.has(z)||S.has(z)?M(E):P.has(V)?p--:v.get(z)>v.get(V)?(P.add(z),M(E)):(S.add(V),p--):(l(C,a),p--)}for(;p--;){const E=t[p];b.has(E.key)||l(E,a)}for(;h;)M($[h-1]);return Ur(w),$}function zi(t,e){const r={},n={},i={$$scope:1};let o=t.length;for(;o--;){const a=t[o],s=e[o];if(s){for(const l in a)l in s||(n[l]=1);for(const l in s)i[l]||(r[l]=s[l],i[l]=1);t[o]=s}else for(const l in a)i[l]=1}for(const a in n)a in r||(r[a]=void 0);return r}function Gi(t){return typeof t=="object"&&t!==null?t:{}}function Ro(t,e,r){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=r,r(t.$$.ctx[n]))}function Ht(t){t&&t.c()}function Vt(t,e,r,n){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,r),n||wl(()=>{const a=t.$$.on_mount.map(T2).filter(kr);t.$$.on_destroy?t.$$.on_destroy.push(...a):Ur(a),t.$$.on_mount=[]}),o.forEach(wl)}function Nt(t,e){const r=t.$$;r.fragment!==null&&(function(n){const i=[],o=[];ec.forEach(a=>n.indexOf(a)===-1?i.push(a):o.push(a)),o.forEach(a=>a()),ec=i}(r.after_update),Ur(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function fr(t,e,r,n,i,o,a,s=[-1]){const l=cu;tu(t);const c=t.$$={fragment:null,ctx:[],props:o,update:qe,not_equal:i,bound:Pf(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Pf(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let u=!1;if(c.ctx=r?r(t,e.props||{},(d,p,...h)=>{const f=h.length?h[0]:p;return c.ctx&&i(c.ctx[d],c.ctx[d]=f)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](f),u&&function(g,$){g.$$.dirty[0]===-1&&(Zl.push(g),F2(),g.$$.dirty.fill(0)),g.$$.dirty[$/31|0]|=1<<$%31}(t,d)),p}):[],c.update(),u=!0,Ur(c.before_update),c.fragment=!!n&&n(c.ctx),e.target){if(e.hydrate){const d=function(p){return Array.from(p.childNodes)}(e.target);c.fragment&&c.fragment.l(d),d.forEach(J)}else c.fragment&&c.fragment.c();e.intro&&I(t.$$.fragment),Vt(t,e.target,e.anchor,e.customElement),A()}tu(l)}class gr{$destroy(){Nt(this,1),this.$destroy=qe}$on(e,r){if(!kr(r))return qe;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const i=n.indexOf(r);i!==-1&&n.splice(i,1)}}$set(e){var r;this.$$set&&(r=e,Object.keys(r).length!==0)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ul=[];function Yl(t,e){return{subscribe:ge(t,e).subscribe}}function ge(t,e=qe){let r;const n=new Set;function i(o){if(cr(t,o)&&(t=o,r)){const a=!Ul.length;for(const s of n)s[1](),Ul.push(s,t);if(a){for(let s=0;s<Ul.length;s+=2)Ul[s][0](Ul[s+1]);Ul.length=0}}}return{set:i,update:function(o){i(o(t))},subscribe:function(o,a=qe){const s=[o,a];return n.add(s),n.size===1&&(r=e(i)||qe),o(t),()=>{n.delete(s),n.size===0&&r&&(r(),r=null)}}}}function Hr(t,e,r){const n=!Array.isArray(t),i=n?[t]:t,o=e.length<2;return Yl(r,a=>{let s=!1;const l=[];let c=0,u=qe;const d=()=>{if(c)return;u();const h=e(n?l[0]:l,a);o?a(h):u=kr(h)?h:qe},p=i.map((h,f)=>Hi(h,g=>{l[f]=g,c&=~(1<<f),s&&d()},()=>{c|=1<<f}));return s=!0,d(),function(){Ur(p),u(),s=!1}})}var B2=t=>t.reduce((e,r)=>Object.assign(e,r),{});const Gl=t=>({updateValue:t}),Jo=t=>({defaultValue:t}),O2=t=>({store:t}),bd=t=>({store:(e,r)=>Hr(...t(r))}),xd=t=>({store:(e,r)=>{const[n,i,o=()=>!1]=t(r);let a,s=!0;return Hr(n,(l,c)=>{i(l,u=>{!s&&o(a,u)||(a=u,s=!1,c(u))})})}}),Vc=t=>({store:(e,r)=>{const[n,i={},o]=t(r);let a=[];const s={},l=h=>n(h,s),c=h=>{(a.length||h.length)&&(a=h,u())},u=()=>{const h=a.map(l);o&&h.sort(o),a=[...h],p(h)};Object.entries(i).map(([h,f])=>f.subscribe(g=>{s[h]=g,g&&u()}));const{subscribe:d,set:p}=ge(e||[]);return{set:c,update:h=>c(h(a)),subscribe:d}}});var zf=t=>{const e={},r={};return t.forEach(([n,...i])=>{const o=B2(i),a=e[n]=((l,c,u)=>{const{store:d=S=>ge(S),defaultValue:p=se,updateValue:h}=u,f=d(p(),c,l),{subscribe:g,update:$=se}=f;let b;const v=S=>{let P=!0;b&&b(),b=g(M=>{if(P)return P=!1;S(M),b(),b=void 0})},w=h?h(l):tn;return f.set=S=>$(P=>w(S,P,v)),f.defaultValue=p,f})(r,e,o),s={get:()=>Ea(a),set:a.set};Object.defineProperty(r,n,s)}),{stores:e,accessors:r}},Vv=[["src",O2(()=>{let t;const{subscribe:e,set:r}=ge(),n=i=>{t!==i&&(t=i,r(t))};return{set:n,subscribe:e,update:i=>n(i(t))}})],["imageReader"],["imageWriter"],["imageScrambler"],["imageRedactionRendering",Jo(()=>"pixelated")],["images",Jo(()=>[])],["shapePreprocessor"],["willRequestResource"],["willRequest"],["csp"]],W2=t=>t.charAt(0).toUpperCase()+t.slice(1),uu=(t,e)=>{Object.keys(e).forEach(r=>{const n=Vr(e[r])?{value:e[r],writable:!1}:e[r];Object.defineProperty(t,r,n)})};const Df=(t,e)=>{let r,n,i,o,a,s,l,c,u,d;const p=e.length;for(r=0;r<p;r++)if(n=e[r],i=e[r+1>p-1?0:r+1],o=n.x-t.x,a=n.y-t.y,s=i.x-t.x,l=i.y-t.y,c=o-s,u=a-l,d=c*a-u*o,d<-1e-5)return!1;return!0};var Bf=(t,e)=>{const r=Zy(e),n=dn();Oo(t).forEach(o=>{jn(o,n),Df(o,e)||r.forEach(a=>{const s=Math.atan2(a.start.y-a.end.y,a.start.x-a.end.x),l=1e4*Math.sin(Math.PI-s),c=1e4*Math.cos(Math.PI-s),u=lt(o.x+l,o.y+c),d=K1(Ny(a),1e4),p=J1(Gs(o,u),d);p&&jn(n,Un(He(p),o))})});const i=Fr(t);return jn(i,n),!!Oo(i).every(o=>Df(o,e))&&(cp(t,i),!0)},_2=(t,e)=>{const r=Oo(t),n=Xy(e,5),i=Lr(t),o=[];r.forEach(l=>{const c=((d,p)=>{const h=lt(d.start.x-d.end.x,d.start.y-d.end.y),f=yo(h),g=ji(f,p);return d.end.x+=g.x,d.end.y+=g.y,d})(Gs(He(i),He(l)),1e6);let u=!1;n.map(Ny).forEach(d=>{const p=J1(c,d);p&&!u&&(o.push(p),u=!0)})});const a=Ni(o[0],o[2])<Ni(o[1],o[3])?[o[0],o[2]]:[o[1],o[3]],s=ri(a);return s.width<t.width&&(cp(t,s),!0)},V2=(t,e,r={x:0,y:0})=>{const n=Ui(t),i=Lr(n),o=jy(n,r,i).map(s=>qi(s,e,i)),a=ri(o);return o.map(s=>Un(s,a))},ql=(t,e=0,r=$i(t))=>{let n,i;if(e!==0){const o=Math.atan2(1,r),a=Math.sign(e)*e,s=a%Math.PI,l=a%ea;let c;c=s>ua&&s<ea+ua?l>ua?a:ea-l:l>ua?ea-l:a;const u=Math.min(Math.abs(t.height/Math.sin(o+c)),Math.abs(t.width/Math.cos(o-c)));n=Math.cos(o)*u,i=n/r}else n=t.width,i=n/r,i>t.height&&(i=t.height,n=i*r);return An(n,i)},Nv=(t,e,r,n,i,o,a,s)=>{const l=so(a),c=so(s),u=mr(Math.max(e.width/c.width,e.height/c.height)),d=mr(Math.min(e.width/l.width,e.height/l.height)),p=Fr(e);if(d<1||u>1){const h=Lr(t),f=Lr(e),g=d<1?d:u,$=(f.x+h.x)/2,b=(f.y+h.y)/2,v=p.width/g,w=p.height/g;Hy(p,$-.5*v,b-.5*w,v,w)}return o?(((h,f,g=0,$=dn(),b)=>{if(_e(g)&&g!==0||$.x||$.y){const v=$i(h),w=V2(f,g,$),S=ql(f,g,v);if(!(h.width<S.width&&h.height<S.height)){const P=.5*h.width-.5*S.width,M=.5*h.height-.5*S.height;h.width>S.width&&(h.width=S.width,h.x+=P),h.height>S.height&&(h.height=S.height,h.y+=M)}Bf(h,w),_2(h,w)&&Bf(h,w)}else{const v=$i(h);h.width=Math.min(h.width,f.width),h.height=Math.min(h.height,f.height),h.x=Math.max(h.x,0),h.x+h.width>f.width&&(h.x-=h.x+h.width-f.width),h.y=Math.max(h.y,0),h.y+h.height>f.height&&(h.y-=h.y+h.height-f.height);const w=Lr(h),S=Ki(h,v);S.width=Math.max(b.width,S.width),S.height=Math.max(b.height,S.height),S.x=w.x-.5*S.width,S.y=w.y-.5*S.height,cp(h,S)}})(p,r,n,i,l),{crop:p}):{crop:p}},g0=(t,e,r)=>{const n=Ui(t),i=Lr(n),o=Ti(n,r,i),a=Lr(ou(ri(o))),s=Lr(e),l=qi(s,-r,a),c=Un(l,a),u=_o(jn(i,c),mr);return Wn(u.x-.5*e.width,u.y-.5*e.height,e.width,e.height)},an=(t,e,r)=>Math.max(e,Math.min(t,r));const Xh=["cropLimitToImage","cropMinSize","cropMaxSize","cropAspectRatio","flipX","flipY","rotation","crop","colorMatrix","convolutionMatrix","gamma","vignette","manipulation","redaction","annotation","decoration","selection","frame","backgroundColor","backgroundImage","backgroundFilterMode","targetSize","metadata","trim","volume","minDuration","maxDuration","currentTime"],F1=t=>En(t)?t.map(F1):r0(t)||fu(t)?t:bs(t)?{...t}:t,Nc=t=>t.map(e=>Object.entries(e).reduce((r,[n,i])=>(n.startsWith("_")||(r[n]=i),r),{})),Hv=(t,e)=>t===e;var ys=(t,e,r=Hv)=>{if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!r(t[n],e[n]))return!1;return!0};const Of=(t,e,r)=>{const n=_o(Lr(t),u=>mr(u,8)),i=Ui(e),o=Lr(i),a=Ti(i,r,o),s=_o(xl(ri(a)),u=>mr(u,8)),l=Math.abs(s.x-n.x),c=Math.abs(s.y-n.y);return l<1&&c<1},jv=(t,e,r,n,i)=>{if(!i)return[-1/0,1/0];const o=Math.max(r.width/n.width,r.height/n.height),a=An(n.width*o,n.height*o),s=(l=a,Math.sqrt(l.width*l.width+l.height*l.height));var l;if(s<Math.min(t.width,t.height))return[-1/0,1/0];const c=e?t.height:t.width,u=e?t.width:t.height,d=Math.acos(a.height/s),p=d-Math.acos(u/s),h=Math.asin(c/s)-d;if(Number.isNaN(p)&&Number.isNaN(h))return[-1/0,1/0];const f=Number.isNaN(p)?h:Number.isNaN(h)?p:Math.min(p,h);return[-f,f]},Xc=(t,e)=>{const{context:r,props:n}=e;return t._isFormatted||((t=h2(t))._isFormatted=!0,Object.assign(t,n)),t._isDraft||!up(t)||t._context&&pa(r,t._context)||($2(t,r),t._context={...r}),t},Uv=(t,e)=>(t._isFormatted||(t.disableMove=!0,t.disableSelect=!0,t.disableResize=!0,t.disableRotate=!0),Xc(t,e));var $0=[["file"],["size"],["loadState"],["processState"],["aspectRatio",bd(({size:t})=>[t,e=>e?$i(e):void 0])],["perspectiveX",Jo(()=>0)],["perspectiveY",Jo(()=>0)],["perspective",bd(({perspectiveX:t,perspectiveY:e})=>[[t,e],([r,n])=>({x:r,y:n})])],["rotation",Jo(()=>0),Gl(t=>(e,r,n)=>{if(e===r)return e;const{loadState:i,size:o,rotationRange:a,cropMinSize:s,cropMaxSize:l,crop:c,perspective:u,cropLimitToImage:d,cropOrigin:p}=t;if(!c||!i||!i.beforeComplete)return e;const h=d&&(($,b,v)=>{const w=ql(b,v,$i($));return iu(La(w,Math.round),La(so($),Math.round))})(c,o,r),f=d&&Of(c,o,r),g=(($,b,v,w,S,P,M,E,C,z)=>{const V=so(C),L=so(z);M&&(L.width=Math.min(z.width,S.width),L.height=Math.min(z.height,S.height));let y=!1;const ct=(N,nt)=>{const ft=g0(S,w,N),xt=Ui(S),H=Lr(xt),Z=jy(xt,P,H),wt=Un(He(H),tf(Z)),vt=qi(Lr(ft),nt,H),et=Un(He(H),vt);Z.forEach(X=>qi(X,nt,H));const Pt=ri(Z),Et=tf(Z),kt=jn(Un(Un(Et,et),Pt),wt),st=Wn(kt.x-.5*ft.width,kt.y-.5*ft.height,ft.width,ft.height);if(E&&Ei(st,E.width/st.width),M){const X=V2(S,nt,P);_2(st,X)}const Ut=mr(Math.min(st.width/V.width,st.height/V.height),8),rt=mr(Math.max(st.width/L.width,st.height/L.height),8);return(Ut<1||rt>1)&&mr(Math.abs(nt-N))===mr(Math.PI/2)&&!y?(y=!0,ct($,$+Math.sign(nt-N)*Math.PI)):{rotation:nt,crop:ta(st,X=>mr(X,8))}},j=Math.sign(b)*Math.round(Math.abs(b)/ea)*ea,k=an(b,j+v[0],j+v[1]);return ct($,k)})(r,e,a,c,o,u,d,p,s,l);if(h&&f){const $=ql(o,e,$i(g.crop));g.crop.x+=.5*g.crop.width,g.crop.y+=.5*g.crop.height,g.crop.x-=.5*$.width,g.crop.y-=.5*$.height,g.crop.width=$.width,g.crop.height=$.height}return n(()=>{t.crop=ta(g.crop,$=>mr($,8))}),g.rotation})],["flipX",Jo(()=>!1)],["flipY",Jo(()=>!1)],["flip",bd(({flipX:t,flipY:e})=>[[t,e],([r,n])=>({x:r,y:n})])],["isRotatedSideways",xd(({rotation:t})=>[[t],([e],r)=>r(Xa(e)),(e,r)=>e!==r])],["crop",Gl(t=>(e,r=e)=>{const{loadState:n,size:i,cropMinSize:o,cropMaxSize:a,cropLimitToImage:s,cropAspectRatio:l,rotation:c,perspective:u}=t;if(!e&&!r||!n||!n.beforeComplete)return e;e||(e=Ui(ql(i,c,l||$i(i))));const d=Nv(r,e,i,c,u,s,o,a),p=ta(d.crop,h=>mr(h,8));return pa(r,p)?r:p})],["cropAspectRatio",Gl(t=>(e,r)=>{const{loadState:n,crop:i,size:o,rotation:a,cropLimitToImage:s}=t,l=(u=>{if(u){if(/:/.test(u)){const[d,p]=u.split(":");return d/p}return parseFloat(u)}})(e);if(!l)return;if(!i||!n||!n.beforeComplete)return l;const c=r?Math.abs(e-r):1;if(Of(i,o,a)&&s&&c>=.1){const u=((d,p)=>{const h=d.width,f=d.height;return Xa(p)&&(d.width=f,d.height=h),d})(so(o),a);t.crop=ta(Ki(Ui(u),e),mr)}else{const u={width:i.height*l,height:i.height},d=.5*(i.width-u.width),p=.5*(i.height-u.height);t.crop=ta(Wn(i.x+d,i.y+p,u.width,u.height),mr)}return l})],["cropOrigin"],["cropMinSize",Jo(()=>({width:1,height:1}))],["cropMaxSize",Jo(()=>({width:32768,height:32768}))],["cropLimitToImage",Jo(()=>!0),Gl(t=>(e,r,n)=>{const{crop:i}=t;return i&&!r&&e&&n(()=>t.crop=Fr(t.crop)),e})],["cropSize",xd(({crop:t})=>[[t],([e],r)=>{e&&r(An(e.width,e.height))},(e,r)=>iu(e,r)])],["cropRectAspectRatio",bd(({cropSize:t})=>[[t],([e],r)=>{e&&r(mr($i(e),5))}])],["cropRange",xd(({size:t,rotation:e,cropRectAspectRatio:r,cropMinSize:n,cropMaxSize:i,cropLimitToImage:o})=>[[t,e,r,n,i,o],([a,s,l,c,u,d],p)=>{a&&p(((h,f,g,$,b,v)=>{const w=so($),S=so(b);return v?[w,La(ql(h,f,g),Math.round)]:[w,S]})(a,s,l,c,u,d))},(a,s)=>ys(a,s)])],["rotationRange",xd(({size:t,isRotatedSideways:e,cropMinSize:r,cropSize:n,cropLimitToImage:i})=>[[t,e,r,n,i],([o,a,s,l,c],u)=>{!o||!l||u(jv(o,a,s,l,c))},(o,a)=>ys(o,a)])],["backgroundColor",Gl(()=>t=>((e=[0,0,0,0],r=1)=>e.length===4?e:[...e,r])(t))],["backgroundImage"],["backgroundFilterMode"],["targetSize"],["colorMatrix"],["convolutionMatrix"],["gamma"],["noise"],["vignette"],["duration"],["currentTime"],["minDuration",Jo(()=>1/24)],["maxDuration",Jo(()=>1/0)],["volume",Jo(()=>1)],["trim"],["redaction",Vc(({size:t})=>[Xc,{context:t}])],["manipulation",Vc(({size:t})=>[Xc,{context:t}])],["annotation",Vc(({size:t})=>[Xc,{context:t}])],["decoration",Vc(({crop:t})=>[Xc,{context:t}])],["selection",Vc(({size:t})=>[Uv,{context:t}])],["frame",Gl(()=>t=>{if(!t)return;const e={frameStyle:void 0,x:0,y:0,width:"100%",height:"100%",disableStyle:["backgroundColor","strokeColor","strokeWidth"]};return Ge(t)?e.frameStyle=t:Object.assign(e,t),e})],["metadata"],["state",O2((t,e,r)=>{const n=Xh.map(l=>e[l]);let i=!1;const o=ge({}),{subscribe:a}=Hr([...n,o],(l,c)=>{if(i)return;const u=Xh.reduce((d,p,h)=>(d[p]=F1(l[h]),d),{});u.crop&&ta(u.crop,Math.round),u.manipulation=u.manipulation&&Nc(u.manipulation),u.redaction=u.redaction&&Nc(u.redaction),u.annotation=u.annotation&&Nc(u.annotation),u.decoration=u.decoration&&Nc(u.decoration),u.selection=u.selection&&Nc(u.selection),c(u)}),s=l=>{l&&(i=!0,r.cropOrigin=void 0,Xh.filter(c=>Te(l,c)).forEach(c=>{const u=l[c];r[c]=u===null?void 0:F1(u)}),i=!1,o.set({}))};return{set:s,update:l=>s(l(null)),subscribe:a}})]],Wf=async(t,e,r={},n)=>{const{ontaskstart:i,ontaskprogress:o,ontaskend:a,token:s}=n;let l=!1;const c={cancel:se};s.cancel=()=>{l=!0,c.cancel()};for(const[u,d]of e.entries()){if(l)return;const[p,h]=d;i(u,h);try{t=await p(t,{...r,taskCancelToken:c},f=>o(u,h,f))}catch(f){throw l=!0,f}a(u,h)}return t};const N2=t=>console.warn(`Pintura: ${t} is a required prop.`),H2=["loadstart","loadabort","loaderror","loadprogress","load","processstart","processabort","processerror","processprogress","process"],Gv=["flip","cropOrigin","isRotatedSideways","perspective","perspectiveX","perspectiveY","cropRange"],Zv=$0.map(([t])=>t).filter(t=>!Gv.includes(t)),Yh=t=>"image"+W2(t),_f=t=>Te(t,"crop");var j2=()=>{const{stores:t,accessors:e}=zf(Vv),{sub:r,pub:n}=Ka(),i=()=>e.images?e.images[0]:{};let o={};const a={};Zv.forEach($=>{Object.defineProperty(e,Yh($),{get:()=>{const b=i();if(b)return b.accessors[$]},set:b=>{o[Yh($)]=b,a[Yh($)]=b;const v=i();v&&(v.accessors[$]=b)}})});const s=()=>e.images&&e.images[0];let l;const c=t.src.subscribe($=>{if(!$)return e.images=[];e.imageReader?(e.images.length&&(o={}),d($)):l=setTimeout(()=>N2("imageReader"),32)}),u=t.imageReader.subscribe($=>{$&&(clearTimeout(l),e.images.length||e.src&&d(e.src))}),d=$=>{Promise.resolve().then(()=>h($,o)).catch(()=>{})};let p;const h=($,b={})=>new Promise((v,w)=>{let S=s();const P=!(b.cropLimitToImage===!1||b.imageCropLimitToImage===!1||a.imageCropLmitedToImage===!1),M=b.cropMinSize||b.imageCropMinSize||a.imageCropMinSize,E=P?M:S&&S.accessors.cropMinSize,C=b.minDuration||b.imageMinDuration;S&&g(),S=(({minSize:L={width:1,height:1},minDuration:y=0}={})=>{const{stores:ct,accessors:j}=zf($0),{pub:k,sub:N}=Ka(),nt=(ft,xt)=>{const H=()=>j[ft]||{},Z=et=>{j[ft]={...H(),...et,timeStamp:Date.now()}},wt=()=>H().error,vt=et=>{wt()||(Z({error:et}),k(xt+"error",{...H()}))};return{start(){k(xt+"start")},onabort(){Z({abort:!0}),k(xt+"abort",{...H()})},ontaskstart(et,Pt){wt()||(Z({index:et,task:Pt,taskProgress:void 0,taskLengthComputable:void 0}),k(xt+"taskstart",{...H()}))},ontaskprogress(et,Pt,Et){wt()||(Z({index:et,task:Pt,taskProgress:Et.loaded/Et.total,taskLengthComputable:Et.lengthComputable}),k(xt+"taskprogress",{...H()}),k(xt+"progress",{...H()}))},ontaskend(et,Pt){wt()||(Z({index:et,task:Pt}),k(xt+"taskend",{...H()}))},ontaskerror(et){vt(et)},error(et){vt(et)},beforeComplete(et){wt()||(Z({beforeComplete:!0}),k("before"+xt,et))},complete(et){wt()||(Z({complete:!0}),k(xt,et))}}};return uu(j,{read:(ft,{reader:xt},H={})=>{if(!xt)return;Object.assign(j,{file:void 0,size:void 0,loadState:void 0});let Z={cancel:se},wt=!1;const vt=nt("loadState","load"),et={token:Z,...vt},Pt={src:ft,size:void 0,dest:void 0,duration:void 0};return Promise.resolve().then(async()=>{try{if(vt.start(),wt)return vt.onabort();const Et=await Wf(Pt,xt,H,et);if(wt)return vt.onabort();const{size:kt,duration:st,dest:Ut}=Et||{};if(!kt||!kt.width||!kt.height)throw new Qc("Image size missing","IMAGE_SIZE_MISSING",Et);if(st>0&&st<y)throw new Qc("Video too short","VIDEO_TOO_SHORT",{...Et,minDuration:y});if(kt.width<L.width||kt.height<L.height)throw new Qc("Image too small","IMAGE_TOO_SMALL",{...Et,minWidth:L.width,minHeight:L.height});Object.assign(j,{file:Ut,size:kt,duration:st}),vt.beforeComplete(Et),vt.complete(Et)}catch(Et){vt.error(Et)}finally{Z=void 0}}),()=>{wt=!0,Z&&Z.cancel(),vt.onabort()}},write:(ft,xt)=>{if(!j.loadState.complete)return;j.processState=void 0;const H=nt("processState","process"),Z={src:j.file,imageState:j.state,dest:void 0};if(Vr(ft)&&(ft=ft(j.file,j.state)),!ft)return H.start(),void H.complete(Z);let wt={cancel:se},vt=!1;const et=xt,Pt={token:wt,...H};return Promise.resolve().then(async()=>{try{if(H.start(),vt)return H.onabort();const Et=await Wf(Z,ft,et,Pt);if(vt)return H.onabort();H.complete(Et)}catch(Et){H.error(Et)}finally{wt=void 0}}),()=>{vt=!0,wt&&wt.cancel(),H.onabort()}},on:N}),{accessors:j,stores:ct}})({minSize:E,minDuration:C}),H2.map(L=>{return S.accessors.on(L,(y=L,ct=>n(y,ct)));var y});const z=()=>{o={},V.forEach(L=>L())},V=[];V.push(S.accessors.on("loaderror",L=>{z(),w(L)})),V.push(S.accessors.on("loadabort",()=>{z(),w({name:"AbortError"})})),V.push(S.accessors.on("load",L=>{p=void 0,z(),v(L)})),V.push(S.accessors.on("beforeload",()=>((L,y)=>{if(_f(y))return void(e.imageState=y);if(!y.imageCrop){const k=L.accessors.size,N=y.imageRotation||0,nt=Vy(so(k),N),ft=Ui(nt);ft.width=mr(Math.abs(ft.width),6),ft.height=mr(Math.abs(ft.height),6);const xt=y.imageCropAspectRatio||(y.imageCropLimitToImage?$i(k):$i(ft));let H;y.imageCropLimitToImage?H=Ki(ft,xt):(H=Zs(ft,xt),H.x=(k.width-H.width)/2,H.y=(k.height-H.height)/2),y.imageCrop=H}if(L.accessors.duration&&!y.imageTrim&&y.imageMaxDuration){const{duration:k}=L.accessors;y.imageTrim=[[0,Math.min(y.imageMaxDuration/k,1)]]}const ct=["imageCropLimitToImage","imageCrop","imageCropAspectRatio","imageRotation"];ct.filter(k=>Te(y,k)).forEach(k=>{e[k]=y[k],delete y[k]});const j=Object.keys(y).filter(k=>!ct.includes(k)).reduce((k,N)=>(k[N]=y[N],k),{});Object.assign(e,j)})(S,b))),e.images=[S],b.imageReader&&(e.imageReader=b.imageReader),b.imageWriter&&(e.imageWriter=b.imageWriter),p=S.accessors.read($,{reader:e.imageReader},{willRequest:e.willRequest})});let f;const g=()=>{const $=s();$&&(p&&p(),$.accessors.loadState=void 0,e.images=[])};return Object.defineProperty(e,"stores",{get:()=>t}),uu(e,{on:r,loadImage:h,abortLoadImage:()=>{p&&p(),e.images=[]},editImage:($,b)=>new Promise((v,w)=>{h($,b).then(()=>{const{images:S}=e,P=S[0],M=()=>{E(),C()},E=P.accessors.on("processerror",z=>{M(),w(z)}),C=P.accessors.on("process",z=>{M(),v(z)})}).catch(w)}),removeImage:g,processImage:($,b)=>new Promise((v,w)=>{try{const S=[],P=()=>{S.forEach(M=>M())};(async()=>{if((E=>Ge(E)||ic(E)||nc(E))($))try{await h($,b)}catch(E){w(E)}else $&&(_f($)?e.imageState=$:Object.assign(e,$));const M=s();if(!M)return w("no image");S.push(M.accessors.on("processerror",E=>{P(),w(E)})),S.push(M.accessors.on("processabort",()=>{P(),w({name:"AbortError"})})),S.push(M.accessors.on("process",E=>{f=void 0,P(),v(E)})),f=M.accessors.write(e.imageWriter,{redactionRenderStyle:e.imageRedactionRendering,shapePreprocessor:e.shapePreprocessor||tn,imageScrambler:e.imageScrambler,willRequest:e.willRequest,csp:e.csp||{},willRequestResource:e.willRequestResource})})()}catch(S){w(S)}}),abortProcessImage:()=>{const $=s();$&&(f&&f(),$.accessors.processState=void 0)},destroy:()=>{c&&c(),u&&u()}}),e};const U2=(t,e)=>{const{processImage:r}=j2();return r(t,e)};var G2=()=>Fa()?Vo()?/15_|16_/.test(navigator.userAgent)?14745600:16777216:/15_/.test(navigator.userAgent)?16777216:1/0:1/0,Z2=(t,e)=>Object.keys(t).filter(r=>!e.includes(r)).reduce((r,n)=>(r[n]=t[n],r),{}),X2=t=>new Promise(e=>{if(t.duration===1/0)return t.ontimeupdate=()=>{t.ontimeupdate=void 0,e(t)},void(t.currentTime=Number.MAX_SAFE_INTEGER);e(t)});const Xv=t=>new Promise(e=>{const r=new FileReader;r.onload=()=>e(r.result),r.readAsArrayBuffer(t)}),qh=(t,e=0,r=t.byteLength)=>{const n=[],i=e+r;for(;e<i;){const o=t.getUint32(e);if(o<0)break;const a=t.getUint32(e+4);if(n.push({type:a,size:o,offset:e,bodyOffset:e+8,bodySize:o-8}),o<8)break;e+=o}return n},Yv=(t,{limit:e=1024}={})=>{let r=0;if(r+=4,t.getUint32(r)!==1718909296)return 0;r+=4;const n=t.getUint32(r);return n===1836069938?((i,o,a)=>{let s=!1,l=-1;for(let h=o;h<a;h++)if(s||i.getUint32(h)!==1953653099||(s=!0,h+=4),s&&i.getUint8(h)==64){l=h;break}if(l<0)return 0;const c=i.getUint32(l-28),u=i.getUint32(l-20),d=i.getUint32(l-32),p=i.getUint32(l-16);return c===65536&&u===4294901760?90:d===4294901760&&p===4294901760?180:c===4294901760&&u===65536?270:0})(t,r,e):n===1903435808?(i=>{const o=qh(i).find(c=>c.type===1836019574);if(!o)return 0;const a=qh(i,o.bodyOffset,o.bodySize);a.filter(c=>c.type===1953653099).forEach(c=>{a.push(...qh(i,c.bodyOffset,c.bodySize))});const s=[1836476516,1953196132],l=a.filter(c=>s.includes(c.type));for(const{type:c,bodyOffset:u}of l){const d=i.getUint8(u);let p=u+4;p+=c===1836476516?32:36,p+=d===1?12:0;const h=i.getInt32(p),f=i.getInt32(p+4);if(h===0&&f>0)return 90;if(h<0&&f===0)return 180;if(h===0&&f<0)return 270}return 0})(t):0};var Y2=t=>new Promise((e,r)=>{(Aa()?(async n=>{const i=await Xv(n),o=new DataView(i);return Yv(o)})(t):Promise.resolve(0)).then(n=>{const i=document.createElement("video");i.onerror=()=>r(i.error),i.playsInline=!0,i.preload="auto",i.onseeked=()=>{i.onseeked=void 0,e(i)},i.onloadeddata=()=>{i.onloadeddata=void 0,i.dataset.rotation=n?""+n:"0",X2(i).then(e),i.currentTime=0},Vo()&&Fa()?(i.srcObject=t,i.load()):i.src=URL.createObjectURL(t)})}),q2=(t,e)=>new Promise(r=>{if(t.currentTime===e)return r(t);let n=t.onseeked;t.onseeked=()=>{t.onseeked=n,r(t)},t.currentTime=an(e,0,t.duration)}),K2=(t,e=0)=>new Promise((r,n)=>{Y2(t).then(i=>{q2(i,e).then(o=>{const a=yn("canvas");Jy(o).then(({width:s,height:l})=>{a.width=s,a.height=l;const c=a.getContext("2d",{willReadFrequently:!0}),u=()=>{c.drawImage(o,0,0,a.width,a.height);const d=c.getImageData(0,0,a.width,a.height);ti(a),URL.revokeObjectURL(o.src),r(d)};Fa()?setTimeout(u,16):u()})})})}),Xs=t=>/video/.test(t.type);let Kh=null;const y0=({imageDataResizer:t,canvasMemoryLimit:e}={})=>async(r,n,i,o,a)=>{i.width=Math.max(i.width,1),i.height=Math.max(i.height,1),o.width=Math.max(o.width,1),o.height=Math.max(o.height,1);const{dest:s}=await U2(n,{imageReader:nb(),imageWriter:b0({format:"canvas",targetSize:{...o,upscale:!0},imageDataResizer:t,canvasMemoryLimit:e}),imageCrop:i}),{feather:l=0}=a||{};if(l>0){const c=yn("canvas");c.width=s.width,c.height=s.height;const u=c.getContext("2d",{willReadFrequently:!0}),d=1/l;let p=0;for(p=0;p<l;p++){const f=p*d;u.strokeStyle=`rgba(0,0,0,${f*f})`,u.strokeRect(p+.5,p+.5,s.width-2*p-1,s.height-2*p-1)}u.fillStyle="#000",u.fillRect(p,p,s.width+.5-2*p,s.height+.5-2*p);const h=s.getContext("2d");h.globalCompositeOperation="destination-in",h.drawImage(c,0,0),ti(c)}r.drawImage(s,o.x,o.y,o.width,o.height),ti(s)},zn=(t,e=(...n)=>n,r)=>async(n,i,o)=>{o(Xl(0,!1));let a=!1;const s=await t(...e(n,i,l=>{a=!0,o(l)}));return r&&r(n,s),a||o(Xl(1,!1)),n},qv=({willRequest:t,srcProp:e="src",destProp:r="dest"}={})=>[zn(Qx,(n,i,o)=>[n[e],o,{...i,willRequest:t}],(n,i)=>n[r]=i),"any-to-file"],Kv=({srcProp:t="dest",destProp:e="dest"}={})=>[zn(async r=>{if(/octet-stream/.test(r.type)){console.warn(`Pintura: File has unknown mime type "${r.type}", make sure your server sets the correct Content-Type header.`);let n="image";const i=await e0(r);/video/i.test(i.nodeName)&&(n="video");const o={type:n+"/unknown"};return fu(r)?new File([r],r.name,{...o,lastModified:r.lastModified}):new Blob([r],o)}return r},r=>[r[t]],(r,n)=>r[e]=n),"guard-mimetype"],J2=({srcProp:t="src",destProp:e="size"}={})=>[zn(Qy,r=>[r[t]],(r,n)=>r[e]=n),"read-image-size"],Jv=async t=>{const e=await e0(t);if(au(e))return await(r=>new Promise((n,i)=>{const o=()=>{X2(r).then(()=>{n(r.duration)})};if(r.readyState>=1)return o();r.onloadedmetadata=o,r.onerror=()=>i(r.error)}))(e)},Qv=({srcProp:t="src",destProp:e="duration"}={})=>[zn(Jv,r=>[r[t]],(r,n)=>r[e]=n),"read-media-duration"],Q2=({srcSize:t="size",srcOrientation:e="orientation",destSize:r="size"}={})=>[zn(tv,n=>[n[t],n[e]],(n,i)=>n[r]=i),"image-size-match-orientation"],tb=({srcProp:t="src",destProp:e="copy"}={})=>[zn((r,n)=>r2(r)?X1(r,n):void 0,r=>[r[t],onprogress],(r,n)=>{n&&(r[e]=n)}),"read-image-head"],eb=({srcProp:t="copy",orientationProp:e="orientation",colorSpaceProp:r="colorSpace"}={})=>[zn((n,i)=>{if(n)return Ry(n,i)},n=>[n[t],{exif:[274],app2:[b1]}],(n,i)=>{i&&(n[e]=i.exif&&i.exif[274]||1,n[r]=(i.app2&&i.app2[b1]||"sRGB").toLowerCase())}),"read-image-head-tags"],t5=({srcProp:t="copy"}={})=>[zn((e,r)=>{if(e)return((n,i)=>{const o=Py(n);o&&Object.entries(i).forEach(([a,s])=>{if(!o[a])return;const l=o[a].getTags();l&&s.forEach(([c,u])=>{l.write(c,u)})})})(e,r)},e=>[e[t],{exif:[[274,1]]}]),"clear-exif-orientation-tag"],e5=({srcImageSize:t="size",srcCanvasSize:e="imageData",srcImageState:r="imageState",destImageSize:n="size",destScalar:i="scalar"}={})=>[zn((o,a)=>[Math.min(a.width/o.width,a.height/o.height),ts(a)],o=>[o[t],o[e],o[r]],(o,[a,s])=>{o[i]=a,o[n]=s}),"calculate-canvas-scalar"],r5=({srcProp:t="src",destProp:e="imageData",canvasMemoryLimit:r,colorSpaceProp:n="colorSpace",srcImageState:i="imageState"}={})=>[zn((o,a,s,l)=>Xs(o)?K2(o,l.currentTime):By(o,{canvasMemoryLimit:a,colorSpace:s}),o=>[o[t],r,o[n],o[i]],(o,a)=>o[e]=a),"blob-to-image-data"],n5=({srcImageData:t="imageData",srcOrientation:e="orientation"}={})=>[zn(Ay,r=>[r[t],r[e]],(r,n)=>r.imageData=n),"image-data-match-orientation"],i5=({srcImageData:t="imageData",srcImageState:e="imageState"}={})=>[zn(Ev,r=>{const{colorMatrix:n}=r[e],i=n&&Object.keys(n).map(o=>n[o]).filter(Boolean);return[r[t],{backgroundColor:r[e].backgroundColor,backgroundImage:r[e].backgroundImage,backgroundFilterMode:r[e].backgroundFilterMode,colorMatrix:i&&$u(i),convolutionMatrix:r[e].convolutionMatrix,gamma:r[e].gamma,noise:r[e].noise,vignette:r[e].vignette}]},(r,n)=>r.imageData=n),"image-data-fill"],o5=({srcImageData:t="imageData",srcImageState:e="imageState",destScalar:r="scalar"}={})=>[zn(rv,n=>{const i=n[r];let{crop:o}=n[e];return o&&i!==1&&(o=Ei(Fr(o),i,dn())),[n[t],{crop:o,rotation:n[e].rotation,flipX:n[e].flipX,flipY:n[e].flipY}]},(n,i)=>n.imageData=i),"image-data-crop"],a5=({targetSize:t={width:void 0,height:void 0,fit:void 0,upscale:void 0},imageDataResizer:e,srcProp:r="imageData",srcImageState:n="imageState",destImageScaledSize:i="imageScaledSize"})=>[zn(iv,o=>{const a=Math.min(t.width||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.width||Number.MAX_SAFE_INTEGER),s=Math.min(t.height||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.height||Number.MAX_SAFE_INTEGER);return[o[r],{width:a,height:s,fit:t.fit||"contain",upscale:(l=o[n],!!(l.targetSize&&l.targetSize.width||l.targetSize&&l.targetSize.height)||t.upscale||!1)},e];var l},(o,a)=>{iu(o.imageData,a)||(o[i]=ts(a)),o.imageData=a}),"image-data-resize"],s5=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:r="imageData"}={})=>[zn(o2,n=>{const{colorMatrix:i}=n[e],o=i&&Object.keys(i).map(a=>i[a]).filter(Boolean);return[n[t],{colorMatrix:o&&$u(o),convolutionMatrix:n[e].convolutionMatrix,gamma:n[e].gamma,noise:n[e].noise,vignette:n[e].vignette}]},(n,i)=>n[r]=i),"image-data-filter"],l5=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:r="imageData",destScalar:n="scalar"}={})=>[zn(async(i,o,a,s,l,c)=>{if(!o||!s.length)return i;let u;try{const g={dataSizeScalar:S2(i,s)};a&&a[3]>0&&(g.backgroundColor=[...a]),u=await o(i,g)}catch{}const d=yn("canvas");d.width=i.width,d.height=i.height;const p=d.getContext("2d",{willReadFrequently:!0,colorSpace:i.colorSpace});if(p.putImageData(i,0,0),c==="auto"){const g=Math.sqrt(i.width*i.height);p.filter=`blur(${Math.round(g/100)}px)`}const h=new Path2D;s.forEach(g=>{const $=Wn(g.x,g.y,g.width,g.height);yl($,l);const b=Ti(Fr($),g.rotation),v=new Path2D;b.forEach((w,S)=>{if(S===0)return v.moveTo(w.x,w.y);v.lineTo(w.x,w.y)}),h.addPath(v)}),p.clip(h,"nonzero"),p.imageSmoothingEnabled=!1,p.drawImage(u,0,0,d.width,d.height),ti(u);const f=p.getImageData(0,0,d.width,d.height);return ti(d),f},(i,{imageScrambler:o,redactionRenderStyle:a})=>[i[t],o,i[e].backgroundColor,i[e].redaction,i[n],a],(i,o)=>i[r]=o),"image-data-redact"],Jh=({srcImageData:t="imageData",srcSize:e="size",srcImageState:r="imageState",srcShapes:n="annotation",destImageData:i="imageData",destImageScaledSize:o="imageScaledSize",destScalar:a="scalar",imageDataResizer:s,canvasMemoryLimit:l,shapeFilter:c=tn,shapeClip:u=!0,destImageContext:d="imageContext"}={})=>[zn(d0,(p,{shapePreprocessor:h,willRequestResource:f,csp:g,willRequest:$})=>{const b=p[r][n].filter(c);if(!b.length)return[p[t]];const v=p[a],{crop:w}=p[r],S=p[e];let P=v;const M=p[o];M&&(P=Math.min(M.width/w.width,M.height/w.height));const E={width:S.width/v,height:S.height/v};return[p[t],{shapes:b,computeShape:C=>(C=On(C,E),C=Z2(C,["left","right","top","bottom"]),C=y2(C,P)),transform:C=>{const z=p[e],{rotation:V=0,flipX:L,flipY:y,cropLimitToImage:ct}=p[r],{crop:j=Ui(z)}=p[r];let k=1;k=p[o]?P:v;const N={width:z.width/v*k,height:z.height/v*k},nt=qy(N,V),ft=nt.width,xt=nt.height,H=.5*N.width-.5*ft,Z=.5*N.height-.5*xt,wt=xl(N);C.translate(-H,-Z),C.translate(-j.x*k,-j.y*k),C.translate(wt.x,wt.y),C.rotate(V),C.translate(-wt.x,-wt.y);const vt=p[d]||{x:0,y:0};C.translate(vt.x,vt.y),C.scale(L?-1:1,y?-1:1),C.translate(L?-N.width*v:0,y?-N.height*v:0),ct&&u&&(C.rect(0,0,N.width,N.height),C.clip())},drawImage:y0({imageDataResizer:s,canvasMemoryLimit:l}),preprocessShape:C=>h(C,{isPreview:!1,...p[r]}),canvasMemoryLimit:l,willRequest:$||f,styleNonce:g.styleNonce}]},(p,h)=>p[i]=h),"image-data-annotate"],Vf=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:r="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:i,canvasMemoryLimit:o,destScalar:a="scalar",shapeFilter:s=tn,destImageContext:l="imageContext"}={})=>[zn(d0,(c,{shapePreprocessor:u,willRequestResource:d,willRequest:p,csp:h})=>{let f=c[e].decoration.filter(s);if(typeof window<"u"&&(v=>{if(v&&v._zb8to4f)return;const[w]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101,32]].map(E=>E.map(C=>String.fromCharCode(C)).join("")),{width:S,height:P}=c[e].crop,M=P/15;f=[...f,{x:.5*-M,y:.5*-M,width:1.5*S,height:1.25*P,text:Array(50).fill(w).join(""),fontWeight:900,lineHeight:M,fontSize:M,color:[1,1,1,.05]}]})(window),!f.length)return[c[t]];let g=c[a];const{crop:$}=c[e],b=c[n];return b&&(g=Math.min(b.width/$.width,b.height/$.height)),[c[t],{shapes:f,drawImage:y0({imageDataResizer:i,canvasMemoryLimit:o}),computeShape:v=>(v=On(v,$),v=Z2(v,["left","right","top","bottom"]),v=y2(v,g)),preprocessShape:v=>u(v,{isPreview:!1,...c[e]}),canvasMemoryLimit:o,willRequest:p||d,styleNonce:h.styleNonce,transform:v=>{const w=c[l]||{x:0,y:0};v.translate(w.x,w.y)}}]},(c,u)=>c[r]=u),"image-data-decorate"],c5=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:r="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:i,canvasMemoryLimit:o,destScalar:a="scalar",destImageContext:s="imageContext"}={})=>[zn((l,c)=>new Promise(u=>{if(!c)return u([l]);d0(l,c).then(d=>{u([d,c.contextBounds])})}),(l,{shapePreprocessor:c,willRequestResource:u,willRequest:d,csp:p})=>{const h=l[e].frame;if(!h)return[l[t]];const f=l[a];let{crop:g}=l[e];g&&f!==1&&(g=Ei(Fr(g),f,dn()));const $={...g},b=f2(g2(h,$,c),$);$.x=Math.abs(b.left),$.y=Math.abs(b.top),$.width+=Math.abs(b.left)+Math.abs(b.right),$.height+=Math.abs(b.top)+Math.abs(b.bottom);const v=l[n],w=v?v.width/g.width:1,S=v?v.height/g.height:1;return $.x*=w,$.y*=S,$.width*=w,$.height*=S,$.x=Math.round($.x),$.y=Math.round($.y),$.width=Math.round($.width),$.height=Math.round($.height),v&&(Math.abs($.width-v.width)<=1&&($.width=v.width),Math.abs($.height-v.height)<=1&&($.height=v.height)),[l[t],{shapes:[h],contextBounds:$,computeShape:P=>On(P,l[t]),transform:P=>{P.translate($.x,$.y)},drawImage:y0({imageDataResizer:i,canvasMemoryLimit:o}),preprocessShape:P=>c(P,{isPreview:!1,...l[e]}),canvasMemoryLimit:o,willRequest:d||u,styleNonce:p.styleNonce}]},(l,[c,u])=>{l[s]=u,l[r]=c}),"image-data-frame"],u5=({mimeType:t,quality:e,srcImageData:r="imageData",srcFile:n="src",destBlob:i="blob"}={})=>[zn(_x,o=>[o[r],t||q1(o[n].name)||o[n].type,e],(o,a)=>o[i]=a),"image-data-to-blob"],d5=({srcImageData:t="imageData",srcOrientation:e="orientation",destCanvas:r="dest"}={})=>[zn(Sl,n=>[n[t],n[e]],(n,i)=>n[r]=i),"image-data-to-canvas"],p5=async(t,e,r)=>{if(!r2(t)||!e)return t;const n=/p3/i.test(r),i=(l,c)=>{let u=2;const d=new DataView(l),p=d.byteLength;for(c(d.getUint8(0),0,2,p);u<p&&d.getUint8(u)==255;){const h=d.getUint8(u+1),f=d.getUint16(u+2)+2;if(c(h,u,f,p)===!1)break;u+=f}},o=l=>l>=224&&l<=237,a=(l=>{const c=[];return i(l,(u,d,p)=>{if(u===218)return!1;if(o(u)){if(u===226&&(!n||(Kh===null&&(Kh=new ImageData(1,1).colorSpace!==void 0),!Kh)))return!1;c.push(new Uint8Array(l,d,p))}}),c})(e),s=((l,c)=>{const u=[];i(l,(f,g,$,b)=>g===0?(u.push(new Uint8Array(l,g,$)),void u.push(...c)):f===218?(u.push(new Uint8Array(l,g,b-g)),!1):void(o(f)||u.push(new Uint8Array(l,g,$))));let d=u.reduce((f,g)=>f+g.length,0),p=new Uint8Array(d),h=0;return u.forEach(f=>{p.set(f,h),h+=f.length}),p})(await X1(t),a);return new Blob([s],{type:"image/jpeg"})},h5=(t="blob",e="copy",r="colorSpace",n="blob")=>[zn((i,o,a)=>{if(o)return p5(i,o,a)},i=>[i[t],i[e],i[r]],(i,o)=>{o&&(i[n]=o)}),"blob-write-image-head"],m5=({renameFile:t,srcBlob:e="blob",srcFile:r="src",destFile:n="dest",defaultFilename:i}={})=>[zn(ru,o=>[o[e],t?t(o[r]):o[r].name||`${i}.${Oy(o[e].type)}`],(o,a)=>o[n]=a),"blob-to-file"],Nf=({url:t="./",dataset:e=o=>[["dest",o.dest,o.dest.name],["imageState",o.imageState]],destStore:r="store",credentials:n,headers:i={}})=>[zn(async(o,a)=>await((s,l,c)=>new Promise((u,d)=>{const{token:p={},beforeSend:h=se,onprogress:f=se}=c;p.cancel=()=>g.abort();const g=new XMLHttpRequest;g.upload.onprogress=f,g.onload=()=>g.status>=200&&g.status<300?u(g):d(g),g.onerror=()=>d(g),g.ontimeout=()=>d(g),g.open("POST",encodeURI(s)),h(g),g.send(l instanceof FormData?l:l.reduce(($,b)=>($.append(...b.map(ev)),$),new FormData))}))(t,o,{onprogress:a,beforeSend:s=>t2(s,{headers:i,credentials:n})}),(o,a,s)=>[e(o),s],(o,a)=>o[r]=a),"store"],rb=t=>[zn(e=>(t&&t.length&&Object.keys(e).forEach(r=>{t.includes(r)||delete e[r]}),e)),"prop-filter"],nb=(t={})=>{const{orientImage:e=!0,outputProps:r=["src","dest","size","duration"],preprocessImageFile:n,request:i={}}=t;return[qv({willRequest:()=>i}),Kv(),n&&[zn(n,(o,a,s)=>[o.dest,a,s],(o,a)=>o.dest=a),"preprocess-image-file"],J2({srcProp:"dest"}),Qv({srcProp:"dest"}),e&&tb({srcProp:"dest"}),e&&eb(),e&&Q2(),rb(r)].filter(Boolean)},f5=t=>t&&(Ge(t)?Nf({url:t}):Vr(t)?[t,"store"]:Nf(t)),b0=(t={})=>(e,r,n={})=>{let{canvasMemoryLimit:i=G2(),orientImage:o=!0,copyImageHead:a=!0,mimeType:s,quality:l,renameFile:c,targetSize:u,imageDataResizer:d,store:p,format:h="file",outputProps:f=["src","dest","imageState","store"],preprocessImageSource:g,preprocessImageState:$,postprocessImageData:b,postprocessImageBlob:v,testSrcSupport:w=!1}={...t,...n};if(!w||gu(e))return h==="blob"&&(h="file"),[g&&[zn(g,(S,P,M)=>[S.src,P,M,S.imageState],(S,P)=>S.src=P),"preprocess-image-source"],(o||a)&&tb(),eb(),J2(),$&&[zn($,(S,P,M,E)=>[S.imageState,P,M,{size:S.size,orientation:S.orientation}],(S,P)=>S.imageState=P),"preprocess-image-state"],r5({canvasMemoryLimit:i}),o&&Q2(),o&&n5(),e5(),l5(),o5(),a5({imageDataResizer:d,targetSize:u}),Jh({imageDataResizer:d,canvasMemoryLimit:i,srcShapes:"manipulation"}),s5(),i5(),Jh({imageDataResizer:d,canvasMemoryLimit:i,srcShapes:"annotation",shapeFilter:S=>!S.aboveFrame}),Vf({imageDataResizer:d,canvasMemoryLimit:i,shapeFilter:S=>!S.aboveFrame}),c5({imageDataResizer:d,canvasMemoryLimit:i}),Jh({imageDataResizer:d,canvasMemoryLimit:i,srcShapes:"annotation",shapeFilter:S=>S.aboveFrame,shapeClip:!1}),Vf({imageDataResizer:d,canvasMemoryLimit:i,shapeFilter:S=>S.aboveFrame}),b&&[zn(b,(S,P,M)=>[S.imageData,P,M],(S,P)=>S.imageData=P),"postprocess-image-data"],h==="file"?u5({mimeType:s,quality:l}):h==="canvas"?d5():[S=>(S.dest=S.imageData,S)],h==="file"&&o&&t5(),h==="file"&&a&&h5(),v&&[zn(v,({blob:S,imageData:P,src:M},E,C)=>[{blob:S,imageData:P,src:M},E,C],(S,P)=>S.blob=P),"postprocess-image-file"],h==="file"&&m5({defaultFilename:"image",renameFile:c}),h==="file"?f5(p):Vr(p)&&[p,"store"],rb(f)].filter(Boolean)};var ib=(t,e,r,n,i,o,a,s,l,c,u)=>{if(!(t&&e&&r&&n&&s))return;s*=o;const d=ou(Fr(e)),p=Lr(d),h=Lr(t),f=Ui(r),g=Lr(f),$=g0(r,n,l),b=Lr($),v=Un(He(g),b),w=Un(He(h),p);v.x+=w.x,v.y+=w.y;const S=Kl(He(v));S.x+=w.x,S.y+=w.y;const P=Lr(da(da(Fr(i),a),t)),M=Un(P,h);return jn(v,M),{origin:S,translation:v,rotation:{x:u?Math.PI:0,y:c?Math.PI:0,z:l},scale:s}};let Hc=null;var x0=()=>{if(Hc===null)if("WebGL2RenderingContext"in window){let t;try{t=yn("canvas"),Hc=!!t.getContext("webgl2")}catch{Hc=!1}t&&ti(t),t=void 0}else Hc=!1;return Hc},Hf=t=>(t&t-1)==0,Ws=(t,e={},r="",n="")=>Object.keys(e).filter(i=>!bs(e[i])).reduce((i,o)=>i.replace(new RegExp(r+o+n),e[o]),t);const g5={head:`#version 300 es

in vec4 aPosition;uniform mat4 uMatrix;`,text:`
in vec2 aTexCoord;out vec2 vTexCoord;`,matrix:`
gl_Position=uMatrix*vec4(aPosition.x,aPosition.y,0,1);`},$5={head:`#version 300 es
precision highp float;

out vec4 fragColor;`,mask:`
uniform float uMaskFeather[8];uniform float uMaskBounds[4];uniform float uMaskOpacity;float mask(float x,float y,float bounds[4],float opacity){return 1.0-(1.0-(smoothstep(bounds[3],bounds[3]+1.0,x)*(1.0-smoothstep(bounds[1]-1.0,bounds[1],x))*(1.0-step(bounds[0],y))*step(bounds[2],y)))*(1.0-opacity);}`,init:`
float a=1.0;vec4 fillColor=uColor;vec4 textureColor=texture(uTexture,vTexCoord);textureColor*=(1.0-step(uRepeat.y,vTexCoord.y))*step(0.0,vTexCoord.y)*(1.0-step(uRepeat.x,vTexCoord.x))*step(0.0,vTexCoord.x);`,colorize:`
if(uTextureColor.a!=0.0&&textureColor.a>0.0){vec3 colorFlattened=textureColor.rgb/textureColor.a;if(colorFlattened.r>=.9999&&colorFlattened.g==0.0&&colorFlattened.b>=.9999){textureColor.rgb=uTextureColor.rgb*textureColor.a;}textureColor*=uTextureColor.a;}`,maskapply:`
float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);`,maskfeatherapply:`
float leftFeatherOpacity=step(uMaskFeather[1],gl_FragCoord.x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],gl_FragCoord.x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],gl_FragCoord.x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],gl_FragCoord.x));a*=leftFeatherOpacity*rightFeatherOpacity;`,rectaa:`
vec2 scaledPoint=vec2(vRectCoord.x*uSize.x,vRectCoord.y*uSize.y);a*=smoothstep(0.0,uEdgeFeather,uSize.x-scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,uSize.y-scaledPoint.y);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.y);`,cornerradius:`
vec2 s=(uSize-2.0)*.5;vec2 r=(vRectCoord*uSize)-1.0;vec2 p=r-s;float cornerRadius=uCornerRadius[0];bool left=r.x<s.x;bool top=r.y<s.y;if(!left&&top){cornerRadius=uCornerRadius[1];}if(!left&&!top){cornerRadius=uCornerRadius[3];}if(left&&!top){cornerRadius=uCornerRadius[2];}a*=1.0-clamp(length(max(abs(p)-(s-cornerRadius),0.0))-cornerRadius,0.0,1.0);`,fragcolor:`
if(m<=0.0)discard;fillColor.a*=a;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);textureColor*=uTextureOpacity;textureColor.a*=a;textureColor.rgb*=m*a;textureColor.rgb+=(1.0-m)*(uCanvasColor.rgb*textureColor.a);fragColor=textureColor+(fillColor*(1.0-textureColor.a));`},jf=(t,e,r)=>{const n=t.createShader(r),i=((o,a,s)=>(a=Ws(a,s===o.VERTEX_SHADER?g5:$5,"##").trim(),x0()?a:(a=(a=a.replace(/#version.+/gm,"").trim()).replace(/^\/\/\#/gm,"#"),s===o.VERTEX_SHADER&&(a=a.replace(/in /gm,"attribute ").replace(/out /g,"varying ")),s===o.FRAGMENT_SHADER&&(a=a.replace(/in /gm,"varying ").replace(/out.*?;/gm,"").replace(/texture\(/g,"texture2D(").replace(/fragColor/g,"gl_FragColor")),""+a)))(t,e,r);return t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(n)),n},jc=(t,e,r,n,i)=>{const o=jf(t,e,t.VERTEX_SHADER),a=jf(t,r,t.FRAGMENT_SHADER),s=t.createProgram();t.attachShader(s,o),t.attachShader(s,a),t.linkProgram(s);const l={};return n.forEach(c=>{l[c]=t.getAttribLocation(s,c)}),i.forEach(c=>{l[c]=t.getUniformLocation(s,c)}),{program:s,locations:l,destroy(){t.detachShader(s,o),t.detachShader(s,a),t.deleteShader(o),t.deleteShader(a),t.deleteProgram(s)}}},Uf=t=>t.nodeName!=="VIDEO"&&(!!x0()||Hf(t.width)&&Hf(t.height)),y5=(t,e,r,n)=>{const{premultiply:i=!0}=n;return t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),((o,a,s)=>{o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,Uf(a)?o.LINEAR_MIPMAP_LINEAR:o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,s.filterParam),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,s.wrapParam),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,s.wrapParam),Uf(a)&&o.generateMipmap(o.TEXTURE_2D)})(t,r,n),t.bindTexture(t.TEXTURE_2D,null),e},ul=(t,e=1)=>t?[t[0],t[1],t[2],_e(t[3])?e*t[3]:e]:[0,0,0,0],Qh=()=>{const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t1=(t,e,r,n,i,o,a)=>{const s=1/(e-r),l=1/(n-i),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(a+o)*c,t[15]=1},dl=(t,e,r,n)=>{t[12]=t[0]*e+t[4]*r+t[8]*n+t[12],t[13]=t[1]*e+t[5]*r+t[9]*n+t[13],t[14]=t[2]*e+t[6]*r+t[10]*n+t[14],t[15]=t[3]*e+t[7]*r+t[11]*n+t[15]},Gf=(t,e)=>{t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e},Zf=(t,e)=>{const r=Math.sin(e),n=Math.cos(e),i=t[4],o=t[5],a=t[6],s=t[7],l=t[8],c=t[9],u=t[10],d=t[11];t[4]=i*n+l*r,t[5]=o*n+c*r,t[6]=a*n+u*r,t[7]=s*n+d*r,t[8]=l*n-i*r,t[9]=c*n-o*r,t[10]=u*n-a*r,t[11]=d*n-s*r},Xf=(t,e)=>{const r=Math.sin(e),n=Math.cos(e),i=t[0],o=t[1],a=t[2],s=t[3],l=t[8],c=t[9],u=t[10],d=t[11];t[0]=i*n-l*r,t[1]=o*n-c*r,t[2]=a*n-u*r,t[3]=s*n-d*r,t[8]=i*r+l*n,t[9]=o*r+c*n,t[10]=a*r+u*n,t[11]=s*r+d*n},Yf=(t,e)=>{const r=Math.sin(e),n=Math.cos(e),i=t[0],o=t[1],a=t[2],s=t[3],l=t[4],c=t[5],u=t[6],d=t[7];t[0]=i*n+l*r,t[1]=o*n+c*r,t[2]=a*n+u*r,t[3]=s*n+d*r,t[4]=l*n-i*r,t[5]=c*n-o*r,t[6]=u*n-a*r,t[7]=d*n-s*r};var b5=t=>t*Math.PI/180,dp=(t,e)=>x0()?t.getContext("webgl2",e):t.getContext("webgl",e)||t.getContext("experimental-webgl",e);const e1=(t,e)=>{const r=t.length;return e>=r?t[e%r]:e<0?t[e%r+r]:t[e]},x5=(t,e,r,n)=>{const i=lt(r.x-e.x,r.y-e.y),o=lt(n.x-r.x,n.y-r.y),a=lt(e.x-n.x,e.y-n.y),s=lt(t.x-e.x,t.y-e.y),l=lt(t.x-r.x,t.y-r.y),c=lt(t.x-n.x,t.y-n.y),u=zd(i,s),d=zd(o,l),p=zd(a,c);return u<=0&&d<=0&&p<=0},v5=t=>{if(t.length<3)return[];if((b=>{const v=b.length;for(let w=0;w<v;w++){const S=Gs(b[w],e1(b,w+1));if(Gy(S,b,{ignoreIdenticalLines:!0,breakOnIntersection:!0}))return!0}return!1})(t))return[];(b=>{let v,w,S,P,M,E=0;const C=b.length;for(v=0;v<C;v++)w=b[v],S=b[(v+1)%C],P=S.x-w.x,M=(S.y+w.y)/2,E+=P*M;return E})(t)<0&&t.reverse();const e=t.length,r=[...Array(e).keys()],n=[];let i,o,a,s,l,c,u,d,p,h,f,g,$=1024;for(;r.length>3;){if($<=0)return[];for($--,i=0;i<r.length;i++)if(a=r[i],s=e1(r,i-1),l=e1(r,i+1),c=t[a],u=t[s],d=t[l],p=lt(u.x-c.x,u.y-c.y),h=lt(d.x-c.x,d.y-c.y),!(zd(p,h)<0)){for(f=!0,o=0;o<e;o++)if(o!==a&&o!==s&&o!==l&&(g=t[o],x5(g,u,c,d))){f=!1;break}if(f){n.push([u,c,d]),r.splice(i,1);break}}}return n.push([t[r[0]],t[r[1]],t[r[2]]]),n},qf=(t,e,r,n,i)=>{const o=yo(lt(n.x-r.x,n.y-r.y)),a=yo(lt(i.x-n.x,i.y-n.y)),s=yo(lt(o.x+a.x,o.y+a.y)),l=lt(-s.y,s.x),c=lt(-o.y,o.x),u=Math.min(1/Fd(l,c),5);t[e]=n.x,t[e+1]=n.y,t[e+2]=l.x*u,t[e+3]=l.y*u,t[e+4]=-1,t[e+5]=n.x,t[e+6]=n.y,t[e+7]=l.x*u,t[e+8]=l.y*u,t[e+9]=1},Kf=t=>{const e=new Float32Array(8);return e[0]=t[3].x,e[1]=t[3].y,e[2]=t[0].x,e[3]=t[0].y,e[4]=t[2].x,e[5]=t[2].y,e[6]=t[1].x,e[7]=t[1].y,e},Jf=(t,e=0,r,n)=>{const i=Oo(t),o=t.x+.5*t.width,a=t.y+.5*t.height;return(r||n)&&Jl(i,r,n,o,a),e!==0&&$s(i,e,o,a),i},vd=(t,e,r,n,i)=>{const o=Math.min(20,Math.max(4,Math.round(n/2)));let a=0,s=0,l=0,c=0,u=0;for(;u<o;u++)a=u/o,s=i*ea+a*ea,l=n*Math.cos(s),c=n*Math.sin(s),t.push(lt(e+l,r+c))};let wd=null;var v0=()=>{if(wd!==null)return wd;let t=yn("canvas");const e=dp(t);return wd=e?e.getParameter(e.MAX_TEXTURE_SIZE):void 0,ti(t),t=void 0,wd},w0=()=>ni()&&!!window.chrome;const Yc=new Float32Array([0,1,0,0,1,1,1,0]),w5=new Float32Array([1,0,0,0,1,1,0,1]),S5=ni()&&Aa(),Qf=[0,0,0,0,1,0,0,0,0],k5=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],r1=[0,0,0,0],T5=[0,0,0,0],tg=(t,e,r,n,i)=>{if(!r||!n)return Yc;let o=n.x/r.width,a=n.y/r.height,s=t/r.width/i,l=e/r.height/i;return s-=o,l-=a,new Float32Array([-o,l,-o,-a,s,l,s,-a])};var ob=(t,e={})=>{const{alpha:r=!1}=e,n={width:0,height:0},i={width:0,height:0},o=v0()||1024;let a,s,l;const c=Qh(),u=Qh();let d,p,h,f,g,$,b,v,w,S=0,P=0,M=0,E=1;const C=new Map([]),z=()=>{y.stencilOp(y.KEEP,y.KEEP,y.KEEP),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},V=b5(30),L=Math.tan(V/2),y=dp(t,{alpha:r,antialias:!1,premultipliedAlpha:!0,stencil:!0});if(!y)return;y.getExtension("OES_standard_derivatives"),y.disable(y.DEPTH_TEST),y.enable(y.STENCIL_TEST),y.enable(y.BLEND),y.blendFunc(y.ONE,y.ONE_MINUS_SRC_ALPHA),z();const ct=y.createTexture();y.bindTexture(y.TEXTURE_2D,ct),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,new Uint8Array(r1)),C.set(0,ct);const j=y.createTexture();C.set(2,j);const k=y.createFramebuffer(),N=y.createTexture();C.set(1,N);const nt=y.createFramebuffer(),ft=jc(y,`
##head
##text
void main(){vTexCoord=aTexCoord;gl_Position=uMatrix*aPosition;}`,`
##head
in vec2 vTexCoord;uniform sampler2D uTexture;uniform sampler2D uTextureOverlay;uniform sampler2D uTextureBlend;uniform vec2 uTextureSize;uniform float uOpacity;uniform int uAntialias;uniform vec4 uOverlayColor;uniform mat4 uColorMatrix;uniform vec4 uColorOffset;uniform float uClarityKernel[9];uniform float uClarityKernelWeight;uniform float uColorGamma;uniform float uColorVignette;uniform float uMaskClip;uniform float uMaskOpacity;uniform float uMaskBounds[4];uniform float uMaskCornerRadius[4];uniform float uMaskFeather[8];vec4 applyGamma(vec4 c,float g){c.r=pow(c.r,g);c.g=pow(c.g,g);c.b=pow(c.b,g);return c;}vec4 applyColorMatrix(vec4 c,mat4 m,vec4 o){vec4 res=(c*m)+(o*c.a);res=clamp(res,0.0,1.0);return res;}vec4 applyConvolutionMatrix(vec4 c,float k0,float k1,float k2,float k3,float k4,float k5,float k6,float k7,float k8,float w){vec2 pixel=vec2(1)/uTextureSize;vec4 colorSum=texture(uTexture,vTexCoord-pixel)*k0+texture(uTexture,vTexCoord+pixel*vec2(0.0,-1.0))*k1+texture(uTexture,vTexCoord+pixel*vec2(1.0,-1.0))*k2+texture(uTexture,vTexCoord+pixel*vec2(-1.0,0.0))*k3+texture(uTexture,vTexCoord)*k4+texture(uTexture,vTexCoord+pixel*vec2(1.0,0.0))*k5+texture(uTexture,vTexCoord+pixel*vec2(-1.0,1.0))*k6+texture(uTexture,vTexCoord+pixel*vec2(0.0,1.0))*k7+texture(uTexture,vTexCoord+pixel)*k8;vec4 color=vec4(clamp((colorSum/w),0.0,1.0).rgb,c.a);return color;}vec4 blendPremultipliedAlpha(vec4 back,vec4 front){return front+(back*(1.0-front.a));}vec4 applyVignette(vec4 c,vec2 pos,vec2 center,float v){float d=distance(pos,center)/length(center);float f=1.0-(d*abs(v));if(v>0.0){c.rgb*=f;}else if(v<0.0){c.rgb+=(1.0-f)*(1.0-c.rgb);}return c;}void main(){float x=gl_FragCoord.x;float y=gl_FragCoord.y;float a=1.0;float maskTop=uMaskBounds[0];float maskRight=uMaskBounds[1];float maskBottom=uMaskBounds[2];float maskLeft=uMaskBounds[3];float leftFeatherOpacity=step(uMaskFeather[1],x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],x));a*=leftFeatherOpacity*rightFeatherOpacity;float overlayColorAlpha=(smoothstep(maskLeft,maskLeft+1.0,x)*(1.0-smoothstep(maskRight-1.0,maskRight,x))*(1.0-step(maskTop,y))*step(maskBottom,y));if(uOverlayColor.a==0.0){a*=overlayColorAlpha;}vec2 offset=vec2(maskLeft,maskBottom);vec2 size=vec2(maskRight-maskLeft,maskTop-maskBottom)*.5;vec2 center=offset.xy+size.xy;int pixelX=int(step(center.x,x));int pixelY=int(step(y,center.y));float cornerRadius=0.0;if(pixelX==0&&pixelY==0)cornerRadius=uMaskCornerRadius[0];if(pixelX==1&&pixelY==0)cornerRadius=uMaskCornerRadius[1];if(pixelX==0&&pixelY==1)cornerRadius=uMaskCornerRadius[2];if(pixelX==1&&pixelY==1)cornerRadius=uMaskCornerRadius[3];float cornerOffset=sign(cornerRadius)*length(max(abs(gl_FragCoord.xy-size-offset)-size+cornerRadius,0.0))-cornerRadius;float cornerOpacity=1.0-smoothstep(0.0,1.0,cornerOffset);a*=cornerOpacity;if(uAntialias==1){vec2 scaledPoint=vec2(vTexCoord.x*uTextureSize.x,vTexCoord.y*uTextureSize.y);a*=smoothstep(0.0,1.0,uTextureSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uTextureSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);}vec4 color=texture(uTexture,vTexCoord);if(uClarityKernelWeight!=-1.0){color=applyConvolutionMatrix(color,uClarityKernel[0],uClarityKernel[1],uClarityKernel[2],uClarityKernel[3],uClarityKernel[4],uClarityKernel[5],uClarityKernel[6],uClarityKernel[7],uClarityKernel[8],uClarityKernelWeight);}color=blendPremultipliedAlpha(color,texture(uTextureBlend,vTexCoord));color=applyGamma(color,uColorGamma);color=applyColorMatrix(color,uColorMatrix,uColorOffset);color*=a;if(uColorVignette!=0.0){vec2 pos=gl_FragCoord.xy-offset;color=applyVignette(color,pos,center-offset,uColorVignette);}color=blendPremultipliedAlpha(color,texture(uTextureOverlay,vTexCoord));if(overlayColorAlpha<=0.0){color*=1.0-uOverlayColor.a;}color*=uOpacity;fragColor=color;}`,["aPosition","aTexCoord"],["uMatrix","uTexture","uTextureBlend","uTextureOverlay","uTextureSize","uColorGamma","uColorVignette","uColorOffset","uColorMatrix","uClarityKernel","uClarityKernelWeight","uOpacity","uMaskOpacity","uMaskBounds","uMaskCornerRadius","uMaskFeather","uOverlayColor","uAntialias"]),xt=y.createBuffer(),H=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,H),y.bufferData(y.ARRAY_BUFFER,Yc,y.STATIC_DRAW);const Z=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,Z),y.bufferData(y.ARRAY_BUFFER,w5,y.STATIC_DRAW);const wt=jc(y,`#version 300 es

in vec4 aPosition;in vec2 aNormal;in float aMiter;out vec2 vNormal;out float vMiter;out float vWidth;uniform float uWidth;uniform float uSharpness;uniform mat4 uMatrix;void main(){vMiter=aMiter;vNormal=aNormal;vWidth=(uWidth*.5)+uSharpness;gl_Position=uMatrix*vec4(aPosition.x+(aNormal.x*vWidth*aMiter),aPosition.y+(aNormal.y*vWidth*aMiter),0,1);}`,`
##head
##mask
in vec2 vNormal;in float vMiter;in float vWidth;uniform float uWidth;uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);if(m<=0.0)discard;fillColor.a*=clamp(smoothstep(vWidth-.5,vWidth-1.0,abs(vMiter)*vWidth),0.0,1.0);fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition","aNormal","aMiter"],["uColor","uCanvasColor","uMatrix","uWidth","uSharpness","uMaskBounds","uMaskOpacity"]),vt=y.createBuffer();w0()&&(y.bindBuffer(y.ARRAY_BUFFER,vt),y.bufferData(y.ARRAY_BUFFER,1,y.DYNAMIC_DRAW));const et=(St,pt,Xt,Zt=!1)=>{const{program:ie,locations:gt}=wt;y.useProgram(ie),y.enableVertexAttribArray(gt.aPosition),y.enableVertexAttribArray(gt.aNormal),y.enableVertexAttribArray(gt.aMiter);const te=((qt,le)=>{let de,Oe,rr,Ct=0;const pe=qt.length,ar=new Float32Array(10*(le?pe+1:pe)),Ke=qt[0],Qe=qt[pe-1];for(Ct=0;Ct<pe;Ct++)de=qt[Ct-1],Oe=qt[Ct],rr=qt[Ct+1],de||(de=le?Qe:lt(Oe.x+(Oe.x-rr.x),Oe.y+(Oe.y-rr.y))),rr||(rr=le?Ke:lt(Oe.x+(Oe.x-de.x),Oe.y+(Oe.y-de.y))),qf(ar,10*Ct,de,Oe,rr);return le&&qf(ar,10*pe,Qe,Ke,qt[1]),ar})(St,Zt),xe=5*Float32Array.BYTES_PER_ELEMENT,_=2*Float32Array.BYTES_PER_ELEMENT,Kt=4*Float32Array.BYTES_PER_ELEMENT;y.uniform1f(gt.uWidth,pt),y.uniform1f(gt.uSharpness,l),y.uniform4fv(gt.uColor,Xt),y.uniformMatrix4fv(gt.uMatrix,!1,d),y.uniform4f(gt.uCanvasColor,S,P,M,E),y.uniform1fv(gt.uMaskBounds,b),y.uniform1f(gt.uMaskOpacity,$),y.bindBuffer(y.ARRAY_BUFFER,vt),y.bufferData(y.ARRAY_BUFFER,te,y.STATIC_DRAW),y.vertexAttribPointer(gt.aPosition,2,y.FLOAT,!1,xe,0),y.vertexAttribPointer(gt.aNormal,2,y.FLOAT,!1,xe,_),y.vertexAttribPointer(gt.aMiter,1,y.FLOAT,!1,xe,Kt),y.drawArrays(y.TRIANGLE_STRIP,0,te.length/5),y.disableVertexAttribArray(gt.aPosition),y.disableVertexAttribArray(gt.aNormal),y.disableVertexAttribArray(gt.aMiter)},Pt=jc(y,`
##head
void main(){
##matrix
}`,`
##head
##mask
uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;
##maskapply
if(m<=0.0)discard;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition"],["uColor","uCanvasColor","uMatrix","uMaskBounds","uMaskOpacity"]),Et=y.createBuffer(),kt=jc(y,`
##head
##text
in vec2 aRectCoord;out vec2 vRectCoord;void main(){vTexCoord=aTexCoord;vRectCoord=aRectCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vRectCoord;uniform sampler2D uTexture;uniform vec4 uTextureColor;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec4 uColor;uniform float uCornerRadius[4];uniform vec2 uSize;uniform vec2 uPosition;uniform vec4 uCanvasColor;uniform int uInverted;uniform float uEdgeFeather;void main(){
##init
##colorize
##rectaa
##cornerradius
##maskfeatherapply
if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord","aRectCoord"],["uTexture","uColor","uMatrix","uCanvasColor","uTextureColor","uTextureOpacity","uRepeat","uPosition","uSize","uMaskBounds","uMaskOpacity","uMaskFeather","uCornerRadius","uInverted","uEdgeFeather"]),st=y.createBuffer(),Ut=y.createBuffer(),rt=y.createBuffer(),X=jc(y,`
##head
##text
out vec2 vTexCoordDouble;void main(){vTexCoordDouble=vec2(aTexCoord.x*2.0-1.0,aTexCoord.y*2.0-1.0);vTexCoord=aTexCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vTexCoordDouble;uniform sampler2D uTexture;uniform float uTextureOpacity;uniform vec2 uTextureAdjust;uniform vec2 uRepeat;uniform vec2 uRadius;uniform vec4 uColor;uniform int uInverted;uniform vec4 uCanvasColor;void main(){
##init
float ar=uRadius.x/uRadius.y;vec2 rAA=vec2(uRadius.x-1.0,uRadius.y-(1.0/ar));vec2 scaledPointSq=vec2((vTexCoordDouble.x*uTextureAdjust.x*uRadius.x)*(vTexCoordDouble.x*uTextureAdjust.x*uRadius.x),(vTexCoordDouble.y*uTextureAdjust.y*uRadius.y)*(vTexCoordDouble.y*uTextureAdjust.y*uRadius.y));float p=(scaledPointSq.x/(uRadius.x*uRadius.x))+(scaledPointSq.y/(uRadius.y*uRadius.y));float pAA=(scaledPointSq.x/(rAA.x*rAA.x))+(scaledPointSq.y/(rAA.y*rAA.y));a=smoothstep(1.0,p/pAA,p);if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord"],["uTexture","uTextureOpacity","uTextureAdjust","uRepeat","uColor","uCanvasColor","uMatrix","uRadius","uInverted","uMaskBounds","uMaskOpacity"]),q=y.createBuffer(),Ft=y.createBuffer(),zt=new Map,yt={2:{width:0,height:0},1:{width:0,height:0}},Dt=(St,pt,Xt,Zt=1)=>{const ie=Math.min(Math.min(4096,o)/Xt.width,Math.min(4096,o)/Xt.height,Zt),gt=Math.floor(ie*Xt.width),te=Math.floor(ie*Xt.height);iu(Xt,yt[St])?y.bindFramebuffer(y.FRAMEBUFFER,pt):(y.bindTexture(y.TEXTURE_2D,C.get(St)),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,gt,te,0,y.RGBA,y.UNSIGNED_BYTE,null),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.bindFramebuffer(y.FRAMEBUFFER,pt),y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,C.get(St),0),yt[St]=Xt);const xe=Xt.width*s,_=Xt.height*s;var Kt,qt;t1(u,0,xe,_,0,-1,1),dl(u,0,_,0),qt=1,(Kt=u)[0]*=qt,Kt[1]*=qt,Kt[2]*=qt,Kt[3]*=qt,((le,de)=>{le[4]*=de,le[5]*=de,le[6]*=de,le[7]*=de})(u,-1),d=u,y.viewport(0,0,gt,te),y.colorMask(!0,!0,!0,!0),y.clearColor(0,0,0,0),y.clear(y.COLOR_BUFFER_BIT),w=[1,0,1,0,1,Math.max(n.width,Xt.width),1,Math.max(n.width,Xt.width)]},Wt=(St,pt)=>{const{forceRelease:Xt=!1}=pt||{},{src:Zt}=zt.get(St);Zt instanceof HTMLCanvasElement&&(Xt||Zt.dataset.retain||ti(Zt)),zt.delete(St),y.deleteTexture(St)},at=St=>zt.get(St).isRotatedVideo;return{drawPath:(St,pt=0,Xt=!1,Zt=!1,ie,gt,te,xe,_)=>{if(St.length<2)return;const Kt=St.map(Oe=>({x:Oe.x*s,y:Oe.y*s})),qt=ie*s;if(qt>0&&et(Kt,qt,ul(gt,_),te),Kt.length<3||!xe||xe[3]===0||!te)return;const le=v5(Kt),de=new Float32Array(6*le.length);le.forEach(([Oe,rr,Ct],pe)=>{const ar=6*pe;de[ar+0]=Oe.x,de[ar+1]=Oe.y,de[ar+2]=rr.x,de[ar+3]=rr.y,de[ar+4]=Ct.x,de[ar+5]=Ct.y}),((Oe,rr)=>{const{program:Ct,locations:pe}=Pt;y.useProgram(Ct),y.enableVertexAttribArray(pe.aPosition),y.uniform4fv(pe.uColor,rr),y.uniformMatrix4fv(pe.uMatrix,!1,d),y.uniform1fv(pe.uMaskBounds,b),y.uniform1f(pe.uMaskOpacity,$),y.uniform4f(pe.uCanvasColor,S,P,M,E),y.bindBuffer(y.ARRAY_BUFFER,Et),y.bufferData(y.ARRAY_BUFFER,Oe,y.STATIC_DRAW),y.vertexAttribPointer(pe.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLES,0,Oe.length/2),y.disableVertexAttribArray(pe.aPosition)})(de,ul(xe,_))},drawRect:(St,pt=0,Xt=!1,Zt=!1,ie,gt,te,xe,_,Kt=!1,qt,le,de,Oe,rr,Ct=1/s,pe,ar)=>{const Ke=yl(Fr(St),s),Qe=ie.map(Re=>((Je,ur)=>Math.floor(an(Je,0,Math.min(.5*(ur.width-1),.5*(ur.height-1)))))(Re||0,St)).map(Re=>Re*s);if(gt||te){const Re=Fr(Ke);Re.x-=.5,Re.y-=.5,Re.width+=1,Re.height+=1;const Je=Jf(Re,pt,Xt,Zt),ur=Kf(Je);let $r;pe&&($r=ul(pe),$r[3]===0&&($r[3]=.001));const zr=xe&&Kt?[Re.width/xe.width,Re.height/xe.height]:[1,1];((Dr,dr,Y,it,G,Bt=ct,ae,De=1,we=r1,Ot=Yc,Ce=w,nr=1,lr)=>{const{program:ot,locations:Yt}=kt;y.useProgram(ot),y.enableVertexAttribArray(Yt.aPosition),y.enableVertexAttribArray(Yt.aTexCoord),y.enableVertexAttribArray(Yt.aRectCoord),y.uniform4fv(Yt.uColor,G),y.uniform2fv(Yt.uSize,[dr,Y]),y.uniform2fv(Yt.uPosition,[Dr[2],Dr[3]]),y.uniform2fv(Yt.uRepeat,ae),y.uniform1i(Yt.uInverted,lr?1:0),y.uniform1fv(Yt.uCornerRadius,it),y.uniform4f(Yt.uCanvasColor,S,P,M,E),y.uniform1fv(Yt.uMaskFeather,Ce.map((Ve,Se)=>Se%2==0?Ve:Ve*s)),y.uniform1fv(Yt.uMaskBounds,b),y.uniform1f(Yt.uMaskOpacity,$),y.uniform1f(Yt.uEdgeFeather,Math.max(0,nr)),y.uniformMatrix4fv(Yt.uMatrix,!1,d),y.uniform1i(Yt.uTexture,4),y.uniform4fv(Yt.uTextureColor,we),y.uniform1f(Yt.uTextureOpacity,De),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,Bt),y.bindBuffer(y.ARRAY_BUFFER,Ut),y.bufferData(y.ARRAY_BUFFER,Ot,y.STATIC_DRAW),y.vertexAttribPointer(Yt.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,rt),y.bufferData(y.ARRAY_BUFFER,Yc,y.STATIC_DRAW),y.vertexAttribPointer(Yt.aRectCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,st),y.bufferData(y.ARRAY_BUFFER,Dr,y.STATIC_DRAW),y.vertexAttribPointer(Yt.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,Dr.length/2),y.disableVertexAttribArray(Yt.aPosition),y.disableVertexAttribArray(Yt.aTexCoord),y.disableVertexAttribArray(Yt.aRectCoord)})(ur,Re.width,Re.height,Qe,ul(gt,Oe),te,zr,Oe,$r,qt?new Float32Array(qt):tg(Re.width,Re.height,xe,_,s),rr,Ct*s,ar)}le&&(le=Math.min(le,Ke.width,Ke.height),et(((Re,Je,ur,$r,zr,Dr,dr,Y)=>{const it=[];if(Dr.every(G=>G===0))it.push(lt(Re,Je),lt(Re+ur,Je),lt(Re+ur,Je+$r),lt(Re,Je+$r));else{const[G,Bt,ae,De]=Dr,we=Re,Ot=Re+ur,Ce=Je,nr=Je+$r;it.push(lt(we+G,Ce)),vd(it,Ot-Bt,Ce+Bt,Bt,-1),it.push(lt(Ot,Ce+Bt)),vd(it,Ot-De,nr-De,De,0),it.push(lt(Ot-De,nr)),vd(it,we+ae,nr-ae,ae,1),it.push(lt(we,nr-ae)),vd(it,we+G,Ce+G,G,2)}return(dr||Y)&&Jl(it,dr,Y,Re+.5*ur,Je+.5*$r),zr&&$s(it,zr,Re+.5*ur,Je+.5*$r),it})(Ke.x,Ke.y,Ke.width,Ke.height,pt,Qe,Xt,Zt),le*s,ul(de,Oe),!0))},drawEllipse:(St,pt,Xt,Zt,ie,gt,te,xe,_,Kt,qt,le,de,Oe,rr)=>{const Ct=yl(Wn(St.x-pt,St.y-Xt,2*pt,2*Xt),s);if(te||xe){const pe=Fr(Ct);rr||(pe.x-=.5,pe.y-=.5,pe.width+=1,pe.height+=1);const ar=Jf(pe,Zt,ie,gt);((Ke,Qe,Re,Je,ur=ct,$r,zr=Yc,Dr=1,dr=!1)=>{const{program:Y,locations:it}=X;y.useProgram(Y),y.enableVertexAttribArray(it.aPosition),y.enableVertexAttribArray(it.aTexCoord),y.uniformMatrix4fv(it.uMatrix,!1,d),y.uniform2fv(it.uRadius,[.5*Qe,.5*Re]),y.uniform2fv(it.uTextureAdjust,[$r.width/(Qe/s),$r.height/(Re/s)]),y.uniform1i(it.uInverted,dr?1:0),y.uniform4fv(it.uColor,Je),y.uniform4f(it.uCanvasColor,S,P,M,E),y.uniform2fv(it.uRepeat,[1,1]),y.uniform1fv(it.uMaskBounds,b),y.uniform1f(it.uMaskOpacity,$),y.uniform1i(it.uTexture,4),y.uniform1f(it.uTextureOpacity,Dr),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,ur),y.bindBuffer(y.ARRAY_BUFFER,Ft),y.bufferData(y.ARRAY_BUFFER,zr,y.STATIC_DRAW),y.vertexAttribPointer(it.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,q),y.bufferData(y.ARRAY_BUFFER,Ke,y.STATIC_DRAW),y.vertexAttribPointer(it.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,Ke.length/2),y.disableVertexAttribArray(it.aPosition),y.disableVertexAttribArray(it.aTexCoord)})(Kf(ar),pe.width,pe.height,ul(te,Oe),xe,_||An(pe.width/s,pe.height/s),qt?new Float32Array(qt):tg(pe.width,pe.height,_,Kt,s),Oe,rr)}le&&et(((pe,ar,Ke,Qe,Re,Je,ur)=>{const $r=.5*Math.abs(Ke),zr=.5*Math.abs(Qe),Dr=Math.abs(Ke)+Math.abs(Qe),dr=Math.max(20,Math.round(Dr/6));return Xd(lt(pe+$r,ar+zr),$r,zr,Re,Je,ur,dr)})(Ct.x,Ct.y,Ct.width,Ct.height,Zt,ie,gt),le*s,ul(de,Oe),!0)},drawImage:(St,pt,Xt,Zt,ie,gt,te,xe,_,Kt,qt=k5,le=1,de,Oe=1,rr=0,Ct=v,pe=T5,ar=r1,Ke=!1,Qe=!1,Re=!0)=>{const Je=pt.width*s,ur=pt.height*s,$r=-.5*Je,zr=.5*ur,Dr=.5*Je,dr=-.5*ur,Y=new Float32Array([$r,dr,0,$r,zr,0,Dr,dr,0,Dr,zr,0]);y.bindBuffer(y.ARRAY_BUFFER,xt),y.bufferData(y.ARRAY_BUFFER,Y,y.STATIC_DRAW);const it=pt.height/2/L*(n.height/pt.height)*-1;ie*=s,gt*=s,Xt*=s,Zt*=s;const{program:G,locations:Bt}=ft,ae=Qh();((ot,Yt,Ve,Se,ee)=>{const Xe=1/Math.tan(Yt/2),Be=1/(Se-ee);ot[0]=Xe/Ve,ot[1]=0,ot[2]=0,ot[3]=0,ot[4]=0,ot[5]=Xe,ot[6]=0,ot[7]=0,ot[8]=0,ot[9]=0,ot[10]=(ee+Se)*Be,ot[11]=-1,ot[12]=0,ot[13]=0,ot[14]=2*ee*Se*Be,ot[15]=0})(ae,V,a,1,2*-it),dl(ae,ie,-gt,it),dl(ae,Xt,-Zt,0),Yf(ae,-_),Gf(ae,Kt),dl(ae,-Xt,Zt,0),Xf(ae,xe),Zf(ae,te),y.useProgram(G),y.enableVertexAttribArray(Bt.aPosition),y.enableVertexAttribArray(Bt.aTexCoord),y.uniform1i(Bt.uTexture,3),y.uniform2f(Bt.uTextureSize,pt.width,pt.height),y.activeTexture(y.TEXTURE0+3),y.bindTexture(y.TEXTURE_2D,St);const De=Qe?1:0,we=C.get(De);y.uniform1i(Bt.uTextureBlend,De),y.activeTexture(y.TEXTURE0+De),y.bindTexture(y.TEXTURE_2D,we);const Ot=Ke?2:0,Ce=C.get(Ot);y.uniform1i(Bt.uTextureOverlay,Ot),y.activeTexture(y.TEXTURE0+Ot),y.bindTexture(y.TEXTURE_2D,Ce),y.bindBuffer(y.ARRAY_BUFFER,xt),y.vertexAttribPointer(Bt.aPosition,3,y.FLOAT,!1,0,0);const nr=S5&&at(St);let lr;y.bindBuffer(y.ARRAY_BUFFER,nr?Z:H),y.vertexAttribPointer(Bt.aTexCoord,2,y.FLOAT,!1,0,0),y.uniformMatrix4fv(Bt.uMatrix,!1,ae),y.uniform4fv(Bt.uOverlayColor,ar),!de||ys(de,Qf)?(de=Qf,lr=-1):(lr=de.reduce((ot,Yt)=>ot+Yt,0),lr=lr<=0?1:lr),y.uniform1fv(Bt.uClarityKernel,de),y.uniform1f(Bt.uClarityKernelWeight,lr),y.uniform1f(Bt.uColorGamma,1/Oe),y.uniform1f(Bt.uColorVignette,rr),y.uniform1i(Bt.uAntialias,Re?1:0),y.uniform4f(Bt.uColorOffset,qt[4],qt[9],qt[14],qt[19]),y.uniformMatrix4fv(Bt.uColorMatrix,!1,[qt[0],qt[1],qt[2],qt[3],qt[5],qt[6],qt[7],qt[8],qt[10],qt[11],qt[12],qt[13],qt[15],qt[16],qt[17],qt[18]]),y.uniform1f(Bt.uOpacity,le),y.uniform1f(Bt.uMaskOpacity,$),y.uniform1fv(Bt.uMaskBounds,b),y.uniform1fv(Bt.uMaskCornerRadius,pe.map(ot=>ot*s)),y.uniform1fv(Bt.uMaskFeather,Ct.map((ot,Yt)=>Yt%2==0?ot:ot*s)),y.drawArrays(y.TRIANGLE_STRIP,0,4),y.disableVertexAttribArray(Bt.aPosition),y.disableVertexAttribArray(Bt.aTexCoord)},textureFilterNearest:y.NEAREST,textureFilterLinear:y.LINEAR,textureClamp:y.CLAMP_TO_EDGE,textureRepeat:y.REPEAT,textureCreate:()=>y.createTexture(),textureUpdate:(St,pt,Xt)=>(zt.set(St,{src:pt,options:Xt,isRotatedVideo:pt.nodeName==="VIDEO"&&(pt.dataset&&pt.dataset.rotation==90||pt.dataset.rotation==270)}),y5(y,St,pt,Xt)),textureGetSize:St=>{const{src:pt,options:Xt}=zt.get(St),Zt=ts(pt);return Xt.scalar?La(Zt,ie=>ie/Xt.scalar):Zt},textureDelete:Wt,enablePreviewStencil:()=>{y.stencilOp(y.KEEP,y.KEEP,y.REPLACE),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},applyPreviewStencil:()=>{y.stencilFunc(y.EQUAL,1,255),y.stencilMask(0)},disablePreviewStencil:z,setCanvasColor(St){S=St[0],P=St[1],M=St[2],E=r?St[3]:1,y.clear(y.COLOR_BUFFER_BIT)},resetCanvasMatrix:()=>{t1(c,0,n.width,n.height,0,-1,1)},updateCanvasMatrix(St,pt,Xt,Zt,ie){const gt=St.width,te=St.height,xe=n.width*(.5/s),_=n.height*(.5/s),Kt={x:xe+(Xt.x+pt.x),y:_+(Xt.y+pt.y)},qt={x:Kt.x-pt.x,y:Kt.y-pt.y},le=.5*gt,de=.5*te;qi(qt,ie.z,Kt),Hx(qt,Zt,Kt),dl(c,(qt.x-le)*s,(qt.y-de)*s,0),dl(c,le*s,de*s,0),Yf(c,ie.z);const Oe=ie.x>Math.PI/2;Zf(c,Oe?Math.PI:0);const rr=ie.y>Math.PI/2;Xf(c,rr?Math.PI:0),Gf(c,Zt),dl(c,-le*s,-de*s,0)},drawToCanvas(){y.bindFramebuffer(y.FRAMEBUFFER,null),d=c,y.viewport(0,0,y.drawingBufferWidth,y.drawingBufferHeight),y.colorMask(!0,!0,!0,!0),y.clearColor(S,P,M,E),y.clear(y.COLOR_BUFFER_BIT),w=[1,0,1,0,1,n.width,1,n.width]},drawToImageBlendBuffer(St,pt){Dt(1,nt,St,pt)},drawToImageOverlayBuffer(St,pt){Dt(2,k,St,pt)},enableMask(St,pt){const Xt=St.x*s,Zt=St.y*s,ie=St.width*s,gt=St.height*s;g=Xt,h=g+ie,p=n.height-Zt,f=n.height-(Zt+gt),$=1-pt,b=[p,h,f,g]},disableMask(){g=0,h=n.width,p=n.height,f=0,$=1,b=[p,h,f,g]},resize:(St,pt,Xt)=>{s=Math.max(1,Xt),l=s===1?.75:1,i.width=St,i.height=pt,n.width=St*s,n.height=pt*s,a=ca(n.width,n.height),t.width=n.width,t.height=n.height,t1(c,0,n.width,n.height,0,-1,1),v=[1,0,1,0,1,i.width,1,i.width]},release(){Array.from(zt.keys()).forEach(St=>Wt(St,{forceRelease:!0})),zt.clear(),C.forEach(St=>{y.deleteTexture(St)}),C.clear(),ft.destroy(),wt.destroy(),Pt.destroy(),kt.destroy(),X.destroy(),t.width=1,t.height=1,t=void 0}}},eg=t=>t%2==0?t:t+1,eT=(t,e,r)=>{const n=au(t),{targetCanvas:i,targetSize:o,disableDraw:a=!1,shapePreprocessor:s,forceEvenSize:l=n}=r||{},c=i||document.createElement("canvas"),{crop:u,colorMatrix:d,convolutionMatrix:p}=e,h={width:n?t.videoWidth:t.width,height:n?t.videoHeight:t.height},{upscale:f=!1,fit:g="contain",width:$,height:b}=o||{};let v=1;v=g==="contain"?Math.min(($||Number.MAX_SAFE_INTEGER)/u.width,(b||Number.MAX_SAFE_INTEGER)/u.height):Math.max(($||u.width)/u.width,(b||u.height)/u.height),f||(v=Math.min(v,1));const w=g==="force"?$:Math.floor(u.width*v),S=g==="force"?b:Math.floor(u.height*v),P=l?eg(w):w,M=l?eg(S):S,E=ob(c,{alpha:!0});E.resize(P,M,1);const C=E.textureCreate();let z;E.setCanvasColor([0,0,0,0]),E.drawToCanvas(),E.disableMask(),E.disablePreviewStencil();{const Z=Object.values(d||{}).filter(Boolean);Z.length&&(z=$u(Z))}const V={x:0,y:0,width:P,height:M},{origin:L,translation:y,rotation:ct,scale:j}=ib(V,V,h,u,{x:0,y:0,width:P,height:M},v,{x:0,y:0},1,e.rotation,e.flipX,e.flipY),k=[h,L.x,L.y,y.x,y.y,ct.x,ct.y,ct.z,j,z,1,p&&p.clarity,_e(e.gamma)?e.gamma:1,e.vignette||0,[1,0,1,0,1,M,1,P],void 0,void 0,void 0,void 0,!1];let N=!1;const nt=e.decoration.length||e.annotation.length,ft=nt&&E.textureCreate(),xt=()=>{E.textureUpdate(C,t,{filterParam:E.textureFilterLinear,wrapParam:E.textureClamp})},H=()=>{xt(),E.drawImage(C,...k),nt&&N&&E.drawRect(V,0,!1,!1,[0,0,0,0],void 0,ft)};return xt(),!a&&H(),{canvas:c,prepare:async()=>{if(!nt)return;const{dest:Z}=await U2(yn("canvas",h),{shapePreprocessor:s,imageReader:[[async(wt,vt,et)=>{const{src:Pt}=wt,Et=parseInt(Pt.width,10),kt=parseInt(Pt.height,10),st=await lp(Pt);return{...wt,dest:st,size:{width:Et,height:kt}}},"read-canvas"]],imageWriter:b0({format:"canvas"}),imageState:{...e,redaction:[],frame:void 0,gamma:void 0,convolutionMatrix:void 0,colorMatrix:void 0,backgroundColor:[0,0,0,0],backgroundImage:void 0,trim:void 0,vignette:void 0,volume:void 0}});E.textureUpdate(ft,Z,{filterParam:E.textureFilterLinear,wrapParam:E.textureClamp}),N=!0,!a&&H()},redraw:H,destroy:()=>{E.release()}}},C5=(t,e)=>{const{imageData:r,amount:n=1}=t,i=Math.round(2*Math.max(1,n)),o=Math.round(.5*i),a=r.width,s=r.height,l=r.colorSpace,c=new Uint8ClampedArray(a*s*4),u=r.data;let d,p,h,f,g,$=0,b=0,v=0;const w=a*s*4-4;for(h=0;h<s;h++)for(d=crypto.getRandomValues(new Uint8ClampedArray(s)),p=0;p<a;p++)f=d[h]/255,b=0,v=0,f<.5&&(b=4*(-o+Math.round(Math.random()*i))),f>.5&&(v=(-o+Math.round(Math.random()*i))*(4*a)),g=Math.min(Math.max(0,$+b+v),w),c[$]=u[g],c[$+1]=u[g+1],c[$+2]=u[g+2],c[$+3]=u[g+3],$+=4;e(null,{data:c,width:r.width,height:r.height,colorSpace:l})};const M5=[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625];function P5(t){return Math.sqrt(1- --t*t)}function rg(t){return Object.prototype.toString.call(t)==="[object Date]"}function z1(t,e){if(t===e||t!=t)return()=>t;const r=typeof t;if(r!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map((i,o)=>z1(t[o],i));return i=>n.map(o=>o(i))}if(r==="object"){if(!t||!e)throw new Error("Object cannot be null");if(rg(t)&&rg(e)){t=t.getTime();const o=(e=e.getTime())-t;return a=>new Date(t+a*o)}const n=Object.keys(e),i={};return n.forEach(o=>{i[o]=z1(t[o],e[o])}),o=>{const a={};return n.forEach(s=>{a[s]=i[s](o)}),a}}if(r==="number"){const n=e-t;return i=>t+i*n}throw new Error(`Cannot interpolate ${r} values`)}function S0(t,e={}){const r=ge(t);let n,i=t;function o(a,s){if(t==null)return r.set(t=a),Promise.resolve();i=a;let l=n,c=!1,{delay:u=0,duration:d=400,easing:p=k2,interpolate:h=z1}=_n(_n({},e),s);if(d===0)return l&&(l.abort(),l=null),r.set(t=i),Promise.resolve();const f=P2()+u;let g;return n=h0($=>{if($<f)return!0;c||(g=h(t,a),typeof d=="function"&&(d=d(t,a)),c=!0),l&&(l.abort(),l=null);const b=$-f;return b>d?(r.set(t=a),!1):(r.set(t=g(p(b/d))),!0)}),n.promise}return{set:o,update:(a,s)=>o(a(i,t),s),subscribe:r.subscribe}}function D1(t,e,r,n){if(typeof r=="number"){const i=n-r,o=(r-e)/(t.dt||1/60),a=(o+(t.opts.stiffness*i-t.opts.damping*o)*t.inv_mass)*t.dt;return Math.abs(a)<t.opts.precision&&Math.abs(i)<t.opts.precision?n:(t.settled=!1,r+a)}if(En(r))return r.map((i,o)=>D1(t,e[o],r[o],n[o]));if(typeof r=="object"){const i={};for(const o in r)i[o]=D1(t,e[o],r[o],n[o]);return i}throw new Error(`Cannot spring ${typeof r} values`)}function hr(t,e={}){const r=ge(t),{stiffness:n=.15,damping:i=.8,precision:o=.01}=e;let a,s,l,c=t,u=t,d=1,p=0,h=!1;function f($,b={}){u=$;const v=l={};if(t==null||b.hard||g.stiffness>=1&&g.damping>=1)return h=!0,a=null,c=$,r.set(t=u),Promise.resolve();if(b.soft&&(p=1/(60*(b.soft===!0?.5:+b.soft)),d=0),!s){a=null,h=!1;const w={inv_mass:void 0,opts:g,settled:!0,dt:void 0};s=h0(S=>{if(a===null&&(a=S),h)return h=!1,s=null,!1;d=Math.min(d+p,1),w.inv_mass=d,w.opts=g,w.settled=!0,w.dt=60*(S-a)/1e3;const P=D1(w,c,t,u);return a=S,c=t,r.set(t=P),w.settled&&(s=null),!w.settled})}return new Promise(w=>{s.promise.then(()=>{v===l&&w()})})}const g={set:f,update:($,b)=>f($(u,t),b),subscribe:r.subscribe,stiffness:n,damping:i,precision:o};return g}var R5=Yl(!1,t=>{const e=window.matchMedia("(prefers-reduced-motion:reduce)"),r=()=>t(e.matches);return r(),e.addListener(r),()=>e.removeListener(r)}),ng=()=>"ResizeObserver"in window;const n1=Os(),ab=(t,e,r,n,i)=>{t.rect||(t.rect=Os());const o=t.rect;Hy(n1,e,r,n,i),pa(o,n1)||(cp(o,n1),t.dispatchEvent(new CustomEvent("measure",{detail:o})))},Sd=Math.round,I5=t=>{const e=t.getBoundingClientRect();Ra&&ab(t,Sd(e.x),Sd(e.y),Sd(e.width),Sd(e.height))},i1=t=>{Ra&&ab(t,t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight)},eu=[];let pl,Ma,Ra;function B1(){eu.length?(eu.forEach(t=>t.measure(t)),Ra=requestAnimationFrame(B1)):Ra=void 0}let kd=new Map([]),Uc=0,o1=0;var Di=(t,e={})=>{const{observePosition:r=!1,observeViewRect:n=!1,once:i=!1,disabled:o=!1,isMeasureRoot:a=!1}=e;if(ng()&&a&&(Ma||(Ma=new ResizeObserver(s=>{s.forEach(c=>{kd.set(c.target,c.contentRect)});const l=Array.from(kd.values()).some(({width:c,height:u})=>c>0&&u>0);l?l&&Ra===!1&&B1():(Ra&&cancelAnimationFrame(Ra),Ra=!1)})),Ma.observe(t),Uc++),!o)return!ng()||r||n?(t.measure=n?I5:i1,eu.push(t),Ra===void 0&&(Ra=requestAnimationFrame(B1)),t.measure(t),{destroy(){a&&Ma&&(kd.delete(t),Ma.unobserve(t),Uc--,Uc===0&&(Ma.disconnect(),Ma=void 0));const s=eu.indexOf(t);eu.splice(s,1),delete t.measure}}):(pl||(pl=new ResizeObserver(s=>{s.forEach(l=>{Ra&&i1(l.target)})})),pl.observe(t),i1(t),i?pl.unobserve(t):o1++,{destroy(){a&&Ma&&(kd.delete(t),Ma.unobserve(t),Uc--,Uc===0&&(Ma.disconnect(),Ma=void 0)),i||(pl.unobserve(t),o1--,o1===0&&(pl.disconnect(),pl=void 0))}})},E5=t=>{let e;const r={pointerdown:()=>{e=!1},keydown:()=>{e=!0},keyup:()=>{e=!1},focus:n=>{e!==!1&&(n.target.dataset.focusVisible="")},blur:n=>{delete n.target.dataset.focusVisible}};return Object.keys(r).forEach(n=>t.addEventListener(n,r[n],!0)),{destroy(){Object.keys(r).forEach(n=>t.removeEventListener(n,r[n],!0))}}};const ig=t=>/^http/.test(t),A5=t=>new Promise((e,r)=>t.kind==="file"?e(t.getAsFile()):t.kind==="string"?t.getAsString(e):void r());var sb=(t,e={})=>{const r=a=>{a.preventDefault()},n=async a=>{a.preventDefault(),a.stopPropagation();try{const s=await(l=>new Promise((c,u)=>{const{items:d}=l.dataTransfer;if(!d)return c([]);const p=Array.from(d).some(f=>f.type==="text/uri-list"),h=Array.from(d).filter(f=>(f.kind==="file"||f.kind==="string")&&f.type!=="text/x-moz-url").map(A5);Promise.all(h).then(f=>{if(p)return c([f.find(ig)].filter(Boolean));const g=f.filter($=>ic($)&&(gu($)||Xs($))||ig($));c(g)}).catch(u)}))(a);t.dispatchEvent(new CustomEvent("dropfiles",{detail:{event:a,resources:s},...e}))}catch{}};function i(){t.removeEventListener("drop",n),t.removeEventListener("dragover",r)}function o(a){const{disabled:s=!1}=a||{};i(),s||(t.addEventListener("drop",n),t.addEventListener("dragover",r))}return o(e),{update:o,destroy(){i()}}};let Td=null;var k0=()=>{if(Td===null)if(ni()){const t=yn("canvas");Td=!dp(t,{failIfMajorPerformanceCaveat:!0}),ti(t)}else Td=!1;return Td},a1=t=>t instanceof WebGLTexture,og=([t,e,r,n])=>[n.x,n.y,t.x,t.y,r.x,r.y,e.x,e.y];function L5(t){let e,r,n,i;return{c(){e=mt("div"),r=mt("canvas"),T(e,"class","PinturaCanvas")},m(o,a){tt(o,e,a),Lt(e,r),t[37](r),n||(i=[Tt(r,"measure",t[38]),Tr(Di.call(null,r))],n=!0)},p:qe,i:qe,o:qe,d(o){o&&J(e),t[37](null),n=!1,Ur(i)}}}function F5(t,e,r){let n,i,o,a,s,l,c;const u=[0,0,0,0],d=dn(),p=ni()&&(Y=>{const it=.5*Y,G=yn("canvas",{"data-retain":!0,width:Y,height:Y}),Bt=G.getContext("2d");return Bt.fillStyle="#f0f",Bt.fillRect(0,0,it,it),Bt.fillRect(it,it,it,it),G})(128),h=ba();let f,{isAnimated:g}=e,{isTransparent:$}=e,{maskRect:b}=e,{maskOpacity:v=1}=e,{maskFrameOpacity:w=.95}=e,{maskMarkupOpacity:S=1}=e,{clipAnnotationsToImage:P=!0}=e,{pixelRatio:M=1}=e,{textPixelRatio:E=M}=e,{backgroundColor:C}=e,{willRender:z=tn}=e,{didRender:V=tn}=e,{willRequest:L}=e,{csp:y}=e,{loadImageData:ct=tn}=e,{enableGrid:j=!1}=e,{gridColors:k}=e,{gridSize:N}=e,{gridOpacity:nt=0}=e,{images:ft=[]}=e,{interfaceImages:xt=[]}=e,{selectionColor:H}=e,Z=null,wt=null,vt=null;const et=(Y,it)=>Y.set(it,{hard:!g}),Pt={precision:1e-4*.01};let Et=0;const kt=S0(void 0,{duration:0});D(t,kt,Y=>r(36,c=Y));const st=hr(1,Pt);D(t,st,Y=>r(35,s=Y));const Ut=hr(1,Pt);D(t,Ut,Y=>r(51,o=Y));const rt=ge();D(t,rt,Y=>r(53,l=Y));const X=ge();D(t,X,Y=>r(52,a=Y));const q={},Ft=(Y,it)=>{let G=q[Y.id];const Bt=Math.min(1,2048/it.width);let ae=G?G.element:yn("canvas",{width:it.width*Bt,height:it.height*Bt,"data-retain":!0});if(!G||((De,we)=>{if(De.total!==we.length)return!0;const Ot=De.last,Ce=we[we.length-1];return Ot.drawMode!==Ce.drawMode||!(!Wo(Ot)||Wo(Ce)&&pa(Ot,Ce))||!(!di(Ot)||di(Ce)&&Ot.x===Ce.x&&Ot.y===Ce.y&&Ot.rx===Ce.rx&&Ot.ry===Ce.ry)||!(!Jn(Ot)||Jn(Ce)&&Ce.points.length===Ot.points.length)})(G,Y.actions)){ae=ae.cloneNode(),((we,Ot,Ce)=>{const{selectionColor:nr=[1,1,1],scalar:lr=1}=Ce||{};let ot=!1;for(const Yt of Ot){const Ve=Yt.drawMode==="subtract";if(Ve&&!ot)continue;we.globalCompositeOperation=Ve?"destination-out":"source-over",we.save(),we.beginPath();const Se=b2(Yt);n2(we,lr,lr),n0(we,Yt.rotation,Se),v2(we,Yt.flipX,Yt.flipY,Se),Yt.width?c0(we,{...Yt,backgroundColor:nr}):Yt.points?E1(we,Object.assign({},Yt,Yt.pathClose?{backgroundColor:nr,strokeColor:[0,0,0,0]}:{strokeColor:nr,strokeJoin:"round",strokeCap:"round"})):Yt.rx&&u0(we,{...Yt,backgroundColor:nr,strokeColor:[0,0,0,0],strokeJoin:"round",strokeCap:"round"}),we.restore(),ot=!0}})(ae.getContext("2d"),Y.actions,{selectionColor:[1,0,1],scalar:Bt});const De=Y.actions.length;q[Y.id]={total:De,last:{...Y.actions[De-1]},element:ae}}return{x:0,y:0,...it,fillColor:Y.color||[1,1,1],backgroundImage:ae}};let zt;const yt=()=>{cancelAnimationFrame(zt),zt=requestAnimationFrame(()=>{Ct=!0,Dr=0,i()})},Dt=new Map([]),Wt=new Map([]),at=(Y,it)=>({filterParam:Y==="pixelated"?Z.textureFilterNearest:Z.textureFilterLinear,wrapParam:it==="repeat"?Z.textureRepeat:Z.textureClamp}),St=(Y,it,G)=>{if(!Dt.has(Y)){Dt.set(Y,Y);const De=at(it,G);if(!Ge(Bt=Y)&&(e2(Bt)||rc(Bt)||oc(Bt)||au(Bt))){const we=Z.textureCreate();Z.textureUpdate(we,Y,De),Dt.set(Y,we)}else ct(Y).then(we=>{if(!Z||!we)return;const Ot=Z.textureCreate();Z.textureUpdate(Ot,we,De),Dt.set(Y,Ot),yt()}).catch(we=>{Dt.set(Y,we)})}var Bt,ae;if(au(Y)&&((ae=Y).currentTime>0&&!ae.paused&&!ae.ended&&ae.readyState>2||Y.dataset.redraw==="true")){const De=Dt.get(Y),we=at(it,G);return Z.textureUpdate(De,Y,we),Y.dataset.redraw=!1,De}return Dt.get(Y)},pt=(Y,it={})=>{const G=it.id||Y.id;if(Y.width&&Y.width<1||Y.height&&Y.height<1||!Y.text.length)return void Wt.delete(G);let{text:Bt,textAlign:ae,fontFamily:De,fontSize:we=16,fontWeight:Ot,fontVariant:Ce,fontStyle:nr,letterSpacing:lr,lineHeight:ot=we,width:Yt,height:Ve}=Y,{outline:Se=0,blur:ee=0,paddingTop:Xe=0,paddingRight:Be=0,paddingBottom:yr=0,paddingLeft:$t=0}=it;Yt=_e(Yt)?Math.floor(Yt):Yt,Ve=_e(Ve)?Math.floor(Ve):Ve;const{textSize:Ae,signature:Gt}=((er="",Er)=>{let{width:fe=0,height:Cr="auto",fontSize:Mr,fontFamily:ir,lineHeight:en,fontWeight:ye,fontStyle:tr,fontVariant:je,letterSpacing:pn}=Er;const wn=Od({text:er,fontFamily:ir,fontWeight:ye,fontStyle:tr,fontVariant:je,fontSize:Mr,lineHeight:en,letterSpacing:pn,width:fe,height:Cr});let sn=cf.get(wn);if(sn)return sn;let Xr=1;Mr>1e3&&Aa()&&(Xr=Mr/1e3,Mr=1e3,en*=Xr);const hn=t0(yn("pre",{contenteditable:"true",spellcheck:"false",style:`${c2}${o0({fontFamily:ir,fontWeight:ye,fontStyle:tr,fontVariant:je,fontSize:Mr,letterSpacing:pn,lineHeight:en})};${a0(er,Er)}"`,innerHTML:er})),li=hn.getBoundingClientRect();return sn={signature:l2(hn).flat().map(kn=>kn.text).join("_;_"),textSize:La(ts(li),kn=>Math.ceil(kn*Xr))},cf.set(wn,sn),hn.remove(),sn})(Bt,{...Y,width:Yt,height:void 0}),me=Od({text:Bt,textAlign:ae,fontFamily:De,fontSize:we,fontWeight:Ot,fontVariant:Ce,fontStyle:nr,lineHeight:ot,letterSpacing:lr,outline:Se,blur:ee,signature:Gt});if(!Dt.has(me)){Dt.set(me,Bt);const er=Math.ceil(Ae.width),Er=Math.ceil(Ae.height);if(er===0||Er===0)return;const fe=v0(),Cr=Math.min(1,(fe-($t+Be)*E)/(er*E),(fe-(Xe+yr)*E)/(Er*E));u2(Bt,{fontSize:we,fontFamily:De,fontWeight:Ot,fontVariant:Ce,fontStyle:nr,letterSpacing:lr,textAlign:ae,lineHeight:ot,width:Yt,height:Ve,imageWidth:er,imageHeight:Er,paddingLeft:$t,paddingTop:Xe,paddingRight:Be,paddingBottom:yr,pixelRatio:E*Cr,willRequest:L,outline:Se,blur:ee,styleNonce:y.styleNonce,color:[1,0,1]}).then(Mr=>{if(!Z)return;const ir=Z.textureCreate();Z.textureUpdate(ir,Mr,{filterParam:Z.textureFilterLinear,wrapParam:Z.textureClamp,scalar:Cr,premultiply:!Aa()}),Dt.set(me,ir),Wt.set(G,ir),yt()}).catch(console.error)}const he=Dt.get(me);return a1(he)?he:Wt.get(G)},Xt=new Map,Zt=Y=>{let it;return Y.backgroundImage?it=St(Y.backgroundImage,Y.backgroundImageRendering,Y.backgroundRepeat==="repeat"?"repeat":void 0):Y.bitmap&&Y.points&&(it=(G=>{const{id:Bt,points:ae,strokeWidth:De,strokeCap:we,strokeJoin:Ot,strokeColor:Ce,strokeDash:nr,pathClose:lr,backgroundColor:ot}=G;let Yt=Dt.get(Bt),Ve=Xt.get(Bt);const Se=Od({points:ae.map(he=>`${he.x},${he.y}`).join(","),strokeWidth:De,strokeCap:we,strokeJoin:Ot,strokeColor:Ce,strokeDash:(nr||[]).join(","),pathClose:lr,backgroundColor:lr?(ot||[]).join(","):void 0});if(Ve){const{hash:he}=Ve;if(Dt.has(Bt)){if(Se===he)return Dt.get(Bt)}else Ve=void 0}if(!Ve){const he=yn("canvas",{width:1,height:1});Ve={canvas:he,hash:void 0},Xt.set(G.id,Ve),Yt=Z.textureCreate(),Z.textureUpdate(Yt,he,{filterParam:Z.textureFilterLinear,wrapParam:Z.textureClamp}),Dt.set(Bt,Yt)}const{canvas:ee}=Ve,Xe=Math.ceil(G.strokeWidth)+2,Be=ri(ae),yr=Math.floor(Be.x-.5*Xe),$t=Math.floor(Be.y-.5*Xe),Ae=Math.ceil(Be.width+Xe),Gt=Math.ceil(Be.height+Xe);ee.width=Math.max(Ae,1),ee.height=Math.max(Gt,1);const me=ee.getContext("2d");return me.clearRect(0,0,ee.width,ee.height),Ae>=1&&Gt>=1&&(me.translate(-yr,-$t),E1(me,G),me.resetTransform()),Z.textureUpdate(Yt,ee,{filterParam:Z.textureFilterLinear,wrapParam:Z.textureClamp}),Xt.set(Bt,{canvas:ee,hash:Se}),Dt.get(Bt)})(Y)),it},ie=({texture:Y,size:it,origin:G,translation:Bt,rotation:ae,scale:De,colorMatrix:we,opacity:Ot,convolutionMatrix:Ce,gamma:nr,vignette:lr,maskFeather:ot,maskCornerRadius:Yt,overlayColor:Ve,enableOverlay:Se,enableManipulation:ee,enableAntialiasing:Xe})=>{let Be=0,yr=0;if(M===1){const $t=Math.abs(1-De)<Number.EPSILON;Be=$t&&wt%2!=0?.5:0,yr=$t&&vt%2!=0?.5:0}return Z.drawImage(Y,it,G.x,G.y,Bt.x+Be,Bt.y+yr,ae.x,ae.y,ae.z,De,we,an(Ot,0,1),Ce,nr,lr,ot,Yt,Ve,Se,ee,Xe),Y},gt=(Y,it,G)=>{const Bt=Lr(it),ae=Lr(Y),De=Bt.x-ae.x,we=Bt.y-ae.y,Ot=qi(Bt,G,ae);return{x:Ot.x-ae.x-De,y:Ot.y-ae.y-we}},te=(Y,it,G)=>{let Bt,ae;const De=ca(G.width,G.height);if(Y.backgroundRepeat==="repeat"&&(Bt={...G},ae={x:0,y:0}),Y.backgroundSize==="contain"){const we=Ki(it,De,it);Bt=bl(we),ae=Y.backgroundPosition?Y.backgroundPosition:lt(.5*(it.width-Bt.width),.5*(it.height-Bt.height))}else if(Y.backgroundSize==="cover"){const we=Zs(it,De,it);Bt=bl(we),Y.backgroundPosition?ae=Y.backgroundPosition:(ae=lt(we.x,we.y),ae=lt(.5*(it.width-Bt.width),.5*(it.height-Bt.height)))}else Y.backgroundSize?(Bt=Y.backgroundSize,ae=Y.backgroundPosition||{x:0,y:0}):Y.backgroundPosition&&(Bt={...G},ae=Y.backgroundPosition);return{backgroundSize:Bt,backgroundPosition:ae}},xe=(Y=[],it)=>{Y.forEach(G=>{let Bt=Zt(G);const ae=G.status!=="complete"&&(G.status==="loading"||G.backgroundImage&&Bt===G.backgroundImage);ae&&yt();const De=G.status==="error"||G.backgroundImage&&Bt instanceof Error;let we=a1(Bt)?Bt:void 0;const Ot=G._scale||1,Ce=G._translate||d,nr=G.strokeWidth&&G.strokeWidth*Ot,lr=G.cornerRadius?((ee,Xe)=>[ee,ee,ee,ee].map(Be=>Be*Xe))(G.cornerRadius,Ot):u,ot=!!G.width,Yt=Ge(G.text),Ve=En(G.points),Se=di(G);if(Ve){const ee=G.points.map(Xe=>lt(Xe.x*Ot+Ce.x,Xe.y*Ot+Ce.y));if(G.bitmap){Bt&&it.push(Bt);const Xe=ri(ee),Be=Math.ceil(G.strokeWidth*Ot)+2;Z.drawRect({x:Math.floor(Xe.x-.5*Be),y:Math.floor(Xe.y-.5*Be),width:Math.ceil(Xe.width+Be),height:Math.ceil(Xe.height+Be)},G.rotation,G.flipX,G.flipY,[0,0,0,0],void 0,we,void 0,void 0,void 0,void 0,void 0,void 0,G.opacity,void 0,void 0,!1,!1)}else Z.drawPath(ee,G.rotation,G.flipX,G.flipY,nr,G.strokeColor,G.pathClose,G.backgroundColor,G.opacity)}else if(Se){let ee=G.x,Xe=G.y;ee*=Ot,Xe*=Ot,ee+=Ce.x,Xe+=Ce.y;const Be=Dd({x:ee,y:Xe,rx:G.rx*Ot,ry:G.ry*Ot}),yr=lt(ee,Xe),$t=we&&Z.textureGetSize(we);let Ae,Gt;if($t&&G.backgroundImage&&(G.backgroundSize||G.backgroundPosition||G.backgroundRepeat)){const me=te(G,Be,$t);Ae=me.backgroundSize,Gt=me.backgroundPosition}if(Z.drawEllipse(yr,G.rx*Ot,G.ry*Ot,G.rotation,G.flipX,G.flipY,G.backgroundColor,we,Ae,Gt,G.backgroundCorners&&og(G.backgroundCorners),nr,G.strokeColor,G.opacity,G.inverted),Bt&&it.push(Bt),ae||De){if(!(G.backgroundColor||G.strokeColor&&G.strokeWidth)){const me=G.opacity||1;Z.drawEllipse(yr,G.rx*Ot,G.ry*Ot,G.rotation,G.flipX,G.flipY,De?[1,.2549,.2118,.25*me]:[0,0,0,.25*me])}De&&Oe(yr),ae&&de(yr)}}else if(Yt){const{fontSize:ee=16}=G,Xe=ee>1e3&&Aa()?ee/1e3:1,Be=Math.max(16,Math.ceil(ee/Xe*.25)),yr=Math.abs(G.rotation)>0,$t=_e(G.width)?Math.floor(G.width):G.width,Ae=_e(G.height)?Math.floor(G.height):G.height,Gt=oo(G.text,{...G,width:$t,height:Ae}),me=Math.ceil(Gt.width),he=Math.ceil(Gt.height),er={x:G.x*Ot+Ce.x,y:G.y*Ot+Ce.y,width:me*Ot,height:he*Ot},Er=!!G.height;(G.backgroundColor||G.strokeColor)&&Z.drawRect(er,G.rotation,G.flipX,G.flipY,lr,G.backgroundColor,void 0,void 0,void 0,!1,void 0,nr,G.strokeColor,G.opacity,void 0,void 0,void 0,G.inverted);const{textShadowX:fe,textShadowY:Cr,textShadowBlur:Mr}=G;if(fe||Cr||Mr){const en=Math.ceil(.5*Mr),ye=Math.max(Be,Er?0:en),tr=pt(G,{id:G.id+"shadow",blur:Mr,paddingTop:ye,paddingRight:ye,paddingBottom:ye,paddingLeft:ye});if(tr&&!G._prerender){it.push(tr);const je=Z.textureGetSize(tr),pn={x:0,y:0},wn={width:je.width/E*Ot,height:je.height/E*Ot},sn=Be*Ot/Xe;let Xr;if(Er)Xr={...er},pn.x=fe-sn,pn.y=Cr-sn;else if(Xr={x:G.x*Ot+Ce.x-sn,y:G.y*Ot+Ce.y-sn,width:wn.width,height:wn.height},yr){const hn=gt(er,Xr,G.rotation);Xr.x+=hn.x,Xr.y+=hn.y;const li=qi(lt(fe,Cr),G.rotation);Xr.x+=li.x,Xr.y+=li.y}else Xr.x+=fe,Xr.y+=Cr;Z.drawRect(Xr,G.rotation,G.flipX,G.flipY,[0,0,0,0],void 0,tr,wn,pn,!1,void 0,void 0,void 0,G.opacity,void 0,0,G.textShadowColor)}}if(G.textOutlineWidth){const en=Math.ceil(.5*G.textOutlineWidth),ye=Be+en,tr=pt(G,{id:G.id+"outline",outline:G.textOutlineWidth,paddingTop:ye,paddingRight:ye,paddingBottom:ye,paddingLeft:ye});if(tr&&!G._prerender){it.push(tr);const je=Z.textureGetSize(tr),pn={x:0,y:0},wn={width:je.width/E*Ot,height:je.height/E*Ot},sn=(Be+en)*Ot/Xe,Xr={x:G.x*Ot+Ce.x-sn,y:G.y*Ot+Ce.y-sn,width:wn.width,height:G.height?he+sn:wn.height};if(yr){const hn=gt(er,Xr,G.rotation);Xr.x+=hn.x,Xr.y+=hn.y}Z.drawRect(Xr,G.rotation,G.flipX,G.flipY,[0,0,0,0],void 0,tr,wn,pn,!1,void 0,void 0,void 0,G.opacity,void 0,0,G.textOutlineColor)}}const ir=pt(G,{id:G.id+"text",paddingTop:Be,paddingRight:Be,paddingBottom:Be,paddingLeft:Be});if(ir&&!G._prerender){it.push(ir);const en=Z.textureGetSize(ir),ye={x:0,y:0},tr={width:en.width/E*Ot,height:en.height/E*Ot},je=Be*Ot/Xe,pn={x:G.x*Ot+Ce.x-je,y:G.y*Ot+Ce.y-je,width:tr.width,height:G.height?he+je:tr.height};if(yr){const sn=gt(er,pn,G.rotation);pn.x+=sn.x,pn.y+=sn.y}const wn=G.color||[0,0,0];G._prerender&&(wn[3]=0),Z.drawRect(pn,G.rotation,G.flipX,G.flipY,u,!1,ir,tr,ye,!1,!1,void 0,void 0,G.opacity,void 0,G.feather,wn,G.inverted)}}else if(ot){Bt&&it.push(Bt);const ee=Ya(G);let Xe,Be;Ce&&(ee.x*=Ot,ee.y*=Ot,ee.x+=Ce.x,ee.y+=Ce.y,ee.width*=Ot,ee.height*=Ot);const{backgroundRepeat:yr="no-repeat"}=G,$t=we&&Z.textureGetSize(we);if($t&&G.backgroundImage&&(G.backgroundSize||G.backgroundPosition||G.backgroundRepeat)){const Ae=te(G,ee,$t);Xe=Ae.backgroundSize,Be=Ae.backgroundPosition}if(Z.drawRect(ee,G.rotation,G.flipX,G.flipY,lr,G.backgroundColor||[0,0,0,0],we,Xe,Be,yr==="repeat",G.backgroundCorners&&og(G.backgroundCorners),nr,G.strokeColor,G.opacity,void 0,G.feather,G.fillColor,G.inverted),ae||De){if(!(G.backgroundColor&&G.backgroundColor[3]!==0||G.strokeColor&&G.strokeWidth)){const Gt=G.opacity||1;Z.drawRect(ee,G.rotation,G.flipX,G.flipY,lr,De?[1,.2549,.2118,.25*Gt]:[0,0,0,.25*Gt])}const Ae=Lr(ee);De&&Oe(Ae),ae&&de(Ae)}}else Bt&&it.push(Bt)})};let _=0;const Kt=[{x:-5,y:-5},{x:5,y:5}],qt=[{x:5,y:-5},{x:-5,y:5}],le=Xd({x:0,y:0},10,10,0,!1,!1,16);le.length=9;const de=Y=>{_=Date.now()/50,Z.drawEllipse(Y,15,15,0,!1,!1,[0,0,0,.5]);const it=$s(le.map(G=>({x:G.x+Y.x,y:G.y+Y.y})),_,Y.x,Y.y);Z.drawPath(it,0,!1,!1,2,[1,1,1])},Oe=Y=>{Z.drawEllipse(Y,13,13,0,!1,!1,[1,.2549,.2118,.75]);const it=Kt.map(Bt=>({x:Bt.x+Y.x,y:Bt.y+Y.y})),G=qt.map(Bt=>({x:Bt.x+Y.x,y:Bt.y+Y.y}));Z.drawPath(it,0,!1,!1,3,[1,1,1]),Z.drawPath(G,0,!1,!1,3,[1,1,1])},rr=(Y,it,G,Bt,ae,De)=>Z.drawRect(it,0,!1,!1,u,u,Y,Bt,G,!0,void 0,0,void 0,De,void 0,void 0,ae);let Ct=!1,pe=!0,ar=!1;const Ke=[],Qe=[],Re=[],Je=Y=>!Y.aboveFrame,ur=Y=>Y.aboveFrame,$r=()=>{Re.length=0;const Y=ft[0],{manipulationShapes:it,manipulationShapesDirty:G,annotationShapes:Bt,annotationShapesDirty:ae,interfaceShapes:De,decorationShapes:we,frameShapes:Ot,selectionShapes:Ce}=z({opacity:Y.opacity,rotation:Y.rotation,scale:Y.scale,images:ft,size:An(wt,vt),backgroundColor:[...c],selectionRect:l}),nr=[...c],lr=l,ot=an(s,0,1),Yt=a,Ve=Math.abs(Y.rotation.x/Math.PI*2-1),Se=Math.abs(Y.rotation.y/Math.PI*2-1),ee=Ve<.99||Se<.99,Xe={...Y.size},Be=Y.backgroundColor,yr=Y.backgroundImage,$t=Y.backgroundFilterMode,Ae=it.length>0,Gt=Bt.length>0,me=Bt.filter(ur).length>0,he=we.filter(ur).length>0,er=Be[3]>0,Er=!!P&&S>=1;if(ot<1&&er){const fe=nr[0],Cr=nr[1],Mr=nr[2],ir=1-ot,en=Be[0]*ir,ye=Be[1]*ir,tr=Be[2]*ir,je=1-ir;nr[0]=en+fe*je,nr[1]=ye+Cr*je,nr[2]=tr+Mr*je,nr[3]=1}if(Z.setCanvasColor($?u:nr),Ae&&(G||Ct)?(Z.disableMask(),Z.drawToImageBlendBuffer(Xe),Ke.length=0,xe(it,Ke)):Ae||(Ke.length=0),Re.push(...Ke),pe&&(Z.drawToImageOverlayBuffer(Xe,E),pe=!1),ee){if(Gt&&(ae||Ct)||!ar){Z.disableMask(),Z.drawToImageOverlayBuffer(Xe,E),Qe.length=0;const fe=me?Bt.filter(Je):Bt;xe(fe,Qe)}else Gt||(Qe.length=0);ar=!0}else ar=!1;if(Z.drawToCanvas(),Z.enableMask(lr,ot),j&&N>=1&&k.length===2&&nt&&((fe,Cr,Mr,ir,en)=>{const ye=An(Cr,Cr),tr=St(p,"pixelated","repeat"),je=lt(-fe.x%Cr,-fe.y%Cr),pn=lt(je.x+.5*ye.width,je.y);rr(tr,fe,je,ye,Mr,en),rr(tr,fe,pn,ye,ir,en)})(lr,N,k[0],k[1],nt),er&&Z.drawRect(lr,0,!1,!1,u,Be),yr){Z.enableMask(lr,1);const fe=Math.max(b.width/yr.width,b.height/yr.height);yr.width*fe,yr.height*fe;const Cr={x:b.x+.5*b.width,y:b.y+.5*b.height},[Mr]=ft,ir=ie({...Mr,vignette:$t==="image"?Mr.vignette:void 0,gamma:$t==="image"?Mr.gamma:void 0,convolutionMatrix:$t==="image"?Mr.convolutionMatrix:void 0,colorMatrix:$t==="image"?Mr.colorMatrix:void 0,size:{width:yr.width,height:yr.height},translation:{x:Cr.x-.5*wt,y:Cr.y-.5*vt},scale:fe,origin:{x:0,y:0},rotation:{x:0,y:0,z:0},enableAntialiasing:!1,texture:St(yr)});Re.push(ir),Z.enableMask(lr,ot)}if(Er&&Z.enablePreviewStencil(),Re.push(...[...ft].reverse().map(fe=>ie({...fe,texture:St(fe.data),enableOverlay:ee&&Gt,enableManipulation:Ae,enableAntialiasing:!0,overlayColor:Yt}))),Z.enableMask(lr,S),!ee){Er&&Z.applyPreviewStencil(),Z.resetCanvasMatrix(),Z.updateCanvasMatrix(Xe,Y.origin,Y.translation,Y.scale,Y.rotation),Qe.length=0;const fe=me?Bt.filter(Je):Bt;xe(fe,Qe),Er&&Z.disablePreviewStencil()}if(Re.push(...Qe),Z.resetCanvasMatrix(),Z.enableMask(lr,S),xe(he?we.filter(Je):we,Re),Ot.length){Z.enableMask(lr,1);const fe=Ot.filter(Mr=>!Mr.expandsCanvas),Cr=Ot.filter(Mr=>Mr.expandsCanvas);fe.length&&xe(fe,Re),Cr.length&&(Z.enableMask({x:lr.x+.5,y:lr.y+.5,width:lr.width-1,height:lr.height-1},o),xe(Cr,Re))}if(me&&(Z.resetCanvasMatrix(),Z.updateCanvasMatrix(Xe,Y.origin,Y.translation,Y.scale,Y.rotation),xe(Bt.filter(ur),Re),Z.resetCanvasMatrix()),he&&(Z.resetCanvasMatrix(),xe(we.filter(ur),Re),Z.resetCanvasMatrix()),H&&Ce.length&&!ee){Z.resetCanvasMatrix(),Z.updateCanvasMatrix(Xe,Y.origin,Y.translation,Y.scale,Y.rotation);const fe=[...H];fe[3]=.5;const Cr=[{id:"selection",color:fe,actions:[...Ce]}].map(Mr=>Ft(Mr,Xe));xe(Cr,Re),Z.resetCanvasMatrix()}Z.disableMask(),xe(De,Re),xt.forEach(fe=>{if(Z.enableMask(fe.mask,fe.maskOpacity),yr){const Mr=ie({...fe,vignette:$t==="image"?fe.vignette:void 0,gamma:$t==="image"?fe.gamma:void 0,convolutionMatrix:$t==="image"?fe.convolutionMatrix:void 0,colorMatrix:$t==="image"?fe.colorMatrix:void 0,texture:St(yr),enableAntialiasing:!1,translation:{x:fe.translation.x+fe.offset.x-.5*wt,y:fe.translation.y+fe.offset.y-.5*vt}});Re.push(Mr)}else fe.backgroundColor&&Z.drawRect(fe.mask,0,!1,!1,fe.maskCornerRadius,fe.backgroundColor,void 0,void 0,void 0,void 0,void 0,void 0,void 0,fe.opacity,fe.maskFeather);const Cr=ie({...fe,texture:St(fe.data),enableAntialiasing:!1,translation:{x:fe.translation.x+fe.offset.x-.5*wt,y:fe.translation.y+fe.offset.y-.5*vt}});Re.push(Cr)}),Z.disableMask(),(fe=>{Dt.forEach((Cr,Mr)=>{!fe.find(ir=>ir===Cr)&&a1(Cr)&&(Array.from(Wt.values()).includes(Cr)||(Dt.delete(Mr),Z.textureDelete(Cr)))})})(Re),V(),Ct=!1};let zr,Dr=0;const dr=()=>{clearTimeout(zr);const Y=Date.now();Y-Dr<48?zr=setTimeout(dr,48):(Dr=Y,$r())};return A2(()=>i()),xs(()=>r(31,Z=ob(f,{alpha:$}))),jo(()=>{Z&&(Xt.forEach(({canvas:Y})=>ti(Y)),Xt.clear(),Z.release(),r(31,Z=void 0),r(0,f=void 0))}),t.$$set=Y=>{"isAnimated"in Y&&r(9,g=Y.isAnimated),"isTransparent"in Y&&r(10,$=Y.isTransparent),"maskRect"in Y&&r(11,b=Y.maskRect),"maskOpacity"in Y&&r(12,v=Y.maskOpacity),"maskFrameOpacity"in Y&&r(13,w=Y.maskFrameOpacity),"maskMarkupOpacity"in Y&&r(14,S=Y.maskMarkupOpacity),"clipAnnotationsToImage"in Y&&r(15,P=Y.clipAnnotationsToImage),"pixelRatio"in Y&&r(16,M=Y.pixelRatio),"textPixelRatio"in Y&&r(17,E=Y.textPixelRatio),"backgroundColor"in Y&&r(18,C=Y.backgroundColor),"willRender"in Y&&r(19,z=Y.willRender),"didRender"in Y&&r(20,V=Y.didRender),"willRequest"in Y&&r(21,L=Y.willRequest),"csp"in Y&&r(22,y=Y.csp),"loadImageData"in Y&&r(23,ct=Y.loadImageData),"enableGrid"in Y&&r(24,j=Y.enableGrid),"gridColors"in Y&&r(25,k=Y.gridColors),"gridSize"in Y&&r(26,N=Y.gridSize),"gridOpacity"in Y&&r(27,nt=Y.gridOpacity),"images"in Y&&r(28,ft=Y.images),"interfaceImages"in Y&&r(29,xt=Y.interfaceImages),"selectionColor"in Y&&r(30,H=Y.selectionColor)},t.$$.update=()=>{if(1&t.$$.dirty[0]&&f){const Y=getComputedStyle(f).getPropertyValue("--color-transition-duration");r(32,Et=(it=>{let G=parseFloat(it);return/^[0-9]+s$/.test(it)?1e3*G:G})(Y))}262656&t.$$.dirty[0]|2&t.$$.dirty[1]&&C&&kt.set(C,{duration:g?Et:0}),4096&t.$$.dirty[0]&&et(st,_e(v)?v:1),8192&t.$$.dirty[0]&&et(Ut,_e(w)?w:1),2048&t.$$.dirty[0]&&b&&rt.set(b),48&t.$$.dirty[1]&&c&&X.set([c[0],c[1],c[2],an(s,0,1)]),268435462&t.$$.dirty[0]|1&t.$$.dirty[1]&&r(34,n=!!(Z&&wt&&vt&&ft.length)),65542&t.$$.dirty[0]|1&t.$$.dirty[1]&&wt&&vt&&Z&&(Dr=0,Z.resize(wt,vt,M)),8&t.$$.dirty[1]&&r(33,i=n?k0()?dr:$r:se),12&t.$$.dirty[1]&&n&&i&&i()},[f,wt,vt,h,kt,st,Ut,rt,X,g,$,b,v,w,S,P,M,E,C,z,V,L,y,ct,j,k,N,nt,ft,xt,H,Z,Et,i,n,s,c,function(Y){jr[Y?"unshift":"push"](()=>{f=Y,r(0,f)})},Y=>{r(1,wt=Y.detail.width),r(2,vt=Y.detail.height),h("measure",{width:wt,height:vt})}]}class z5 extends gr{constructor(e){super(),fr(this,e,F5,L5,cr,{isAnimated:9,isTransparent:10,maskRect:11,maskOpacity:12,maskFrameOpacity:13,maskMarkupOpacity:14,clipAnnotationsToImage:15,pixelRatio:16,textPixelRatio:17,backgroundColor:18,willRender:19,didRender:20,willRequest:21,csp:22,loadImageData:23,enableGrid:24,gridColors:25,gridSize:26,gridOpacity:27,images:28,interfaceImages:29,selectionColor:30},null,[-1,-1,-1])}}var br=(t,e=Boolean,r=" ")=>t.filter(e).join(r);function ag(t,e,r){const n=t.slice();return n[17]=e[r],n}const D5=t=>({tab:4&t}),sg=t=>({tab:t[17]});function lg(t){let e,r,n,i=[],o=new Map,a=t[2];const s=l=>l[17].id;for(let l=0;l<a.length;l+=1){let c=ag(t,a,l),u=s(c);o.set(u,i[l]=cg(u,c))}return{c(){e=mt("div");for(let l=0;l<i.length;l+=1)i[l].c();T(e,"class",r=br(["PinturaTabList",t[0]])),T(e,"role","tablist"),T(e,"data-layout",t[1])},m(l,c){tt(l,e,c);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);t[14](e),n=!0},p(l,c){1124&c&&(a=l[2],Fe(),i=es(i,c,s,1,l,a,o,e,Ys,cg,null,ag),ze()),(!n||1&c&&r!==(r=br(["PinturaTabList",l[0]])))&&T(e,"class",r),(!n||2&c)&&T(e,"data-layout",l[1])},i(l){if(!n){for(let c=0;c<a.length;c+=1)I(i[c]);n=!0}},o(l){for(let c=0;c<i.length;c+=1)B(i[c]);n=!1},d(l){l&&J(e);for(let c=0;c<i.length;c+=1)i[c].d();t[14](null)}}}function cg(t,e){let r,n,i,o,a,s,l,c,u,d;const p=e[11].default,h=yi(p,e,e[10],sg);function f(...$){return e[12](e[17],...$)}function g(...$){return e[13](e[17],...$)}return{key:t,first:null,c(){r=mt("button"),h&&h.c(),n=ue(),T(r,"role","tab"),T(r,"title",i=e[17].title),T(r,"id",o=e[17].tabId),T(r,"aria-controls",a=e[17].href.substring(1)),T(r,"aria-selected",s=e[17].selected),r.disabled=l=e[17].disabled,T(r,"type","button"),this.first=r},m($,b){tt($,r,b),h&&h.m(r,null),Lt(r,n),c=!0,u||(d=[Tt(r,"keydown",f),Tt(r,"click",g)],u=!0)},p($,b){e=$,h&&h.p&&(!c||1028&b)&&xi(h,p,e,e[10],c?bi(p,e[10],b,D5):vi(e[10]),sg),(!c||4&b&&i!==(i=e[17].title))&&T(r,"title",i),(!c||4&b&&o!==(o=e[17].tabId))&&T(r,"id",o),(!c||4&b&&a!==(a=e[17].href.substring(1)))&&T(r,"aria-controls",a),(!c||4&b&&s!==(s=e[17].selected))&&T(r,"aria-selected",s),(!c||4&b&&l!==(l=e[17].disabled))&&(r.disabled=l)},i($){c||(I(h,$),c=!0)},o($){B(h,$),c=!1},d($){$&&J(r),h&&h.d($),u=!1,Ur(d)}}}function B5(t){let e,r,n=t[4]&&lg(t);return{c(){n&&n.c(),e=Dn()},m(i,o){n&&n.m(i,o),tt(i,e,o),r=!0},p(i,[o]){i[4]?n?(n.p(i,o),16&o&&I(n,1)):(n=lg(i),n.c(),I(n,1),n.m(e.parentNode,e)):n&&(Fe(),B(n,1,1,()=>{n=null}),ze())},i(i){r||(I(n),r=!0)},o(i){B(n),r=!1},d(i){n&&n.d(i),i&&J(e)}}}function O5(t,e,r){let n,i,o,{$$slots:a={},$$scope:s}=e,{class:l}=e,{name:c}=e,{selected:u}=e,{tabs:d=[]}=e,{layout:p}=e;const h=ba(),f=b=>{const v=o.querySelectorAll('[role="tab"] button')[b];v&&v.focus()},g=(b,v)=>{b.preventDefault(),b.stopPropagation(),Fa()&&b.target.focus(),h("select",v)},$=({key:b},v)=>{if(!/arrow/i.test(b))return;const w=d.findIndex(S=>S.id===v);return/right|down/i.test(b)?f(w<d.length-1?w+1:0):/left|up/i.test(b)?f(w>0?w-1:d.length-1):void 0};return t.$$set=b=>{"class"in b&&r(0,l=b.class),"name"in b&&r(7,c=b.name),"selected"in b&&r(8,u=b.selected),"tabs"in b&&r(9,d=b.tabs),"layout"in b&&r(1,p=b.layout),"$$scope"in b&&r(10,s=b.$$scope)},t.$$.update=()=>{896&t.$$.dirty&&r(2,n=d.map(b=>{const v=b.id===u;return{...b,tabId:`tab-${c}-${b.id}`,href:`#panel-${c}-${b.id}`,selected:v}})),4&t.$$.dirty&&r(4,i=n.length>1)},[l,p,n,o,i,g,$,c,u,d,s,a,(b,v)=>$(v,b.id),(b,v)=>g(v,b.id),function(b){jr[b?"unshift":"push"](()=>{o=b,r(3,o)})}]}class pp extends gr{constructor(e){super(),fr(this,e,O5,B5,cr,{class:0,name:7,selected:8,tabs:9,layout:1})}}var vs=(t,e)=>{if(!e)return;const r=n=>{Iy(t,n)};return r(e),{update:r}};const W5=t=>({panel:16&t}),ug=t=>({panel:t[4][0].id,panelIsActive:!0});function dg(t,e,r){const n=t.slice();return n[14]=e[r].id,n[15]=e[r].shouldDraw,n[16]=e[r].panelId,n[17]=e[r].labelledBy,n[18]=e[r].isActive,n[19]=e[r].hidden,n[3]=e[r].visible,n}const _5=t=>({panel:16&t,panelIsActive:16&t}),pg=t=>({panel:t[14],panelIsActive:t[18]});function V5(t){let e,r,n,i,o,a,s;const l=t[11].default,c=yi(l,t,t[10],ug);return{c(){e=mt("div"),r=mt("div"),c&&c.c(),T(r,"class",n=br([t[1]])),T(e,"class",t[0])},m(u,d){tt(u,e,d),Lt(e,r),c&&c.m(r,null),o=!0,a||(s=[Tr(i=vs.call(null,e,t[2])),Tt(e,"measure",t[13]),Tr(Di.call(null,e))],a=!0)},p(u,d){c&&c.p&&(!o||1040&d)&&xi(c,l,u,u[10],o?bi(l,u[10],d,W5):vi(u[10]),ug),(!o||2&d&&n!==(n=br([u[1]])))&&T(r,"class",n),(!o||1&d)&&T(e,"class",u[0]),i&&kr(i.update)&&4&d&&i.update.call(null,u[2])},i(u){o||(I(c,u),o=!0)},o(u){B(c,u),o=!1},d(u){u&&J(e),c&&c.d(u),a=!1,Ur(s)}}}function N5(t){let e,r,n,i,o,a,s=[],l=new Map,c=t[4];const u=d=>d[14];for(let d=0;d<c.length;d+=1){let p=dg(t,c,d),h=u(p);l.set(h,s[d]=mg(h,p))}return{c(){e=mt("div");for(let d=0;d<s.length;d+=1)s[d].c();T(e,"class",r=br(["PinturaTabPanels",t[0]]))},m(d,p){tt(d,e,p);for(let h=0;h<s.length;h+=1)s[h]&&s[h].m(e,null);i=!0,o||(a=[Tr(n=vs.call(null,e,t[2])),Tt(e,"measure",t[12]),Tr(Di.call(null,e,{observePosition:!0}))],o=!0)},p(d,p){1042&p&&(c=d[4],Fe(),s=es(s,p,u,1,d,c,l,e,Ys,mg,null,dg),ze()),(!i||1&p&&r!==(r=br(["PinturaTabPanels",d[0]])))&&T(e,"class",r),n&&kr(n.update)&&4&p&&n.update.call(null,d[2])},i(d){if(!i){for(let p=0;p<c.length;p+=1)I(s[p]);i=!0}},o(d){for(let p=0;p<s.length;p+=1)B(s[p]);i=!1},d(d){d&&J(e);for(let p=0;p<s.length;p+=1)s[p].d();o=!1,Ur(a)}}}function hg(t){let e;const r=t[11].default,n=yi(r,t,t[10],pg);return{c(){n&&n.c()},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||1040&o)&&xi(n,r,i,i[10],e?bi(r,i[10],o,_5):vi(i[10]),pg)},i(i){e||(I(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function mg(t,e){let r,n,i,o,a,s,l,c,u=e[15]&&hg(e);return{key:t,first:null,c(){r=mt("div"),u&&u.c(),n=ue(),T(r,"id",i=e[16]),T(r,"class",o=br(["PinturaTabPanel",e[1]])),T(r,"aria-hidden",a=e[19]),T(r,"aria-labelledby",s=e[17]),T(r,"data-inert",l=!e[3]),T(r,"role","tabpanel"),this.first=r},m(d,p){tt(d,r,p),u&&u.m(r,null),Lt(r,n),c=!0},p(d,p){(e=d)[15]?u?(u.p(e,p),16&p&&I(u,1)):(u=hg(e),u.c(),I(u,1),u.m(r,n)):u&&(Fe(),B(u,1,1,()=>{u=null}),ze()),(!c||16&p&&i!==(i=e[16]))&&T(r,"id",i),(!c||2&p&&o!==(o=br(["PinturaTabPanel",e[1]])))&&T(r,"class",o),(!c||16&p&&a!==(a=e[19]))&&T(r,"aria-hidden",a),(!c||16&p&&s!==(s=e[17]))&&T(r,"aria-labelledby",s),(!c||16&p&&l!==(l=!e[3]))&&T(r,"data-inert",l)},i(d){c||(I(u),c=!0)},o(d){B(u),c=!1},d(d){d&&J(r),u&&u.d()}}}function H5(t){let e,r,n,i;const o=[N5,V5],a=[];function s(l,c){return l[5]?0:1}return e=s(t),r=a[e]=o[e](t),{c(){r.c(),n=Dn()},m(l,c){a[e].m(l,c),tt(l,n,c),i=!0},p(l,[c]){let u=e;e=s(l),e===u?a[e].p(l,c):(Fe(),B(a[u],1,1,()=>{a[u]=null}),ze(),r=a[e],r?r.p(l,c):(r=a[e]=o[e](l),r.c()),I(r,1),r.m(n.parentNode,n))},i(l){i||(I(r),i=!0)},o(l){B(r),i=!1},d(l){a[e].d(l),l&&J(n)}}}function j5(t,e,r){let n,i,{$$slots:o={},$$scope:a}=e,{class:s}=e,{name:l}=e,{selected:c}=e,{panelClass:u}=e,{panels:d=[]}=e,{visible:p}=e,{style:h}=e;const f={};return t.$$set=g=>{"class"in g&&r(0,s=g.class),"name"in g&&r(6,l=g.name),"selected"in g&&r(7,c=g.selected),"panelClass"in g&&r(1,u=g.panelClass),"panels"in g&&r(8,d=g.panels),"visible"in g&&r(3,p=g.visible),"style"in g&&r(2,h=g.style),"$$scope"in g&&r(10,a=g.$$scope)},t.$$.update=()=>{968&t.$$.dirty&&r(4,n=d.map(g=>{const $=g===c;$&&r(9,f[g]=!0,f);const b=p?p.indexOf(g)!==-1:$;return{id:g,panelId:`panel-${l}-${g}`,labelledBy:`tab-${l}-${g}`,isActive:$,hidden:!$,visible:b,shouldDraw:$||f[g]}})),16&t.$$.dirty&&r(5,i=n.length>1)},[s,u,h,p,n,i,l,c,d,f,a,o,function(g){Ji.call(this,t,g)},function(g){Ji.call(this,t,g)}]}class hp extends gr{constructor(e){super(),fr(this,e,j5,H5,cr,{class:0,name:6,selected:7,panelClass:1,panels:8,visible:3,style:2})}}var T0=t=>{const e=Object.getOwnPropertyDescriptors(t.prototype);return Object.keys(e).filter(r=>!!e[r].get)};function fg(t){let e,r,n,i;const o=[t[5],{locale:t[1]}];function a(c){t[22](c)}var s=t[10];function l(c){let u={};for(let d=0;d<o.length;d+=1)u=_n(u,o[d]);return c[3]!==void 0&&(u.name=c[3]),{props:u}}return s&&(e=tp(s,l(t)),jr.push(()=>Ro(e,"name",a)),t[23](e),e.$on("measure",t[11])),{c(){e&&Ht(e.$$.fragment),n=Dn()},m(c,u){e&&Vt(e,c,u),tt(c,n,u),i=!0},p(c,u){const d=34&u[0]?zi(o,[32&u[0]&&Gi(c[5]),2&u[0]&&{locale:c[1]}]):{};if(!r&&8&u[0]&&(r=!0,d.name=c[3],No(()=>r=!1)),s!==(s=c[10])){if(e){Fe();const p=e;B(p.$$.fragment,1,0,()=>{Nt(p,1)}),ze()}s?(e=tp(s,l(c)),jr.push(()=>Ro(e,"name",a)),c[23](e),e.$on("measure",c[11]),Ht(e.$$.fragment),I(e.$$.fragment,1),Vt(e,n.parentNode,n)):e=null}else s&&e.$set(d)},i(c){i||(e&&I(e.$$.fragment,c),i=!0)},o(c){e&&B(e.$$.fragment,c),i=!1},d(c){t[23](null),c&&J(n),e&&Nt(e,c)}}}function U5(t){let e,r,n,i=t[6]&&fg(t);return{c(){e=mt("div"),i&&i.c(),T(e,"data-util",t[3]),T(e,"class",r=br(["PinturaUtilPanel",t[2]])),Mt(e,"opacity",t[7])},m(o,a){tt(o,e,a),i&&i.m(e,null),t[24](e),n=!0},p(o,a){o[6]?i?(i.p(o,a),64&a[0]&&I(i,1)):(i=fg(o),i.c(),I(i,1),i.m(e,null)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze()),(!n||8&a[0])&&T(e,"data-util",o[3]),(!n||4&a[0]&&r!==(r=br(["PinturaUtilPanel",o[2]])))&&T(e,"class",r),128&a[0]&&Mt(e,"opacity",o[7])},i(o){n||(I(i),n=!0)},o(o){B(i),n=!1},d(o){o&&J(e),i&&i.d(),t[24](null)}}}function G5(t,e,r){let n,i,o,a,s;const l=ba();let{isActive:c=!0}=e,{stores:u}=e,{view:d}=e,{props:p}=e,{component:h}=e,{locale:f}=e,{class:g}=e;const $=$n("isAnimated");let b;D(t,$,N=>r(21,s=N));const v=hr(0),w=Hr(v,N=>an(N,0,1));D(t,w,N=>r(20,a=N));let S=!c;const P=ge(c),M={isActive:Hr(P,async(N,nt)=>{if(!N)return nt(N);await z2(),nt(N)},!1),isActiveFraction:Hr(w,N=>N),isVisible:Hr(w,N=>N>0)},E=d,C=T0(E),z=Object.keys(p||{}).reduce((N,nt)=>(C.includes(nt)&&(N[nt]=p[nt]),N),{}),V=Object.keys(M).reduce((N,nt)=>(C.includes(nt)&&(N[nt]=M[nt]),N),{});let L,y;const ct=N=>{r(17,b={...N.detail}),k&&c&&l("measure",{...b})};go("measurable",Di);const j=kl().$$.context;let k=!1;return xs(()=>{if(r(19,k=!0),o)return;r(0,h=new E({target:y,props:{...i,locale:f},context:j})),r(3,L=h.name);const N=h.$on("measure",ct);return()=>{N(),h.$destroy()}}),t.$$set=N=>{"isActive"in N&&r(12,c=N.isActive),"stores"in N&&r(13,u=N.stores),"view"in N&&r(14,d=N.view),"props"in N&&r(15,p=N.props),"component"in N&&r(0,h=N.component),"locale"in N&&r(1,f=N.locale),"class"in N&&r(2,g=N.class)},t.$$.update=()=>{135169&t.$$.dirty[0]&&b&&c&&h&&l("measure",b),2101248&t.$$.dirty[0]&&v.set(c?1:0,{hard:s===!1}),1310720&t.$$.dirty[0]&&(a<=0&&!S?r(18,S=!0):a>0&&S&&r(18,S=!1)),786432&t.$$.dirty[0]&&k&&l(S?"hide":"show"),1048576&t.$$.dirty[0]&&l("fade",a),1048576&t.$$.dirty[0]&&r(7,n=a),4096&t.$$.dirty[0]&&P.set(c),8192&t.$$.dirty[0]&&r(5,i={...z,...V,stores:u})},r(6,o=!C.includes("external")),[h,f,g,L,y,i,o,n,$,w,E,ct,c,u,d,p,v,b,S,k,a,s,function(N){L=N,r(3,L)},function(N){jr[N?"unshift":"push"](()=>{h=N,r(0,h)})},function(N){jr[N?"unshift":"push"](()=>{y=N,r(4,y)})}]}class lb extends gr{constructor(e){super(),fr(this,e,G5,U5,cr,{isActive:12,stores:13,view:14,props:15,component:0,locale:1,class:2,opacity:16},null,[-1,-1])}get opacity(){return this.$$.ctx[16]}}function Z5(t){let e,r,n,i,o,a;const s=t[5].default,l=yi(s,t,t[4],null);return{c(){e=Li("svg"),l&&l.c(),T(e,"class",t[3]),T(e,"width",t[0]),T(e,"height",t[1]),T(e,"viewBox",r="0 0 "+t[0]+`
    `+t[1]),T(e,"xmlns","http://www.w3.org/2000/svg"),T(e,"aria-hidden","true"),T(e,"focusable","false"),T(e,"stroke-linecap","round"),T(e,"stroke-linejoin","round")},m(c,u){tt(c,e,u),l&&l.m(e,null),i=!0,o||(a=Tr(n=vs.call(null,e,t[2])),o=!0)},p(c,[u]){l&&l.p&&(!i||16&u)&&xi(l,s,c,c[4],i?bi(s,c[4],u,null):vi(c[4]),null),(!i||8&u)&&T(e,"class",c[3]),(!i||1&u)&&T(e,"width",c[0]),(!i||2&u)&&T(e,"height",c[1]),(!i||3&u&&r!==(r="0 0 "+c[0]+`
    `+c[1]))&&T(e,"viewBox",r),n&&kr(n.update)&&4&u&&n.update.call(null,c[2])},i(c){i||(I(l,c),i=!0)},o(c){B(l,c),i=!1},d(c){c&&J(e),l&&l.d(c),o=!1,a()}}}function X5(t,e,r){let{$$slots:n={},$$scope:i}=e,{width:o=24}=e,{height:a=24}=e,{style:s}=e,{class:l}=e;return t.$$set=c=>{"width"in c&&r(0,o=c.width),"height"in c&&r(1,a=c.height),"style"in c&&r(2,s=c.style),"class"in c&&r(3,l=c.class),"$$scope"in c&&r(4,i=c.$$scope)},[o,a,s,l,i,n]}class Ho extends gr{constructor(e){super(),fr(this,e,X5,Z5,cr,{width:0,height:1,style:2,class:3})}}var cb=(t,e)=>e===t.target||e.contains(t.target),rp=(t,e,r)=>{const n=Ge(e)?e:t;return r?`${n} (${i=r,i.map(o=>o==="CMD"?su()?"â":"Ctrl":o).join("+")})`:n;var i};const{document:gg}=m0;function Y5(t){let e,r,n,i;return{c(){e=ue(),r=mt("button"),T(r,"class","PinturaImageButton"),T(r,"type","button"),T(r,"title",t[1]),r.disabled=t[2]},m(o,a){tt(o,e,a),tt(o,r,a),r.innerHTML=t[0],t[11](r),n||(i=[Tt(gg.body,"load",t[5],!0),Tt(gg.body,"error",t[6],!0),Tt(r,"pointerdown",t[4])],n=!0)},p(o,[a]){1&a&&(r.innerHTML=o[0]),2&a&&T(r,"title",o[1]),4&a&&(r.disabled=o[2])},i:qe,o:qe,d(o){o&&J(e),o&&J(r),t[11](null),n=!1,Ur(i)}}}function q5(t,e,r){let n,{html:i}=e,{title:o}=e,{onclick:a}=e,{disabled:s=!1}=e,{ongrab:l=se}=e,{ondrag:c=se}=e,{ondrop:u=se}=e;const d=$=>Po(p,lt($.pageX,$.pageY))<256;let p;const h=$=>{document.documentElement.removeEventListener("pointermove",f),document.documentElement.removeEventListener("pointerup",h);const b=lt($.pageX,$.pageY);if(Po(p,b)<32)return a($);d($)||u($)},f=$=>{d($)||c($)},g=$=>n&&n.contains($)&&$.nodeName==="IMG";return t.$$set=$=>{"html"in $&&r(0,i=$.html),"title"in $&&r(1,o=$.title),"onclick"in $&&r(7,a=$.onclick),"disabled"in $&&r(2,s=$.disabled),"ongrab"in $&&r(8,l=$.ongrab),"ondrag"in $&&r(9,c=$.ondrag),"ondrop"in $&&r(10,u=$.ondrop)},t.$$.update=()=>{8&t.$$.dirty&&n&&n.querySelector("img")&&r(3,n.dataset.loader=!0,n)},[i,o,s,n,$=>{p=lt($.pageX,$.pageY),l($),document.documentElement.addEventListener("pointermove",f),document.documentElement.addEventListener("pointerup",h)},({target:$})=>{g($)&&r(3,n.dataset.load=!0,n)},({target:$})=>{g($)&&r(3,n.dataset.error=!0,n)},a,l,c,u,function($){jr[$?"unshift":"push"](()=>{n=$,r(3,n)})}]}class ub extends gr{constructor(e){super(),fr(this,e,q5,Y5,cr,{html:0,title:1,onclick:7,disabled:2,ongrab:8,ondrag:9,ondrop:10})}}function $g(t,e,r){const n=t.slice();return n[13]=e[r],n}function yg(t,e){let r,n,i,o,a,s,l;function c(){return e[9](e[13])}function u(...h){return e[10](e[13],...h)}function d(...h){return e[11](e[13],...h)}function p(...h){return e[12](e[13],...h)}return n=new ub({props:{onclick:c,ongrab:u,ondrag:d,ondrop:p,disabled:e[1]||e[13].disabled,title:e[13].title,html:e[13].thumb}}),{key:t,first:null,c(){r=mt("li"),Ht(n.$$.fragment),i=ue(),Mt(r,"opacity",e[6]),this.first=r},m(h,f){tt(h,r,f),Vt(n,r,null),Lt(r,i),a=!0,s||(l=Tr(o=e[8].call(null,r,e[13])),s=!0)},p(h,f){e=h;const g={};5&f&&(g.onclick=c),9&f&&(g.ongrab=u),17&f&&(g.ondrag=d),33&f&&(g.ondrop=p),3&f&&(g.disabled=e[1]||e[13].disabled),1&f&&(g.title=e[13].title),1&f&&(g.html=e[13].thumb),n.$set(g),o&&kr(o.update)&&1&f&&o.update.call(null,e[13]),64&f&&Mt(r,"opacity",e[6])},i(h){a||(I(n.$$.fragment,h),a=!0)},o(h){B(n.$$.fragment,h),a=!1},d(h){h&&J(r),Nt(n),s=!1,l()}}}function K5(t){let e,r,n=[],i=new Map,o=t[0];const a=s=>s[13].id;for(let s=0;s<o.length;s+=1){let l=$g(t,o,s),c=a(l);i.set(c,n[s]=yg(c,l))}return{c(){e=mt("ul");for(let s=0;s<n.length;s+=1)n[s].c();T(e,"class","PinturaImageButtonList")},m(s,l){tt(s,e,l);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(e,null);r=!0},p(s,[l]){127&l&&(o=s[0],Fe(),n=es(n,l,a,1,s,o,i,e,Ys,yg,null,$g),ze())},i(s){if(!r){for(let l=0;l<o.length;l+=1)I(n[l]);r=!0}},o(s){for(let l=0;l<n.length;l+=1)B(n[l]);r=!1},d(s){s&&J(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function J5(t,e,r){let n,{items:i}=e,{disabled:o}=e,{onclickitem:a}=e,{ongrabitem:s}=e,{ondragitem:l}=e,{ondropitem:c}=e;const u=hr(0,{stiffness:.25,damping:.9});return D(t,u,d=>r(6,n=d)),xs(()=>u.set(1)),t.$$set=d=>{"items"in d&&r(0,i=d.items),"disabled"in d&&r(1,o=d.disabled),"onclickitem"in d&&r(2,a=d.onclickitem),"ongrabitem"in d&&r(3,s=d.ongrabitem),"ondragitem"in d&&r(4,l=d.ondragitem),"ondropitem"in d&&r(5,c=d.ondropitem)},[i,o,a,s,l,c,n,u,(d,p)=>p.mount&&p.mount(d.firstChild,p),d=>a(d.id),(d,p)=>s&&s(d.id,p),(d,p)=>l&&l(d.id,p),(d,p)=>c&&c(d.id,p)]}class C0 extends gr{constructor(e){super(),fr(this,e,J5,K5,cr,{items:0,disabled:1,onclickitem:2,ongrabitem:3,ondragitem:4,ondropitem:5})}}var qc=()=>ni()&&window.devicePixelRatio||1;let s1=null;var du=t=>(s1===null&&(s1=qc()===1?Math.round:e=>e),s1(t)),O1=(t,e={})=>{if(t){if(e.preventScroll&&Fa()){const r=document.body.scrollTop;return t.focus(),void(document.body.scrollTop=r)}t.focus(e)}},db=t=>/date|email|number|search|text|url/.test(t.type),Ja=t=>(e=>/textarea/i.test(e.nodeName))(t)||db(t)||t.isContentEditable;const Q5=t=>({}),bg=t=>({}),t4=t=>({}),xg=t=>({});function e4(t){let e,r;const n=[t[7]];let i={$$slots:{default:[n4]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new ks({props:i}),t[53](e),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=128&a[0]?zi(n,[Gi(o[7])]):{};67108864&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){t[53](null),Nt(e,o)}}}function r4(t){let e,r;const n=[t[7]];let i={};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new ks({props:i}),t[52](e),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=128&a[0]?zi(n,[Gi(o[7])]):{};e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){t[52](null),Nt(e,o)}}}function n4(t){let e;const r=t[51].label,n=yi(r,t,t[57],xg);return{c(){n&&n.c()},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||67108864&o[1])&&xi(n,r,i,i[57],e?bi(r,i[57],o,t4):vi(i[57]),xg)},i(i){e||(I(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function vg(t){let e,r,n,i,o,a,s;const l=t[51].details,c=yi(l,t,t[57],bg);return{c(){e=mt("div"),c&&c.c(),r=ue(),n=mt("span"),T(n,"class","PinturaPanelTip"),T(n,"data-top",t[10]),Mt(n,"opacity",t[14]),Mt(n,"transform",t[13]),Mt(n,"top",t[12]),Mt(n,"left",t[11]),T(e,"class",i=br(["PinturaPanel","pintura-editor-panel",t[2]])),T(e,"tabindex","-1"),Mt(e,"opacity",t[18]),Mt(e,"pointer-events",t[17]),Mt(e,"transform",t[16]),Mt(e,"--panel-max-height",t[15])},m(u,d){tt(u,e,d),c&&c.m(e,null),Lt(e,r),Lt(e,n),t[54](e),o=!0,a||(s=[Tt(e,"close",t[55]),Tt(e,"keydown",t[25]),Tt(e,"measure",t[56]),Tr(Di.call(null,e))],a=!0)},p(u,d){c&&c.p&&(!o||67108864&d[1])&&xi(c,l,u,u[57],o?bi(l,u[57],d,Q5):vi(u[57]),bg),(!o||1024&d[0])&&T(n,"data-top",u[10]),16384&d[0]&&Mt(n,"opacity",u[14]),8192&d[0]&&Mt(n,"transform",u[13]),4096&d[0]&&Mt(n,"top",u[12]),2048&d[0]&&Mt(n,"left",u[11]),(!o||4&d[0]&&i!==(i=br(["PinturaPanel","pintura-editor-panel",u[2]])))&&T(e,"class",i),262144&d[0]&&Mt(e,"opacity",u[18]),131072&d[0]&&Mt(e,"pointer-events",u[17]),65536&d[0]&&Mt(e,"transform",u[16]),32768&d[0]&&Mt(e,"--panel-max-height",u[15])},i(u){o||(I(c,u),o=!0)},o(u){B(c,u),o=!1},d(u){u&&J(e),c&&c.d(u),t[54](null),a=!1,Ur(s)}}}function i4(t){let e,r,n,i,o,a,s,l,c;const u=[r4,e4],d=[];function p(f,g){return f[1]?0:1}r=p(t),n=d[r]=u[r](t);let h=t[6]&&vg(t);return{c(){e=ue(),n.c(),i=ue(),h&&h.c(),o=ue(),a=Dn()},m(f,g){tt(f,e,g),d[r].m(f,g),tt(f,i,g),h&&h.m(f,g),tt(f,o,g),tt(f,a,g),s=!0,l||(c=[Tt(document.body,"pointerdown",function(){kr(t[9])&&t[9].apply(this,arguments)}),Tt(document.body,"pointerup",function(){kr(t[8])&&t[8].apply(this,arguments)})],l=!0)},p(f,g){let $=r;r=p(t=f),r===$?d[r].p(t,g):(Fe(),B(d[$],1,1,()=>{d[$]=null}),ze(),n=d[r],n?n.p(t,g):(n=d[r]=u[r](t),n.c()),I(n,1),n.m(i.parentNode,i)),t[6]?h?(h.p(t,g),64&g[0]&&I(h,1)):(h=vg(t),h.c(),I(h,1),h.m(o.parentNode,o)):h&&(Fe(),B(h,1,1,()=>{h=null}),ze())},i(f){s||(I(n),I(h),I(!1),s=!0)},o(f){B(n),B(h),B(!1),s=!1},d(f){f&&J(e),d[r].d(f),f&&J(i),h&&h.d(f),f&&J(o),f&&J(a),l=!1,Ur(c)}}}function o4(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,E,C,z,V,L,{$$slots:y={},$$scope:ct}=e,{buttonClass:j}=e,{buttonLabel:k}=e,{buttonLabelClass:N}=e,{buttonHideLabel:nt}=e,{buttonIcon:ft}=e,{buttonTitle:xt}=e,{buttonOnClick:H}=e,{panelClass:Z}=e,{isActive:wt=!1}=e,{onshow:vt=se}=e,{onhide:et=se}=e;const Pt=$n("isAnimated");D(t,Pt,gt=>r(50,L=gt));const Et=$n("rootPortal");D(t,Et,gt=>r(45,M=gt));const kt=$n("rootRect");let st,Ut,rt;D(t,kt,gt=>r(47,C=gt));const X=()=>r(34,rt=n&&n.getBoundingClientRect());let q=dn(),Ft=hr(0);D(t,Ft,gt=>r(48,z=gt));let zt=dn();const yt=ge({x:0,y:0});D(t,yt,gt=>r(46,E=gt));const Dt=hr(-5,{stiffness:.1,damping:.35,precision:.001});D(t,Dt,gt=>r(49,V=gt));let Wt=!0;const at=gt=>cb(gt,M)||Ut.isEventTarget(gt);let St,pt,Xt=!1;const Zt=gt=>{Ja(gt.target)||(Vr(H)&&H(),wt||X(),r(39,pt=gt),r(0,wt=!wt))},ie=gt=>{/down/i.test(gt.key)&&(gt.target&&Ja(gt.target)||(r(0,wt=!0),r(39,pt=gt)))};return jo(()=>{if(!M||!St)return;const gt=St;z2().then(()=>{gt.parentNode&&gt.remove()})}),t.$$set=gt=>{"buttonClass"in gt&&r(26,j=gt.buttonClass),"buttonLabel"in gt&&r(1,k=gt.buttonLabel),"buttonLabelClass"in gt&&r(27,N=gt.buttonLabelClass),"buttonHideLabel"in gt&&r(28,nt=gt.buttonHideLabel),"buttonIcon"in gt&&r(29,ft=gt.buttonIcon),"buttonTitle"in gt&&r(30,xt=gt.buttonTitle),"buttonOnClick"in gt&&r(31,H=gt.buttonOnClick),"panelClass"in gt&&r(2,Z=gt.panelClass),"isActive"in gt&&r(0,wt=gt.isActive),"onshow"in gt&&r(32,vt=gt.onshow),"onhide"in gt&&r(33,et=gt.onhide),"$$scope"in gt&&r(57,ct=gt.$$scope)},t.$$.update=()=>{if(16&t.$$.dirty[0]&&(n=Ut&&Ut.getElement()),1&t.$$.dirty[0]|128&t.$$.dirty[1]&&r(8,S=wt?gt=>{Xt&&(r(38,Xt=!1),at(gt)||r(0,wt=!1))}:void 0),1&t.$$.dirty[0]|524288&t.$$.dirty[1]&&Ft.set(wt?1:0,{hard:L===!1}),1&t.$$.dirty[0]|524288&t.$$.dirty[1]&&Dt.set(wt?0:-5,{hard:L===!1}),262144&t.$$.dirty[1]&&r(43,i=1-V/-5),1&t.$$.dirty[0]|65536&t.$$.dirty[1]&&C&&wt&&X(),9&t.$$.dirty[0]|65544&t.$$.dirty[1]&&C&&st&&rt&&wt){r(37,Wt=!0);let gt=rt.x-C.x+.5*rt.width-.5*st.width,te=rt.y-C.y+rt.height;const xe=12,_=12,Kt=C.width-12,qt=C.height-12,le=gt,de=te,Oe=le+st.width,rr=de+st.height;le<xe&&(r(36,zt.x=le-xe,zt),gt=xe),Oe>Kt&&(r(36,zt.x=Oe-Kt,zt),gt=Kt-st.width),rr>qt?(r(35,q.y=-1,q),_<te-st.height-rt.height?(r(36,zt.y=0,zt),te-=st.height+rt.height):(r(36,zt.y=te-(rr-qt),zt),te-=rr-qt-12,r(37,Wt=!1))):r(35,q.y=1,q),It(yt,E=_o(lt(gt,te),du),E)}if(131072&t.$$.dirty[1]&&r(6,o=z>0),294928&t.$$.dirty[1]&&r(44,a=`translateX(${Math.round(E.x)+12*q.x}px) translateY(${Math.round(E.y)+12*q.y+q.y*V}px)`),131072&t.$$.dirty[1]&&r(18,s=z),131072&t.$$.dirty[1]&&r(17,l=z<1?"none":"all"),8192&t.$$.dirty[1]&&r(16,c=a),65536&t.$$.dirty[1]&&r(15,u=C.height-24+"px"),4096&t.$$.dirty[1]&&r(41,d=.5+.5*i),4096&t.$$.dirty[1]&&r(42,p=i),8&t.$$.dirty[0]|32768&t.$$.dirty[1]&&r(40,h=st&&E),2624&t.$$.dirty[1]&&r(14,f=h&&Wt?p:0),1536&t.$$.dirty[1]&&r(13,g=h?`scaleX(${d})rotate(45deg)`:"none"),8&t.$$.dirty[0]|560&t.$$.dirty[1]&&r(12,$=h?(q.y<0?zt.y+st.height:0)+"px":"0"),8&t.$$.dirty[0]|544&t.$$.dirty[1]&&r(11,b=h?zt.x+.5*st.width+"px":"0"),16&t.$$.dirty[1]&&r(10,v=q.y>=0),1&t.$$.dirty[0]&&r(9,w=wt?gt=>{at(gt)||r(38,Xt=!0)}:void 0),96&t.$$.dirty[0]|16384&t.$$.dirty[1]&&o&&M&&St&&St.parentNode!==M&&M.append(St),1&t.$$.dirty[0]&&(wt||r(39,pt=void 0)),97&t.$$.dirty[0]|258&t.$$.dirty[1]&&wt&&o&&St){let gt=!1;vt({e:pt,panel:St,preventFocus(){gt=!0}}),gt||O1(St,{preventScroll:!0})}65&t.$$.dirty[0]|4&t.$$.dirty[1]&&o&&!wt&&et(),2080374786&t.$$.dirty[0]&&r(7,P={label:k,icon:ft,class:br(["PinturaPanelButton",j]),onkeydown:ie,onclick:Zt,hideLabel:nt,labelClass:N,title:xt})},[wt,k,Z,st,Ut,St,o,P,S,w,v,b,$,g,f,u,c,l,s,Pt,Et,kt,Ft,yt,Dt,gt=>{/esc/i.test(gt.key)&&(r(0,wt=!1),n.focus())},j,N,nt,ft,xt,H,vt,et,rt,q,zt,Wt,Xt,pt,h,d,p,i,a,M,E,C,z,V,L,y,function(gt){jr[gt?"unshift":"push"](()=>{Ut=gt,r(4,Ut)})},function(gt){jr[gt?"unshift":"push"](()=>{Ut=gt,r(4,Ut)})},function(gt){jr[gt?"unshift":"push"](()=>{St=gt,r(5,St)})},gt=>{gt.stopPropagation(),r(0,wt=!1)},gt=>r(3,st=ts(gt.detail)),ct]}class mp extends gr{constructor(e){super(),fr(this,e,o4,i4,cr,{buttonClass:26,buttonLabel:1,buttonLabelClass:27,buttonHideLabel:28,buttonIcon:29,buttonTitle:30,buttonOnClick:31,panelClass:2,isActive:0,onshow:32,onhide:33},null,[-1,-1,-1])}}var a4={Up:38,Down:40,Left:37,Right:39};function s4(t){let e,r,n,i,o,a,s,l;const c=t[16].default,u=yi(c,t,t[15],null);return{c(){e=mt("li"),r=mt("input"),n=ue(),i=mt("label"),u&&u.c(),T(r,"type","radio"),T(r,"class","implicit"),T(r,"id",t[7]),T(r,"name",t[0]),r.value=t[3],r.disabled=t[6],r.hidden=t[5],r.checked=t[4],T(i,"for",t[7]),T(i,"title",t[2]),T(e,"class",o=br(["PinturaRadioGroupOption",t[1]])),T(e,"data-hidden",t[5]),T(e,"data-disabled",t[6]),T(e,"data-selected",t[4])},m(d,p){tt(d,e,p),Lt(e,r),Lt(e,n),Lt(e,i),u&&u.m(i,null),a=!0,s||(l=[Tt(r,"change",Fv(t[17])),Tt(r,"keydown",t[9]),Tt(r,"click",t[10])],s=!0)},p(d,[p]){(!a||128&p)&&T(r,"id",d[7]),(!a||1&p)&&T(r,"name",d[0]),(!a||8&p)&&(r.value=d[3]),(!a||64&p)&&(r.disabled=d[6]),(!a||32&p)&&(r.hidden=d[5]),(!a||16&p)&&(r.checked=d[4]),u&&u.p&&(!a||32768&p)&&xi(u,c,d,d[15],a?bi(c,d[15],p,null):vi(d[15]),null),(!a||128&p)&&T(i,"for",d[7]),(!a||4&p)&&T(i,"title",d[2]),(!a||2&p&&o!==(o=br(["PinturaRadioGroupOption",d[1]])))&&T(e,"class",o),(!a||32&p)&&T(e,"data-hidden",d[5]),(!a||64&p)&&T(e,"data-disabled",d[6]),(!a||16&p)&&T(e,"data-selected",d[4])},i(d){a||(I(u,d),a=!0)},o(d){B(u,d),a=!1},d(d){d&&J(e),u&&u.d(d),s=!1,Ur(l)}}}function l4(t,e,r){let n,i,{$$slots:o={},$$scope:a}=e,{name:s}=e,{class:l}=e,{label:c}=e,{title:u}=e,{id:d}=e,{value:p}=e,{checked:h}=e,{onkeydown:f}=e,{onclick:g}=e,{hidden:$=!1}=e,{disabled:b=!1}=e;const v=Object.values(a4),w=$n("keysPressed");return D(t,w,S=>r(18,i=S)),t.$$set=S=>{"name"in S&&r(0,s=S.name),"class"in S&&r(1,l=S.class),"label"in S&&r(11,c=S.label),"title"in S&&r(2,u=S.title),"id"in S&&r(12,d=S.id),"value"in S&&r(3,p=S.value),"checked"in S&&r(4,h=S.checked),"onkeydown"in S&&r(13,f=S.onkeydown),"onclick"in S&&r(14,g=S.onclick),"hidden"in S&&r(5,$=S.hidden),"disabled"in S&&r(6,b=S.disabled),"$$scope"in S&&r(15,a=S.$$scope)},t.$$.update=()=>{4097&t.$$.dirty&&r(7,n=`${s}-${d}`)},[s,l,u,p,h,$,b,n,w,S=>{f(S)},S=>{i.some(P=>v.includes(P))||g(S)},c,d,f,g,a,o,function(S){Ji.call(this,t,S)}]}class pb extends gr{constructor(e){super(),fr(this,e,l4,s4,cr,{name:0,class:1,label:11,title:2,id:12,value:3,checked:4,onkeydown:13,onclick:14,hidden:5,disabled:6})}}var _s=(t=[])=>t.reduce((e,r)=>(En(r)?En(r[1]):r.options)?e.concat(En(r)?r[1]:r.options):(e.push(r),e),[]);const Cd=(t,e,r)=>{let n;return En(t)?n={id:e,value:t[0],label:t[1],...t[2]||{}}:(n=t,n.id=n.id!=null?n.id:e),r?r(n):n};var Fi=(t,e,r)=>Vr(t)?t(e,r):t;const hb=(t,e)=>t.map(([r,n,i])=>{if(En(n))return[Fi(r,e),hb(n,e)];{const o=[r,Fi(n,e)];if(i){let a={...i};i.icon&&(a.icon=Fi(i.icon,e)),o.push(a)}return o}});var mb=(t,e)=>hb(t,e),fb=t=>/enter| /i.test(t),gb=(t,e)=>Array.isArray(t)&&Array.isArray(e)?ys(t,e):t===e;function wg(t,e,r){const n=t.slice();return n[27]=e[r],n}const c4=t=>({option:1024&t[0]}),Sg=t=>({option:t[27]});function kg(t,e,r){const n=t.slice();return n[27]=e[r],n}const u4=t=>({option:1024&t[0]}),Tg=t=>({option:t[27]}),d4=t=>({option:1024&t[0]}),Cg=t=>({option:t[27]});function Mg(t){let e,r,n,i,o,a=[],s=new Map,l=t[1]&&Pg(t),c=t[10];const u=d=>d[27].id;for(let d=0;d<c.length;d+=1){let p=wg(t,c,d),h=u(p);s.set(h,a[d]=Fg(h,p))}return{c(){e=mt("fieldset"),l&&l.c(),r=ue(),n=mt("ul");for(let d=0;d<a.length;d+=1)a[d].c();T(n,"class","PinturaRadioGroupOptions"),T(e,"class",i=br(["PinturaRadioGroup",t[3]])),T(e,"data-layout",t[5]),T(e,"title",t[7])},m(d,p){tt(d,e,p),l&&l.m(e,null),Lt(e,r),Lt(e,n);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(n,null);o=!0},p(d,p){d[1]?l?l.p(d,p):(l=Pg(d),l.c(),l.m(e,r)):l&&(l.d(1),l=null),8419153&p[0]&&(c=d[10],Fe(),a=es(a,p,u,1,d,c,s,n,Ys,Fg,null,wg),ze()),(!o||8&p[0]&&i!==(i=br(["PinturaRadioGroup",d[3]])))&&T(e,"class",i),(!o||32&p[0])&&T(e,"data-layout",d[5]),(!o||128&p[0])&&T(e,"title",d[7])},i(d){if(!o){for(let p=0;p<c.length;p+=1)I(a[p]);o=!0}},o(d){for(let p=0;p<a.length;p+=1)B(a[p]);o=!1},d(d){d&&J(e),l&&l.d();for(let p=0;p<a.length;p+=1)a[p].d()}}}function Pg(t){let e,r,n;return{c(){e=mt("legend"),r=Mn(t[1]),T(e,"class",n=t[2]&&"implicit")},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){2&o[0]&&Gn(r,i[1]),4&o[0]&&n!==(n=i[2]&&"implicit")&&T(e,"class",n)},d(i){i&&J(e)}}}function p4(t){let e,r;return e=new pb({props:{name:t[4],label:t[27].label,title:t[27].hideLabel?t[27].title||t[27].label:t[27].title,id:t[27].id,value:t[27].value,disabled:t[27].disabled,hidden:t[27].hidden,class:t[8],checked:t[12](t[27])===t[0],onkeydown:t[13](t[27]),onclick:t[14](t[27]),$$slots:{default:[f4]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16&i[0]&&(o.name=n[4]),1024&i[0]&&(o.label=n[27].label),1024&i[0]&&(o.title=n[27].hideLabel?n[27].title||n[27].label:n[27].title),1024&i[0]&&(o.id=n[27].id),1024&i[0]&&(o.value=n[27].value),1024&i[0]&&(o.disabled=n[27].disabled),1024&i[0]&&(o.hidden=n[27].hidden),256&i[0]&&(o.class=n[8]),1025&i[0]&&(o.checked=n[12](n[27])===n[0]),1024&i[0]&&(o.onkeydown=n[13](n[27])),1024&i[0]&&(o.onclick=n[14](n[27])),8389696&i[0]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function h4(t){let e,r,n,i,o,a,s=[],l=new Map;const c=t[22].group,u=yi(c,t,t[23],Cg),d=u||function(f){let g,$,b=f[27].label+"";return{c(){g=mt("span"),$=Mn(b),T(g,"class","PinturaRadioGroupOptionGroupLabel")},m(v,w){tt(v,g,w),Lt(g,$)},p(v,w){1024&w[0]&&b!==(b=v[27].label+"")&&Gn($,b)},d(v){v&&J(g)}}}(t);let p=t[27].options;const h=f=>f[27].id;for(let f=0;f<p.length;f+=1){let g=kg(t,p,f),$=h(g);l.set($,s[f]=Lg($,g))}return{c(){e=mt("li"),d&&d.c(),r=ue(),n=mt("ul");for(let f=0;f<s.length;f+=1)s[f].c();i=ue(),T(n,"class","PinturaRadioGroupOptions"),T(e,"class",o=br(["PinturaRadioGroupOptionGroup",t[9]]))},m(f,g){tt(f,e,g),d&&d.m(e,null),Lt(e,r),Lt(e,n);for(let $=0;$<s.length;$+=1)s[$]&&s[$].m(n,null);Lt(e,i),a=!0},p(f,g){u?u.p&&(!a||8389632&g[0])&&xi(u,c,f,f[23],a?bi(c,f[23],g,d4):vi(f[23]),Cg):d&&d.p&&(!a||1024&g[0])&&d.p(f,a?g:[-1,-1]),8418641&g[0]&&(p=f[27].options,Fe(),s=es(s,g,h,1,f,p,l,n,Ys,Lg,null,kg),ze()),(!a||512&g[0]&&o!==(o=br(["PinturaRadioGroupOptionGroup",f[9]])))&&T(e,"class",o)},i(f){if(!a){I(d,f);for(let g=0;g<p.length;g+=1)I(s[g]);a=!0}},o(f){B(d,f);for(let g=0;g<s.length;g+=1)B(s[g]);a=!1},d(f){f&&J(e),d&&d.d(f);for(let g=0;g<s.length;g+=1)s[g].d()}}}function Rg(t){let e,r;return e=new Ho({props:{$$slots:{default:[m4]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};8389632&i[0]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function m4(t){let e,r=t[27].icon+"";return{c(){e=Li("g")},m(n,i){tt(n,e,i),e.innerHTML=r},p(n,i){1024&i[0]&&r!==(r=n[27].icon+"")&&(e.innerHTML=r)},d(n){n&&J(e)}}}function Ig(t){let e,r,n=t[27].label+"";return{c(){e=mt("span"),r=Mn(n),T(e,"class",t[6])},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){1024&o[0]&&n!==(n=i[27].label+"")&&Gn(r,n),64&o[0]&&T(e,"class",i[6])},d(i){i&&J(e)}}}function f4(t){let e;const r=t[22].option,n=yi(r,t,t[23],Sg),i=n||function(o){let a,s,l,c=o[27].icon&&Rg(o),u=!o[27].hideLabel&&Ig(o);return{c(){c&&c.c(),a=ue(),u&&u.c(),s=ue()},m(d,p){c&&c.m(d,p),tt(d,a,p),u&&u.m(d,p),tt(d,s,p),l=!0},p(d,p){d[27].icon?c?(c.p(d,p),1024&p[0]&&I(c,1)):(c=Rg(d),c.c(),I(c,1),c.m(a.parentNode,a)):c&&(Fe(),B(c,1,1,()=>{c=null}),ze()),d[27].hideLabel?u&&(u.d(1),u=null):u?u.p(d,p):(u=Ig(d),u.c(),u.m(s.parentNode,s))},i(d){l||(I(c),l=!0)},o(d){B(c),l=!1},d(d){c&&c.d(d),d&&J(a),u&&u.d(d),d&&J(s)}}}(t);return{c(){i&&i.c()},m(o,a){i&&i.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&xi(n,r,o,o[23],e?bi(r,o[23],a,c4):vi(o[23]),Sg):i&&i.p&&(!e||1088&a[0])&&i.p(o,e?a:[-1,-1])},i(o){e||(I(i,o),e=!0)},o(o){B(i,o),e=!1},d(o){i&&i.d(o)}}}function Eg(t){let e,r;return e=new Ho({props:{$$slots:{default:[g4]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};8389632&i[0]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function g4(t){let e,r=t[27].icon+"";return{c(){e=Li("g")},m(n,i){tt(n,e,i),e.innerHTML=r},p(n,i){1024&i[0]&&r!==(r=n[27].icon+"")&&(e.innerHTML=r)},d(n){n&&J(e)}}}function Ag(t){let e,r,n=t[27].label+"";return{c(){e=mt("span"),r=Mn(n),T(e,"class",t[6])},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){1024&o[0]&&n!==(n=i[27].label+"")&&Gn(r,n),64&o[0]&&T(e,"class",i[6])},d(i){i&&J(e)}}}function $4(t){let e;const r=t[22].option,n=yi(r,t,t[23],Tg),i=n||function(o){let a,s,l,c=o[27].icon&&Eg(o),u=!o[27].hideLabel&&Ag(o);return{c(){c&&c.c(),a=ue(),u&&u.c(),s=ue()},m(d,p){c&&c.m(d,p),tt(d,a,p),u&&u.m(d,p),tt(d,s,p),l=!0},p(d,p){d[27].icon?c?(c.p(d,p),1024&p[0]&&I(c,1)):(c=Eg(d),c.c(),I(c,1),c.m(a.parentNode,a)):c&&(Fe(),B(c,1,1,()=>{c=null}),ze()),d[27].hideLabel?u&&(u.d(1),u=null):u?u.p(d,p):(u=Ag(d),u.c(),u.m(s.parentNode,s))},i(d){l||(I(c),l=!0)},o(d){B(c),l=!1},d(d){c&&c.d(d),d&&J(a),u&&u.d(d),d&&J(s)}}}(t);return{c(){i&&i.c()},m(o,a){i&&i.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&xi(n,r,o,o[23],e?bi(r,o[23],a,u4):vi(o[23]),Tg):i&&i.p&&(!e||1088&a[0])&&i.p(o,e?a:[-1,-1])},i(o){e||(I(i,o),e=!0)},o(o){B(i,o),e=!1},d(o){i&&i.d(o)}}}function Lg(t,e){let r,n,i;return n=new pb({props:{name:e[4],label:e[27].label,title:e[27].hideLabel?e[27].title||e[27].label:e[27].title,id:e[27].id,value:e[27].value,disabled:e[27].disabled,hidden:e[27].hidden,class:e[8],checked:e[12](e[27])===e[0],onkeydown:e[13](e[27]),onclick:e[14](e[27]),$$slots:{default:[$4]},$$scope:{ctx:e}}}),{key:t,first:null,c(){r=Dn(),Ht(n.$$.fragment),this.first=r},m(o,a){tt(o,r,a),Vt(n,o,a),i=!0},p(o,a){e=o;const s={};16&a[0]&&(s.name=e[4]),1024&a[0]&&(s.label=e[27].label),1024&a[0]&&(s.title=e[27].hideLabel?e[27].title||e[27].label:e[27].title),1024&a[0]&&(s.id=e[27].id),1024&a[0]&&(s.value=e[27].value),1024&a[0]&&(s.disabled=e[27].disabled),1024&a[0]&&(s.hidden=e[27].hidden),256&a[0]&&(s.class=e[8]),1025&a[0]&&(s.checked=e[12](e[27])===e[0]),1024&a[0]&&(s.onkeydown=e[13](e[27])),1024&a[0]&&(s.onclick=e[14](e[27])),8389696&a[0]&&(s.$$scope={dirty:a,ctx:e}),n.$set(s)},i(o){i||(I(n.$$.fragment,o),i=!0)},o(o){B(n.$$.fragment,o),i=!1},d(o){o&&J(r),Nt(n,o)}}}function Fg(t,e){let r,n,i,o,a;const s=[h4,p4],l=[];function c(u,d){return u[27].options?0:1}return n=c(e),i=l[n]=s[n](e),{key:t,first:null,c(){r=Dn(),i.c(),o=Dn(),this.first=r},m(u,d){tt(u,r,d),l[n].m(u,d),tt(u,o,d),a=!0},p(u,d){let p=n;n=c(e=u),n===p?l[n].p(e,d):(Fe(),B(l[p],1,1,()=>{l[p]=null}),ze(),i=l[n],i?i.p(e,d):(i=l[n]=s[n](e),i.c()),I(i,1),i.m(o.parentNode,o))},i(u){a||(I(i),a=!0)},o(u){B(i),a=!1},d(u){u&&J(r),l[n].d(u),u&&J(o)}}}function y4(t){let e,r,n,i=t[11].length&&Mg(t);return{c(){i&&i.c(),e=ue(),r=Dn()},m(o,a){i&&i.m(o,a),tt(o,e,a),tt(o,r,a),n=!0},p(o,a){o[11].length?i?(i.p(o,a),2048&a[0]&&I(i,1)):(i=Mg(o),i.c(),I(i,1),i.m(e.parentNode,e)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze())},i(o){n||(I(i),I(!1),n=!0)},o(o){B(i),B(!1),n=!1},d(o){i&&i.d(o),o&&J(e),o&&J(r)}}}function b4(t,e,r){let n,i,o,{$$slots:a={},$$scope:s}=e;const l=ba();let{label:c}=e,{hideLabel:u=!0}=e,{class:d}=e,{name:p="radio-group-"+ra()}=e,{selectedIndex:h=-1}=e,{options:f=[]}=e,{onchange:g}=e,{layout:$}=e,{optionMapper:b}=e,{optionFilter:v}=e,{value:w}=e,{optionLabelClass:S}=e,{title:P}=e,{locale:M}=e,{optionClass:E}=e,{optionGroupClass:C}=e;const z=L=>o.findIndex(y=>y.id===L.id),V=(L,y)=>{r(0,h=z(L));const ct={index:h,...L};((j,...k)=>{j&&j(...k)})(g,ct,y),l("change",ct)};return t.$$set=L=>{"label"in L&&r(1,c=L.label),"hideLabel"in L&&r(2,u=L.hideLabel),"class"in L&&r(3,d=L.class),"name"in L&&r(4,p=L.name),"selectedIndex"in L&&r(0,h=L.selectedIndex),"options"in L&&r(15,f=L.options),"onchange"in L&&r(16,g=L.onchange),"layout"in L&&r(5,$=L.layout),"optionMapper"in L&&r(17,b=L.optionMapper),"optionFilter"in L&&r(18,v=L.optionFilter),"value"in L&&r(19,w=L.value),"optionLabelClass"in L&&r(6,S=L.optionLabelClass),"title"in L&&r(7,P=L.title),"locale"in L&&r(20,M=L.locale),"optionClass"in L&&r(8,E=L.optionClass),"optionGroupClass"in L&&r(9,C=L.optionGroupClass),"$$scope"in L&&r(23,s=L.$$scope)},t.$$.update=()=>{1343488&t.$$.dirty[0]&&r(11,n=mb(v?f.filter(v):f,M)),133120&t.$$.dirty[0]&&r(10,i=((L=[],y)=>{let ct=0;return L.map(j=>(ct++,En(j)?En(j[1])?{id:ct,label:j[0],options:j[1].map(k=>Cd(k,++ct,y))}:Cd(j,ct,y):j.options?{id:j.id||ct,label:j.label,options:j.options.map(k=>Cd(k,++ct,y))}:Cd(j,ct,y)))})(n,b)),1024&t.$$.dirty[0]&&r(21,o=_s(i)),2654209&t.$$.dirty[0]&&h<0&&(r(0,h=o.findIndex(L=>gb(L.value,w))),h<0&&r(0,h=(L=>L.findIndex(y=>y[0]===void 0))(f)))},[h,c,u,d,p,$,S,P,E,C,i,n,z,L=>y=>{fb(y.key)&&V(L,y)},L=>y=>{V(L,y)},f,g,b,v,w,M,o,a,s]}class ws extends gr{constructor(e){super(),fr(this,e,b4,y4,cr,{label:1,hideLabel:2,class:3,name:4,selectedIndex:0,options:15,onchange:16,layout:5,optionMapper:17,optionFilter:18,value:19,optionLabelClass:6,title:7,locale:20,optionClass:8,optionGroupClass:9},null,[-1,-1])}}function zg(t){let e,r,n,i,o,a,s,l,c,u;return{c(){e=mt("div"),r=mt("button"),n=Mn("â²"),o=ue(),a=mt("button"),s=Mn("â¼"),T(r,"type","button"),T(r,"tabindex","-1"),T(r,"aria-label",i="increase "+t[7]),T(a,"type","button"),T(a,"tabindex","-1"),T(a,"aria-label",l="decrease "+t[7]),T(e,"class","PinturaInputSpinners")},m(d,p){tt(d,e,p),Lt(e,r),Lt(r,n),Lt(e,o),Lt(e,a),Lt(a,s),c||(u=[Tt(r,"click",t[18]),Tt(a,"click",t[19])],c=!0)},p(d,p){128&p[0]&&i!==(i="increase "+d[7])&&T(r,"aria-label",i),128&p[0]&&l!==(l="decrease "+d[7])&&T(a,"aria-label",l)},d(d){d&&J(e),c=!1,Ur(u)}}}function x4(t){let e,r,n,i,o,a,s=t[14]&&t[9]&&zg(t);return{c(){e=mt("div"),r=mt("input"),i=ue(),s&&s.c(),T(r,"class","PinturaInputField"),T(r,"title",t[7]),T(r,"type",t[1]),T(r,"min",t[4]),T(r,"max",t[5]),T(r,"step",t[6]),T(r,"inputmode",t[3]),r.value=n=t[12]?t[15]:t[0],T(r,"placeholder",t[8]),T(r,"maxlength",t[13]),r.disabled=t[2],T(r,"spellcheck","false"),T(r,"autocorrect","off"),T(r,"autocapitalize","off"),Mt(r,"min-width",t[11]?t[11]+"em":void 0),T(e,"class","PinturaInput")},m(l,c){tt(l,e,c),Lt(e,r),t[30](r),Lt(e,i),s&&s.m(e,null),o||(a=[Tt(r,"input",t[17]),Tt(r,"blur",function(){kr(t[12]&&t[16])&&(t[12]&&t[16]).apply(this,arguments)}),Tt(r,"keydown",t[20]),Tt(r,"keyup",t[21])],o=!0)},p(l,c){t=l,128&c[0]&&T(r,"title",t[7]),2&c[0]&&T(r,"type",t[1]),16&c[0]&&T(r,"min",t[4]),32&c[0]&&T(r,"max",t[5]),64&c[0]&&T(r,"step",t[6]),8&c[0]&&T(r,"inputmode",t[3]),36865&c[0]&&n!==(n=t[12]?t[15]:t[0])&&r.value!==n&&(r.value=n),256&c[0]&&T(r,"placeholder",t[8]),8192&c[0]&&T(r,"maxlength",t[13]),4&c[0]&&(r.disabled=t[2]),2048&c[0]&&Mt(r,"min-width",t[11]?t[11]+"em":void 0),t[14]&&t[9]?s?s.p(t,c):(s=zg(t),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},i:qe,o:qe,d(l){l&&J(e),t[30](null),s&&s.d(),o=!1,Ur(a)}}}function v4(t,e,r){let n,i,o,a,s,l,c,u,d,{value:p}=e,{type:h="text"}=e,{disabled:f=!1}=e,{inputmode:g}=e,{min:$}=e,{max:b}=e,{step:v}=e,{onchange:w=se}=e,{onkeydown:S=se}=e,{onkeyup:P=se}=e,{title:M}=e,{stepMultiplier:E=10}=e,{placeholder:C}=e,{enableSpinButtons:z=!0}=e,{enableStopPropagation:V=!1}=e;const L=()=>{let k=u.value;return h==="number"&&(k=g==="numeric"?parseInt(k,10):parseFloat(k),!_e(k)||Number.isNaN(k)?k=$||0:i&&(k=an(k,$,b))),k};let y=p;const ct=()=>{const k=an(L()+(d?v*E:v),$,b);k!==p&&(r(27,y=k),r(0,p=k),w(p))},j=()=>{const k=an(L()-(d?v*E:v),$,b);k!==p&&(r(27,y=k),r(0,p=k),w(p))};return t.$$set=k=>{"value"in k&&r(0,p=k.value),"type"in k&&r(1,h=k.type),"disabled"in k&&r(2,f=k.disabled),"inputmode"in k&&r(3,g=k.inputmode),"min"in k&&r(4,$=k.min),"max"in k&&r(5,b=k.max),"step"in k&&r(6,v=k.step),"onchange"in k&&r(22,w=k.onchange),"onkeydown"in k&&r(23,S=k.onkeydown),"onkeyup"in k&&r(24,P=k.onkeyup),"title"in k&&r(7,M=k.title),"stepMultiplier"in k&&r(25,E=k.stepMultiplier),"placeholder"in k&&r(8,C=k.placeholder),"enableSpinButtons"in k&&r(9,z=k.enableSpinButtons),"enableStopPropagation"in k&&r(26,V=k.enableStopPropagation)},t.$$.update=()=>{2&t.$$.dirty[0]&&r(29,n=h==="number"),48&t.$$.dirty[0]&&r(12,i=_e($)&&_e(b)),64&t.$$.dirty[0]&&r(28,o=_e(v)),805310464&t.$$.dirty[0]&&r(14,a=n&&i&&o),134218753&t.$$.dirty[0]&&r(15,s=u===document.activeElement?y:p),32&t.$$.dirty[0]&&r(11,l=b?(b+"").length:void 0),2056&t.$$.dirty[0]&&r(13,c=g==="numeric"&&l?l:void 0)},[p,h,f,g,$,b,v,M,C,z,u,l,i,c,a,s,()=>{r(27,y=L()),w(p)},()=>{r(27,y=u.value),w(L())},ct,j,k=>{if(S(k),!a)return;d=k.shiftKey;const{key:N}=k;V&&k.stopPropagation(),/up|down/i.test(N)&&(/up/i.test(N)&&ct(),/down/i.test(N)&&j(),k.preventDefault(),k.stopPropagation())},k=>{if(P(k),!a)return;const{key:N}=k;/up|down/i.test(N)&&(k.preventDefault(),k.stopPropagation())},w,S,P,E,V,y,o,n,function(k){jr[k?"unshift":"push"](()=>{u=k,r(10,u)})}]}class $b extends gr{constructor(e){super(),fr(this,e,v4,x4,cr,{value:0,type:1,disabled:2,inputmode:3,min:4,max:5,step:6,onchange:22,onkeydown:23,onkeyup:24,title:7,stepMultiplier:25,placeholder:8,enableSpinButtons:9,enableStopPropagation:26},null,[-1,-1])}}const w4=t=>({}),Dg=t=>({});function S4(t){let e,r,n,i,o=(t[2]||t[21])+"",a=t[6]&&Bg(t);return{c(){a&&a.c(),e=ue(),r=mt("span"),T(r,"class",n=br(["PinturaButtonLabel",t[3],t[5]&&"implicit"]))},m(s,l){a&&a.m(s,l),tt(s,e,l),tt(s,r,l),r.innerHTML=o,i=!0},p(s,l){s[6]?a?(a.p(s,l),64&l[0]&&I(a,1)):(a=Bg(s),a.c(),I(a,1),a.m(e.parentNode,e)):a&&(Fe(),B(a,1,1,()=>{a=null}),ze()),(!i||2097156&l[0])&&o!==(o=(s[2]||s[21])+"")&&(r.innerHTML=o),(!i||40&l[0]&&n!==(n=br(["PinturaButtonLabel",s[3],s[5]&&"implicit"])))&&T(r,"class",n)},i(s){i||(I(a),i=!0)},o(s){B(a),i=!1},d(s){a&&a.d(s),s&&J(e),s&&J(r)}}}function k4(t){let e,r;return e=new $b({props:{value:parseFloat(t[10]),onchange:t[17],enableStopPropagation:!0,type:"number",inputmode:"numeric",min:t[8].reduce(t[29],1/0),max:t[8].reduce(t[30],-1/0),enableSpinButtons:!1}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};1024&i[0]&&(o.value=parseFloat(n[10])),131072&i[0]&&(o.onchange=n[17]),256&i[0]&&(o.min=n[8].reduce(n[29],1/0)),256&i[0]&&(o.max=n[8].reduce(n[30],-1/0)),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function Bg(t){let e,r;return e=new Ho({props:{class:"PinturaButtonIcon",$$slots:{default:[T4]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};64&i[0]|2&i[1]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function T4(t){let e;return{c(){e=Li("g")},m(r,n){tt(r,e,n),e.innerHTML=t[6]},p(r,n){64&n[0]&&(e.innerHTML=r[6])},d(r){r&&J(e)}}}function C4(t){let e,r,n,i,o;const a=[k4,S4],s=[];function l(c,u){return c[18]?0:1}return r=l(t),n=s[r]=a[r](t),{c(){e=mt("span"),n.c(),T(e,"slot","label"),T(e,"class",i=br(["PinturaButtonInner",t[18]&&"PinturaComboBox",t[4]]))},m(c,u){tt(c,e,u),s[r].m(e,null),o=!0},p(c,u){let d=r;r=l(c),r===d?s[r].p(c,u):(Fe(),B(s[d],1,1,()=>{s[d]=null}),ze(),n=s[r],n?n.p(c,u):(n=s[r]=a[r](c),n.c()),I(n,1),n.m(e,null)),(!o||262160&u[0]&&i!==(i=br(["PinturaButtonInner",c[18]&&"PinturaComboBox",c[4]])))&&T(e,"class",i)},i(c){o||(I(n),o=!0)},o(c){B(n),o=!1},d(c){c&&J(e),s[r].d()}}}function M4(t){let e,r,n=t[34].label+"";return{c(){e=mt("span"),r=Mn(n),T(e,"slot","group")},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){8&o[1]&&n!==(n=i[34].label+"")&&Gn(r,n)},d(i){i&&J(e)}}}function Og(t){let e,r;return e=new Ho({props:{style:Vr(t[14])?t[14](t[34].value):t[14],$$slots:{default:[P4]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16384&i[0]|8&i[1]&&(o.style=Vr(n[14])?n[14](n[34].value):n[14]),10&i[1]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function P4(t){let e,r=t[34].icon+"";return{c(){e=Li("g")},m(n,i){tt(n,e,i),e.innerHTML=r},p(n,i){8&i[1]&&r!==(r=n[34].icon+"")&&(e.innerHTML=r)},d(n){n&&J(e)}}}function Wg(t){let e,r,n,i,o,a,s,l=t[34].label+"",c=t[34].sublabel&&_g(t);return{c(){e=mt("span"),r=new f0(!1),n=ue(),c&&c.c(),r.a=n,T(e,"class",i=br(["PinturaDropdownOptionLabel",t[11]]))},m(u,d){tt(u,e,d),r.m(l,e),Lt(e,n),c&&c.m(e,null),a||(s=Tr(o=vs.call(null,e,Vr(t[15])?t[15](t[34].value):t[15])),a=!0)},p(u,d){8&d[1]&&l!==(l=u[34].label+"")&&r.p(l),u[34].sublabel?c?c.p(u,d):(c=_g(u),c.c(),c.m(e,null)):c&&(c.d(1),c=null),2048&d[0]&&i!==(i=br(["PinturaDropdownOptionLabel",u[11]]))&&T(e,"class",i),o&&kr(o.update)&&32768&d[0]|8&d[1]&&o.update.call(null,Vr(u[15])?u[15](u[34].value):u[15])},d(u){u&&J(e),c&&c.d(),a=!1,s()}}}function _g(t){let e,r=t[34].sublabel+"";return{c(){e=mt("span"),T(e,"class","PinturaDropdownOptionSublabel")},m(n,i){tt(n,e,i),e.innerHTML=r},p(n,i){8&i[1]&&r!==(r=n[34].sublabel+"")&&(e.innerHTML=r)},d(n){n&&J(e)}}}function R4(t){let e,r,n,i=t[34].icon&&Og(t),o=!t[34].hideLabel&&Wg(t);return{c(){e=mt("span"),i&&i.c(),r=ue(),o&&o.c(),T(e,"slot","option")},m(a,s){tt(a,e,s),i&&i.m(e,null),Lt(e,r),o&&o.m(e,null),n=!0},p(a,s){a[34].icon?i?(i.p(a,s),8&s[1]&&I(i,1)):(i=Og(a),i.c(),I(i,1),i.m(e,r)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze()),a[34].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=Wg(a),o.c(),o.m(e,null))},i(a){n||(I(i),n=!0)},o(a){B(i),n=!1},d(a){a&&J(e),i&&i.d(),o&&o.d()}}}function I4(t){let e,r,n,i,o,a;const s=t[28].controls,l=yi(s,t,t[32],Dg);return n=new ws({props:{class:"PinturaOptionsList PinturaScrollableContent",name:t[7],value:t[10],selectedIndex:t[9],optionFilter:t[12],optionMapper:t[13],optionLabelClass:br(["PinturaDropdownOptionLabel",t[11]]),optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[19],onchange:t[22],$$slots:{option:[R4,({option:c})=>({34:c}),({option:c})=>[0,c?8:0]],group:[M4,({option:c})=>({34:c}),({option:c})=>[0,c?8:0]]},$$scope:{ctx:t}}}),{c(){e=mt("div"),l&&l.c(),r=ue(),Ht(n.$$.fragment),T(e,"slot","details"),T(e,"class","PinturaOptionsListWrapper")},m(c,u){tt(c,e,u),l&&l.m(e,null),Lt(e,r),Vt(n,e,null),i=!0,o||(a=Tt(e,"keydown",t[24]),o=!0)},p(c,u){l&&l.p&&(!i||2&u[1])&&xi(l,s,c,c[32],i?bi(s,c[32],u,w4):vi(c[32]),Dg);const d={};128&u[0]&&(d.name=c[7]),1024&u[0]&&(d.value=c[10]),512&u[0]&&(d.selectedIndex=c[9]),4096&u[0]&&(d.optionFilter=c[12]),8192&u[0]&&(d.optionMapper=c[13]),2048&u[0]&&(d.optionLabelClass=br(["PinturaDropdownOptionLabel",c[11]])),524288&u[0]&&(d.options=c[19]),51200&u[0]|10&u[1]&&(d.$$scope={dirty:u,ctx:c}),n.$set(d)},i(c){i||(I(l,c),I(n.$$.fragment,c),i=!0)},o(c){B(l,c),B(n.$$.fragment,c),i=!1},d(c){c&&J(e),l&&l.d(c),Nt(n),o=!1,a()}}}function E4(t){let e,r,n;function i(a){t[31](a)}let o={onshow:t[23],buttonTitle:rp(t[2],t[1]),buttonClass:br(["PinturaDropdownButton",t[0],t[5]&&"PinturaDropdownIconOnly"]),buttonOnClick:t[16],$$slots:{details:[I4],label:[C4]},$$scope:{ctx:t}};return t[20]!==void 0&&(o.isActive=t[20]),e=new mp({props:o}),jr.push(()=>Ro(e,"isActive",i)),{c(){Ht(e.$$.fragment)},m(a,s){Vt(e,a,s),n=!0},p(a,s){const l={};6&s[0]&&(l.buttonTitle=rp(a[2],a[1])),33&s[0]&&(l.buttonClass=br(["PinturaDropdownButton",a[0],a[5]&&"PinturaDropdownIconOnly"])),65536&s[0]&&(l.buttonOnClick=a[16]),3080188&s[0]|2&s[1]&&(l.$$scope={dirty:s,ctx:a}),!r&&1048576&s[0]&&(r=!0,l.isActive=a[20],No(()=>r=!1)),e.$set(l)},i(a){n||(I(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){Nt(e,a)}}}function A4(t,e,r){let n,i,{$$slots:o={},$$scope:a}=e,{class:s}=e,{title:l}=e,{label:c}=e,{labelClass:u}=e,{innerClass:d}=e,{hideLabel:p=!1}=e,{icon:h}=e,{name:f}=e,{options:g=[]}=e,{selectedIndex:$=-1}=e,{value:b}=e,{optionLabelClass:v}=e,{optionFilter:w}=e,{optionMapper:S}=e,{optionIconStyle:P}=e,{optionLabelStyle:M}=e,{locale:E}=e,{onclick:C}=e,{onchange:z=se}=e,{onload:V=se}=e,{ondestroy:L=se}=e,{enableInput:y=!1}=e,ct;return xs(()=>V({options:g})),jo(()=>L({options:g})),t.$$set=j=>{"class"in j&&r(0,s=j.class),"title"in j&&r(1,l=j.title),"label"in j&&r(2,c=j.label),"labelClass"in j&&r(3,u=j.labelClass),"innerClass"in j&&r(4,d=j.innerClass),"hideLabel"in j&&r(5,p=j.hideLabel),"icon"in j&&r(6,h=j.icon),"name"in j&&r(7,f=j.name),"options"in j&&r(8,g=j.options),"selectedIndex"in j&&r(9,$=j.selectedIndex),"value"in j&&r(10,b=j.value),"optionLabelClass"in j&&r(11,v=j.optionLabelClass),"optionFilter"in j&&r(12,w=j.optionFilter),"optionMapper"in j&&r(13,S=j.optionMapper),"optionIconStyle"in j&&r(14,P=j.optionIconStyle),"optionLabelStyle"in j&&r(15,M=j.optionLabelStyle),"locale"in j&&r(25,E=j.locale),"onclick"in j&&r(16,C=j.onclick),"onchange"in j&&r(17,z=j.onchange),"onload"in j&&r(26,V=j.onload),"ondestroy"in j&&r(27,L=j.ondestroy),"enableInput"in j&&r(18,y=j.enableInput),"$$scope"in j&&r(32,a=j.$$scope)},t.$$.update=()=>{33554688&t.$$.dirty[0]&&r(19,n=E?mb(g,E):g),525312&t.$$.dirty[0]&&r(21,i=n.reduce((j,k)=>{if(j)return j;const N=Array.isArray(k)?k:[k,k],[nt,ft]=N;return gb(nt,b)?ft:void 0},void 0)||(j=>{const k=j.find(N=>N[0]===void 0);if(k)return k[1]})(n)||b)},[s,l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,C,z,y,n,ct,i,j=>{r(21,i=j.value),z(j),r(20,ct=!1)},({e:j,panel:k,preventFocus:N})=>{if(N(),j&&j.key&&/up|down/i.test(j.key))return O1(k.querySelector("input:not([disabled])"));O1(k.querySelector("fieldset"))},j=>{/tab/i.test(j.key)&&j.preventDefault()},E,V,L,o,(j,[k])=>(k=parseFloat(k))<j?k:j,(j,[k])=>(k=parseFloat(k))>j?k:j,function(j){ct=j,r(20,ct)},a]}class M0 extends gr{constructor(e){super(),fr(this,e,A4,E4,cr,{class:0,title:1,label:2,labelClass:3,innerClass:4,hideLabel:5,icon:6,name:7,options:8,selectedIndex:9,value:10,optionLabelClass:11,optionFilter:12,optionMapper:13,optionIconStyle:14,optionLabelStyle:15,locale:25,onclick:16,onchange:17,onload:26,ondestroy:27,enableInput:18},null,[-1,-1])}}function L4(t){let e;return{c(){e=mt("div"),T(e,"slot","details")},m(r,n){tt(r,e,n),t[14](e)},p:qe,d(r){r&&J(e),t[14](null)}}}function F4(t){let e,r,n;function i(a){t[15](a)}let o={buttonLabel:t[1],buttonClass:t[2],buttonIcon:t[3],buttonHideLabel:t[4],buttonTitle:t[5],buttonLabelClass:t[6],onshow:t[7],onhide:t[8],$$slots:{details:[L4]},$$scope:{ctx:t}};return t[0]!==void 0&&(o.isActive=t[0]),e=new mp({props:o}),jr.push(()=>Ro(e,"isActive",i)),{c(){Ht(e.$$.fragment)},m(a,s){Vt(e,a,s),n=!0},p(a,[s]){const l={};2&s&&(l.buttonLabel=a[1]),4&s&&(l.buttonClass=a[2]),8&s&&(l.buttonIcon=a[3]),16&s&&(l.buttonHideLabel=a[4]),32&s&&(l.buttonTitle=a[5]),64&s&&(l.buttonLabelClass=a[6]),128&s&&(l.onshow=a[7]),256&s&&(l.onhide=a[8]),66048&s&&(l.$$scope={dirty:s,ctx:a}),!r&&1&s&&(r=!0,l.isActive=a[0],No(()=>r=!1)),e.$set(l)},i(a){n||(I(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){Nt(e,a)}}}function z4(t,e,r){let{buttonLabel:n}=e,{buttonClass:i}=e,{buttonIcon:o}=e,{buttonHideLabel:a}=e,{buttonTitle:s}=e,{buttonLabelClass:l}=e,{isActive:c=!1}=e,{root:u}=e,{ondestroy:d=se}=e,{onshow:p=se}=e,{onhide:h=se}=e,f;return jo(d),t.$$set=g=>{"buttonLabel"in g&&r(1,n=g.buttonLabel),"buttonClass"in g&&r(2,i=g.buttonClass),"buttonIcon"in g&&r(3,o=g.buttonIcon),"buttonHideLabel"in g&&r(4,a=g.buttonHideLabel),"buttonTitle"in g&&r(5,s=g.buttonTitle),"buttonLabelClass"in g&&r(6,l=g.buttonLabelClass),"isActive"in g&&r(0,c=g.isActive),"root"in g&&r(10,u=g.root),"ondestroy"in g&&r(11,d=g.ondestroy),"onshow"in g&&r(7,p=g.onshow),"onhide"in g&&r(8,h=g.onhide)},t.$$.update=()=>{1536&t.$$.dirty&&f&&u&&f.firstChild!==u&&(f.hasChildNodes()?f.replaceChild(u,f.firstChild):f.append(u))},[c,n,i,o,a,s,l,p,h,f,u,d,()=>r(0,c=!1),()=>r(0,c=!0),function(g){jr[g?"unshift":"push"](()=>{f=g,r(9,f)})},function(g){c=g,r(0,c)}]}class D4 extends gr{constructor(e){super(),fr(this,e,z4,F4,cr,{buttonLabel:1,buttonClass:2,buttonIcon:3,buttonHideLabel:4,buttonTitle:5,buttonLabelClass:6,isActive:0,root:10,ondestroy:11,onshow:7,onhide:8,hide:12,show:13})}get hide(){return this.$$.ctx[12]}get show(){return this.$$.ctx[13]}}var Ss=(t,e={})=>{const{direction:r,shiftMultiplier:n=10,bubbles:i=!1,preventDefault:o=!1,stopKeydownPropagation:a=!0}=e,s=r==="horizontal",l=r==="vertical",c=u=>{const{key:d}=u,p=u.shiftKey,h=/up|down/i.test(d),f=/left|right/i.test(d);if(!f&&!h||s&&h||l&&f)return;const g=p?n:1;a&&u.stopPropagation(),o&&u.preventDefault(),t.dispatchEvent(new CustomEvent("nudge",{bubbles:i,detail:lt((/left/i.test(d)?-1:/right/i.test(d)?1:0)*g,(/up/i.test(d)?-1:/down/i.test(d)?1:0)*g)}))};return t.addEventListener("keydown",c),{destroy(){t.removeEventListener("keydown",c)}}},Kc=(t,e,r)=>(t-e)/(r-e),yu=(t,e)=>{const{fixScrollDirection:r=!1}=e||{},{deltaX:n,deltaY:i}=t;let o=function(a,s){let l=0;return l=Math.abs(a)>Math.abs(s)?a:s,-1*l}(n,i);return su()?o%1!=0?o*=.05:Aa()?o*=.1:o*=.25:Math.abs(n)===0&&Math.abs(i)>=100?o*=.05:o*=.25,o=an(o,-10,10),su()&&!r&&(o*=-1),o};const B4=t=>({}),Vg=t=>({});function Ng(t){let e,r,n;return{c(){e=mt("label"),r=Mn(t[0]),T(e,"for",t[17]),T(e,"class",n=t[1]?"implicit":void 0)},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){1&o[0]&&Gn(r,i[0]),131072&o[0]&&T(e,"for",i[17]),2&o[0]&&n!==(n=i[1]?"implicit":void 0)&&T(e,"class",n)},d(i){i&&J(e)}}}function Hg(t){let e,r,n,i,o,a,s,l;return r=new Ho({props:{$$slots:{default:[O4]},$$scope:{ctx:t}}}),o=new Ho({props:{$$slots:{default:[W4]},$$scope:{ctx:t}}}),{c(){e=mt("button"),Ht(r.$$.fragment),n=ue(),i=mt("button"),Ht(o.$$.fragment),T(e,"type","button"),T(e,"aria-label","Increase"),T(i,"type","button"),T(i,"aria-label","Decrease")},m(c,u){tt(c,e,u),Vt(r,e,null),tt(c,n,u),tt(c,i,u),Vt(o,i,null),a=!0,s||(l=[Tt(e,"pointerdown",t[20](1)),Tt(e,"keydown",t[20](1)),Tt(i,"pointerdown",t[20](-1)),Tt(i,"keydown",t[20](-1))],s=!0)},p(c,u){const d={};512&u[1]&&(d.$$scope={dirty:u,ctx:c}),r.$set(d);const p={};512&u[1]&&(p.$$scope={dirty:u,ctx:c}),o.$set(p)},i(c){a||(I(r.$$.fragment,c),I(o.$$.fragment,c),a=!0)},o(c){B(r.$$.fragment,c),B(o.$$.fragment,c),a=!1},d(c){c&&J(e),Nt(r),c&&J(n),c&&J(i),Nt(o),s=!1,Ur(l)}}}function O4(t){let e;return{c(){e=Li("path"),T(e,"d","M8 12 h8 M12 8 v8")},m(r,n){tt(r,e,n)},p:qe,d(r){r&&J(e)}}}function W4(t){let e;return{c(){e=Li("path"),T(e,"d","M9 12 h6")},m(r,n){tt(r,e,n)},p:qe,d(r){r&&J(e)}}}function _4(t){let e,r,n,i,o,a,s,l,c,u,d,p,h,f,g,$,b=t[0]&&Ng(t);const v=t[38].default,w=yi(v,t,t[40],null),S=t[38].knob,P=yi(S,t,t[40],Vg);let M=t[8]&&Hg(t);return{c(){e=mt("div"),r=mt("div"),b&&b.c(),n=ue(),i=mt("input"),o=ue(),a=mt("div"),w&&w.c(),l=ue(),c=mt("div"),u=mt("div"),P&&P.c(),p=ue(),M&&M.c(),T(i,"type","range"),T(i,"id",t[17]),T(i,"min",t[2]),T(i,"max",t[3]),T(i,"step",t[4]),i.value=t[13],Mt(i,"pointer-events",t[9]?"none":void 0),T(a,"class",s=br(["PinturaSliderTrack",t[5]])),T(u,"class",d=br(["PinturaSliderKnob",t[6]])),T(c,"class","PinturaSliderKnobController"),Mt(c,"transform",t[16]),T(r,"class","PinturaSliderControl"),Mt(r,"--slider-position",Math.round(t[14])),T(e,"class",h=br(["PinturaSlider",t[11]])),T(e,"data-direction",t[7])},m(E,C){tt(E,e,C),Lt(e,r),b&&b.m(r,null),Lt(r,n),Lt(r,i),t[39](i),Lt(r,o),Lt(r,a),w&&w.m(a,null),Lt(r,l),Lt(r,c),Lt(c,u),P&&P.m(u,null),Lt(e,p),M&&M.m(e,null),f=!0,g||($=[Tt(i,"input",t[18]),Tt(i,"nudge",t[19]),Tt(i,"wheel",t[21]),Tr(Ss.call(null,i)),Tt(r,"pointerdown",function(){kr(t[10]&&t[12])&&(t[10]&&t[12]).apply(this,arguments)})],g=!0)},p(E,C){(t=E)[0]?b?b.p(t,C):(b=Ng(t),b.c(),b.m(r,n)):b&&(b.d(1),b=null),(!f||131072&C[0])&&T(i,"id",t[17]),(!f||4&C[0])&&T(i,"min",t[2]),(!f||8&C[0])&&T(i,"max",t[3]),(!f||16&C[0])&&T(i,"step",t[4]),(!f||8192&C[0])&&(i.value=t[13]),512&C[0]&&Mt(i,"pointer-events",t[9]?"none":void 0),w&&w.p&&(!f||512&C[1])&&xi(w,v,t,t[40],f?bi(v,t[40],C,null):vi(t[40]),null),(!f||32&C[0]&&s!==(s=br(["PinturaSliderTrack",t[5]])))&&T(a,"class",s),P&&P.p&&(!f||512&C[1])&&xi(P,S,t,t[40],f?bi(S,t[40],C,B4):vi(t[40]),Vg),(!f||64&C[0]&&d!==(d=br(["PinturaSliderKnob",t[6]])))&&T(u,"class",d),65536&C[0]&&Mt(c,"transform",t[16]),16384&C[0]&&Mt(r,"--slider-position",Math.round(t[14])),t[8]?M?(M.p(t,C),256&C[0]&&I(M,1)):(M=Hg(t),M.c(),I(M,1),M.m(e,null)):M&&(Fe(),B(M,1,1,()=>{M=null}),ze()),(!f||2048&C[0]&&h!==(h=br(["PinturaSlider",t[11]])))&&T(e,"class",h),(!f||128&C[0])&&T(e,"data-direction",t[7])},i(E){f||(I(w,E),I(P,E),I(M),f=!0)},o(E){B(w,E),B(P,E),B(M),f=!1},d(E){E&&J(e),b&&b.d(),t[39](null),w&&w.d(E),P&&P.d(E),M&&M.d(),g=!1,Ur($)}}}function V4(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,{$$slots:w={},$$scope:S}=e,{id:P}=e,{label:M}=e,{hideLabel:E=!1}=e,{min:C=0}=e,{max:z=100}=e,{step:V=1}=e,{value:L=0}=e,{valueMin:y}=e,{valueMax:ct}=e,{trackClass:j}=e,{knobClass:k}=e,{ongrab:N=se}=e,{onchange:nt=se}=e,{onrelease:ft=se}=e,{onexceed:xt=se}=e,{direction:H="x"}=e,{getValue:Z=tn}=e,{setValue:wt=tn}=e,{enableSpinButtons:vt=!0}=e,{enableForceUseKnob:et=!1}=e,{enableStopPropagation:Pt=!0}=e,{enablePointerdownListener:Et=!0}=e,{maxInteractionDistance:kt=6}=e,{class:st}=e;const Ut=pt=>wt(((Xt,Zt)=>(Zt=1/Zt,Math.round(Xt*Zt)/Zt))(an(pt,C,z),V),L),rt=(pt,Xt,Zt={})=>{const{grabbed:ie=!1,released:gt=!1}=Zt,te=Ut(C+pt/Xt*o),xe=y||C,_=ct||z;r(22,L=Ge(te)?te:an(te,xe,_)),v!==te&&(v=te,!Ge(te)&&(te<xe||te>_)&&xt(L,te),L!==b&&(b=L,ie&&N(L),nt(L),gt&&ft(L)))};let X,q;const Ft=pt=>{const Xt=pt[d]-$;rt(g+Xt,f)},zt=pt=>{q=setTimeout(()=>{f=void 0},50),document.documentElement.removeEventListener("pointermove",Ft),document.documentElement.removeEventListener("pointerup",zt),nt(L),ft(L)},yt=()=>{r(22,L=Ut(i+Wt*V)),nt(L)};let Dt=null,Wt=1,at=!1;const St=pt=>{clearTimeout(Dt),Dt=null,at||yt(),ft(L),document.removeEventListener("pointerup",St),document.removeEventListener("keyup",St)};return t.$$set=pt=>{"id"in pt&&r(23,P=pt.id),"label"in pt&&r(0,M=pt.label),"hideLabel"in pt&&r(1,E=pt.hideLabel),"min"in pt&&r(2,C=pt.min),"max"in pt&&r(3,z=pt.max),"step"in pt&&r(4,V=pt.step),"value"in pt&&r(22,L=pt.value),"valueMin"in pt&&r(24,y=pt.valueMin),"valueMax"in pt&&r(25,ct=pt.valueMax),"trackClass"in pt&&r(5,j=pt.trackClass),"knobClass"in pt&&r(6,k=pt.knobClass),"ongrab"in pt&&r(26,N=pt.ongrab),"onchange"in pt&&r(27,nt=pt.onchange),"onrelease"in pt&&r(28,ft=pt.onrelease),"onexceed"in pt&&r(29,xt=pt.onexceed),"direction"in pt&&r(7,H=pt.direction),"getValue"in pt&&r(30,Z=pt.getValue),"setValue"in pt&&r(31,wt=pt.setValue),"enableSpinButtons"in pt&&r(8,vt=pt.enableSpinButtons),"enableForceUseKnob"in pt&&r(9,et=pt.enableForceUseKnob),"enableStopPropagation"in pt&&r(32,Pt=pt.enableStopPropagation),"enablePointerdownListener"in pt&&r(10,Et=pt.enablePointerdownListener),"maxInteractionDistance"in pt&&r(33,kt=pt.maxInteractionDistance),"class"in pt&&r(11,st=pt.class),"$$scope"in pt&&r(40,S=pt.$$scope)},t.$$.update=()=>{8388609&t.$$.dirty[0]&&r(17,n=P||(M?"PinturaSlider_"+ra():void 0)),1077936128&t.$$.dirty[0]&&r(13,i=L!==void 0?Z(L):0),12&t.$$.dirty[0]&&(o=z-C),8204&t.$$.dirty[0]&&r(35,a=Kc(i,C,z)),16&t.$$.dirty[1]&&r(14,s=100*a),128&t.$$.dirty[0]&&r(36,l=H.toUpperCase()),128&t.$$.dirty[0]&&r(37,c=H==="x"?"Width":"Height"),64&t.$$.dirty[1]&&(u="offset"+c),32&t.$$.dirty[1]&&(d="page"+l),16384&t.$$.dirty[0]|32&t.$$.dirty[1]&&r(16,p=`translate${l}(${s}%)`)},[M,E,C,z,V,j,k,H,vt,et,Et,st,pt=>{clearTimeout(q);let Xt=!1;Pt&&pt.stopPropagation(),clearTimeout(X);const Zt=h.getBoundingClientRect();if(f=h[u],$=pt[d],g=$-Zt[H],et){if(Math.abs(g-a*f)>kt)return;Xt=!0,pt.stopPropagation()}return document.activeElement!==h&&h.focus(),rt(g,f,{grabbed:!0}),document.documentElement.addEventListener("pointermove",Ft),document.documentElement.addEventListener("pointerup",zt),Xt},i,s,h,p,n,pt=>{f||(r(22,L=wt(parseFloat(pt.target.value))),L!==b&&(b=L,nt(L)))},pt=>{const Xt=h[u];rt(i/o*Xt+pt.detail[H],Xt),clearTimeout(X),X=setTimeout(()=>{ft(L)},250)},pt=>Xt=>{(Xt.type!=="keydown"||fb(Xt.key)&&Dt===null)&&(clearTimeout(X),Wt=pt,at=!1,Dt=setInterval(()=>{at=!0,yt()},100),Xt.type==="pointerdown"?(document.addEventListener("pointercancel",St),document.addEventListener("pointerup",St)):document.addEventListener("keyup",St))},pt=>{const Xt=yu(pt),Zt=Xt<0?Math.floor(Xt):Math.ceil(Xt);r(22,L=Ut(i+Zt*V)),nt(L)},L,P,y,ct,N,nt,ft,xt,Z,wt,Pt,kt,pt=>{const Xt=h.getBoundingClientRect(),Zt=pt[d]-Xt[H],ie=h[u];return Math.abs(Zt-a*ie)},a,l,c,w,function(pt){jr[pt?"unshift":"push"](()=>{h=pt,r(15,h)})},S]}class P0 extends gr{constructor(e){super(),fr(this,e,V4,_4,cr,{id:23,label:0,hideLabel:1,min:2,max:3,step:4,value:22,valueMin:24,valueMax:25,trackClass:5,knobClass:6,ongrab:26,onchange:27,onrelease:28,onexceed:29,direction:7,getValue:30,setValue:31,enableSpinButtons:8,enableForceUseKnob:9,enableStopPropagation:32,enablePointerdownListener:10,maxInteractionDistance:33,class:11,eventDistanceToKnob:34,handlePointerDown:12},null,[-1,-1])}get eventDistanceToKnob(){return this.$$.ctx[34]}get handlePointerDown(){return this.$$.ctx[12]}}function jg(t){let e,r;return e=new Ho({props:{class:"PinturaButtonIcon",$$slots:{default:[N4]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};1048580&i&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function N4(t){let e;return{c(){e=Li("g")},m(r,n){tt(r,e,n),e.innerHTML=t[2]},p(r,n){4&n&&(e.innerHTML=r[2])},d(r){r&&J(e)}}}function Ug(t){let e,r,n=Fi(t[8],t[6])+"";return{c(){e=mt("span"),r=Mn(n),T(e,"class","PinturaButtonLabelPrefix")},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){320&o&&n!==(n=Fi(i[8],i[6])+"")&&Gn(r,n)},d(i){i&&J(e)}}}function H4(t){let e,r,n,i,o,a,s,l,c,u=t[2]&&jg(t),d=t[8]&&Ug(t);return{c(){e=mt("span"),u&&u.c(),r=ue(),d&&d.c(),n=ue(),i=mt("span"),o=Mn(t[9]),T(i,"class",a=br(["PinturaButtonLabel",t[3],t[5]&&"implicit"])),T(e,"slot","label"),T(e,"title",s=Fi(t[1],t[6])),T(e,"class",l=br(["PinturaButtonInner",t[4]]))},m(p,h){tt(p,e,h),u&&u.m(e,null),Lt(e,r),d&&d.m(e,null),Lt(e,n),Lt(e,i),Lt(i,o),c=!0},p(p,h){p[2]?u?(u.p(p,h),4&h&&I(u,1)):(u=jg(p),u.c(),I(u,1),u.m(e,r)):u&&(Fe(),B(u,1,1,()=>{u=null}),ze()),p[8]?d?d.p(p,h):(d=Ug(p),d.c(),d.m(e,n)):d&&(d.d(1),d=null),(!c||512&h)&&Gn(o,p[9]),(!c||40&h&&a!==(a=br(["PinturaButtonLabel",p[3],p[5]&&"implicit"])))&&T(i,"class",a),(!c||66&h&&s!==(s=Fi(p[1],p[6])))&&T(e,"title",s),(!c||16&h&&l!==(l=br(["PinturaButtonInner",p[4]])))&&T(e,"class",l)},i(p){c||(I(u),c=!0)},o(p){B(u),c=!1},d(p){p&&J(e),u&&u.d(),d&&d.d()}}}function j4(t){let e,r,n,i,o;const a=[{label:Fi(t[1],t[6])},{hideLabel:!0},t[12],{value:t[7]},{onchange:t[11]}];let s={};for(let l=0;l<a.length;l+=1)s=_n(s,a[l]);return r=new P0({props:s}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"slot","details")},m(l,c){tt(l,e,c),Vt(r,e,null),n=!0,i||(o=Tt(e,"keydown",t[10]),i=!0)},p(l,c){const u=6338&c?zi(a,[66&c&&{label:Fi(l[1],l[6])},a[1],4096&c&&Gi(l[12]),128&c&&{value:l[7]},2048&c&&{onchange:l[11]}]):{};r.$set(u)},i(l){n||(I(r.$$.fragment,l),n=!0)},o(l){B(r.$$.fragment,l),n=!1},d(l){l&&J(e),Nt(r),i=!1,o()}}}function U4(t){let e,r;return e=new mp({props:{panelClass:"PinturaSliderPanel",buttonClass:br(["PinturaSliderButton",t[0],t[5]&&"PinturaSliderIconOnly"]),$$slots:{details:[j4],label:[H4]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,[i]){const o={};33&i&&(o.buttonClass=br(["PinturaSliderButton",n[0],n[5]&&"PinturaSliderIconOnly"])),1053694&i&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function G4(t,e,r){const n=["class","title","label","icon","labelClass","innerClass","hideLabel","locale","value","onchange","labelPrefix"];let i=If(e,n),{class:o}=e,{title:a}=e,{label:s=Math.round}=e,{icon:l}=e,{labelClass:c}=e,{innerClass:u}=e,{hideLabel:d=!1}=e,{locale:p}=e,{value:h}=e,{onchange:f=se}=e,{labelPrefix:g}=e;const{min:$,max:b,getValue:v=tn}=i;let w;const S=P=>r(9,w=(M=>Vr(s)?s(v(M),$,b,M):s)(P));return t.$$set=P=>{e=_n(_n({},e),lu(P)),r(12,i=If(e,n)),"class"in P&&r(0,o=P.class),"title"in P&&r(1,a=P.title),"label"in P&&r(13,s=P.label),"icon"in P&&r(2,l=P.icon),"labelClass"in P&&r(3,c=P.labelClass),"innerClass"in P&&r(4,u=P.innerClass),"hideLabel"in P&&r(5,d=P.hideLabel),"locale"in P&&r(6,p=P.locale),"value"in P&&r(7,h=P.value),"onchange"in P&&r(14,f=P.onchange),"labelPrefix"in P&&r(8,g=P.labelPrefix)},t.$$.update=()=>{8320&t.$$.dirty&&S(h)},[o,a,l,c,u,d,p,h,g,w,P=>{/tab/i.test(P.key)&&P.preventDefault()},P=>{S(P),f(P)},i,s,f]}class Z4 extends gr{constructor(e){super(),fr(this,e,G4,U4,cr,{class:0,title:1,label:13,icon:2,labelClass:3,innerClass:4,hideLabel:5,locale:6,value:7,onchange:14,labelPrefix:8})}}function X4(t){let e,r,n,i,o,a,s,l;return{c(){e=mt("span"),r=Li("svg"),n=Li("g"),i=Li("circle"),o=Li("circle"),a=ue(),s=mt("span"),l=Mn(t[3]),T(i,"class","PinturaProgressIndicatorBar"),T(i,"r","8.5"),T(i,"cx","10"),T(i,"cy","10"),T(i,"stroke-linecap","round"),T(i,"opacity",".25"),T(o,"class","PinturaProgressIndicatorFill"),T(o,"r","8.5"),T(o,"stroke-dasharray",t[2]),T(o,"cx","10"),T(o,"cy","10"),T(o,"transform","rotate(-90) translate(-20)"),T(n,"fill","none"),T(n,"stroke","currentColor"),T(n,"stroke-width","2.5"),T(n,"stroke-linecap","round"),T(n,"opacity",t[1]),T(r,"width","20"),T(r,"height","20"),T(r,"viewBox","0 0 20 20"),T(r,"xmlns","http://www.w3.org/2000/svg"),T(r,"aria-hidden","true"),T(r,"focusable","false"),T(s,"class","implicit"),T(e,"class","PinturaProgressIndicator"),T(e,"data-status",t[0]),Mt(e,"opacity",t[4])},m(c,u){tt(c,e,u),Lt(e,r),Lt(r,n),Lt(n,i),Lt(n,o),Lt(e,a),Lt(e,s),Lt(s,l)},p(c,[u]){4&u&&T(o,"stroke-dasharray",c[2]),2&u&&T(n,"opacity",c[1]),8&u&&Gn(l,c[3]),1&u&&T(e,"data-status",c[0]),16&u&&Mt(e,"opacity",c[4])},i:qe,o:qe,d(c){c&&J(e)}}}function Y4(t,e,r){let n,i,o,a,s,l,c,u;const d=ba();let{progress:p}=e,{min:h=0}=e,{max:f=100}=e,{labelBusy:g="Busy"}=e,{opacity:$}=e;const b=$n("isAnimated");D(t,b,E=>r(14,s=E));const v=hr($,{precision:.01});D(t,v,E=>r(4,u=E));const w=hr(0,{precision:.01}),S=hr(0,{precision:.01});D(t,S,E=>r(15,l=E));const P=Hr([w],E=>an(E,h,f));D(t,P,E=>r(16,c=E));const M=P.subscribe(E=>{p===1&&Math.round(E)>=100&&d("complete")});return xs(()=>{S.set(1,{hard:!s})}),jo(()=>{M()}),t.$$set=E=>{"progress"in E&&r(9,p=E.progress),"min"in E&&r(10,h=E.min),"max"in E&&r(11,f=E.max),"labelBusy"in E&&r(12,g=E.labelBusy),"opacity"in E&&r(13,$=E.opacity)},t.$$.update=()=>{24576&t.$$.dirty&&_e($)&&v.set($,{hard:!s}),16896&t.$$.dirty&&p&&p!==1/0&&w.set(100*p,{hard:!s}),70144&t.$$.dirty&&r(3,n=p===1/0?g:Math.round(c)+"%"),66048&t.$$.dirty&&r(2,i=p===1/0?"26.5 53":c/100*53+" 53"),32768&t.$$.dirty&&r(1,o=l),512&t.$$.dirty&&r(0,a=p===1/0?"busy":"loading")},[a,o,i,n,u,b,v,S,P,p,h,f,g,$,s,l,c]}class yb extends gr{constructor(e){super(),fr(this,e,Y4,X4,cr,{progress:9,min:10,max:11,labelBusy:12,opacity:13})}}function Gg(t){let e,r,n=Fi(t[0],t[1])+"";return{c(){e=mt("span"),r=Mn(n),T(e,"class",t[3])},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){3&o&&n!==(n=Fi(i[0],i[1])+"")&&Gn(r,n),8&o&&T(e,"class",i[3])},d(i){i&&J(e)}}}function q4(t){let e,r,n,i,o=t[0]&&Gg(t);return n=new Qi({props:{items:t[2]}}),{c(){e=mt("li"),o&&o.c(),r=ue(),Ht(n.$$.fragment),T(e,"class","PinturaShapeStyle")},m(a,s){tt(a,e,s),o&&o.m(e,null),Lt(e,r),Vt(n,e,null),i=!0},p(a,[s]){a[0]?o?o.p(a,s):(o=Gg(a),o.c(),o.m(e,r)):o&&(o.d(1),o=null);const l={};4&s&&(l.items=a[2]),n.$set(l)},i(a){i||(I(n.$$.fragment,a),i=!0)},o(a){B(n.$$.fragment,a),i=!1},d(a){a&&J(e),o&&o.d(),Nt(n)}}}function K4(t,e,r){let n,{title:i}=e,{locale:o}=e,{items:a}=e,{hideTitle:s=!1}=e;return t.$$set=l=>{"title"in l&&r(0,i=l.title),"locale"in l&&r(1,o=l.locale),"items"in l&&r(2,a=l.items),"hideTitle"in l&&r(4,s=l.hideTitle)},t.$$.update=()=>{16&t.$$.dirty&&r(3,n="PinturaShapeStyleLabel"+(s?" implicit":""))},[i,o,a,n,s]}class J4 extends gr{constructor(e){super(),fr(this,e,K4,q4,cr,{title:0,locale:1,items:2,hideTitle:4})}}var Zg=(t,e,r)=>{let n,i,o;const a=Math.floor(6*t),s=6*t-a,l=r*(1-e),c=r*(1-s*e),u=r*(1-(1-s)*e);switch(a%6){case 0:n=r,i=u,o=l;break;case 1:n=c,i=r,o=l;break;case 2:n=l,i=r,o=u;break;case 3:n=l,i=c,o=r;break;case 4:n=u,i=l,o=r;break;case 5:n=r,i=l,o=c}return[n,i,o]};function Q4(t){let e,r;return{c(){e=mt("div"),r=mt("span"),T(e,"class","PinturaColorPreview"),T(e,"title",t[0]),Mt(e,"--color",t[1])},m(n,i){tt(n,e,i),Lt(e,r)},p(n,[i]){1&i&&T(e,"title",n[0]),2&i&&Mt(e,"--color",n[1])},i:qe,o:qe,d(n){n&&J(e)}}}function t3(t,e,r){let n,{color:i}=e,{title:o}=e;return t.$$set=a=>{"color"in a&&r(2,i=a.color),"title"in a&&r(0,o=a.title)},t.$$.update=()=>{4&t.$$.dirty&&r(1,n=i?Ai(i):"transparent")},[o,n,i]}class R0 extends gr{constructor(e){super(),fr(this,e,t3,Q4,cr,{color:2,title:0})}}var np=t=>(t=t.trim(),/^rgba/.test(t)?t.substring(5).split(",").map(parseFloat).map((e,r)=>e/(r===3?1:255)):/^rgb/.test(t)?t.substring(4).split(",").map(parseFloat).map(e=>e/255):/^#/.test(t)?(e=>{const[,r,n,i,o]=e.split("");e=e.length>=4&&e.length<=5?`#${r}${r}${n}${n}${i}${i}${o?`${o}${o}`:""}`:e;const[a,s,l,c,u]=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(e)||[];if(a)return[s,l,c,u].filter(d=>d!==void 0).map(d=>parseInt(d,16)/255)})(t):/[0-9]{1,3}\s?,\s?[0-9]{1,3}\s?,\s?[0-9]{1,3}/.test(t)?t.split(",").map(e=>parseInt(e,10)).map(e=>e/255):void 0);let l1=null;function Xg(t){let e,r;return{c(){e=mt("span"),r=Mn(t[0])},m(n,i){tt(n,e,i),Lt(e,r)},p(n,i){1&i[0]&&Gn(r,n[0])},d(n){n&&J(e)}}}function e3(t){let e,r,n,i;r=new R0({props:{color:t[4],title:Fi(t[8],t[10])}});let o=!t[9]&&Xg(t);return{c(){e=mt("span"),Ht(r.$$.fragment),n=ue(),o&&o.c(),T(e,"slot","label"),T(e,"class","PinturaButtonLabel")},m(a,s){tt(a,e,s),Vt(r,e,null),Lt(e,n),o&&o.m(e,null),i=!0},p(a,s){const l={};16&s[0]&&(l.color=a[4]),1280&s[0]&&(l.title=Fi(a[8],a[10])),r.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=Xg(a),o.c(),o.m(e,null))},i(a){i||(I(r.$$.fragment,a),i=!0)},o(a){B(r.$$.fragment,a),i=!1},d(a){a&&J(e),Nt(r),o&&o.d()}}}function Yg(t){let e,r,n,i,o,a,s,l,c,u,d,p;s=new P0({props:{label:"Hue",hideLabel:!0,class:"PinturaHuePicker",onchange:t[27],value:t[16],min:0,max:1,step:.01}});let h=t[11]&&qg(t),f=(t[14]||t[15])&&Kg(t);return{c(){e=mt("div"),r=mt("div"),n=mt("div"),i=mt("div"),o=ue(),a=mt("div"),Ht(s.$$.fragment),l=ue(),h&&h.c(),c=ue(),f&&f.c(),T(i,"role","button"),T(i,"aria-label","Saturation slider"),T(i,"class","PinturaPickerKnob"),T(i,"tabindex","0"),Mt(i,"background-color",t[20]),T(n,"class","PinturaPickerKnobController"),Mt(n,"transform",`translate(${t[25]}%,${t[24]}%)`),T(r,"class","PinturaSaturationPicker"),Mt(r,"background-color",t[21]),Mt(a,"--knob-background",t[21]),T(e,"class","PinturaPicker")},m(g,$){tt(g,e,$),Lt(e,r),Lt(r,n),Lt(n,i),t[42](r),Lt(e,o),Lt(e,a),Vt(s,a,null),Lt(e,l),h&&h.m(e,null),Lt(e,c),f&&f.m(e,null),u=!0,d||(p=[Tt(i,"nudge",t[30]),Tr(Ss.call(null,i,{preventDefault:!0})),Tt(r,"pointerdown",t[29])],d=!0)},p(g,$){1048576&$[0]&&Mt(i,"background-color",g[20]),50331648&$[0]&&Mt(n,"transform",`translate(${g[25]}%,${g[24]}%)`),2097152&$[0]&&Mt(r,"background-color",g[21]);const b={};65536&$[0]&&(b.value=g[16]),s.$set(b),2097152&$[0]&&Mt(a,"--knob-background",g[21]),g[11]?h?(h.p(g,$),2048&$[0]&&I(h,1)):(h=qg(g),h.c(),I(h,1),h.m(e,c)):h&&(Fe(),B(h,1,1,()=>{h=null}),ze()),g[14]||g[15]?f?(f.p(g,$),49152&$[0]&&I(f,1)):(f=Kg(g),f.c(),I(f,1),f.m(e,null)):f&&(Fe(),B(f,1,1,()=>{f=null}),ze())},i(g){u||(I(s.$$.fragment,g),I(h),I(f),u=!0)},o(g){B(s.$$.fragment,g),B(h),B(f),u=!1},d(g){g&&J(e),t[42](null),Nt(s),h&&h.d(),f&&f.d(),d=!1,Ur(p)}}}function qg(t){let e,r,n;return r=new P0({props:{label:"Opacity",hideLabel:!0,class:"PinturaOpacityPicker",onchange:t[28],value:t[17],min:0,max:1,step:.01}}),{c(){e=mt("div"),Ht(r.$$.fragment),Mt(e,"--knob-background",t[18]),Mt(e,"--track-background",`linear-gradient(to right,${t[19]},${t[20]})`)},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};131072&o[0]&&(a.value=i[17]),r.$set(a),262144&o[0]&&Mt(e,"--knob-background",i[18]),1572864&o[0]&&Mt(e,"--track-background",`linear-gradient(to right,${i[19]},${i[20]})`)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function Kg(t){let e,r,n,i,o,a,s,l=t[15]&&Jg(t);return{c(){e=mt("div"),r=mt("input"),i=ue(),l&&l.c(),T(r,"class","PinturaColorPickerInput"),T(r,"type","text"),r.disabled=n=!t[14],r.value=t[23],T(e,"class","PinturColorPickerInputGroup")},m(c,u){tt(c,e,u),Lt(e,r),Lt(e,i),l&&l.m(e,null),o=!0,a||(s=[Tt(r,"keydown",t[32]),Tt(r,"input",t[31])],a=!0)},p(c,u){(!o||16384&u[0]&&n!==(n=!c[14]))&&(r.disabled=n),(!o||8388608&u[0]&&r.value!==c[23])&&(r.value=c[23]),c[15]?l?(l.p(c,u),32768&u[0]&&I(l,1)):(l=Jg(c),l.c(),I(l,1),l.m(e,null)):l&&(Fe(),B(l,1,1,()=>{l=null}),ze())},i(c){o||(I(l),o=!0)},o(c){B(l),o=!1},d(c){c&&J(e),l&&l.d(),a=!1,Ur(s)}}}function Jg(t){let e,r;return e=new ks({props:{icon:'<path stroke="currentColor" stroke-linecap="square" d="m13 14-7 7a2.704 2.704 0 0 1-3 0 2.704 2.704 0 0 1 0-3l7-7"/><path fill="currentColor" d="M9.475 9.475 14.5 14.5c.263.263.69.265.955.005l.783-.767a4.209 4.209 0 0 0 1.262-3.006V10l4-4c.5-.5.375-2.125-.5-3s-2.5-1-3-.5l-4 4h-.732a4.329 4.329 0 0 0-3.03 1.238l-.758.742a.7.7 0 0 0-.005.995Z"/>',hideLabel:!0,label:"Pick a color",class:"PinturaEyeDropper",onclick:t[33]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p:qe,i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function Qg(t){let e,r;return e=new ws({props:{label:Fi(t[10].labelColorPalette,t[10]),class:br(["PinturaColorPresets",t[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"]),hideLabel:!1,name:t[1],value:t[4],optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[2].map(t[43]),selectedIndex:t[3],optionMapper:t[7],optionLabelClass:t[6],onchange:t[44],$$slots:{option:[n3,({option:n})=>({60:n}),({option:n})=>[0,n?536870912:0]],group:[r3,({option:n})=>({60:n}),({option:n})=>[0,n?536870912:0]]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};1024&i[0]&&(o.label=Fi(n[10].labelColorPalette,n[10])),512&i[0]&&(o.class=br(["PinturaColorPresets",n[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"])),2&i[0]&&(o.name=n[1]),16&i[0]&&(o.value=n[4]),4&i[0]&&(o.options=n[2].map(n[43])),8&i[0]&&(o.selectedIndex=n[3]),128&i[0]&&(o.optionMapper=n[7]),64&i[0]&&(o.optionLabelClass=n[6]),512&i[0]|1610612736&i[1]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function r3(t){let e,r,n=t[60].label+"";return{c(){e=mt("span"),r=Mn(n),T(e,"slot","group")},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){536870912&o[1]&&n!==(n=i[60].label+"")&&Gn(r,n)},d(i){i&&J(e)}}}function t$(t){let e,r,n=t[60].label+"";return{c(){e=mt("span"),r=Mn(n),T(e,"class","PinturaButtonLabel")},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){536870912&o[1]&&n!==(n=i[60].label+"")&&Gn(r,n)},d(i){i&&J(e)}}}function n3(t){let e,r,n,i;r=new R0({props:{color:t[60].value}});let o=!t[9]&&t$(t);return{c(){e=mt("span"),Ht(r.$$.fragment),n=ue(),o&&o.c(),T(e,"slot","option")},m(a,s){tt(a,e,s),Vt(r,e,null),Lt(e,n),o&&o.m(e,null),i=!0},p(a,s){const l={};536870912&s[1]&&(l.color=a[60].value),r.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=t$(a),o.c(),o.m(e,null))},i(a){i||(I(r.$$.fragment,a),i=!0)},o(a){B(r.$$.fragment,a),i=!1},d(a){a&&J(e),Nt(r),o&&o.d()}}}function i3(t){let e,r,n,i=t[13]&&Yg(t),o=t[12]&&Qg(t);return{c(){e=mt("div"),i&&i.c(),r=ue(),o&&o.c(),T(e,"slot","details"),T(e,"class","PinturaColorPickerPanel")},m(a,s){tt(a,e,s),i&&i.m(e,null),Lt(e,r),o&&o.m(e,null),n=!0},p(a,s){a[13]?i?(i.p(a,s),8192&s[0]&&I(i,1)):(i=Yg(a),i.c(),I(i,1),i.m(e,r)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze()),a[12]?o?(o.p(a,s),4096&s[0]&&I(o,1)):(o=Qg(a),o.c(),I(o,1),o.m(e,null)):o&&(Fe(),B(o,1,1,()=>{o=null}),ze())},i(a){n||(I(i),I(o),n=!0)},o(a){B(i),B(o),n=!1},d(a){a&&J(e),i&&i.d(),o&&o.d()}}}function o3(t){let e,r;return e=new mp({props:{buttonClass:br(["PinturaColorPickerButton",t[5]]),$$slots:{details:[i3],label:[e3]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};32&i[0]&&(o.buttonClass=br(["PinturaColorPickerButton",n[5]])),67108831&i[0]|1073741824&i[1]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function a3(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,{label:$}=e,{name:b}=e,{options:v=[]}=e,{selectedIndex:w=-1}=e,{value:S}=e,{buttonClass:P}=e,{optionLabelClass:M}=e,{optionMapper:E}=e,{onchange:C}=e,{title:z}=e,{hidePresetLabel:V=!0}=e,{locale:L}=e,{enableOpacity:y=!0}=e,{enablePresets:ct=!0}=e,{enablePicker:j=!0}=e,{enableInput:k=!1}=e,{enableEyeDropper:N=!1}=e,nt="transparent",ft="transparent";const xt=(yt,Dt)=>{if(p=[yt[0],yt[1],yt[2]],Dt){let Wt=((Xt,Zt,ie)=>{let gt=Math.max(Xt,Zt,ie),te=gt-Math.min(Xt,Zt,ie),xe=te&&(gt==Xt?(Zt-ie)/te:gt==Zt?2+(ie-Xt)/te:4+(Xt-Zt)/te);return[60*(xe<0?xe+6:xe)/360,gt&&te/gt,gt]})(...p),at=Wt[0],St=Wt[1],pt=Wt[2];_e(Pt)&&(at=Pt),_e(vt)&&(St=vt),_e(et)&&(pt=et),r(16,l=at),r(37,c=St),r(38,u=pt),r(17,d=_e(yt[3])?yt[3]:1)}r(18,h=Ai(yt)),r(19,f=Ai([...p,0])),r(20,nt=Ai([...p,1])),r(21,ft=Ai(Zg(l,1,1)))},H=()=>{const yt=[...Zg(l,c,u),d];xt(yt),C(yt)},Z=yt=>{const Dt=yt.length===3?[...yt,1]:yt;wt(),xt(Dt,!0),C(Dt)},wt=()=>{vt=void 0,et=void 0,Pt=void 0};let vt,et,Pt;const Et=(yt,Dt)=>{const Wt=an(yt.x/Dt.width,0,1),at=an(yt.y/Dt.height,0,1);var St,pt;pt=1-at,r(37,c=St=Wt),r(38,u=pt),vt=St,et=pt,H()};let kt,st,Ut,rt;const X=yt=>{const Dt=Un(Ym(yt),rt);Et(jn(He(Ut),Dt),st)},q=yt=>{st=void 0,document.documentElement.removeEventListener("pointermove",X),document.documentElement.removeEventListener("pointerup",q)};let Ft;function zt(yt){return Vr(yt)?yt(L):yt}return t.$$set=yt=>{"label"in yt&&r(0,$=yt.label),"name"in yt&&r(1,b=yt.name),"options"in yt&&r(2,v=yt.options),"selectedIndex"in yt&&r(3,w=yt.selectedIndex),"value"in yt&&r(4,S=yt.value),"buttonClass"in yt&&r(5,P=yt.buttonClass),"optionLabelClass"in yt&&r(6,M=yt.optionLabelClass),"optionMapper"in yt&&r(7,E=yt.optionMapper),"onchange"in yt&&r(35,C=yt.onchange),"title"in yt&&r(8,z=yt.title),"hidePresetLabel"in yt&&r(9,V=yt.hidePresetLabel),"locale"in yt&&r(10,L=yt.locale),"enableOpacity"in yt&&r(11,y=yt.enableOpacity),"enablePresets"in yt&&r(12,ct=yt.enablePresets),"enablePicker"in yt&&r(13,j=yt.enablePicker),"enableInput"in yt&&r(14,k=yt.enableInput),"enableEyeDropper"in yt&&r(36,N=yt.enableEyeDropper)},t.$$.update=()=>{32&t.$$.dirty[1]&&r(15,n=N&&(l1===null&&(l1=ni()&&"EyeDropper"in window),l1)),16&t.$$.dirty[0]|256&t.$$.dirty[1]&&(!S||g&&ys(S,g)||(r(39,g=[...S]),xt(S,!0))),64&t.$$.dirty[1]&&r(25,i=100*c),128&t.$$.dirty[1]&&r(24,o=100-100*u),512&t.$$.dirty[1]&&r(41,a=!!Ft&&Ft.length>=4&&Ft.length<=5),51216&t.$$.dirty[0]|1024&t.$$.dirty[1]&&r(23,s=(k||n)&&S?((yt,Dt,Wt)=>{let at=yt.map(St=>Math.round(255*St).toString(16).toLowerCase().padStart(2,"0"));return(!Dt&&at.length>3||at[3]==="ff")&&at.pop(),Wt&&(at=at.map(St=>St.substring(0,1))),"#"+at.join("")})(S,y,a):void 0)},[$,b,v,w,S,P,M,E,z,V,L,y,ct,j,k,n,l,d,h,f,nt,ft,kt,s,o,i,Z,yt=>{r(16,l=yt),Pt=yt,H()},yt=>{r(17,d=yt),H()},yt=>{yt.stopPropagation(),st=An(kt.offsetWidth,kt.offsetHeight),Ut=(Dt=>lt(Dt.offsetX,Dt.offsetY))(yt),rt=Ym(yt),Et(Ut,st),document.documentElement.addEventListener("pointermove",X),document.documentElement.addEventListener("pointerup",q)},yt=>{st=An(kt.offsetWidth,kt.offsetHeight);const Dt=i/100*st.width,Wt=o/100*st.height;Et({x:Dt+yt.detail.x,y:Wt+yt.detail.y},st)},yt=>{const{value:Dt}=yt.target,Wt=Dt.length;if(!Dt.startsWith("#")||Wt<4||Wt===6||Wt===8||Wt>9||!y&&Wt>7)return;const at=np(Dt);at&&(r(40,Ft=Dt),wt(),xt(at),C(at))},yt=>{yt.stopPropagation()},yt=>{new EyeDropper().open().then(({sRGBHex:Dt})=>{const Wt=np(Dt);Wt&&(Wt[3]=1,r(40,Ft=S),wt(),xt(Wt),C(Wt))}).catch(Dt=>{})},zt,C,N,c,u,g,Ft,a,function(yt){jr[yt?"unshift":"push"](()=>{kt=yt,r(22,kt)})},([yt,Dt])=>[yt,zt(Dt),{title:zt(Dt)}],yt=>Z(yt.value)]}class s3 extends gr{constructor(e){super(),fr(this,e,a3,o3,cr,{label:0,name:1,options:2,selectedIndex:3,value:4,buttonClass:5,optionLabelClass:6,optionMapper:7,onchange:35,title:8,hidePresetLabel:9,locale:10,enableOpacity:11,enablePresets:12,enablePicker:13,enableInput:14,enableEyeDropper:36},null,[-1,-1])}}function l3(t){let e,r,n;return r=new Qi({props:{items:t[0]}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"class","PinturaShorthandControl PinturaShapeStyle")},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,[o]){const a={};1&o&&(a.items=i[0]),r.$set(a)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function c3(t,e,r){let n,i,{value:o}=e,{onchange:a}=e,{controls:s=[]}=e;return t.$$set=l=>{r(6,e=_n(_n({},e),lu(l))),"value"in l&&r(1,o=l.value),"onchange"in l&&r(2,a=l.onchange),"controls"in l&&r(3,s=l.controls)},t.$$.update=()=>{r(4,n=(l=>{const{controls:c,...u}=l;return u})(e)),30&t.$$.dirty&&r(0,i=s.map((l,c)=>{const[u,d,p]=l;return[u,d,{...n,...p,value:o[c],onchange:h=>{const f=[...o];f[c]=h,a(f)}}]}))},e=lu(e),[i,o,a,s,n]}class u3 extends gr{constructor(e){super(),fr(this,e,c3,l3,cr,{value:1,onchange:2,controls:3})}}function d3(t){let e,r;return e=new M0({props:{label:t[4],options:t[1],title:t[2],selectedIndex:t[5],onchange:t[10]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,[i]){const o={};16&i&&(o.label=n[4]),2&i&&(o.options=n[1]),4&i&&(o.title=n[2]),32&i&&(o.selectedIndex=n[5]),9&i&&(o.onchange=n[10]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function p3(t,e,r){let n,i,o,a,{options:s}=e,{title:l}=e,{onchange:c}=e,{selectedIndex:u=-1}=e,{value:d}=e,{label:p}=e;return t.$$set=h=>{"options"in h&&r(1,s=h.options),"title"in h&&r(2,l=h.title),"onchange"in h&&r(3,c=h.onchange),"selectedIndex"in h&&r(0,u=h.selectedIndex),"value"in h&&r(6,d=h.value),"label"in h&&r(7,p=h.label)},t.$$.update=()=>{67&t.$$.dirty&&r(9,n=((h,f,g)=>{if(h)return f>-1?h[f]:g!==void 0?h.find($=>$[0]===g):h[0]})(s,u,d)),514&t.$$.dirty&&r(5,i=s&&s.findIndex(h=>h===n)),512&t.$$.dirty&&r(8,o=n&&n[1]),384&t.$$.dirty&&r(4,a=p||o)},[u,s,l,c,a,i,d,p,o,n,h=>{r(0,u=h.index),c&&c(h)}]}class h3 extends gr{constructor(e){super(),fr(this,e,p3,d3,cr,{options:1,title:2,onchange:3,selectedIndex:0,value:6,label:7})}}function e$(t,e,r){const n=t.slice();return n[9]=e[r][0],n[0]=e[r][1],n[10]=e[r][2],n[2]=e[r][3],n}function m3(t){let e,r,n;const i=[t[10]];var o=t[3][t[9]]||t[9];function a(s){let l={};for(let c=0;c<i.length;c+=1)l=_n(l,i[c]);return{props:l}}return o&&(e=tp(o,a())),{c(){e&&Ht(e.$$.fragment),r=Dn()},m(s,l){e&&Vt(e,s,l),tt(s,r,l),n=!0},p(s,l){const c=4&l?zi(i,[Gi(s[10])]):{};if(4&l&&o!==(o=s[3][s[9]]||s[9])){if(e){Fe();const u=e;B(u.$$.fragment,1,0,()=>{Nt(u,1)}),ze()}o?(e=tp(o,a()),Ht(e.$$.fragment),I(e.$$.fragment,1),Vt(e,r.parentNode,r)):e=null}else o&&e.$set(c)},i(s){n||(e&&I(e.$$.fragment,s),n=!0)},o(s){e&&B(e.$$.fragment,s),n=!1},d(s){s&&J(r),e&&Nt(e,s)}}}function f3(t){let e,r=t[9],n=t[9]&&c1(t);return{c(){n&&n.c(),e=Dn()},m(i,o){n&&n.m(i,o),tt(i,e,o)},p(i,o){i[9]?r?cr(r,i[9])?(n.d(1),n=c1(i),r=i[9],n.c(),n.m(e.parentNode,e)):n.p(i,o):(n=c1(i),r=i[9],n.c(),n.m(e.parentNode,e)):r&&(n.d(1),n=null,r=i[9])},i:qe,o(i){B(n)},d(i){i&&J(e),n&&n.d(i)}}}function g3(t){let e,r,n=t[10].innerHTML+"";return{c(){e=new f0(!1),r=Dn(),e.a=r},m(i,o){e.m(n,i,o),tt(i,r,o)},p(i,o){4&o&&n!==(n=i[10].innerHTML+"")&&e.p(n)},i:qe,o:qe,d(i){i&&J(r),i&&e.d()}}}function $3(t){let e,r=t[10].textContent+"";return{c(){e=Mn(r)},m(n,i){tt(n,e,i)},p(n,i){4&i&&r!==(r=n[10].textContent+"")&&Gn(e,r)},i:qe,o:qe,d(n){n&&J(e)}}}function y3(t){let e,r;return e=new Qi({props:{items:t[2],discardEmptyItems:!0}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};4&i&&(o.items=n[2]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function c1(t){let e,r,n,i,o;const a=[y3,$3,g3],s=[];function l(d,p){return d[2]&&d[2].length?0:d[10].textContent?1:d[10].innerHTML?2:-1}~(r=l(t))&&(n=s[r]=a[r](t));let c=[t[4](t[10])],u={};for(let d=0;d<c.length;d+=1)u=_n(u,c[d]);return{c(){e=mt(t[9]),n&&n.c(),i=ue(),Ef(t[9])(e,u)},m(d,p){tt(d,e,p),~r&&s[r].m(e,null),Lt(e,i),o=!0},p(d,p){let h=r;r=l(d),r===h?~r&&s[r].p(d,p):(n&&(Fe(),B(s[h],1,1,()=>{s[h]=null}),ze()),~r?(n=s[r],n?n.p(d,p):(n=s[r]=a[r](d),n.c()),I(n,1),n.m(e,i)):n=null),Ef(d[9])(e,u=zi(c,[4&p&&d[4](d[10])]))},i(d){o||(I(n),o=!0)},o(d){B(n),o=!1},d(d){d&&J(e),~r&&s[r].d()}}}function r$(t,e){let r,n,i,o,a,s;const l=[f3,m3],c=[];function u(d,p){return 4&p&&(n=null),n==null&&(n=!d[5](d[9])),n?0:1}return i=u(e,-1),o=c[i]=l[i](e),{key:t,first:null,c(){r=Dn(),o.c(),a=Dn(),this.first=r},m(d,p){tt(d,r,p),c[i].m(d,p),tt(d,a,p),s=!0},p(d,p){let h=i;i=u(e=d,p),i===h?c[i].p(e,p):(Fe(),B(c[h],1,1,()=>{c[h]=null}),ze(),o=c[i],o?o.p(e,p):(o=c[i]=l[i](e),o.c()),I(o,1),o.m(a.parentNode,a))},i(d){s||(I(o),s=!0)},o(d){B(o),s=!1},d(d){d&&J(r),c[i].d(d),d&&J(a)}}}function b3(t){let e,r,n=[],i=new Map,o=t[2];const a=s=>s[0]+s[1];for(let s=0;s<o.length;s+=1){let l=e$(t,o,s),c=a(l);i.set(c,n[s]=r$(c,l))}return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=Dn()},m(s,l){for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(s,l);tt(s,e,l),r=!0},p(s,[l]){62&l&&(o=s[2],Fe(),n=es(n,l,a,1,s,o,i,e.parentNode,Ys,r$,e,e$),ze())},i(s){if(!r){for(let l=0;l<o.length;l+=1)I(n[l]);r=!0}},o(s){for(let l=0;l<n.length;l+=1)B(n[l]);r=!1},d(s){for(let l=0;l<n.length;l+=1)n[l].d(s);s&&J(e)}}}function x3(t,e,r){let n,i,{items:o}=e,{discardEmptyItems:a=!0}=e,{key:s=""}=e;const l={Button:ks,ImageButton:ub,ImageButtonList:C0,Dropdown:M0,Select:h3,RadioGroup:ws,Input:$b,Panel:D4,ProgressIndicator:yb,ShapeStyle:J4,ToggleSlider:Z4,ColorPicker:s3,ShorthandControl:u3},c=d=>!Ge(d)||!!l[d],u=d=>{if(!d)return!1;const[p,,h,f=[]]=d;return!!c(p)||f.some(u)||h.textContent||h.innerHTML};return t.$$set=d=>{"items"in d&&r(6,o=d.items),"discardEmptyItems"in d&&r(7,a=d.discardEmptyItems),"key"in d&&r(0,s=d.key)},t.$$.update=()=>{1&t.$$.dirty&&r(1,n=s),192&t.$$.dirty&&r(2,i=(o&&a?o.filter(u):o)||[])},[s,n,i,l,(d={})=>{const{textContent:p,innerHTML:h,...f}=d;return f},c,o,a]}class Qi extends gr{constructor(e){super(),fr(this,e,x3,b3,cr,{items:6,discardEmptyItems:7,key:0})}get items(){return this.$$.ctx[6]}set items(e){this.$$set({items:e}),A()}get discardEmptyItems(){return this.$$.ctx[7]}set discardEmptyItems(e){this.$$set({discardEmptyItems:e}),A()}get key(){return this.$$.ctx[0]}set key(e){this.$$set({key:e}),A()}}function n$(t){let e,r;return e=new Ho({props:{class:"PinturaButtonIcon",$$slots:{default:[v3]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};536870920&i&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function v3(t){let e;return{c(){e=Li("g")},m(r,n){tt(r,e,n),e.innerHTML=t[3]},p(r,n){8&n&&(e.innerHTML=r[3])},d(r){r&&J(e)}}}function w3(t){let e;return{c(){e=mt("span"),T(e,"class",t[11])},m(r,n){tt(r,e,n),e.innerHTML=t[0]},p(r,n){1&n&&(e.innerHTML=r[0]),2048&n&&T(e,"class",r[11])},i:qe,o:qe,d(r){r&&J(e)}}}function S3(t){let e,r,n;return r=new Qi({props:{items:t[0]}}),{c(){e=mt("span"),Ht(r.$$.fragment),T(e,"class",t[11])},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};1&o&&(a.items=i[0]),r.$set(a),(!n||2048&o)&&T(e,"class",i[11])},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function k3(t){let e,r,n,i,o,a;const s=t[27].default,l=yi(s,t,t[29],null),c=l||function(u){let d,p,h,f,g,$,b=u[3]&&n$(u);const v=[S3,w3],w=[];function S(P,M){return 1&M&&(h=null),h==null&&(h=!!En(P[0])),h?0:1}return f=S(u,-1),g=w[f]=v[f](u),{c(){d=mt("span"),b&&b.c(),p=ue(),g.c(),T(d,"class",u[13])},m(P,M){tt(P,d,M),b&&b.m(d,null),Lt(d,p),w[f].m(d,null),$=!0},p(P,M){P[3]?b?(b.p(P,M),8&M&&I(b,1)):(b=n$(P),b.c(),I(b,1),b.m(d,p)):b&&(Fe(),B(b,1,1,()=>{b=null}),ze());let E=f;f=S(P,M),f===E?w[f].p(P,M):(Fe(),B(w[E],1,1,()=>{w[E]=null}),ze(),g=w[f],g?g.p(P,M):(g=w[f]=v[f](P),g.c()),I(g,1),g.m(d,null)),(!$||8192&M)&&T(d,"class",P[13])},i(P){$||(I(b),I(g),$=!0)},o(P){B(b),B(g),$=!1},d(P){P&&J(d),b&&b.d(),w[f].d()}}}(t);return{c(){e=mt("button"),c&&c.c(),T(e,"type",t[6]),e.disabled=t[5],T(e,"class",t[12]),T(e,"title",r=rp(t[0],t[1],t[2]))},m(u,d){tt(u,e,d),c&&c.m(e,null),t[28](e),i=!0,o||(a=[Tt(e,"keydown",function(){kr(t[8])&&t[8].apply(this,arguments)}),Tt(e,"click",function(){kr(t[7])&&t[7].apply(this,arguments)}),Tt(e,"pointerdown",function(){kr(t[14])&&t[14].apply(this,arguments)}),Tr(n=vs.call(null,e,t[4])),Tr(t[9].call(null,e))],o=!0)},p(u,[d]){t=u,l?l.p&&(!i||536870912&d)&&xi(l,s,t,t[29],i?bi(s,t[29],d,null):vi(t[29]),null):c&&c.p&&(!i||10249&d)&&c.p(t,i?d:-1),(!i||64&d)&&T(e,"type",t[6]),(!i||32&d)&&(e.disabled=t[5]),(!i||4096&d)&&T(e,"class",t[12]),(!i||7&d&&r!==(r=rp(t[0],t[1],t[2])))&&T(e,"title",r),n&&kr(n.update)&&16&d&&n.update.call(null,t[4])},i(u){i||(I(c,u),i=!0)},o(u){B(c,u),i=!1},d(u){u&&J(e),c&&c.d(u),t[28](null),o=!1,Ur(a)}}}function T3(t,e,r){let n,i,o,a,s,l,{$$slots:c={},$$scope:u}=e,{class:d}=e,{label:p}=e,{title:h}=e,{shortcut:f}=e,{labelClass:g}=e,{innerClass:$}=e,{hideLabel:b=!1}=e,{icon:v}=e,{style:w}=e,{disabled:S}=e,{type:P="button"}=e,{onclick:M}=e,{onkeydown:E}=e,{onhold:C}=e,{action:z=()=>{}}=e,{holdThreshold:V=500}=e,{holdSpeedUpFactor:L=.5}=e,{holdSpeedMin:y=20}=e;const ct=k=>{r(25,l=setTimeout(()=>{C(),ct(Math.max(k*L,y))},k))};let j;return t.$$set=k=>{"class"in k&&r(15,d=k.class),"label"in k&&r(0,p=k.label),"title"in k&&r(1,h=k.title),"shortcut"in k&&r(2,f=k.shortcut),"labelClass"in k&&r(16,g=k.labelClass),"innerClass"in k&&r(17,$=k.innerClass),"hideLabel"in k&&r(18,b=k.hideLabel),"icon"in k&&r(3,v=k.icon),"style"in k&&r(4,w=k.style),"disabled"in k&&r(5,S=k.disabled),"type"in k&&r(6,P=k.type),"onclick"in k&&r(7,M=k.onclick),"onkeydown"in k&&r(8,E=k.onkeydown),"onhold"in k&&r(19,C=k.onhold),"action"in k&&r(9,z=k.action),"holdThreshold"in k&&r(20,V=k.holdThreshold),"holdSpeedUpFactor"in k&&r(21,L=k.holdSpeedUpFactor),"holdSpeedMin"in k&&r(22,y=k.holdSpeedMin),"$$scope"in k&&r(29,u=k.$$scope)},t.$$.update=()=>{101187584&t.$$.dirty&&r(26,i=C?()=>{l&&(clearTimeout(l),r(25,l=void 0),document.documentElement.removeEventListener("pointerup",i))}:se),68681728&t.$$.dirty&&r(14,n=C?()=>{document.documentElement.addEventListener("pointerup",i),ct(V)}:se),131072&t.$$.dirty&&r(13,o=br(["PinturaButtonInner",$])),294912&t.$$.dirty&&r(12,a=br(["PinturaButton",b&&"PinturaButtonIconOnly",d])),327680&t.$$.dirty&&r(11,s=br([b?"implicit":"PinturaButtonLabel",g]))},[p,h,f,v,w,S,P,M,E,z,j,s,a,o,n,d,g,$,b,C,V,L,y,k=>cb(k,j),()=>j,l,i,c,function(k){jr[k?"unshift":"push"](()=>{j=k,r(10,j)})},u]}class ks extends gr{constructor(e){super(),fr(this,e,T3,k3,cr,{class:15,label:0,title:1,shortcut:2,labelClass:16,innerClass:17,hideLabel:18,icon:3,style:4,disabled:5,type:6,onclick:7,onkeydown:8,onhold:19,action:9,holdThreshold:20,holdSpeedUpFactor:21,holdSpeedMin:22,isEventTarget:23,getElement:24})}get isEventTarget(){return this.$$.ctx[23]}get getElement(){return this.$$.ctx[24]}}var bb=(t,e)=>{const r=t.findIndex(e);if(r>=0)return t.splice(r,1)};const C3=80;var Ts=(t,e={})=>{const{inertia:r=!1,inertiaDurationMultiplier:n=C3,shouldStartInteraction:i=()=>!0,pinch:o=!1,multiTouch:a,getEventPosition:s=et=>lt(et.clientX,et.clientY),observeKeys:l=!1}=e;function c(et,Pt){t.dispatchEvent(new CustomEvent(et,{detail:Pt}))}function u(){M&&M(),M=void 0}const d=[],p=et=>et.timeStamp===0?Date.now():et.timeStamp,h=()=>{const et=He(d[0].position);if(d[1]){const Pt=.5*(d[1].position.x-et.x),Et=.5*(d[1].position.y-et.y);et.x+=Pt,et.y+=Et}return et},f=et=>{et.origin.x=et.position.x,et.origin.y=et.position.y,et.translation.x=0,et.translation.y=0},g=et=>{const Pt=(Et=>d.findIndex(kt=>kt.event.pointerId===Et.pointerId))(et);if(!(Pt<0))return d[Pt]},$=()=>d.length===1,b=()=>d.length===2,v=et=>{const Pt=Qo(et.map(Et=>Et.position));return{center:Pt,distance:((Et,kt)=>Et.reduce((st,Ut)=>st+Ni(kt,Ut.position),0)/Et.length)(et,Pt),velocity:Qo(et.map(Et=>Et.velocity)),translation:Qo(et.map(Et=>Et.translation))}};let w,S,P,M,E,C,z,V,L=0,y;t.addEventListener("pointerdown",nt);const ct=["Meta","Control","Alt","Shift"];function j(et){if(!ct.includes(et.key))return;const{metaKey:Pt,ctrlKey:Et,altKey:kt,shiftKey:st}=et;N({metaKey:Pt,ctrlKey:Et,altKey:kt,shiftKey:st})}let k=Date.now();const N=et=>{const Pt=He(d[0].translation);let Et=z;o&&b()&&(Et*=Ni(d[0].position,d[1].position)/E,jn(Pt,d[1].translation)),jn(Pt,C);const kt=Date.now();kt-k<16||(k=kt,c("interactionupdate",{position:h(),translation:Pt,scalar:o?Et:void 0,isMultiTouching:b(),...et}))};function nt(et){if(!b()&&!(Pt=>_e(Pt.button)&&Pt.button!==0)(et)&&i(et,t)){if(u(),(Pt=>{const Et=p(Pt),kt={timeStamp:Et,timeStampInitial:Et,position:s(Pt),origin:s(Pt),velocity:dn(),velocityHistory:[],velocityAverage:dn(),translation:dn(),interactionState:void 0,event:Pt};d.push(kt),kt.interactionState=v(d)})(et),l&&(window.addEventListener("keydown",j),window.addEventListener("keyup",j)),$())document.documentElement.addEventListener("pointermove",ft),document.documentElement.addEventListener("pointerup",xt),document.documentElement.addEventListener("pointercancel",xt),document.addEventListener("visibilitychange",Z),V=!1,z=1,C=dn(),E=void 0,c("interactionstart",{origin:He(g(et).origin)});else if(o)V=!0,E=Ni(d[0].position,d[1].position),C.x+=d[0].translation.x,C.y+=d[0].translation.y,f(d[0]);else if(a===!1)return d.length=0,vt(),c("interactioncancel")}}function ft(et){et.preventDefault(),(Ut=>{const rt=g(Ut);if(!rt)return;const X=p(Ut),q=s(Ut),Ft=Math.max(1,X-rt.timeStamp);rt.velocity.x=(q.x-rt.position.x)/Ft,rt.velocity.y=(q.y-rt.position.y)/Ft,rt.velocityHistory.push(He(rt.velocity)),rt.velocityHistory=rt.velocityHistory.slice(-3),rt.velocityAverage=rt.velocityHistory.reduce((zt,yt,Dt,Wt)=>(zt.x+=yt.x/Wt.length,zt.y+=yt.y/Wt.length,zt),dn()),rt.translation.x=q.x-rt.origin.x,rt.translation.y=q.y-rt.origin.y,rt.timeStamp=X,rt.position.x=q.x,rt.position.y=q.y,rt.event=Ut})(et);const{metaKey:Pt=!1,ctrlKey:Et=!1,altKey:kt=!1,shiftKey:st=!1}=l?et:{};N({metaKey:Pt,ctrlKey:Et,altKey:kt,shiftKey:st})}function xt(et){if(!g(et))return;const Pt=h(),Et=(Ft=>{const zt=bb(d,yt=>yt.event.pointerId===Ft.pointerId);if(zt)return zt[0]})(et);if(o&&$()){const Ft=Ni(d[0].position,Et.position);z*=Ft/E,C.x+=d[0].translation.x+Et.translation.x,C.y+=d[0].translation.y+Et.translation.y,f(d[0])}let kt=!1,st=!1;if(!V&&Et){const Ft=performance.now(),zt=Ft-Et.timeStampInitial;kt=Po(Et.translation)<64&&zt<300,st=!!(y&&kt&&Ft-L<700&&Po(y,Et.position)<128),kt&&(y=He(Et.position),L=Ft)}if(d.length>0)return;vt();const Ut=He(Et.translation),rt=He(Et.velocityAverage);let X=!1;c("interactionrelease",{isTap:kt,isDoubleTap:st,position:Pt,translation:Ut,scalar:z,preventInertia:()=>X=!0});const q=Ni(rt);if(X||!r||q<.25)return wt(Ut,{isTap:kt,isDoubleTap:st});S=He(Pt),P=He(Ut),w=S0(He(Ut),{easing:P5,duration:q*n}),w.set({x:Ut.x+50*rt.x,y:Ut.y+50*rt.y}).then(()=>{M&&wt(Ea(w),{isTap:kt,isDoubleTap:st})}),M=w.subscribe(H)}function H(et){et&&c("interactionupdate",{position:lt(S.x+(et.x-P.x),S.y+(et.y-P.y)),translation:et,scalar:o?z:void 0})}function Z(et){if(document.visibilityState==="visible"||!d.length)return;const Pt=v(d);u(),c("interactionend",{...Pt}),d.length=0,vt()}function wt(et,Pt){u(),c("interactionend",{...Pt,translation:et,scalar:o?z:void 0})}function vt(){l&&window.removeEventListener("keydown",j),l&&window.removeEventListener("keyup",j),document.documentElement.removeEventListener("pointermove",ft),document.documentElement.removeEventListener("pointerup",xt),document.documentElement.removeEventListener("pointercancel",xt),document.removeEventListener("visibilitychange",Z)}return{destroy(){u(),t.removeEventListener("pointerdown",nt)}}};function Ds(t,e){return e?e*Math.sign(t)*Math.log10(1+Math.abs(t)/e):t}const i$=(t,e,r)=>{if(!e||!r)return{...t};const n=t.x+Ds(e.x-t.x,r),i=t.x+t.width+Ds(e.x+e.width-(t.x+t.width),r),o=t.y+Ds(e.y-t.y,r);return{x:n,y:o,width:i-n,height:t.y+t.height+Ds(e.y+e.height-(t.y+t.height),r)-o}},M3=(t,e,r)=>e&&r?lt(t.x+Ds(e.x-t.x,r),t.y+Ds(e.y-t.y,r)):{...t};var xb=(t,e)=>{if(t)return/em/.test(t)?16*parseInt(t,10):/px/.test(t)?parseInt(t,10):void 0};function P3(t){let e,r,n,i,o,a,s;const l=t[40].default,c=yi(l,t,t[39],null);return{c(){e=mt("div"),r=mt("div"),c&&c.c(),Mt(r,"transform",t[6]),T(e,"class",n=br(["PinturaScrollable",t[0]])),T(e,"data-direction",t[1]),T(e,"data-state",t[7]),Mt(e,"--scrollable-feather-start-opacity",t[4]),Mt(e,"--scrollable-feather-end-opacity",t[5])},m(u,d){tt(u,e,d),Lt(e,r),c&&c.m(r,null),t[42](e),o=!0,a||(s=[Tt(r,"interactionstart",t[10]),Tt(r,"interactionupdate",t[12]),Tt(r,"interactionend",t[13]),Tt(r,"interactionrelease",t[11]),Tr(Ts.call(null,r,{inertia:!0})),Tt(r,"measure",t[41]),Tr(Di.call(null,r)),Tt(e,"wheel",t[15],{passive:!1}),Tt(e,"scroll",t[17]),Tt(e,"focusin",t[43]),Tt(e,"nudge",t[18]),Tt(e,"measure",t[14]),Tr(Di.call(null,e,{observePosition:!0})),Tr(i=Ss.call(null,e,{direction:t[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1}))],a=!0)},p(u,d){c&&c.p&&(!o||256&d[1])&&xi(c,l,u,u[39],o?bi(l,u[39],d,null):vi(u[39]),null),64&d[0]&&Mt(r,"transform",u[6]),(!o||1&d[0]&&n!==(n=br(["PinturaScrollable",u[0]])))&&T(e,"class",n),(!o||2&d[0])&&T(e,"data-direction",u[1]),(!o||128&d[0])&&T(e,"data-state",u[7]),i&&kr(i.update)&&2&d[0]&&i.update.call(null,{direction:u[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1}),16&d[0]&&Mt(e,"--scrollable-feather-start-opacity",u[4]),32&d[0]&&Mt(e,"--scrollable-feather-end-opacity",u[5])},i(u){o||(I(c,u),o=!0)},o(u){B(c,u),o=!1},d(u){u&&J(e),c&&c.d(u),t[42](null),a=!1,Ur(s)}}}function R3(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,{$$slots:f={},$$scope:g}=e;const $=ba();let b,v,w,S,P="idle",M=hr(0);D(t,M,X=>r(38,p=X));let{class:E}=e,{scrollBlockInteractionDist:C=5}=e,{scrollStep:z=10}=e,{scrollFocusMargin:V=64}=e,{scrollDirection:L="x"}=e,{scrollAutoCancel:y=!1}=e,{elasticity:ct=0}=e,{onscroll:j=se}=e,{maskFeatherSize:k}=e,{maskFeatherStartOpacity:N}=e,{maskFeatherEndOpacity:nt}=e,{scroll:ft}=e;const xt=$n("fixScrollDirection");let H;D(t,xt,X=>r(50,h=X));let Z,wt,vt=!0;const et=M.subscribe(X=>{const q=dn();q[L]=X,j(q)}),Pt=X=>Math.max(Math.min(0,X),w[n]-v[n]);let Et,kt,st;const Ut=(X,q={})=>{const{elastic:Ft=!1,animate:zt=!1,preventScrollState:yt=!1}=q;Math.abs(X-b)>C&&P==="idle"&&!S&&!yt&&r(29,P="scrolling");const Dt=Pt(X),Wt=Ft&&ct&&!S?Dt+Ds(X-Dt,ct):Dt;let at=!0;zt?at=!1:vt||(at=!S),vt=!1,M.set(Wt,{hard:at}).then(St=>{S&&(vt=!0)})},rt=X=>{if(!s||!S)return;let q=X.target;X.target.classList.contains("implicit")&&(q=q.parentNode);const Ft=q[L==="x"?"offsetLeft":"offsetTop"],zt=Ft+q[L==="x"?"offsetWidth":"offsetHeight"],yt=Ea(M),Dt=V+k;yt+Ft<Dt?Ut(-Ft+Dt):yt+zt>w[n]-Dt&&Ut(w[n]-zt-Dt,{animate:!0})};return jo(()=>{et()}),t.$$set=X=>{"class"in X&&r(0,E=X.class),"scrollBlockInteractionDist"in X&&r(22,C=X.scrollBlockInteractionDist),"scrollStep"in X&&r(23,z=X.scrollStep),"scrollFocusMargin"in X&&r(24,V=X.scrollFocusMargin),"scrollDirection"in X&&r(1,L=X.scrollDirection),"scrollAutoCancel"in X&&r(25,y=X.scrollAutoCancel),"elasticity"in X&&r(26,ct=X.elasticity),"onscroll"in X&&r(27,j=X.onscroll),"maskFeatherSize"in X&&r(21,k=X.maskFeatherSize),"maskFeatherStartOpacity"in X&&r(19,N=X.maskFeatherStartOpacity),"maskFeatherEndOpacity"in X&&r(20,nt=X.maskFeatherEndOpacity),"scroll"in X&&r(28,ft=X.scroll),"$$scope"in X&&r(39,g=X.$$scope)},t.$$.update=()=>{if(2&t.$$.dirty[0]&&r(35,n=L==="x"?"width":"height"),2&t.$$.dirty[0]&&r(31,i=L.toUpperCase()),8&t.$$.dirty[0]&&r(37,o=H&&getComputedStyle(H)),8&t.$$.dirty[0]|64&t.$$.dirty[1]&&r(36,a=o&&xb(o.getPropertyValue("--scrollable-feather-size"))),1075314692&t.$$.dirty[0]|176&t.$$.dirty[1]&&p!=null&&w&&a!=null&&v){const X=-1*p/a,q=-(w[n]-v[n]-p)/a;r(19,N=an(1-X,0,1)),r(20,nt=an(1-q,0,1)),r(21,k=a),r(4,Z=N),r(5,wt=nt)}268435464&t.$$.dirty[0]&&H&&ft!==void 0&&(_e(ft)?Ut(ft):Ut(ft.scrollOffset,ft)),1073741828&t.$$.dirty[0]|16&t.$$.dirty[1]&&r(32,s=w&&v?v[n]>w[n]:void 0),128&t.$$.dirty[1]&&r(34,l=p<0),1073741828&t.$$.dirty[0]|144&t.$$.dirty[1]&&r(33,c=!(!v||!w)&&p+v[n]>w[n]),536870912&t.$$.dirty[0]|14&t.$$.dirty[1]&&r(7,u=br([P,s?"overflows":void 0,l?"overflows-start":void 0,c?"overflows-end":void 0])),131&t.$$.dirty[1]&&r(6,d=s?`translate${i}(${p}px)`:"none")},[E,L,v,H,Z,wt,d,u,M,xt,()=>{s&&(kt=!1,Et=!0,st=lt(0,0),S=!1,r(29,P="idle"),b=Ea(M))},({detail:X})=>{s&&(S=!0,r(29,P="idle"))},({detail:X})=>{s&&(kt||Et&&(Et=!1,Po(X.translation)<.1)||(!y||L!=="x"||(q=>{const Ft=_o(lt(q.x-st.x,q.y-st.y),Math.abs);st=He(q);const zt=Po(Ft),yt=Ft.x-Ft.y;return!(zt>1&&yt<-.5)})(X.translation)?Ut(b+X.translation[L],{elastic:!0}):kt=!0))},({detail:X})=>{if(!s||kt)return;const q=b+X.translation[L],Ft=Pt(q);vt=!1,M.set(Ft).then(zt=>{S&&(vt=!0)})},({detail:X})=>{r(30,w=X),$("measure",{x:X.x,y:X.y,width:X.width,height:X.height})},X=>{if(!s)return;X.preventDefault(),X.stopPropagation();const q=X.shiftKey,Ft=yu(X,{fixScrollDirection:h})*(q?-1:1),zt=Ea(M);Ut(zt+Ft*z,{animate:!0})},rt,()=>{r(3,H[L==="x"?"scrollLeft":"scrollTop"]=0,H)},({detail:X})=>{if(H.querySelector("[data-focus-visible]"))return;const q=-2*X[L],Ft=Ea(M);Ut(Ft+q*z,{animate:!0,preventScrollState:!0})},N,nt,k,C,z,V,y,ct,j,ft,P,w,i,s,c,l,n,a,o,p,g,f,X=>r(2,v=X.detail),function(X){jr[X?"unshift":"push"](()=>{H=X,r(3,H)})},X=>{setTimeout(()=>rt(X),32)}]}class za extends gr{constructor(e){super(),fr(this,e,R3,P3,cr,{class:0,scrollBlockInteractionDist:22,scrollStep:23,scrollFocusMargin:24,scrollDirection:1,scrollAutoCancel:25,elasticity:26,onscroll:27,maskFeatherSize:21,maskFeatherStartOpacity:19,maskFeatherEndOpacity:20,scroll:28},null,[-1,-1])}}function I3(t){let e,r,n,i,o;return{c(){e=mt("span"),T(e,"class","PinturaStatusMessage")},m(a,s){tt(a,e,s),e.innerHTML=t[0],n=!0,i||(o=[Tt(e,"measure",function(){kr(t[1])&&t[1].apply(this,arguments)}),Tr(Di.call(null,e))],i=!0)},p(a,[s]){t=a,(!n||1&s)&&(e.innerHTML=t[0])},i(a){n||(wl(()=>{n&&(r||(r=Ff(e,t[4],{duration:t[2]},!0)),r.run(1))}),n=!0)},o(a){r||(r=Ff(e,t[4],{duration:t[2]},!1)),r.run(0),n=!1},d(a){a&&J(e),a&&r&&r.end(),i=!1,Ur(o)}}}function E3(t,e,r){let n,i,{text:o}=e,{onmeasure:a=se}=e;const s=$n("isAnimated");return D(t,s,l=>r(5,i=l)),t.$$set=l=>{"text"in l&&r(0,o=l.text),"onmeasure"in l&&r(1,a=l.onmeasure)},t.$$.update=()=>{32&t.$$.dirty&&r(2,n=i?500:0)},[o,a,n,s,function(l,{duration:c}){return{duration:c,tick:u=>{l.style.opacity=u}}},i]}class vb extends gr{constructor(e){super(),fr(this,e,E3,I3,cr,{text:0,onmeasure:1})}}function A3(t){let e,r,n;const i=t[5].default,o=yi(i,t,t[4],null);return{c(){e=mt("span"),o&&o.c(),T(e,"class",r="PinturaStatusAside "+t[1]),Mt(e,"transform",t[2]),Mt(e,"opacity",t[0])},m(a,s){tt(a,e,s),o&&o.m(e,null),n=!0},p(a,[s]){o&&o.p&&(!n||16&s)&&xi(o,i,a,a[4],n?bi(i,a[4],s,null):vi(a[4]),null),(!n||2&s&&r!==(r="PinturaStatusAside "+a[1]))&&T(e,"class",r),4&s&&Mt(e,"transform",a[2]),1&s&&Mt(e,"opacity",a[0])},i(a){n||(I(o,a),n=!0)},o(a){B(o,a),n=!1},d(a){a&&J(e),o&&o.d(a)}}}function L3(t,e,r){let n,{$$slots:i={},$$scope:o}=e,{offset:a=0}=e,{opacity:s=0}=e,{class:l}=e;return t.$$set=c=>{"offset"in c&&r(3,a=c.offset),"opacity"in c&&r(0,s=c.opacity),"class"in c&&r(1,l=c.class),"$$scope"in c&&r(4,o=c.$$scope)},t.$$.update=()=>{8&t.$$.dirty&&r(2,n=`translateX(${a}px)`)},[s,l,n,a,o,i]}class wb extends gr{constructor(e){super(),fr(this,e,L3,A3,cr,{offset:3,opacity:0,class:1})}}let u1=null;var Sb=()=>(u1===null&&(u1=ni()&&"visualViewport"in window),u1);function o$(t){let e,r;const n=[{onclick:t[1]},t[3]];let i={};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new ks({props:i}),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=10&a[0]?zi(n,[2&a[0]&&{onclick:o[1]},8&a[0]&&Gi(o[3])]):{};e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){Nt(e,o)}}}function a$(t){let e,r;const n=[{onclick:t[0]},{class:"PinturaInputFormButtonConfirm"},t[2]];let i={};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new ks({props:i}),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=5&a[0]?zi(n,[1&a[0]&&{onclick:o[0]},n[1],4&a[0]&&Gi(o[2])]):{};e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){Nt(e,o)}}}function F3(t){let e,r,n,i,o,a,s,l,c=t[3]&&o$(t);const u=t[29].default,d=yi(u,t,t[28],null);let p=t[2]&&a$(t);return{c(){e=mt("div"),r=mt("div"),c&&c.c(),n=ue(),i=mt("div"),d&&d.c(),o=ue(),p&&p.c(),T(i,"class","PinturaInputFormFields"),T(r,"class","PinturaInputFormInner"),T(e,"class","PinturaInputForm"),T(e,"data-layout",t[4]),Mt(e,"opacity",t[6]),Mt(e,"left",t[7]),Mt(e,"top",t[8]),Mt(e,"right",t[9]),Mt(e,"bottom",t[10])},m(h,f){tt(h,e,f),Lt(e,r),c&&c.m(r,null),Lt(r,n),Lt(r,i),d&&d.m(i,null),Lt(r,o),p&&p.m(r,null),t[30](e),a=!0,s||(l=[Tt(i,"keydown",t[14]),Tt(e,"focusin",t[11]),Tt(e,"focusout",t[12]),Tt(e,"measure",t[13]),Tr(Di.call(null,e))],s=!0)},p(h,f){h[3]?c?(c.p(h,f),8&f[0]&&I(c,1)):(c=o$(h),c.c(),I(c,1),c.m(r,n)):c&&(Fe(),B(c,1,1,()=>{c=null}),ze()),d&&d.p&&(!a||268435456&f[0])&&xi(d,u,h,h[28],a?bi(u,h[28],f,null):vi(h[28]),null),h[2]?p?(p.p(h,f),4&f[0]&&I(p,1)):(p=a$(h),p.c(),I(p,1),p.m(r,null)):p&&(Fe(),B(p,1,1,()=>{p=null}),ze()),(!a||16&f[0])&&T(e,"data-layout",h[4]),64&f[0]&&Mt(e,"opacity",h[6]),128&f[0]&&Mt(e,"left",h[7]),256&f[0]&&Mt(e,"top",h[8]),512&f[0]&&Mt(e,"right",h[9]),1024&f[0]&&Mt(e,"bottom",h[10])},i(h){a||(I(c),I(d,h),I(p),a=!0)},o(h){B(c),B(d,h),B(p),a=!1},d(h){h&&J(e),c&&c.d(),d&&d.d(h),p&&p.d(),t[30](null),s=!1,Ur(l)}}}function z3(t,e,r){let n,i,o,a,s,{$$slots:l={},$$scope:c}=e,{onconfirm:u}=e,{oncancel:d}=e,{autoFocus:p=!0}=e,{autoPositionCursor:h=!0}=e,{buttonConfirm:f}=e,{buttonCancel:g}=e,{layout:$="stack"}=e,{parentRect:b}=e,{align:v}=e,{justify:w}=e,{parentMargin:S=16}=e,{panelOffset:P=dn()}=e,{willHandleKeydown:M=()=>!0}=e,E=!1,C,z,V={top:void 0,bottom:void 0},L=0,y,ct,j,k;const N=()=>{const H=s.querySelector("input, textarea");H.focus(),L>=1||H.select()},nt=()=>{E=!0,xt||!Vo()&&!sp()||r(24,V={top:"1em",bottom:"auto"}),Vo()&&(H=>{let Z;const wt=et=>Z=et.touches[0].screenY,vt=et=>{const Pt=et.touches[0].screenY,Et=et.target;/textarea/i.test(Et.nodeName)?(Pt>Z?Et.scrollTop==0&&et.preventDefault():Pt<Z?Et.scrollTop+Et.offsetHeight==Et.scrollHeight&&et.preventDefault():et.preventDefault(),Z=Pt):et.preventDefault()};H.addEventListener("touchstart",wt),H.addEventListener("touchmove",vt)})(s),r(6,L=1)};let ft;const xt=(H=>{if(!Sb())return!1;const Z=visualViewport.height,wt=()=>{H(visualViewport.height<Z?"visible":"hidden")};return visualViewport.addEventListener("resize",wt),()=>visualViewport.removeEventListener("resize",wt)})(H=>{a?H!=="hidden"||E?(clearTimeout(z),z=void 0,r(24,V={top:visualViewport.height-C.height-P.y+"px"}),H==="visible"?(r(5,s.dataset.stick=!0,s),N(),nt()):(E=!1,r(6,L=0))):N():r(24,V={top:"4.5em",bottom:"auto"})});return xs(()=>{p&&N()}),jo(()=>{xt&&xt()}),t.$$set=H=>{"onconfirm"in H&&r(0,u=H.onconfirm),"oncancel"in H&&r(1,d=H.oncancel),"autoFocus"in H&&r(15,p=H.autoFocus),"autoPositionCursor"in H&&r(16,h=H.autoPositionCursor),"buttonConfirm"in H&&r(2,f=H.buttonConfirm),"buttonCancel"in H&&r(3,g=H.buttonCancel),"layout"in H&&r(4,$=H.layout),"parentRect"in H&&r(17,b=H.parentRect),"align"in H&&r(18,v=H.align),"justify"in H&&r(19,w=H.justify),"parentMargin"in H&&r(20,S=H.parentMargin),"panelOffset"in H&&r(21,P=H.panelOffset),"willHandleKeydown"in H&&r(22,M=H.willHandleKeydown),"$$scope"in H&&r(28,c=H.$$scope)},t.$$.update=()=>{8519680&t.$$.dirty[0]&&r(27,n=b&&C),144572416&t.$$.dirty[0]&&r(26,i=n?((H,Z,wt,vt,et)=>{let Pt,Et;return Pt=vt==="center"?H.x+.5*H.width-.5*Z.width:vt==="right"?H.x+H.width-Z.width-et:H.x+et,Et=wt==="center"?H.y+.5*H.height-.5*Z.height:wt==="bottom"?H.y+H.height-Z.height-et:H.y+et,{top:Et+"px",right:"auto",bottom:"auto",left:Pt+"px"}})(b,C,v,w,S):void 0),201326592&t.$$.dirty[0]&&r(7,y=n?i.left:void 0),218103808&t.$$.dirty[0]&&r(8,ct=n?i.top:V.top),201326592&t.$$.dirty[0]&&r(9,j=n?i.right:void 0),218103808&t.$$.dirty[0]&&r(10,k=n?i.bottom:V.bottom),32&t.$$.dirty[0]&&r(25,o=s&&getComputedStyle(s)),33554432&t.$$.dirty[0]&&(a=o&&o.getPropertyValue("--editor-modal")==="1")},[u,d,f,g,$,s,L,y,ct,j,k,H=>{var Z;((wt=>/textarea/i.test(wt))(H.target)||db(H.target))&&(ft=Date.now(),h&&((Z=H.target).selectionStart=Z.selectionEnd=Z.value.length),clearTimeout(z),z=setTimeout(nt,200))},H=>{Date.now()-ft>50||(H.stopPropagation(),N())},({detail:H})=>{r(23,C={width:H.width,height:H.height})},H=>{if(M(H))return H.key==="Enter"?u():H.key==="Escape"?d():void 0},p,h,b,v,w,S,P,M,C,V,o,i,n,c,l,function(H){jr[H?"unshift":"push"](()=>{s=H,r(5,s)})}]}class kb extends gr{constructor(e){super(),fr(this,e,z3,F3,cr,{onconfirm:0,oncancel:1,autoFocus:15,autoPositionCursor:16,buttonConfirm:2,buttonCancel:3,layout:4,parentRect:17,align:18,justify:19,parentMargin:20,panelOffset:21,willHandleKeydown:22},null,[-1,-1])}}var s$=(t,e)=>{t.fastSeek&&t.fastSeek(e),t.currentTime=e},Tb=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus";const D3=["aspectRatio","isRotatedSideways","flip","cropSize"],l$=$0.map(([t])=>t).filter(t=>!D3.includes(t));var Fs=(t,e)=>new CustomEvent("ping",{detail:{type:t,data:e},cancelable:!0,bubbles:!0}),Cb=(t,e)=>(e?Ws(t,e):t).replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase(),c$=(t,e=tn)=>{const{subscribe:r,set:n}=ge(void 0);return{subscribe:r,destroy:((i,o)=>{const a=matchMedia(i);return a.addListener(o),o(a),{get matches(){return a.matches},destroy:()=>a.removeListener(o)}})(t,({matches:i})=>n(e(i))).destroy}},u$=(t,e)=>new Promise((r,n)=>{(async()=>{const{imageOrienter:i,canvasMemoryLimit:o}=e||{};Xs(t)&&r(await K2(t));const a=await i.read(t),s=c=>By(c,{canvasMemoryLimit:o}).then(u=>i.apply(u,a)).then(r).catch(n);if(Dy(t)||!zy()||Fa()||Vo())return s(t);let l;try{l=await mu((c,u)=>createImageBitmap(c,{colorSpaceConversion:"default"}).then(d=>u(null,d)).catch(u),[t])}catch{}l&&l.width?await ap()?w0()&&a>1?r(await(async c=>lc(await Sl(c)))(l)):r(l):r(i.apply(l,a)):s(t)})()}),d$=(t,e)=>new Promise(async r=>{if(t.width<e.width&&t.height<e.height)return r(t);const n=Math.min(e.width/t.width,e.height/t.height),i=n*t.width,o=n*t.height,a=yn("canvas",{width:i,height:o}),s=a.getContext("2d",{willReadFrequently:!0}),l=rc(t)?await Sl(t):t;s.drawImage(l,0,0,i,o),r(lc(a))});let d1=null;var B3=()=>{if(d1===null){let t=yn("canvas");d1=!!dp(t),ti(t),t=void 0}return d1};const p$=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],fl={precision:1e-4},Md={precision:.01*fl.precision};var O3=()=>{const t=[],e=[],r=[],n=()=>{e.forEach(o=>o(r))},i=o=>{o.unsub=o.subscribe(a=>((s,l)=>{const c=t.indexOf(s);c<0||(r[c]=l,n())})(o,a)),n()};return{get length(){return t.length},clear:()=>{t.forEach(o=>o.unsub()),t.length=0,r.length=0},unshift:o=>{t.unshift(o),i(o)},get:o=>t[o],push:o=>{t.push(o),i(o)},remove:o=>{o.unsub();const a=t.indexOf(o);t.splice(a,1),r.splice(a,1)},forEach:o=>t.forEach(o),filter:o=>t.filter(o),subscribe:o=>(e.push(o),o(r),()=>{e.splice(e.indexOf(o),1)})}},p1=t=>t[0]<.25&&t[1]<.25&&t[2]<.25,Mb=(t={})=>new Promise(e=>{const{accept:r="image/*"}=t,n=yn("input",{style:"position:absolute;visibility:hidden;width:0;height:0;",type:"file",accept:r}),i=()=>{const[o]=n.files;n.parentNode&&n.remove(),n.removeEventListener("change",i),e(o)};n.addEventListener("change",i),Vo()&&document.body.append(n),n.click()}),pu=t=>{try{return t()}catch(e){console.error(e)}},W3=([t,e])=>t+.5*(e-t),Vs=t=>Math.round(100*t),I0=t=>lt(t.clientX,t.clientY),W1=(t,e,r)=>{const n=I0(t);return Un(Un(n,e),r)};function _3(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,E,C=qe,z=()=>(C(),C=Hi(ct,$t=>r(71,M=$t)),ct);t.$$.on_destroy.push(()=>C());let{root:V}=e,{locale:L}=e,{stores:y}=e,{isAnimated:ct}=e;z();let{allowPan:j=!0}=e,{allowZoom:k=!0}=e,{enablePan:N=!0}=e,{enableZoom:nt=!0}=e,{enableZoomControls:ft=nt}=e,{enableZoomInput:xt=!0}=e,{enablePanInput:H=!0}=e,{enablePanLimit:Z=!0}=e,{panLimitGutterScalar:wt=0}=e,{zoomOptions:vt=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:et=.25}=e,{zoomAdjustFactor:Pt=.1}=e,{zoomAdjustWheelFactor:Et=1}=e,{elasticity:kt=5}=e,{imageSelectionRectCentered:st}=e,{imageSelectionRectScalar:Ut}=e,{zoomLevel:rt=null}=e,{zoomControls:X}=e,{zoomMultiTouching:q=!1}=e;const{isInteracting:Ft,rootRect:zt,stageRect:yt,stageScalar:Dt,imageSelectionPan:Wt,imageSelectionZoom:at,imageSelectionStageFitScalar:St,imageSelectionRect:pt,imageSelectionStoredState:Xt,imagePreviewUpscale:Zt}=y;D(t,Ft,$t=>r(70,S=$t)),D(t,zt,$t=>r(67,b=$t)),D(t,yt,$t=>r(66,$=$t)),D(t,Dt,$t=>r(46,P=$t)),D(t,Wt,$t=>r(65,h=$t)),D(t,at,$t=>r(43,p=$t)),D(t,St,$t=>r(44,f=$t)),D(t,pt,$t=>r(68,v=$t)),D(t,Xt,$t=>r(72,E=$t)),D(t,Zt,$t=>r(45,g=$t));const ie=$n("fixScrollDirection");D(t,ie,$t=>r(69,w=$t));let gt=!1,te,xe,_,Kt;const qt=$t=>{const Ae=V.querySelector(".PinturaMain > .PinturaUtilMain")||V.querySelector('div[data-inert="false"] .PinturaUtilMain');return!!Ae&&!!Ae.contains($t.target)&&!Ja($t.target)},le=($t={})=>{const{pan:Ae=h,zoom:Gt=p}=$t;It(Xt,E={translation:Ae,zoom:Gt},E)},de=()=>h&&h.x===0&&h.y===0,Oe=()=>{It(at,p=void 0,p),de()||It(Wt,h=dn(),h),Ct.set(void 0,{hard:!0})},rr=()=>{Oe(),le()},Ct=hr(void 0,{precision:.01});Ct.subscribe($t=>{if($t===void 0)return It(at,p=void 0,p),void(de()||It(Wt,h=dn(),h));const Ae=p;$t<=1?de()||It(Wt,h=dn(),h):$t<=Ae&&It(Wt,h=ji(h,.8),h),It(at,p=$t,p)});const pe=$t=>{Ct.update(Ae=>{const Gt=$t(Ae||f);return le({zoom:Gt}),Gt},{hard:!M})},ar=$t=>{$t?Ct.set($t,{hard:M===!1}):($t=void 0,Ct.set(void 0,{hard:!0})),It(at,p=$t,p),le({zoom:$t})};let Ke;function Qe(){const $t=Date.now();!_e(Ke)||$t-Ke>500?Ke=$t:(Ke=void 0,ar(o?u===1?f:1:u===f?1:f))}const Re=($t,Ae)=>{const Gt=Ut*Ae,me={...st},he=1-an(wt,0,1);Ei(me,Gt<he?Gt:he);const er={...st};Ei(er,Gt),da(er,$t);const Er={...er};return er.x>me.x&&(Er.x=me.x),er.y>me.y&&(Er.y=me.y),er.x+er.width<me.x+me.width&&(Er.x=me.x+me.width-er.width),er.y+er.height<me.y+me.height&&(Er.y=me.y+me.height-er.height),Un(Lr(Er),Lr(me))},Je=({translation:$t,zoom:Ae=1,elastify:Gt=!0})=>{if(!te)return;let me=$t;const he=lt(te.x+me.x,te.y+me.y);if(!Z)return he;const er=Re(he,Ae);return Gt?M3(er,he,kt):er};let ur,$r;const zr=()=>{$r=void 0,It(Ft,S=!0,S),r(34,gt=H),ur=!1,_=!1,te={...h},xe=g?p||f:o?p||1:p||f},Dr=$t=>{const{scalar:Ae,translation:Gt,isMultiTouching:me}=$t.detail;if(!te||!me&&!H)return;me&&ji(Gt,.5),(H||me)&&(ur=!0),q||r(13,q=me);const he=n?an(xe*Ae,s,l):1,er=Je({translation:Gt,zoom:he,elastify:!0}),Er=Bs(er);Kt=Bs(h),_=Er<Kt,n&&at.set(he),Wt.set(er),$r=q&&{translation:$t.detail.translation,scalar:Ae}},dr=$t=>{It(Ft,S=!1,S),r(34,gt=!1),r(13,q=!1),_&&Kt<50&&(te=void 0,xe=void 0,Wt.set(dn()))},Y=$t=>{It(Ft,S=!1,S),r(34,gt=!1),r(13,q=!1),Promise.resolve().then(()=>{if(ur&&te){const Ae=$r||$t.detail,Gt=n?an(xe*Ae.scalar,s,l):1,me=Je({elastify:!1,translation:Ae.translation,zoom:Gt});Wt.set(me)}te=void 0,xe=void 0,H&&$t.detail.isDoubleTap&&rr(),le()})};let it,G=Date.now(),Bt=0,ae=!1,De=!1;const we=$t=>{if(!qt($t)||($t.preventDefault(),$t.stopPropagation(),De))return;clearTimeout(it);const Ae=yu($t,{fixScrollDirection:w}),Gt=Date.now(),me=Gt-G;G=Gt;const he=Math.abs(Ae/me)>.2;Bt=he?Bt+1:0;const er=1+-1*Ae*Et/(he?50:100),Er=W1($t,b,$);Ot(Er,er,{isZoomingFast:he})},Ot=($t,Ae,{isZoomingFast:Gt})=>{const me=g?p||f:o?p||1:p||f,he=me*Ae,er=dn(),Er=h,fe=g?f:o?1:f,Cr=Math.abs(he-fe),Mr=he<me,ir=me>fe&&Mr||me<fe&&he>me,en=Bt>=5;if(Gt||(ae=!1),Bt>0&&!ae&&(ae=ir),en&&ae)return rr(),De=!0,void setTimeout(()=>{De=!1},100);if(en)return;!Gt&&ir&&Cr<=.05&&(it=setTimeout(()=>{rr()},250)),It(at,p=an(he,s,l),p);const ye=Fr(v);Ei(ye,me),da(ye,Er);const tr=Lr(ye),je=Fr(ye);Ei(je,p-me+1,$t);const pn=Lr(je),wn=qm(Un(pn,tr),me);((sn,Xr,hn)=>{sn.x=Xr,sn.y=hn})(er,Er.x+wn.x,Er.y+wn.y),It(Wt,h=Mr&&Gt?ji(He(h),.85):Re(er,me),h),le()},Ce=$t=>($t?"add":"remove")+"EventListener";let nr,lr,ot,Yt;const Ve=$t=>{$t.preventDefault(),lr={...h},Yt=Fr(v),ot=W1($t,b,$),nr=g?p||f:o?p||1:p||f},Se=$t=>{$t.preventDefault(),It(at,p=an($t.scale*nr,s,l),p);const Ae=Fr(Yt);Ei(Ae,nr),da(Ae,lr);const Gt=Lr(Ae),me=Fr(Ae);Ei(me,p-nr+1,ot);const he=Lr(me),er=qm(Un(he,Gt),nr),Er={x:lr.x+er.x,y:lr.y+er.y};It(Wt,h=Re(Er,p),h)},ee=$t=>{$t.preventDefault()},Xe=$t=>{V[Ce($t)]("wheel",we),Vo()||(V[Ce($t)]("gesturestart",Ve),V[Ce($t)]("gesturechange",Se),V[Ce($t)]("gestureend",ee))},Be=$t=>{const Ae=Ce($t);V[Ae]("interactionstart",zr),V[Ae]("interactionupdate",Dr),V[Ae]("interactionrelease",dr),V[Ae]("interactionend",Y)};let yr;return xs(()=>{yr=Ts(V,{pinch:!0,inertia:!0,inertiaDurationMultiplier:10,shouldStartInteraction:qt})}),jo(()=>{Xe(!1),Be(!1),yr.destroy(),yr=void 0}),t.$$set=$t=>{"root"in $t&&r(14,V=$t.root),"locale"in $t&&r(15,L=$t.locale),"stores"in $t&&r(16,y=$t.stores),"isAnimated"in $t&&z(r(0,ct=$t.isAnimated)),"allowPan"in $t&&r(17,j=$t.allowPan),"allowZoom"in $t&&r(18,k=$t.allowZoom),"enablePan"in $t&&r(19,N=$t.enablePan),"enableZoom"in $t&&r(20,nt=$t.enableZoom),"enableZoomControls"in $t&&r(21,ft=$t.enableZoomControls),"enableZoomInput"in $t&&r(22,xt=$t.enableZoomInput),"enablePanInput"in $t&&r(23,H=$t.enablePanInput),"enablePanLimit"in $t&&r(24,Z=$t.enablePanLimit),"panLimitGutterScalar"in $t&&r(25,wt=$t.panLimitGutterScalar),"zoomOptions"in $t&&r(26,vt=$t.zoomOptions),"zoomAdjustStep"in $t&&r(27,et=$t.zoomAdjustStep),"zoomAdjustFactor"in $t&&r(28,Pt=$t.zoomAdjustFactor),"zoomAdjustWheelFactor"in $t&&r(29,Et=$t.zoomAdjustWheelFactor),"elasticity"in $t&&r(30,kt=$t.elasticity),"imageSelectionRectCentered"in $t&&r(31,st=$t.imageSelectionRectCentered),"imageSelectionRectScalar"in $t&&r(32,Ut=$t.imageSelectionRectScalar),"zoomLevel"in $t&&r(33,rt=$t.zoomLevel),"zoomControls"in $t&&r(12,X=$t.zoomControls),"zoomMultiTouching"in $t&&r(13,q=$t.zoomMultiTouching)},t.$$.update=()=>{var $t,Ae;5505024&t.$$.dirty[0]&&r(36,n=k&&nt&&xt),655360&t.$$.dirty[0]&&r(35,i=j&&N),393216&t.$$.dirty[0]&&(j||k?(It(at,p=nt?E.zoom:void 0,p),It(Wt,h=N?He(E.translation):de()?h:dn(),h),Ct.set(p)):Oe()),32768&t.$$.dirty[1]&&(o=P>=1),67141632&t.$$.dirty[0]|57344&t.$$.dirty[1]&&r(40,a=[(g||P<1)&&[f,Vs(f)+"%",{sublabel:L.labelZoomFit}],...vt.map(Gt=>[Gt,Vs(Gt)+"%"])].filter(Boolean).map(Gt=>(Gt[0]===1&&(Gt[2]={sublabel:L.labelZoomActual}),Gt)).sort((Gt,me)=>{const he=Gt[0]||f,er=me[0]||f;return he<er?-1:er<he?1:0})),8704&t.$$.dirty[1]&&r(38,s=Math.min(a.reduce((Gt,[me])=>me<Gt?me:Gt,Number.MAX_SAFE_INTEGER),f)),512&t.$$.dirty[1]&&r(37,l=a.reduce((Gt,[me])=>me>Gt?me:Gt,Number.MIN_SAFE_INTEGER)),4&t.$$.dirty[1]&&rt!==null&&ar(rt),61440&t.$$.dirty[1]&&r(42,u=p||(g||P<1?f:1)),2560&t.$$.dirty[1]&&r(39,($t=a.map(([Gt])=>Gt),Ae=u,c=$t.findIndex(Gt=>Gt===Ae))),2048&t.$$.dirty[1]&&r(41,d=Vs(u)+"%"),405045248&t.$$.dirty[0]|6080&t.$$.dirty[1]&&r(12,X=(k||k)&&ft?[["Button","zoom-out",{hideLabel:!0,label:L.labelZoomOut,icon:L.iconZoomOut,disabled:p===s,onclick:()=>pe(Gt=>Math.max(s,Gt-et)),onhold:()=>pe(Gt=>Math.max(s,Gt*(1-Pt)))}],["Dropdown","zoom-level",{label:d,title:L.labelZoom,labelClass:"PinturaFixedWidthCharacters",options:a,selectedIndex:c,onchange:Gt=>ar(Gt.value),onclick:Qe}],["Button","zoom-in",{hideLabel:!0,label:L.labelZoomIn,icon:L.iconZoomIn,disabled:p===l,onclick:()=>pe(Gt=>Math.min(l,Gt+et)),onhold:()=>pe(Gt=>Math.min(l,Gt*(1+Pt)))}]]:[]),16384&t.$$.dirty[0]|32&t.$$.dirty[1]&&V&&Xe(n),16384&t.$$.dirty[0]|16&t.$$.dirty[1]&&V&&Be(i),8404992&t.$$.dirty[0]|24&t.$$.dirty[1]&&V&&V.style.setProperty("--cursor",i&&H?gt?"grabbing":"grab":"")},[ct,Ft,zt,yt,Dt,Wt,at,St,pt,Xt,Zt,ie,X,q,V,L,y,j,k,N,nt,ft,xt,H,Z,wt,vt,et,Pt,Et,kt,st,Ut,rt,gt,i,n,l,s,c,a,d,u,p,f,g,P]}class V3 extends gr{constructor(e){super(),fr(this,e,_3,null,cr,{root:14,locale:15,stores:16,isAnimated:0,allowPan:17,allowZoom:18,enablePan:19,enableZoom:20,enableZoomControls:21,enableZoomInput:22,enablePanInput:23,enablePanLimit:24,panLimitGutterScalar:25,zoomOptions:26,zoomAdjustStep:27,zoomAdjustFactor:28,zoomAdjustWheelFactor:29,elasticity:30,imageSelectionRectCentered:31,imageSelectionRectScalar:32,zoomLevel:33,zoomControls:12,zoomMultiTouching:13},null,[-1,-1,-1,-1])}}const{window:gl}=m0;function h$(t){let e,r,n,i=t[41]&&m$(t),o=t[38]&&y$(t);return{c(){i&&i.c(),e=ue(),o&&o.c(),r=Dn()},m(a,s){i&&i.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,r,s),n=!0},p(a,s){a[41]?i?(i.p(a,s),1024&s[1]&&I(i,1)):(i=m$(a),i.c(),I(i,1),i.m(e.parentNode,e)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze()),a[38]?o?(o.p(a,s),128&s[1]&&I(o,1)):(o=y$(a),o.c(),I(o,1),o.m(r.parentNode,r)):o&&(Fe(),B(o,1,1,()=>{o=null}),ze())},i(a){n||(I(i),I(o),n=!0)},o(a){B(i),B(o),n=!1},d(a){i&&i.d(a),a&&J(e),o&&o.d(a),a&&J(r)}}}function m$(t){let e,r,n,i,o;const a=[H3,N3],s=[];function l(c,u){return c[39]?0:c[35]?1:-1}return~(n=l(t))&&(i=s[n]=a[n](t)),{c(){e=mt("div"),r=mt("p"),i&&i.c(),Mt(r,"transform",t[72]),T(e,"class","PinturaStatus"),Mt(e,"opacity",t[54])},m(c,u){tt(c,e,u),Lt(e,r),~n&&s[n].m(r,null),o=!0},p(c,u){let d=n;n=l(c),n===d?~n&&s[n].p(c,u):(i&&(Fe(),B(s[d],1,1,()=>{s[d]=null}),ze()),~n?(i=s[n],i?i.p(c,u):(i=s[n]=a[n](c),i.c()),I(i,1),i.m(r,null)):i=null),1024&u[2]&&Mt(r,"transform",c[72]),8388608&u[1]&&Mt(e,"opacity",c[54])},i(c){o||(I(i),o=!0)},o(c){B(i),o=!1},d(c){c&&J(e),~n&&s[n].d()}}}function N3(t){let e,r,n,i;e=new vb({props:{text:t[35].text||"",onmeasure:t[221]}});let o=t[35].aside&&f$(t);return{c(){Ht(e.$$.fragment),r=ue(),o&&o.c(),n=Dn()},m(a,s){Vt(e,a,s),tt(a,r,s),o&&o.m(a,s),tt(a,n,s),i=!0},p(a,s){const l={};16&s[1]&&(l.text=a[35].text||""),e.$set(l),a[35].aside?o?(o.p(a,s),16&s[1]&&I(o,1)):(o=f$(a),o.c(),I(o,1),o.m(n.parentNode,n)):o&&(Fe(),B(o,1,1,()=>{o=null}),ze())},i(a){i||(I(e.$$.fragment,a),I(o),i=!0)},o(a){B(e.$$.fragment,a),B(o),i=!1},d(a){Nt(e,a),a&&J(r),o&&o.d(a),a&&J(n)}}}function H3(t){let e,r,n,i;return e=new vb({props:{text:t[39],onmeasure:t[221]}}),n=new wb({props:{class:"PinturaStatusIcon",offset:t[82],opacity:t[83],$$slots:{default:[G3]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment),r=ue(),Ht(n.$$.fragment)},m(o,a){Vt(e,o,a),tt(o,r,a),Vt(n,o,a),i=!0},p(o,a){const s={};256&a[1]&&(s.text=o[39]),e.$set(s);const l={};1048576&a[2]&&(l.offset=o[82]),2097152&a[2]&&(l.opacity=o[83]),8&a[0]|2&a[20]&&(l.$$scope={dirty:a,ctx:o}),n.$set(l)},i(o){i||(I(e.$$.fragment,o),I(n.$$.fragment,o),i=!0)},o(o){B(e.$$.fragment,o),B(n.$$.fragment,o),i=!1},d(o){Nt(e,o),o&&J(r),Nt(n,o)}}}function f$(t){let e,r;return e=new wb({props:{class:"PinturaStatusButton",offset:t[82],opacity:t[83],$$slots:{default:[j3]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};1048576&i[2]&&(o.offset=n[82]),2097152&i[2]&&(o.opacity=n[83]),16&i[1]|2&i[20]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function g$(t){let e,r;return e=new yb({props:{progress:t[35].progressIndicator.progress}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16&i[1]&&(o.progress=n[35].progressIndicator.progress),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function $$(t){let e,r;const n=[t[35].closeButton,{hideLabel:!0}];let i={};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new ks({props:i}),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=16&a[1]?zi(n,[Gi(o[35].closeButton),n[1]]):{};e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){Nt(e,o)}}}function j3(t){let e,r,n,i=t[35].progressIndicator.visible&&g$(t),o=t[35].closeButton&&t[35].text&&$$(t);return{c(){i&&i.c(),e=ue(),o&&o.c(),r=Dn()},m(a,s){i&&i.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,r,s),n=!0},p(a,s){a[35].progressIndicator.visible?i?(i.p(a,s),16&s[1]&&I(i,1)):(i=g$(a),i.c(),I(i,1),i.m(e.parentNode,e)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze()),a[35].closeButton&&a[35].text?o?(o.p(a,s),16&s[1]&&I(o,1)):(o=$$(a),o.c(),I(o,1),o.m(r.parentNode,r)):o&&(Fe(),B(o,1,1,()=>{o=null}),ze())},i(a){n||(I(i),I(o),n=!0)},o(a){B(i),B(o),n=!1},d(a){i&&i.d(a),a&&J(e),o&&o.d(a),a&&J(r)}}}function U3(t){let e,r=t[3].iconSupportError+"";return{c(){e=Li("g")},m(n,i){tt(n,e,i),e.innerHTML=r},p(n,i){8&i[0]&&r!==(r=n[3].iconSupportError+"")&&(e.innerHTML=r)},d(n){n&&J(e)}}}function G3(t){let e,r;return e=new Ho({props:{$$slots:{default:[U3]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};8&i[0]|2&i[20]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function y$(t){let e,r,n,i,o,a,s,l,c,u,d,p,h,f,g=t[10]&&b$(t),$=t[46]&&t[45]&&x$(t);const b=[Q3,J3],v=[];function w(C,z){return C[46]?0:1}function S(C){t[446](C)}function P(C){t[447](C)}function M(C){t[448](C)}n=w(t),i=v[n]=b[n](t),a=new z5({props:{isAnimated:t[53],isTransparent:t[20],pixelRatio:t[57],textPixelRatio:t[6],backgroundColor:t[56],maskRect:t[58],maskOpacity:t[73]?t[73].maskOpacity:1,maskMarkupOpacity:t[7],maskFrameOpacity:t[5],clipAnnotationsToImage:t[85],images:t[55],interfaceImages:t[86],loadImageData:t[28],enableGrid:t[11],gridSize:t[87],gridColors:[t[88],t[89]],gridOpacity:t[90],selectionColor:t[91],csp:t[92]||{},willRequest:t[81]||t[93],willRender:t[443],didRender:t[444]}});let E={root:t[2],locale:t[3],isAnimated:t[163],stores:t[202],allowPan:t[95],enablePan:t[17],enablePanLimit:t[21],panLimitGutterScalar:t[22],enablePanInput:t[96],allowZoom:t[97],enableZoom:t[18],enableZoomInput:t[19]!==void 0?t[19]:t[98],enableZoomControls:t[99],zoomOptions:t[13]||t[23],zoomAdjustStep:t[14]||t[24],zoomAdjustFactor:t[15]||t[25],zoomAdjustWheelFactor:t[16]||t[26],imageSelectionRectCentered:t[100],imageSelectionRectScalar:t[101],elasticity:_1*t[8]};return t[0]!==void 0&&(E.zoomLevel=t[0]),t[33]!==void 0&&(E.zoomControls=t[33]),t[34]!==void 0&&(E.zoomMultiTouching=t[34]),u=new V3({props:E}),jr.push(()=>Ro(u,"zoomLevel",S)),jr.push(()=>Ro(u,"zoomControls",P)),jr.push(()=>Ro(u,"zoomMultiTouching",M)),{c(){g&&g.c(),e=ue(),$&&$.c(),r=ue(),i.c(),o=ue(),Ht(a.$$.fragment),s=ue(),l=mt("div"),c=ue(),Ht(u.$$.fragment),T(l,"class","PinturaRootPortal")},m(C,z){g&&g.m(C,z),tt(C,e,z),$&&$.m(C,z),tt(C,r,z),v[n].m(C,z),tt(C,o,z),Vt(a,C,z),tt(C,s,z),tt(C,l,z),t[445](l),tt(C,c,z),Vt(u,C,z),f=!0},p(C,z){C[10]?g?(g.p(C,z),1024&z[0]&&I(g,1)):(g=b$(C),g.c(),I(g,1),g.m(e.parentNode,e)):g&&(Fe(),B(g,1,1,()=>{g=null}),ze()),C[46]&&C[45]?$?($.p(C,z),49152&z[1]&&I($,1)):($=x$(C),$.c(),I($,1),$.m(r.parentNode,r)):$&&(Fe(),B($,1,1,()=>{$=null}),ze());let V=n;n=w(C),n===V?v[n].p(C,z):(Fe(),B(v[V],1,1,()=>{v[V]=null}),ze(),i=v[n],i?i.p(C,z):(i=v[n]=b[n](C),i.c()),I(i,1),i.m(o.parentNode,o));const L={};4194304&z[1]&&(L.isAnimated=C[53]),1048576&z[0]&&(L.isTransparent=C[20]),67108864&z[1]&&(L.pixelRatio=C[57]),64&z[0]&&(L.textPixelRatio=C[6]),33554432&z[1]&&(L.backgroundColor=C[56]),134217728&z[1]&&(L.maskRect=C[58]),2048&z[2]&&(L.maskOpacity=C[73]?C[73].maskOpacity:1),128&z[0]&&(L.maskMarkupOpacity=C[7]),32&z[0]&&(L.maskFrameOpacity=C[5]),8388608&z[2]&&(L.clipAnnotationsToImage=C[85]),16777216&z[1]&&(L.images=C[55]),16777216&z[2]&&(L.interfaceImages=C[86]),268435456&z[0]&&(L.loadImageData=C[28]),2048&z[0]&&(L.enableGrid=C[11]),33554432&z[2]&&(L.gridSize=C[87]),201326592&z[2]&&(L.gridColors=[C[88],C[89]]),268435456&z[2]&&(L.gridOpacity=C[90]),536870912&z[2]&&(L.selectionColor=C[91]),1073741824&z[2]&&(L.csp=C[92]||{}),524288&z[2]|1&z[3]&&(L.willRequest=C[81]||C[93]),512&z[0]|270991424&z[1]|2&z[3]&&(L.willRender=C[443]),62&z[2]&&(L.didRender=C[444]),a.$set(L);const y={};4&z[0]&&(y.root=C[2]),8&z[0]&&(y.locale=C[3]),4&z[3]&&(y.allowPan=C[95]),131072&z[0]&&(y.enablePan=C[17]),2097152&z[0]&&(y.enablePanLimit=C[21]),4194304&z[0]&&(y.panLimitGutterScalar=C[22]),8&z[3]&&(y.enablePanInput=C[96]),16&z[3]&&(y.allowZoom=C[97]),262144&z[0]&&(y.enableZoom=C[18]),524288&z[0]|32&z[3]&&(y.enableZoomInput=C[19]!==void 0?C[19]:C[98]),64&z[3]&&(y.enableZoomControls=C[99]),8396800&z[0]&&(y.zoomOptions=C[13]||C[23]),16793600&z[0]&&(y.zoomAdjustStep=C[14]||C[24]),33587200&z[0]&&(y.zoomAdjustFactor=C[15]||C[25]),67174400&z[0]&&(y.zoomAdjustWheelFactor=C[16]||C[26]),128&z[3]&&(y.imageSelectionRectCentered=C[100]),256&z[3]&&(y.imageSelectionRectScalar=C[101]),256&z[0]&&(y.elasticity=_1*C[8]),!d&&1&z[0]&&(d=!0,y.zoomLevel=C[0],No(()=>d=!1)),!p&&4&z[1]&&(p=!0,y.zoomControls=C[33],No(()=>p=!1)),!h&&8&z[1]&&(h=!0,y.zoomMultiTouching=C[34],No(()=>h=!1)),u.$set(y)},i(C){f||(I(g),I($),I(i),I(a.$$.fragment,C),I(u.$$.fragment,C),f=!0)},o(C){B(g),B($),B(i),B(a.$$.fragment,C),B(u.$$.fragment,C),f=!1},d(C){g&&g.d(C),C&&J(e),$&&$.d(C),C&&J(r),v[n].d(C),C&&J(o),Nt(a,C),C&&J(s),C&&J(l),t[445](null),C&&J(c),Nt(u,C)}}}function b$(t){let e,r,n,i,o;return r=new Qi({props:{items:t[69]}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"class","PinturaNav PinturaNavTools")},m(a,s){tt(a,e,s),Vt(r,e,null),n=!0,i||(o=[Tt(e,"measure",t[432]),Tr(Di.call(null,e))],i=!0)},p(a,s){const l={};128&s[2]&&(l.items=a[69]),r.$set(l)},i(a){n||(I(r.$$.fragment,a),n=!0)},o(a){B(r.$$.fragment,a),n=!1},d(a){a&&J(e),Nt(r),i=!1,Ur(o)}}}function x$(t){let e,r,n;return r=new za({props:{elasticity:t[8]*V1,scrollDirection:t[76]?"y":"x",$$slots:{default:[K3]},$$scope:{ctx:t}}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"class","PinturaNav PinturaNavMain")},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};256&o[0]&&(a.elasticity=i[8]*V1),16384&o[2]&&(a.scrollDirection=i[76]?"y":"x"),12288&o[1]|135168&o[2]|2&o[20]&&(a.$$scope={dirty:o,ctx:i}),r.$set(a)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function Z3(t){let e,r;const n=[t[79],{tabs:t[44]}];let i={$$slots:{default:[q3,({tab:o})=>({620:o}),({tab:o})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o?1:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new pp({props:i}),e.$on("select",t[433]),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=8192&a[1]|131072&a[2]?zi(n,[131072&a[2]&&Gi(o[79]),8192&a[1]&&{tabs:o[44]}]):{};3&a[20]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){Nt(e,o)}}}function X3(t){let e,r;return e=new Qi({props:{items:t[44]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};8192&i[1]&&(o.items=n[44]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function Y3(t){let e,r=t[620].icon+"";return{c(){e=Li("g")},m(n,i){tt(n,e,i),e.innerHTML=r},p(n,i){1&i[20]&&r!==(r=n[620].icon+"")&&(e.innerHTML=r)},d(n){n&&J(e)}}}function q3(t){let e,r,n,i,o,a=t[620].label+"";return e=new Ho({props:{$$slots:{default:[Y3]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment),r=ue(),n=mt("span"),i=Mn(a)},m(s,l){Vt(e,s,l),tt(s,r,l),tt(s,n,l),Lt(n,i),o=!0},p(s,l){const c={};3&l[20]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c),(!o||1&l[20])&&a!==(a=s[620].label+"")&&Gn(i,a)},i(s){o||(I(e.$$.fragment,s),o=!0)},o(s){B(e.$$.fragment,s),o=!1},d(s){Nt(e,s),s&&J(r),s&&J(n)}}}function K3(t){let e,r,n,i;const o=[X3,Z3],a=[];function s(l,c){return l[74]?0:1}return e=s(t),r=a[e]=o[e](t),{c(){r.c(),n=Dn()},m(l,c){a[e].m(l,c),tt(l,n,c),i=!0},p(l,c){let u=e;e=s(l),e===u?a[e].p(l,c):(Fe(),B(a[u],1,1,()=>{a[u]=null}),ze(),r=a[e],r?r.p(l,c):(r=a[e]=o[e](l),r.c()),I(r,1),r.m(n.parentNode,n))},i(l){i||(I(r),i=!0)},o(l){B(r),i=!1},d(l){a[e].d(l),l&&J(n)}}}function J3(t){let e,r,n;function i(a){t[439](a)}let o={locale:t[3],class:"PinturaMain",view:t[207](t[43]),props:t[206](t[43],t[27]),stores:t[202]};return t[1][t[43]]!==void 0&&(o.component=t[1][t[43]]),e=new lb({props:o}),jr.push(()=>Ro(e,"component",i)),e.$on("measure",t[233]),e.$on("show",t[440]),e.$on("hide",t[441]),e.$on("fade",t[442]),{c(){Ht(e.$$.fragment)},m(a,s){Vt(e,a,s),n=!0},p(a,s){const l={};8&s[0]&&(l.locale=a[3]),4096&s[1]&&(l.view=a[207](a[43])),134217728&s[0]|4096&s[1]&&(l.props=a[206](a[43],a[27])),!r&&2&s[0]|4096&s[1]&&(r=!0,l.component=a[1][a[43]],No(()=>r=!1)),e.$set(l)},i(a){n||(I(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){Nt(e,a)}}}function Q3(t){let e,r;const n=[{class:"PinturaMain"},{visible:t[62]},t[79],{panels:t[78]}];let i={$$slots:{default:[tw,({panel:o,panelIsActive:a})=>({618:o,619:a}),({panel:o,panelIsActive:a})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(o?536870912:0)|(a?1073741824:0)]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new hp({props:i}),e.$on("measure",t[438]),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=196609&a[2]?zi(n,[n[0],1&a[2]&&{visible:o[62]},131072&a[2]&&Gi(o[79]),65536&a[2]&&{panels:o[78]}]):{};134217738&a[0]|1610612736&a[19]|2&a[20]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){Nt(e,o)}}}function tw(t){let e,r,n;function i(a){t[434](a,t[618])}let o={locale:t[3],view:t[207](t[618]),props:t[206](t[618],t[27]),isActive:t[619],stores:t[202]};return t[1][t[618]]!==void 0&&(o.component=t[1][t[618]]),e=new lb({props:o}),jr.push(()=>Ro(e,"component",i)),e.$on("measure",t[233]),e.$on("show",function(){return t[435](t[618])}),e.$on("hide",function(){return t[436](t[618])}),e.$on("fade",function(...a){return t[437](t[618],...a)}),{c(){Ht(e.$$.fragment)},m(a,s){Vt(e,a,s),n=!0},p(a,s){t=a;const l={};8&s[0]&&(l.locale=t[3]),536870912&s[19]&&(l.view=t[207](t[618])),134217728&s[0]|536870912&s[19]&&(l.props=t[206](t[618],t[27])),1073741824&s[19]&&(l.isActive=t[619]),!r&&2&s[0]|536870912&s[19]&&(r=!0,l.component=t[1][t[618]],No(()=>r=!1)),e.$set(l)},i(a){n||(I(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){Nt(e,a)}}}function v$(t){let e;return{c(){e=mt("span"),T(e,"class","PinturaEditorOverlay"),Mt(e,"opacity",t[102])},m(r,n){tt(r,e,n)},p(r,n){512&n[3]&&Mt(e,"opacity",r[102])},d(r){r&&J(e)}}}function w$(t){let e,r;const n=[{layout:"row"},{parentRect:t[50]},t[60]];let i={$$slots:{default:[ew]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new kb({props:i}),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=537395200&a[1]?zi(n,[n[0],524288&a[1]&&{parentRect:o[50]},536870912&a[1]&&Gi(o[60])]):{};1610612736&a[1]|2&a[20]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){Nt(e,o)}}}function ew(t){let e,r,n;return{c(){e=mt("input"),e.value=r=t[60].text,T(e,"placeholder",n=t[60].placeholder),T(e,"type","text"),T(e,"spellcheck","false"),T(e,"autocorrect","off"),T(e,"autocapitalize","off")},m(i,o){tt(i,e,o),t[449](e)},p(i,o){536870912&o[1]&&r!==(r=i[60].text)&&e.value!==r&&(e.value=r),536870912&o[1]&&n!==(n=i[60].placeholder)&&T(e,"placeholder",n)},d(i){i&&J(e),t[449](null)}}}function rw(t){let e,r,n,i,o,a;wl(t[431]);let s=t[40]&&h$(t),l=t[102]>0&&v$(t),c=t[60]&&w$(t);return{c(){e=mt("div"),s&&s.c(),r=ue(),l&&l.c(),n=ue(),c&&c.c(),T(e,"id",t[4]),T(e,"class",t[77]),T(e,"data-env",t[75]),T(e,"dir",t[12])},m(u,d){tt(u,e,d),s&&s.m(e,null),Lt(e,r),l&&l.m(e,null),Lt(e,n),c&&c.m(e,null),t[450](e),i=!0,o||(a=[Tt(gl,"keydown",t[224]),Tt(gl,"keyup",t[225]),Tt(gl,"blur",t[226]),Tt(gl,"paste",t[230]),Tt(gl,"resize",t[431]),Tt(e,"ping",function(){kr(t[68])&&t[68].apply(this,arguments)}),Tt(e,"contextmenu",t[227]),Tt(e,"touchstart",t[222],{passive:!1}),Tt(e,"touchmove",function(){kr(t[71])&&t[71].apply(this,arguments)}),Tt(e,"pointermove",function(){kr(t[70])&&t[70].apply(this,arguments)}),Tt(e,"transitionend",t[212]),Tt(e,"dropfiles",t[228]),Tt(e,"measure",t[451]),Tt(e,"click",function(){kr(t[42]?t[229]:se)&&(t[42]?t[229]:se).apply(this,arguments)}),Tr(Di.call(null,e,{observeViewRect:!0,isMeasureRoot:!0})),Tr(E5.call(null,e)),Tr(sb.call(null,e))],o=!0)},p(u,d){(t=u)[40]?s?(s.p(t,d),512&d[1]&&I(s,1)):(s=h$(t),s.c(),I(s,1),s.m(e,r)):s&&(Fe(),B(s,1,1,()=>{s=null}),ze()),t[102]>0?l?l.p(t,d):(l=v$(t),l.c(),l.m(e,n)):l&&(l.d(1),l=null),t[60]?c?(c.p(t,d),536870912&d[1]&&I(c,1)):(c=w$(t),c.c(),I(c,1),c.m(e,null)):c&&(Fe(),B(c,1,1,()=>{c=null}),ze()),(!i||16&d[0])&&T(e,"id",t[4]),(!i||32768&d[2])&&T(e,"class",t[77]),(!i||8192&d[2])&&T(e,"data-env",t[75]),(!i||4096&d[0])&&T(e,"dir",t[12])},i(u){i||(I(s),I(c),i=!0)},o(u){B(s),B(c),i=!1},d(u){u&&J(e),s&&s.d(),l&&l.d(),c&&c.d(),t[450](null),o=!1,Ur(a)}}}const _1=1,V1=10;function nw(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,E,C,z,V,L,y,ct,j,k,N,nt,ft,xt,H,Z,wt,vt,et,Pt,Et,kt,st,Ut,rt,X,q,Ft,zt,yt,Dt,Wt,at,St,pt,Xt,Zt,ie,gt,te,xe,_,Kt,qt,le,de,Oe,rr,Ct,pe,ar,Ke,Qe,Re,Je,ur,$r,zr,Dr,dr,Y,it,G,Bt,ae,De,we,Ot,Ce,nr,lr,ot,Yt,Ve,Se,ee,Xe,Be,yr,$t,Ae,Gt,me,he,er,Er,fe,Cr,Mr,ir,en,ye,tr,je,pn,wn,sn,Xr,hn,li,kn,Ci,Uo,pi,xn,na,Vn,Br,xa,Zn,ci,Ln,ui,hi,Xn,Tn,mi,Go,Io,Eo,xo,Ao,vo,lo,Bi,co,Zi,ii,ei,Oi,uo,Yr,Nn,to,Cn,wo,oi,Zo,Wi,So,Pn,_i,fn,Yn,Lo,Fo,eo,Xi,ko,wi,po,To,O,Qt,Ar,Ue,be,$e,Kr,Ir,rn,bn,Or,Si,ho,Ze,Xo,Vi,Da,Yo,gn,Fn,mo,zo,Ba,F,oe,Ie,xr,Nr,Wr,or,Sr,qr,Pr,Jr,Hn,Sn,Rn,_r,Mi,ia,qs,Cs,rs,Oa,Wa=qe,ns=qe;D(t,R5,m=>r(419,be=m)),t.$$.on_destroy.push(()=>Wa()),t.$$.on_destroy.push(()=>ns());const va=Ka(),Co=ba();let{class:_a}=e,{layout:vn}=e,{stores:ro}=e,{locale:Gr}=e,{id:no}=e,{util:ln}=e,{utils:fo}=e,{animations:wa="auto"}=e,{disabled:Yi=!1}=e,{previewUpscale:Ms=!1}=e,{previewPad:is=!1}=e,{previewMaskOpacity:bu=.95}=e,{previewImageDataMaxSize:Cl}=e,{previewImageTextPixelRatio:Ml}=e,{markupMaskOpacity:uc=1}=e,{zoomMaskOpacity:Pl=.85}=e,{elasticityMultiplier:os=10}=e,{willRevert:dc=()=>Promise.resolve(!0)}=e,{willProcessImage:pc=()=>Promise.resolve(!0)}=e,{willRenderCanvas:Rl=tn}=e,{willRenderToolbar:hc=tn}=e,{willRenderUtilTabs:mc=tn}=e,{willSetHistoryInitialState:fc=tn}=e,{enableButtonExport:gc=!0}=e,{enableButtonRevert:Il=!0}=e,{enableNavigateHistory:Ks=!0}=e,{enableToolbar:as=!0}=e,{enableUtils:$c=!0}=e,{enableButtonClose:yc=!1}=e,{enableDropImage:Js=!1}=e,{enablePasteImage:El=!1}=e,{enableBrowseImage:ss=!1}=e,{accept:Qs="image/*"}=e,{enableTransparencyGrid:bc=!1}=e,{layoutDirectionPreference:qo="auto"}=e,{layoutHorizontalUtilsPreference:Al="left"}=e,{layoutVerticalUtilsPreference:x="bottom"}=e,{layoutVerticalToolbarPreference:W="top"}=e,{layoutVerticalControlGroupsPreference:R="bottom"}=e,{layoutVerticalControlTabsPreference:K="bottom"}=e,{supportedMediaTypes:Q=["image"]}=e,{status:dt}=e,{formatStatusImageLoading:At=function(m,U){const{state:ht}=m;if(!ht||!ht.task)return U.statusImageLoadNone;if(ht.error){if(ht.error.code==="IMAGE_TOO_SMALL")return U.statusImageLoadMinSize;if(ht.error.code==="VIDEO_TOO_SHORT"){const Rt=Array.isArray(U.unitSeconds)?ht.error.metadata.minDuration===1?U.unitSeconds[0]:U.unitSeconds[1]:U.unitSeconds;return Ws(U.statusImageLoadMinDuration,{seconds:Rt},"{","}")}return U.statusImageLoadError}return ht.task==="blob-to-bitmap"?U.statusImageLoadPrepare:U.statusImageLoadBusy}}=e,{formatStatusImageProcessing:ce=function(m,U){const{state:ht}=m;if(ht&&ht.task)return ht.task==="store"?ht.error?U.statusImageUploadError:U.statusImageUploadBusy:ht.error?U.statusImageProcessError:U.statusImageProcessBusy}}=e,{formatStatusSupportError:jt=function(m,U){const{features:ht}=m;return{features:ht.join(", ")}}}=e,{textDirection:ne}=e,{markupEditorZoomLevel:Jt=null}=e,{markupEditorZoomLevels:Ee}=e,{markupEditorZoomAdjustStep:sr}=e,{markupEditorZoomAdjustFactor:re}=e,{markupEditorZoomAdjustWheelFactor:vr}=e,{markupEditorInteractionMode:Le=!1}=e,{muteAudio:ve=!0}=e,{willSetMediaInitialTimeOffset:Me=(m,U)=>m*W3(U[0])}=e,{enablePan:Pe=!0}=e,{enableZoom:ke=!0}=e,{enableZoomControls:Ye=!0}=e,{enableZoomInput:cn}=e,{enablePanInput:We}=e,{enableCanvasAlpha:pr=!1}=e,{enablePanLimit:mn}=e,{panLimitGutterScalar:ki}=e,{pan:fi=null}=e,{zoomPresetOptions:ai=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:Bn=.25}=e,{zoomAdjustFactor:qn=.1}=e,{zoomAdjustWheelFactor:Kn=1}=e,{zoomLevel:Pi=null}=e,{fixScrollDirection:io=!1}=e;const Do=ge(io);go("fixScrollDirection",Do);const Mo=ni()&&"visualViewport"in window,Ps=ge("hidden");function Va(m){const{height:U,scale:ht}=m.target,Rt=U*ht/window.screen.height<.75?"visible":"hidden";Ps.set(Rt)}let Na,Bo;go("softKeyboardState",Ps),Mo&&window.visualViewport.addEventListener("resize",Va);let{imagePreviewSrc:Sa}=e,{imageOrienter:Ha={read:()=>1,apply:m=>m}}=e,{pluginComponents:ka}=e,{pluginOptions:ja={}}=e;const ls=va.sub,Ri={};let{root:Qr}=e;const oa=()=>{he.setAttribute("data-redraw","true"),tl.set({})},yp=ge(!0);D(t,yp,m=>r(486,Uo=m));const xc=ge(void 0);D(t,xc,m=>r(429,zo=m));const Ua=ge(0);D(t,Ua,m=>r(426,gn=m));const O0=ge(!1),xu=m=>{O0.set(m.type==="play"),va.pub(m.type)};let W0,bp,_0,xp,vp=!1;const wp=()=>{if(!o||!Ll())return;xp=d,It(xc,zo=void 0,zo);const m=he;vp=!1;const U=1/24,ht=cs(),Rt=Math.abs(c*ht-gn*ht)<=U,ut=ht-ht*gn<=U;Rt?It(Ua,gn=l,gn):ut&&It(Ua,gn=0,gn),wu(gn*cs()),m.play().catch(()=>{});const bt=()=>{if(Ll())return;const _t=xp>=0;_0=requestAnimationFrame(bt);const Ne=vu();It(Ua,gn=Math.min(Ne/cs(),1),gn),_t&&gn>=c&&(It(Ua,gn=c,gn),Rs()),d>-1&&(vp=!0),_t&&vp&&d===-1&&p>0&&(It(Ua,gn=s[p][0],gn),wu(gn*cs())),gn>=1&&Rs(),It(ku,Xo=gn*cs(),Xo),oa()};bt()},Rs=()=>{o&&!Ll()&&(It(xc,zo=void 0,zo),xp=void 0,he.pause(),cancelAnimationFrame(_0),oa())},Ll=()=>he&&he.paused,Sp=()=>{if(o)return Ll()?wp():Rs()},kp=()=>{o&&(he.muted=!0)},Tp=()=>{o&&(he.muted=!1)},V0=()=>{o&&It(vc,mo=!mo,mo)},vc=ge(ve);D(t,vc,m=>r(428,mo=m));const cs=()=>{if(o)return he.duration},vu=()=>{if(o)return he.currentTime},wu=m=>{o&&(s$(he,m),It(Ua,gn=m/Fn,gn))},tl=ge({});D(t,tl,m=>r(52,na=m)),go("redrawTrigger",tl);const Su=ge(os);D(t,Su,m=>r(503,Da=m)),go("elasticityMultiplier",Su);let wc=[];const Cp=hr();D(t,Cp,m=>r(102,Oa=m));const N0=v0()||1024,H0=An(N0,N0),j0=G2(),Kb=m=>Promise.resolve(Vi&&Vi(m,{resourceType:"image"})).then(U=>{if(U===!1)return;const{headers:ht,credentials:Rt}=U||{};return fetch(m,{headers:ht,credentials:Rt}).then(ut=>{if(ut.status!==200)throw`${ut.status} (${ut.statusText})`;return ut.blob()}).then(ut=>u$(ut,{imageOrienter:Ha,canvasMemoryLimit:j0})).then(ut=>d$(ut,g))});let{imageSourceToImageData:Mp=m=>Ge(m)?Kb(m):nc(m)?new Promise(U=>U(lc(m))):r0(m)||fu(m)?u$(m,{imageOrienter:Ha,canvasMemoryLimit:j0}).then(U=>d$(U,g)):void 0}=e;const Pp=(()=>{let m,U;const ht=l$.reduce((Rt,ut)=>(Rt[ut]=function(bt,_t,Ne){let wr=[];return{set:_t,update:Ne,publish:Zr=>{wr.forEach(nn=>nn(Zr))},subscribe:Zr=>(wr.push(Zr),bt(Zr),()=>{wr=wr.filter(nn=>nn!==Zr)})}}(bt=>{if(!U)return bt();U.stores[ut].subscribe(bt)()},bt=>{U&&U.stores[ut].set(bt)},bt=>{U&&U.stores[ut].update(bt)}),Rt),{});return{update:Rt=>{if(U=Rt,m&&(m.forEach(ut=>ut()),m=void 0),!Rt)return ht.file.publish(void 0),void ht.loadState.publish(void 0);m=l$.map(ut=>Rt.stores[ut].subscribe(bt=>{ht[ut].publish(bt)}))},stores:ht,destroy:()=>{m&&m.forEach(Rt=>Rt())}}})(),{file:Rp,size:el,duration:Ip,currentTime:ku,trim:Ep,volume:U0,minDuration:Jb,maxDuration:Ap,loadState:Tu,processState:Lp,cropAspectRatio:Cu,cropLimitToImage:Fp,crop:Ta,cropMinSize:Qb,cropMaxSize:tx,cropRange:ex,cropOrigin:rx,cropRectAspectRatio:nx,rotation:Fl,rotationRange:ix,targetSize:ox,flipX:Mu,flipY:Pu,backgroundColor:Ru,backgroundImage:G0,backgroundFilterMode:Z0,colorMatrix:X0,convolutionMatrix:Y0,gamma:q0,vignette:K0,noise:J0,decoration:Iu,annotation:Eu,manipulation:Au,redaction:Lu,frame:rl,selection:zp,state:Fu}=Pp.stores;D(t,Rp,m=>r(403,co=m)),D(t,el,m=>r(377,fe=m)),D(t,Ip,m=>r(427,Fn=m)),D(t,ku,m=>r(502,Xo=m)),D(t,Ep,m=>r(424,Ze=m)),D(t,U0,m=>r(425,Yo=m)),D(t,Ap,m=>r(430,Ba=m)),D(t,Tu,m=>r(395,Tn=m)),D(t,Lp,m=>r(394,Xn=m)),D(t,Cu,m=>r(499,Kr=m)),D(t,Fp,m=>r(85,xr=m)),D(t,Ta,m=>r(414,Yn=m)),D(t,Fl,m=>r(380,ir=m)),D(t,Mu,m=>r(379,Mr=m)),D(t,Pu,m=>r(378,Cr=m)),D(t,Ru,m=>r(385,li=m)),D(t,Iu,m=>r(48,Er=m)),D(t,Eu,m=>r(49,en=m)),D(t,Au,m=>r(382,sn=m)),D(t,Lu,m=>r(383,Xr=m)),D(t,rl,m=>r(47,er=m)),D(t,zp,m=>r(59,Or=m)),D(t,Fu,m=>r(488,ei=m)),go("components",{DynamicComponentTree:Qi}),go("previewcontrols",{play:wp,pause:Rs,togglePlayPause:Sp,mute:kp,unmute:Tp,toggleMute:V0,setCurrentTime:wu,getCurrentTime:vu,getDuration:cs,frameOffset:Ua,framePeekOffset:xc,isPlaying:O0,isMuted:vc});const Q0=(m,U,ht=0)=>new Promise((Rt,ut)=>{if(Xs(m))return void Y2(m).then(wr=>{const Zr=_e(Xo)?Xo:Me(wr.duration,Ze||[[0,1]]);q2(wr,Zr).then(Rt)}).catch(ut);let bt,_t=!1;U.cancel=()=>_t=!0;const Ne=Date.now();Mp(m).then(wr=>{const Zr=Date.now()-Ne;clearTimeout(bt),bt=setTimeout(()=>{_t||Rt(wr)},Math.max(0,ht-Zr))}).catch(ut)}),{images:tm,shapePreprocessor:em,imageScrambler:rm,imageRedactionRendering:nm,willRequest:im,willRequestResource:om,csp:am}=ro;let Sc;D(t,tm,m=>r(423,ho=m)),D(t,em,m=>r(422,Si=m)),D(t,rm,m=>r(386,kn=m)),D(t,nm,m=>r(384,hn=m)),D(t,im,m=>r(81,Vi=m)),D(t,om,m=>r(93,Hn=m)),D(t,am,m=>r(92,Jr=m));const ax=Hr(G0,(m,U)=>{if(!m)return U(void 0);Sc&&(Sc.cancel(),Sc=void 0),Sc={cancel:se},Q0(m,Sc).then(U).catch(ht=>{})}),sx=Fu.subscribe(m=>va.pub("update",m)),lx=ge();go("ui",ge({})),go("selection",zp);const Dp=ge(!0);D(t,Dp,m=>r(95,Rn=m));const Bp=ge(!0);D(t,Bp,m=>r(97,Mi=m));const Op=ge(!0);D(t,Op,m=>r(421,bn=m));const zu=ge(!0);D(t,zu,m=>r(500,Ir=m));const Wp=ge(!0);D(t,Wp,m=>r(98,ia=m));const _p=ge();D(t,_p,m=>r(99,qs=m));const Du=ge();D(t,Du,m=>r(501,rn=m));const Vp=Hr([Du,zu],()=>rn!==void 0?rn:Ir);D(t,Vp,m=>r(96,_r=m));const kc=ge([0,0,0]);D(t,kc,m=>r(56,to=m));const Bu=ge([1,1,1]);D(t,Bu,m=>r(484,wn=m));const Tc=hr([1,1,1]);D(t,Tc,m=>r(483,pn=m));const Np=ge();D(t,Np,m=>r(91,Pr=m));const sm=ge(),Hp=ge();D(t,Hp,m=>r(51,pi=m));const zl=ge();D(t,zl,m=>r(375,Gt=m));const Dl=ge(Os());D(t,Dl,m=>r(80,Oi=m));const jp=ge(0);D(t,jp,m=>r(420,$e=m));const Cc=ge(Os());D(t,Cc,m=>r(84,Ie=m));const nl=ge();D(t,nl,m=>r(481,me=m));const Ou=c$("(pointer: fine)",m=>m?"pointer-fine":"pointer-coarse");D(t,Ou,m=>r(401,lo=m));const Wu=c$("(hover: hover)",m=>m?"pointer-hover":"pointer-no-hover");D(t,Wu,m=>r(400,vo=m));const lm=ge(!1),Mc=ge(!1);D(t,Mc,m=>r(381,je=m));const Up=Yl(void 0,m=>{const U=hr(0),ht=[Mc.subscribe(Rt=>{U.set(Rt?1:0,{hard:!Br})}),U.subscribe(m)];return()=>ht.forEach(Rt=>Rt())});D(t,Up,m=>r(482,tr=m));const _u=ge();D(t,_u,m=>r(487,Eo=m));const Vu=ge();let Gp;D(t,Vu,m=>r(53,Br=m)),go("isAnimated",Vu);const Nu=ge(Ms);D(t,Nu,m=>r(404,Zi=m));const il=ge(!1);D(t,il,m=>r(493,eo=m)),go("imageIsStatic",il);const Pc=ge();D(t,Pc,m=>r(494,Xi=m));const Zp=ge();D(t,Zp,m=>r(491,Lo=m));const cm=Yl(void 0,m=>{const U=ge(void 0),ht=[Ta.subscribe(()=>{if(!Yn)return;if(eo)return U.set(Fr(Yn));const Rt=i$(Yn,Lo,5*os);U.set(Rt)}),U.subscribe(m)];return()=>ht.forEach(Rt=>Rt())}),aa=ge();D(t,aa,m=>r(490,fn=m));const Hu=ge();D(t,Hu,m=>r(492,Fo=m));const Xp=ge(void 0);D(t,Xp,m=>r(497,Qt=m));const um=ge(dn());D(t,um,m=>r(498,Ar=m));const dm=(m,U)=>{if(!U||!m)return{top:0,right:0,bottom:0,left:0};const ht=g2(U,m,$),Rt=f2(ht,m);return{top:Math.abs(Rt.top),right:Math.abs(Rt.right),bottom:Math.abs(Rt.bottom),left:Math.abs(Rt.left)}},pm=ge({}),Yp=Hr([nl,Dl,Cc,pm],([m,U,ht,Rt],ut)=>{if(!m)return ut(void 0);let bt=0;N.length!==1||h||W==="bottom"||(bt=ht.y+ht.height),ut(Wn(m.x+U.x,m.y+U.y+bt,m.width,m.height))});let Rc={left:0,right:0,top:0,bottom:0};const ju=ge(!1),Bl=Hr([ju,rl,Yp,Mc],([m,U,ht,Rt],ut)=>{if(!ht)return ut({left:0,right:0,top:0,bottom:0});if(!m)return;const bt=Math.min(ht.width,ht.height),_t=dm({width:bt,height:bt},U);mr(Rc.top,4)===mr(_t.top,4)&&mr(Rc.bottom,4)===mr(_t.bottom,4)&&mr(Rc.right,4)===mr(_t.right,4)&&mr(Rc.left,4)===mr(_t.left,4)||(Rc=_t,ut(_t))});D(t,Bl,m=>r(412,So=m));const Ol=Hr([ju,Bl],([m,U],ht)=>{if(!m)return ht(!1);ht(Object.values(U).some(Rt=>Rt>0))});D(t,Ol,m=>r(413,Pn=m));const cx=Hr([ju,nl,Ol,Bl],([m,U,ht,Rt],ut)=>{if(U)return m&&ht?void ut(Wn(U.x+Rt.left,U.y+Rt.top,U.width-Rt.left-Rt.right,U.height-Rt.top-Rt.bottom)):ut({...U})}),Ga=Hr([Yp,Ol,Bl],([m,U,ht],Rt)=>m?U?void Rt(Wn(m.x+ht.left,m.y+ht.top,m.width-ht.left-ht.right,m.height-ht.top-ht.bottom)):Rt(m):Rt(void 0));D(t,Ga,m=>r(50,ye=m));const ux=Hr([il,el,Fl],([m,U,ht],Rt)=>{if(!m||!U)return Rt(void 0);const ut=Ui(U);Rt(Ti(ut,ht))}),qp=Hr([ux],([m],U)=>{if(!m)return U(void 0);const ht=ri(m);U(ou(ht))});D(t,qp,m=>r(416,po=m));const us=Hr([Ga,Ta,qp,Nu],([m,U,ht,Rt],ut)=>{if(!m||!U||!(!Xi&&!Lo))return;const{width:bt,height:_t}=ht||U,Ne=Math.min(m.width/bt,m.height/_t);ut(Rt?Ne:Math.min(1,Ne))});D(t,us,m=>r(415,wi=m)),go("imageStaticVisualCorners",Hr([il,el,Fl,Ga,nl,us],([m,U,ht,Rt,ut,bt],_t)=>{if(!(m&&Rt&&ut&&U))return _t(void 0);const Ne=Ui(U),wr=ou(Ei(Ne,bt)),Zr=Bd(Rt,wr);wr.x=Zr.x,wr.y=Zr.y,_t(Ti(wr,ht))}));const Wl=ge(void 0);D(t,Wl,m=>r(418,Ue=m));const hm=Hr([Ta,Ga],([m,U])=>{if(U&&m)return Math.min(U.width/m.width,U.height/m.height)}),Kp=Hr([Ta,aa],([m,U])=>m&&U?Math.min(m.width/U.width,m.height/U.height):1);D(t,Kp,m=>r(101,rs=m));const Ic=Hr([Wl,Kp],([m,U])=>m&&U?U*m:1);D(t,Ic,m=>r(496,To=m));const ol=ge(dn());D(t,ol,m=>r(417,O=m));const mm=ge({scalar:To,translation:O}),fm=()=>{mm.set({scalar:void 0,translation:dn()})},Uu=Yl(void 0,m=>{const U=hr(void 0,{precision:1e-4}),ht=qc()===1?bt=>ta(bt,Math.round):tn,Rt=()=>{if(!fn)return;const bt=je||!Eo;if(eo){const Ne=Fr(fn);return da(Ne,Ar),da(Ne,ye),U.set(Ne,{hard:bt})}const _t=i$(fn,Qt,_1*os);_t.width<0&&(_t.width=0,_t.x=fn.x),_t.height<0&&(_t.height=0,_t.y=fn.y),da(_t,ye),da(_t,O),Ei(_t,To),!bt&&ht(_t),U.set(_t,{hard:bt})},ut=[Ga.subscribe(Rt),aa.subscribe(Rt),Ic.subscribe(Rt),ol.subscribe(Rt),rl.subscribe(Rt),U.subscribe(m)];return()=>ut.forEach(bt=>bt())});D(t,Uu,m=>r(58,Wi=m));const Jp=ge(1);D(t,Jp,m=>r(489,_i=m));const Qp=()=>{if(!Yn||!ye)return;let m=yl(Fr(Yn),wi||1);const U=Bd(ye,yl(Fr(po),wi));da(m,U);const ht=me.width/m.width,Rt=me.height/m.height,ut=Math.min(1,ht,Rt);Jp.set(ut),Ei(m,ut),((bt,_t)=>{const[Ne,wr,Zr,nn]=vl(bt);Ne<_t.y&&(bt.y=Math.max(_t.y,bt.y)),wr>_t.width&&(bt.x=_t.width-bt.width),Zr>_t.height&&(bt.y=_t.height-bt.height),nn<_t.x&&(bt.x=Math.max(_t.x,bt.x))})(m,{...me,x:0,y:0}),aa.set(m)},gm=Hr([Ga,us,Ta,el],([m,U,ht,Rt],ut)=>{m&&(ht||Rt)&&ut($m(m,U||1,ht||Rt))});D(t,gm,m=>r(100,Cs=m));const $m=(m,U,ht)=>ht.width<=m.width&&ht.height<=m.height?Bd(m,yl(Fr(ht),U)):Ki(m,$i(ht));let th,ym;const eh=m=>{if(h&&th&&pa(th,m)&&ym===wi)return;if(eo)return Qp();th=m,ym=wi;const U=$m(m,wi,Yn||fe);aa.set(U)};let bm=!1;const dx=us.subscribe(m=>{!bm&&m!==void 0&&Yn&&(eh(ye),bm=!0)}),px=Ga.subscribe(m=>{m&&wi!==void 0&&Yn&&eh(m)}),hx=il.subscribe(m=>{!m&&ye&&eh(ye)});let rh;const mx=Hu.subscribe(m=>{if(!m)return rh=void 0,void It(Pc,Xi=void 0,Xi);rh=ko;const U=Fr(Yn);Pc.set(U)}),fx=aa.subscribe(m=>{if(!m||!Fo)return;const U=(ht=Fr(m),Rt=Fo,ht.x-=Rt.x,ht.y-=Rt.y,ht.width-=Rt.width,ht.height-=Rt.height,ht);var ht,Rt;((bt,_t)=>{bt.x/=_t,bt.y/=_t,bt.width/=_t,bt.height/=_t})(U,rh);const ut=((bt,_t)=>(bt.x+=_t.x,bt.y+=_t.y,bt.width+=_t.width,bt.height+=_t.height,bt))(Fr(Xi),U);Ta.set(ut)}),gx=Ta.subscribe(m=>{if(!m||!fn)return;if(eo)return void(Fo||Qp());if(je||Fo||Lo)return;const U=$i(fn),ht=$i(m);if(mr(U,6)===mr(ht,6))return;const{width:Rt,height:ut}=Yn,bt=Math.min(ye.width/Rt,ye.height/ut),_t=An(m.width*bt,m.height*bt),Ne=.5*(fn.width-_t.width),wr=.5*(fn.height-_t.height),Zr=Wn(Math.max(0,Math.min(ye.width-_t.width,fn.x+Ne)),Math.max(0,Math.min(ye.height-_t.height,fn.y+wr)),_t.width,_t.height);aa.set(Zr)}),xm=Hr([us,Ta,aa,il],([m,U,ht,Rt],ut)=>{if(!m||!U||!ht)return;if(Rt)return ut(_i);const bt=ht.width/U.width,_t=ht.height/U.height;ut(Math.max(bt,_t)/m)}),Gu=Hr([us,xm],([m,U],ht)=>{U&&ht(m*U)});D(t,Gu,m=>r(495,ko=m));let _l={left:0,right:0,top:0,bottom:0};const vm=Hr([rl,aa],([m,U],ht)=>{if(!U)return ht(_l);const Rt=dm(U,m);mr(_l.top,4)===mr(Rt.top,4)&&mr(_l.bottom,4)===mr(Rt.bottom,4)&&mr(_l.right,4)===mr(Rt.right,4)&&mr(_l.left,4)===mr(Rt.left,4)||(_l=Rt,ht(Rt))}),$x=Hr([vm],([m],U)=>{U(Object.values(m).some(ht=>ht>0))}),nh=hr(.075,{stiffness:.03,damping:.4,precision:.001}),yx=Hr([Tc,kc,nh,Uu,Ic,rl,$x,vm,Ol],([m,U,ht,Rt,ut,bt,_t,Ne,wr],Zr)=>{if(!Rt||h)return Zr([]);let{x:nn,y:Rr,width:si,height:un}=Rt;nn+=.5,Rr+=.5,si-=.5,un-=.5;const gi=[];if(bt){if(_t){let{left:on,right:la,top:ll,bottom:Vl}=Ne;on*=ut,la*=ut,ll*=ut,Vl*=ut;const Eh=p1(U)?[1,1,1,.125]:[0,0,0,.075];gi.push({x:nn-on-.5,y:Rr-ll-.5,width:si+on+la+1,height:un+ll+Vl+1,strokeWidth:1,strokeColor:Eh,opacity:wr?1:.5})}const Ko=p1(m);bt&&bt.frameColor&&p1(bt.frameColor)||Ko||(gi.push({x:nn-1,y:Rr-1,width:si+2,height:un+2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:ht}),gi.push({x:nn+1,y:Rr+1,width:si-2,height:un-2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:ht}))}Zr([...gi,{x:nn,y:Rr,width:si,height:un,strokeWidth:1,strokeColor:m,opacity:ht}])}),Ec=ge([]);D(t,Ec,m=>r(406,uo=m));const wm=Hr([yx,Ec],([m,U],ht)=>{ht([...m,...U])});D(t,wm,m=>r(94,Sn=m));const ih=hr(0,{precision:.001});D(t,ih,m=>r(408,Nn=m));const oh=hr();D(t,oh,m=>r(411,oi=m));const ah=hr();D(t,ah,m=>r(410,wo=m));const sh=hr();D(t,sh,m=>r(409,Cn=m));const lh=hr();D(t,lh,m=>r(407,Yr=m));const Ac=ge(!1);D(t,Ac,m=>r(393,hi=m));const Lc=ge();let Is;D(t,Lc,m=>r(396,mi=m));const ch=Hr([Ac,Lc],([m,U],ht)=>{if(!m||!U)return void ht(void 0);if(Is&&(Is.cancel(),r(297,Is=void 0)),oc(U))return ht(Ey(U));const Rt=sa.length?0:Br?250:0;r(297,Is={cancel:se}),Q0(U,Is,Rt).then(ht).catch(ut=>{It(Tu,Tn.error=ut,Tn)}).finally(()=>{r(297,Is=void 0)})});Wa(),Wa=Hi(ch,m=>r(376,he=m));let{imagePreviewCurrent:Fc}=e;const uh=ge({});D(t,uh,m=>r(398,xo=m));const Zu=ge([]);D(t,Zu,m=>r(86,Nr=m));const Xu=Hr([Ga,zl,el,cm,aa,Gu,Fl,Mu,Pu,Ic,ol,lm],([m,U,ht,Rt,ut,bt,_t,Ne,wr,Zr,nn,Rr],si)=>{if(!m||!ut)return;const un=ib(m,U,ht,Rt,ut,Zr,nn,bt,_t,Ne,wr);!Rr&&y(un),si(un)});D(t,Xu,m=>r(399,Ao=m));const Sm=Hr([X0,Y0,q0,K0,J0],([m,U,ht,Rt,ut],bt)=>{const _t=m&&Object.keys(m).map(Ne=>m[Ne]).filter(Boolean);bt({gamma:ht||void 0,vignette:Rt||void 0,noise:ut||void 0,convolutionMatrix:U||void 0,colorMatrix:_t&&_t.length&&$u(_t)})});let Yu,dh;const km=(()=>{if(!Vo())return!1;const m=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/i)||[],[,U,ht]=m.map(Rt=>parseInt(Rt,10)||0);return U>13||U===13&&ht>=4})(),zc=ge({});D(t,zc,m=>r(387,xn=m)),go("env",zc);const Tm=qc(),ph=Yl(Tm,m=>{const U=()=>m(qc()),ht=matchMedia(`(resolution: ${Tm}dppx)`);return ht.addListener(U),()=>ht.removeListener(U)});D(t,ph,m=>r(57,Zo=m));const Za=((m,U,ht)=>{const{sub:Rt,pub:ut}=Ka(),{willUndo:bt=()=>!0}=ht||{},_t=[],Ne=ge(0),wr=[],Zr=()=>wr.forEach(Rr=>Rr({index:Ea(Ne),length:_t.length})),nn={get index(){return Ea(Ne)},set index(Rr){Rr=Number.isInteger(Rr)?Rr:0,Rr=an(Rr,0,_t.length-1),Ne.set(Rr),U(_t[nn.index]),Zr()},get state(){return _t[_t.length-1]},length:()=>_t.length,undo(){if(bt()===!1)return;const Rr=nn.index--;return ut("undo",Rr),Rr},redo(){const Rr=nn.index++;return ut("redo",nn.index),Rr},revert(){_t.length=1,nn.index=0,ut("revert")},write(Rr){Rr&&U({...m(),...Rr});const si=m(),un=_t[_t.length-1];JSON.stringify(si)!==JSON.stringify(un)&&(_t.length=nn.index+1,_t.push(si),Ne.set(_t.length-1),Zr(),ut("writehistory"))},set(Rr={}){_t.length=0,nn.index=0;const si=Array.isArray(Rr)?Rr:[Rr];_t.push(...si),nn.index=_t.length-1},get:()=>[..._t],subscribe:Rr=>(wr.push(Rr),Rr({index:nn.index,length:_t.length}),()=>wr.splice(wr.indexOf(Rr),1)),on:Rt};return nn})(()=>ei,m=>{It(Fu,ei=m,ei),Dl.set(Oi)},{willUndo:()=>!Sx()||(wx(),!1)});ns(),ns=Hi(Za,m=>r(405,ii=m));const Cm=()=>{const m={...fe},U=ta(Ki(m,ei.cropAspectRatio),Math.round),ht=fc({...ei,rotation:0,crop:U},ei),Rt=[ht];JSON.stringify(ht)!==JSON.stringify(ei)&&Rt.push({...ei}),Za.set(Rt)},bx=Tu.subscribe(m=>{m&&m.complete&&Cm()}),xx=()=>dc().then(m=>m&&Za.revert()),vx=[Eu,Iu,Lu,Au],wx=()=>{vx.forEach(m=>{m.update(U=>U.length&&ao(U[U.length-1])?U.slice(0,-1):U)})},Sx=()=>k.filter(m=>m.length).some(m=>ao(m[m.length-1])),Es=ge(!1);D(t,Es,m=>r(388,Vn=m));const kx=()=>{It(Es,Vn=!0,Vn),pc().then(m=>{if(!m)return void It(Es,Vn=!1,Vn);let U;U=Bc.subscribe(ht=>{ht===1&&(U&&U(),Co("processImage"))})})},Tx=Lp.subscribe(m=>{if(!m)return void It(Es,Vn=!1,Vn);It(Es,Vn=!0,Vn);const{complete:U,abort:ht}=m;(U||ht)&&It(Es,Vn=!1,Vn)}),sa=O3();D(t,sa,m=>r(55,Go=m));const Cx=Hr([sa],([m],U)=>{if(!m.length)return U();const{origin:ht,translation:Rt,rotation:ut,scale:bt}=m[0];U({origin:ht,translation:Rt,rotation:ut,scale:bt})}),qu=ge();D(t,qu,m=>r(402,Bi=m));let Ku,Ju=[];const Mm=ge(),hh=ge(),Mx=Hr([Wl,hh,us,hm],([m,U,ht,Rt])=>m||(U||ht<1?Rt:1)),Pm={...ro,imageFile:Rp,imageSize:el,mediaDuration:Ip,mediaMinDuration:Jb,mediaMaxDuration:Ap,mediaTrim:Ep,imageBackgroundColor:Ru,imageBackgroundImage:G0,imageBackgroundFilterMode:Z0,imageCropAspectRatio:Cu,imageCropMinSize:Qb,imageCropMaxSize:tx,imageCropLimitToImage:Fp,imageCropRect:Ta,imageCropRectOrigin:rx,imageCropRectSnapshot:Pc,imageCropRectAspectRatio:nx,imageCropRange:ex,imageRotation:Fl,imageRotationRange:ix,imageFlipX:Mu,imageFlipY:Pu,imageOutputSize:ox,imageColorMatrix:X0,imageConvolutionMatrix:Y0,imageGamma:q0,imageVignette:K0,imageNoise:J0,imageManipulation:Au,imageDecoration:Iu,imageAnnotation:Eu,imageRedaction:Lu,imageFrame:rl,imagePreview:ch,imagePreviewSource:Lc,imageTransforms:Xu,imagePreviewModifiers:uh,history:Za,animation:_u,pixelRatio:ph,elasticityMultiplier:os,scrollElasticity:V1,rangeInputElasticity:5,redrawTrigger:tl,pointerAccuracy:Ou,pointerHoverable:Wu,env:zc,rootRect:zl,stageRect:Ga,stageRectBase:Yp,stageRecenter:pm,stageScalar:us,stagePadding:Bl,stagePadded:Ol,presentationScalar:Gu,imagePreviewUpscale:hh,utilRect:nl,utilRectPadded:cx,allowPlayPause:yp,allowPan:Dp,allowZoom:Bp,allowZoomControls:Op,enableZoomInput:Wp,enablePanInput:zu,enablePanInputStatus:Vp,imageSelectionMultiTouching:Mm,rootBackgroundColor:kc,rootForegroundColor:Bu,rootLineColor:Tc,rootColorSecondary:sm,imageOutlineOpacity:nh,utilTools:qu,imageSelectionPan:ol,imageSelectionZoom:Wl,imageSelectionZoomCurrent:Mx,imageSelectionStageFitScalar:hm,imageSelectionStoredState:mm,imageOverlayMarkup:Ec,interfaceImages:Zu,isInteracting:Mc,isTransformingImage:lm,isInteractingFraction:Up,imageCropRectIntent:Zp,imageCropRectPresentation:cm,imageSelectionRect:aa,imageSelectionRectIntent:Xp,imageSelectionRectPresentation:Uu,imageSelectionRectSnapshot:Hu,imageScalar:xm,imageTransformsInterpolated:Cx,imageEffects:Sm};delete Pm.image;const Px="util-"+ra();let mh=[];const Rm=m=>nt.find(([U])=>m===U);let Dc=[];const fh=m=>{r(62,Dc=Dc.concat(m))},gh=m=>{r(62,Dc=Dc.filter(U=>U!==m))},$h=(m,U)=>{r(306,Z[m]=U,Z)};let Im=Vo();const Em=(m,U,ht)=>{let Rt=_.getPropertyValue(m);Rt=ht?ht(Rt):/^[0-9]+$/.test(Rt)?parseFloat(Rt):void 0,U.set(Rt,{hard:!Br})},al=(m,U,ht=!1)=>{const Rt=(ut=>{const bt=_.getPropertyValue(ut);return np(bt)})(m);Rt&&Rt[3]!==0&&(ht||(Rt.length=3),U.set(Rt,{hard:!Br}))},yh=ge();D(t,yh,m=>r(87,Wr=m));const bh=ge();D(t,bh,m=>r(88,or=m));const xh=ge();D(t,xh,m=>r(89,Sr=m));const Qu=hr(0,{damping:.9});D(t,Qu,m=>r(90,qr=m));const Am=()=>{al("color",Bu),al(pr?"--color-background":"background-color",kc),al("outline-color",Tc),al("--color-primary",Np),al("--color-secondary",sm),al("--grid-color-even",bh,!0),al("--grid-color-odd",xh,!0),Em("--grid-size",yh),Em("--editor-inset-top",jp,m=>parseInt(m,10))},Lm=Hr([Xu,Sm,Ru,ax,Z0],([m,U,ht,Rt,ut])=>m&&{...m,...U,backgroundColor:ht,backgroundImage:Rt,backgroundFilterMode:ut||"none"});D(t,Lm,m=>r(397,Io=m));const Rx=()=>{const m=sa.length?void 0:{resize:1.05},U=((ht,Rt,ut={})=>{const{resize:bt=1,opacity:_t=0}=ut,Ne={opacity:[hr(_t,{...fl,stiffness:.1}),tn],resize:[hr(bt,{...fl,stiffness:.1}),tn],translation:[hr(void 0,fl),tn],rotation:[hr(void 0,Md),tn],origin:[hr(void 0,fl),tn],scale:[hr(void 0,Md),tn],gamma:[hr(void 0,Md),un=>un||1],vignette:[hr(void 0,Md),un=>un||0],colorMatrix:[hr([...p$],fl),un=>un||[...p$]],convolutionMatrix:[ge(void 0),un=>un&&un.clarity||void 0],backgroundColor:[hr(void 0,fl),(un,gi,Ko)=>{if(Array.isArray(un)){if(Array.isArray(gi)){const on=[...un];gi[3]===0?(on[3]=0,Ko(on)):on[3]===0&&((un=[...gi])[3]=0)}return un}}],backgroundImage:[ge(void 0),tn],backgroundFilterMode:[ge(void 0),tn]},wr=Object.entries(Ne).map(([un,gi])=>[un,gi[0]]),Zr=wr.map(([,un])=>un),nn=Object.entries(Ne).reduce((un,[gi,Ko])=>{const[on,la]=Ko;return un[gi]=(ll,Vl)=>on.set(la(ll,Rr[gi],Eh=>{on.set(Eh,{hard:!0})}),Vl),un},{});let Rr;const si=Hr(Zr,un=>(Rr=un.reduce((gi,Ko,on)=>(gi[wr[on][0]]=Ko,gi),{}),Rr.data=ht,Rr.size=Rt,Rr.scale*=un[1],Rr));return si.get=()=>Rr,si.set=(un,gi)=>{const Ko={hard:!gi};Object.entries(un).forEach(([on,la])=>{nn[on]&&nn[on](la,Ko)})},si})(he,fe,m);sa.unshift(U),Fm(Io)},Fm=m=>{sa.forEach((U,ht)=>{const Rt=ht===0?1:0;U.set({...m,opacity:Rt,resize:1},Eo)})};let td;const Bc=S0(void 0,{duration:500});let vh;D(t,Bc,m=>r(54,Ln=m));const ed=ge(!1);let ds;D(t,ed,m=>r(392,ui=m));const rd=hr(void 0,{stiffness:.1,damping:.7,precision:.25});D(t,rd,m=>r(82,F=m));const nd=hr(0,{stiffness:.1,precision:.05});D(t,nd,m=>r(83,oe=m));const Oc=hr(0,{stiffness:.02,damping:.5,precision:.25});D(t,Oc,m=>r(390,Zn=m));const wh=hr(void 0,{stiffness:.02,damping:.5,precision:.25});D(t,wh,m=>r(391,ci=m));const id=hr(void 0,{stiffness:.02,damping:.5,precision:.25});let od;D(t,id,m=>r(389,xa=m));const Ix=()=>{Co("abortLoadImage")},Ex=()=>{Co("abortProcessImage"),It(Es,Vn=!1,Vn)},zm=m=>{m.target&&m.target.dataset.touchScroll==="true"||Tb(m)||m.preventDefault()},Ax=km?m=>{const U=m.touches?m.touches[0]:m;U.pageX>20&&U.pageX<window.innerWidth-20||zm(m)}:se,sl=ge([]);D(t,sl,m=>r(485,Ci=m)),go("keysPressed",sl);const Sh=m=>{!m||ic(m)&&!((U,ht)=>!(!(Rt=>/^image/.test(Rt.type)&&!/svg/.test(Rt.type))(U)||!/image/.test(ht))||!(!Xs(U)||!/video/.test(ht)))(m,Qs)||!ic(m)&&!/^http/.test(m)||Co("loadImage",m)},Lx=m=>{m&&Sh(m)};let As,Dm,Bm,Wc,kh=[];const Om=ge();go("rootPortal",Om),go("rootRect",zl);const Wm=()=>({foregroundColor:[...wn],lineColor:[...pn],utilVisibility:{...Z},isInteracting:je,isInteractingFraction:tr,rootRect:Fr(Gt),stageRect:Fr(ye),manipulationShapesDirty:dd,annotationShapesDirty:sd,decorationShapesDirty:cd,frameShapesDirty:ud}),_m=(m,U,ht)=>On(m,An(Math.round(U.width/ht),Math.round(U.height/ht))),Vm=(m,U,ht)=>{var Rt;return m._translate=lt((Rt=U).x,Rt.y),m._scale=ht,m},ad=m=>{const U=[];return m.forEach(ht=>U.push(Fx(ht))),U.filter(Boolean)},Fx=m=>Ii(m)?(m.points=[lt(m.x1,m.y1),lt(m.x2,m.y2)],m):(!(U=>Qn(U)&&!U.text.length)(m)||m.backgroundColor&&m.backgroundColor[3]!==0||(Kd(m)&&(m.width=5,m.height=m.lineHeight),m.strokeWidth=1,m.strokeColor=[1,1,1,.5],m.backgroundColor=[0,0,0,.1]),m);let Nm,Th=[],Ch=[],Mh=[],Ph=[],Rh=[],Hm={};const jm=(m,U,ht,Rt,ut,bt,_t)=>{const{manipulationShapesDirty:Ne,annotationShapesDirty:wr,decorationShapesDirty:Zr,frameShapesDirty:nn,selectionRect:Rr,scale:si}=m,un=Nm!==si,gi=un||!pa(Hm,Rr);gi&&(Nm=si,Hm=Rr),Ne&&(Mh=U.filter(gd).map(In).map(on=>On(on,fe))),(wr||ht!==en)&&(Th=ht.filter(gd).map(In).sort((on,la)=>on.alwaysOnTop?1:la.alwaysOnTop?-1:0).map(on=>On(on,fe))),(un||ld||wr||ht!==en)&&(Ch=ad(Th.map(on=>$(on,{flipX:Mr,flipY:Cr,rotation:ir,scale:si,context:Ui(fe)})).flat())),(Zr||Rt!==Er||gi)&&(Ph=ad(Rt.filter(gd).map(In).sort((on,la)=>on.alwaysOnTop?1:la.alwaysOnTop?-1:0).map(on=>_m(on,Rr,si)).map(on=>$(on,{context:Rr})).flat().map(on=>Vm(on,Rr,si)))),(nn||bt!==er||gi)&&(Rh=bt?ad([bt].map(In).map(on=>_m(on,Rr,si)).map($).flat().map(on=>Vm(on,Rr,si))):[]);let Ko=ad(ut.filter(gd));return typeof window<"u"&&(on=>{if(on&&on._zb8to4f)return;const[la]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101]].map(ll=>ll.map(Vl=>String.fromCharCode(Vl)).join(""));Ko=[...Ko,{x:Rr.x+.5*Rr.width-82,y:Rr.y+Rr.height-16-12,width:164,height:16,text:la,fontWeight:900,fontSize:12,color:[1,1,1,.25]}]})(window),{manipulationShapesDirty:Ne,manipulationShapes:Mh,annotationShapesDirty:wr,annotationShapes:Ch,decorationShapesDirty:Zr,decorationShapes:Ph,frameShapesDirty:nn,frameShapes:Rh,interfaceShapes:Ko,selectionShapes:_t.map(In).map(on=>On(on,fe))}};let sd=!0,ld=!0,cd=!0,ud=!0,dd=!0;jo(()=>{Rs(),he&&Ge(he.src)&&/^blob:/.test(he.src)&&URL.revokeObjectURL(he.src),sx(),px(),dx(),hx(),mx(),fx(),gx(),bx(),Tx(),Ou.destroy(),Wu.destroy(),Pp.destroy(),sa.clear(),Th.length=0,Ch.length=0,Mh.length=0,Ph.length=0,Rh.length=0,As&&ti(As),Mo&&window.visualViewport.removeEventListener("resize",Va);try{r(235,Fc=void 0),r(298,td=void 0)}catch{}});let Ih;return t.$$set=m=>{"class"in m&&r(236,_a=m.class),"layout"in m&&r(237,vn=m.layout),"stores"in m&&r(238,ro=m.stores),"locale"in m&&r(3,Gr=m.locale),"id"in m&&r(4,no=m.id),"util"in m&&r(239,ln=m.util),"utils"in m&&r(240,fo=m.utils),"animations"in m&&r(241,wa=m.animations),"disabled"in m&&r(242,Yi=m.disabled),"previewUpscale"in m&&r(243,Ms=m.previewUpscale),"previewPad"in m&&r(244,is=m.previewPad),"previewMaskOpacity"in m&&r(5,bu=m.previewMaskOpacity),"previewImageDataMaxSize"in m&&r(245,Cl=m.previewImageDataMaxSize),"previewImageTextPixelRatio"in m&&r(6,Ml=m.previewImageTextPixelRatio),"markupMaskOpacity"in m&&r(7,uc=m.markupMaskOpacity),"zoomMaskOpacity"in m&&r(246,Pl=m.zoomMaskOpacity),"elasticityMultiplier"in m&&r(8,os=m.elasticityMultiplier),"willRevert"in m&&r(247,dc=m.willRevert),"willProcessImage"in m&&r(248,pc=m.willProcessImage),"willRenderCanvas"in m&&r(9,Rl=m.willRenderCanvas),"willRenderToolbar"in m&&r(249,hc=m.willRenderToolbar),"willRenderUtilTabs"in m&&r(250,mc=m.willRenderUtilTabs),"willSetHistoryInitialState"in m&&r(251,fc=m.willSetHistoryInitialState),"enableButtonExport"in m&&r(252,gc=m.enableButtonExport),"enableButtonRevert"in m&&r(253,Il=m.enableButtonRevert),"enableNavigateHistory"in m&&r(254,Ks=m.enableNavigateHistory),"enableToolbar"in m&&r(10,as=m.enableToolbar),"enableUtils"in m&&r(255,$c=m.enableUtils),"enableButtonClose"in m&&r(256,yc=m.enableButtonClose),"enableDropImage"in m&&r(257,Js=m.enableDropImage),"enablePasteImage"in m&&r(258,El=m.enablePasteImage),"enableBrowseImage"in m&&r(259,ss=m.enableBrowseImage),"accept"in m&&r(260,Qs=m.accept),"enableTransparencyGrid"in m&&r(11,bc=m.enableTransparencyGrid),"layoutDirectionPreference"in m&&r(261,qo=m.layoutDirectionPreference),"layoutHorizontalUtilsPreference"in m&&r(262,Al=m.layoutHorizontalUtilsPreference),"layoutVerticalUtilsPreference"in m&&r(263,x=m.layoutVerticalUtilsPreference),"layoutVerticalToolbarPreference"in m&&r(264,W=m.layoutVerticalToolbarPreference),"layoutVerticalControlGroupsPreference"in m&&r(265,R=m.layoutVerticalControlGroupsPreference),"layoutVerticalControlTabsPreference"in m&&r(266,K=m.layoutVerticalControlTabsPreference),"supportedMediaTypes"in m&&r(267,Q=m.supportedMediaTypes),"status"in m&&r(234,dt=m.status),"formatStatusImageLoading"in m&&r(268,At=m.formatStatusImageLoading),"formatStatusImageProcessing"in m&&r(269,ce=m.formatStatusImageProcessing),"formatStatusSupportError"in m&&r(270,jt=m.formatStatusSupportError),"textDirection"in m&&r(12,ne=m.textDirection),"markupEditorZoomLevel"in m&&r(271,Jt=m.markupEditorZoomLevel),"markupEditorZoomLevels"in m&&r(13,Ee=m.markupEditorZoomLevels),"markupEditorZoomAdjustStep"in m&&r(14,sr=m.markupEditorZoomAdjustStep),"markupEditorZoomAdjustFactor"in m&&r(15,re=m.markupEditorZoomAdjustFactor),"markupEditorZoomAdjustWheelFactor"in m&&r(16,vr=m.markupEditorZoomAdjustWheelFactor),"markupEditorInteractionMode"in m&&r(272,Le=m.markupEditorInteractionMode),"muteAudio"in m&&r(273,ve=m.muteAudio),"willSetMediaInitialTimeOffset"in m&&r(274,Me=m.willSetMediaInitialTimeOffset),"enablePan"in m&&r(17,Pe=m.enablePan),"enableZoom"in m&&r(18,ke=m.enableZoom),"enableZoomControls"in m&&r(275,Ye=m.enableZoomControls),"enableZoomInput"in m&&r(19,cn=m.enableZoomInput),"enablePanInput"in m&&r(276,We=m.enablePanInput),"enableCanvasAlpha"in m&&r(20,pr=m.enableCanvasAlpha),"enablePanLimit"in m&&r(21,mn=m.enablePanLimit),"panLimitGutterScalar"in m&&r(22,ki=m.panLimitGutterScalar),"pan"in m&&r(277,fi=m.pan),"zoomPresetOptions"in m&&r(23,ai=m.zoomPresetOptions),"zoomAdjustStep"in m&&r(24,Bn=m.zoomAdjustStep),"zoomAdjustFactor"in m&&r(25,qn=m.zoomAdjustFactor),"zoomAdjustWheelFactor"in m&&r(26,Kn=m.zoomAdjustWheelFactor),"zoomLevel"in m&&r(0,Pi=m.zoomLevel),"fixScrollDirection"in m&&r(278,io=m.fixScrollDirection),"imagePreviewSrc"in m&&r(281,Sa=m.imagePreviewSrc),"imageOrienter"in m&&r(282,Ha=m.imageOrienter),"pluginComponents"in m&&r(283,ka=m.pluginComponents),"pluginOptions"in m&&r(27,ja=m.pluginOptions),"root"in m&&r(2,Qr=m.root),"imageSourceToImageData"in m&&r(28,Mp=m.imageSourceToImageData),"imagePreviewCurrent"in m&&r(235,Fc=m.imagePreviewCurrent)},t.$$.update=()=>{if(1073741824&t.$$.dirty[8]&&Do.set(io),8&t.$$.dirty[0]&&r(304,n=!!Gr),1&t.$$.dirty[0]|8388608&t.$$.dirty[8]&&r(0,Pi=Pi===null?Jt:Pi),2&t.$$.dirty[0]|16&t.$$.dirty[9]){let ut=!1;ka.forEach(([bt])=>{Ri[bt]||(r(1,Ri[bt]={},Ri),ut=!0)}),ut&&r(295,wc=[...ka])}var m,U,ht,Rt;if(8388608&t.$$.dirty[7]|33619968&t.$$.dirty[9]&&r(356,N=n&&wc.length?fo||wc.map(([ut])=>ut):[]),134217728&t.$$.dirty[0]|65536&t.$$.dirty[9]|32768&t.$$.dirty[11]|1&t.$$.dirty[13]&&r(357,nt=((ut,bt,_t,Ne)=>{const wr=bt.filter(([Zr])=>ut.includes(Zr)).filter(([Zr,{isSupported:nn}])=>nn({...Ne,..._t[Zr]})).map(([Zr,nn])=>[Zr,nn.Component]);return ys(wr,mh,(Zr,nn)=>Zr[0]===nn[0]&&Zr[1]===nn[1])?mh:(mh=wr,wr)})(N,wc,ja,{src:co})),65536&t.$$.dirty[11]&&r(310,ft=nt.length),8&t.$$.dirty[0]|1&t.$$.dirty[10]|32768&t.$$.dirty[11]&&r(355,xt=ft&&N.map(ut=>{const bt=Rm(ut);if(!bt)return;const _t=Gr[ut+"Label"],Ne=Gr[ut+"Title"];return{id:ut,view:bt[1],tabIcon:Gr[ut+"Icon"],tabLabel:_t,tabTitle:Ge(Ne)?Ne:_t}}).filter(Boolean)||[]),16384&t.$$.dirty[11]&&r(374,i=!!xt.find(ut=>ut.id==="trim")),20&t.$$.dirty[12]|16777216&t.$$.dirty[13]&&r(309,o=!!(Fn&&he&&i)),4194304&t.$$.dirty[7]|1&t.$$.dirty[10]&&r(43,H=ft&&ln&&typeof ln=="string"&&Rm(ln)?ln:ft>0?nt[0][0]:void 0),4096&t.$$.dirty[1]|1073741824&t.$$.dirty[9]&&o&&H&&Rs(),1073741824&t.$$.dirty[9]|16&t.$$.dirty[12]&&(o?(he.addEventListener("play",xu),he.addEventListener("pause",xu)):he&&he.nodeName==="video"&&(he.removeEventListener("play",xu),he.removeEventListener("pause",xu))),1073741824&t.$$.dirty[9]&&o&&Ua.set(vu()/cs()),75497472&t.$$.dirty[13]&&(ut=>{if(!Ll())return;const bt=Date.now();if(bp&&bt-bp<16)return;bp=bt;const _t=Fn*ut;if(_t.toFixed(1)===W0)return;W0=_t.toFixed(1);const Ne=he,wr=()=>{Ne.removeEventListener("seeked",wr),oa()};Ne.addEventListener("seeked",wr),s$(Ne,_t)})(zo||gn),8388608&t.$$.dirty[13]&&r(372,a=gn&&mr(gn,6)),153092096&t.$$.dirty[13]&&r(370,s=Ze||[[0,Math.min(Fn,Ba)/Fn]]),536870912&t.$$.dirty[11]&&(l=s[0][0]),536870912&t.$$.dirty[11]&&(c=s[s.length-1][1]),536870912&t.$$.dirty[11]&&r(373,u=s.map(([ut,bt])=>[mr(ut,6),mr(bt,6)])),3&t.$$.dirty[12]&&r(371,d=u.findIndex(([ut,bt])=>a>=ut&&a<=bt)),1073741824&t.$$.dirty[11]|3&t.$$.dirty[12]&&(p=d===-1&&u.findIndex((ut,bt,_t)=>{const Ne=_t[bt-1];return Ne?a<=ut[0]&&a>=Ne[1]:a<=ut[0]})),33554432&t.$$.dirty[8]&&vc.set(ve),16&t.$$.dirty[12]|33554432&t.$$.dirty[13]&&(he&&mo?kp():Tp()),1073741824&t.$$.dirty[9]|8388608&t.$$.dirty[13]&&o&&ku.set(cs()*gn),16&t.$$.dirty[12]|4194304&t.$$.dirty[13]&&he&&(ut=>{o&&(he.volume=Math.min(1,ut))})(Yo),256&t.$$.dirty[0]&&It(Su,Da=os,Da),1048576&t.$$.dirty[7]&&r(366,h=vn==="overlay"),128&t.$$.dirty[8]|33554432&t.$$.dirty[11]&&r(45,f=$c&&!h),134217730&t.$$.dirty[0]&&ja&&Object.entries(ja).forEach(([ut,bt])=>{Object.entries(bt).forEach(([_t,Ne])=>{Ri[ut]&&r(1,Ri[ut][_t]=Ne,Ri)})}),65536&t.$$.dirty[13]&&r(367,w=!be),16777216&t.$$.dirty[7]|201326592&t.$$.dirty[11]&&It(Vu,Br=wa==="always"?b:wa!=="never"&&b&&w,Br),4194304&t.$$.dirty[1]|33554432&t.$$.dirty[7]&&Cp.set(Yi?1:0,{hard:!Br}),268435456&t.$$.dirty[7]&&(g=Cl?(m=Cl,U=H0,An(Math.min(m.width,U.width),Math.min(m.height,U.height))):H0),1048576&t.$$.dirty[13]&&Pp.update(ho[0]),524288&t.$$.dirty[13]&&($=Si?(ut,bt)=>Si(ut,{flipX:void 0,flipY:void 0,rotation:void 0,...bt,isPreview:!0}):tn),268435456&t.$$.dirty[1]&&Array.isArray(Or)&&Co("selectionchange",[...Or]),134217728&t.$$.dirty[8]|262144&t.$$.dirty[13]&&_p.set(bn&&Ye),285212672&t.$$.dirty[8]&&Du.set(Le==="pan"||We),1048576&t.$$.dirty[1]&&pi&&zl.set(Wn(pi.x,pi.y,pi.width,pi.height)),33554432&t.$$.dirty[11]|8388616&t.$$.dirty[12]&&Gt&&h&&Tn&&Tn.complete&&(()=>{const ut=Kr,bt=$i(Gt);ut&&ut===bt||(Cu.set($i(Gt)),Cm())})(),32768&t.$$.dirty[11]&&r(46,Pt=N.length>1),32768&t.$$.dirty[1]&&(Pt||Dl.set(Os())),1024&t.$$.dirty[0]|131072&t.$$.dirty[13]&&(as||Cc.set(Wn(0,$e,0,0))),134217728&t.$$.dirty[11]|512&t.$$.dirty[12]&&r(369,v=!je&&b),1048576&t.$$.dirty[1]&&r(311,Ve=pi&&pi.width>0&&pi.height>0),8&t.$$.dirty[0]|3&t.$$.dirty[10]&&r(40,Se=Ve&&Gr&&!!ft),512&t.$$.dirty[1]&&setTimeout(()=>r(296,Gp=Se),1),16777216&t.$$.dirty[7]|131072&t.$$.dirty[9]|335544320&t.$$.dirty[11]&&It(_u,Eo=wa==="always"?v:wa!=="never"&&v&&Gp&&w,Eo),67108864&t.$$.dirty[7]|33554432&t.$$.dirty[11]&&Nu.set(Ms||h),134217728&t.$$.dirty[7]&&ju.set(is),536870912&t.$$.dirty[8]&&fi&&ol.set(fi),4&t.$$.dirty[0]|36864&t.$$.dirty[13]&&Qr&&(Qr.dispatchEvent(Fs("markupzoom",Ue)),Qr.dispatchEvent(Fs("zoom",_e(Ue)?Ue:wi))),4&t.$$.dirty[0]|16384&t.$$.dirty[13]&&Qr&&(Qr.dispatchEvent(Fs("markuppan",O)),Qr.dispatchEvent(Fs("pan",O))),2048&t.$$.dirty[13]&&Yn&&fm(),8192&t.$$.dirty[13]&&po&&Qp(),4198400&t.$$.dirty[1]&&H&&nh.set(.075,{hard:!Br}),536870912&t.$$.dirty[7]&&r(364,S=Pl),1536&t.$$.dirty[13]&&r(365,P=Pn?-Math.max(...Object.values(So)):0),138936320&t.$$.dirty[1]|25165824&t.$$.dirty[11]&&Wi){let ut=Wi.x-ye.x,bt=ye.x+ye.width-(Wi.x+Wi.width),_t=Wi.y-ye.y,Ne=ye.y+ye.height-(Wi.y+Wi.height),wr=Math.min(ut,_t,bt,Ne);ih.set(wr>P?0:Math.min(S,Math.abs(wr/64)),{hard:!Br})}if(67108864&t.$$.dirty[1]&&r(363,M=.55/Zo),4718592&t.$$.dirty[1]|4194304&t.$$.dirty[11]&&ye&&oh.set({x:0,y:ye.y,width:ye.x<64?0:ye.x,height:ye.height+M},{hard:!Br}),4718592&t.$$.dirty[1]|4194304&t.$$.dirty[11]|8&t.$$.dirty[12]&&ye&&ah.set({x:0,y:0,width:Gt.width,height:ye.y+M},{hard:!Br}),4718592&t.$$.dirty[1]|4194304&t.$$.dirty[11]|8&t.$$.dirty[12]&&ye){let ut=ye.x+ye.width,bt=Gt.width-(ye.x+ye.width);bt<64&&(ut+=bt,bt=0),sh.set({x:ut,y:ye.y,width:bt,height:ye.height+M},{hard:!Br})}if(4718592&t.$$.dirty[1]|8&t.$$.dirty[12]&&ye&&lh.set({x:0,y:ye.y+ye.height,width:Gt.width,height:Gt.height-(ye.y+ye.height)},{hard:!Br}),33554432&t.$$.dirty[1]|288&t.$$.dirty[13]&&r(359,E=oi&&{id:"stage-overlay",backgroundColor:to,opacity:Nn,...oi}),33554432&t.$$.dirty[1]|160&t.$$.dirty[13]&&r(362,C=wo&&{id:"stage-overlay",backgroundColor:to,opacity:Nn,...wo}),33554432&t.$$.dirty[1]|96&t.$$.dirty[13]&&r(361,z=Cn&&{id:"stage-overlay",backgroundColor:to,opacity:Nn,...Cn}),33554432&t.$$.dirty[1]|48&t.$$.dirty[13]&&r(360,V=Yr&&{id:"stage-overlay",backgroundColor:to,opacity:Nn,...Yr}),3932160&t.$$.dirty[11]&&r(358,L=[C,z,V,E].filter(Boolean)),131072&t.$$.dirty[11]|8&t.$$.dirty[13]&&L&&uo&&Ec.update(ut=>[...ut.filter(bt=>bt.id!=="stage-overlay"),...L]),4&t.$$.dirty[9]|1&t.$$.dirty[13]&&Lc.set(Sa||co||void 0),4&t.$$.dirty[0]|262144&t.$$.dirty[7]|16&t.$$.dirty[12]&&(r(235,Fc=he),he&&Qr.dispatchEvent(Fs("loadpreview",Fc))),16777216&t.$$.dirty[12]&&mi&&(ol.set(dn()),Wl.set(void 0),fm(),Zu.set([])),4&t.$$.dirty[13]&&r(315,ct=ii.index>0),4&t.$$.dirty[13]&&r(314,j=ii.index<ii.length-1),393216&t.$$.dirty[1]|3072&t.$$.dirty[12]&&(k=[en,Er,Xr,sn]),8&t.$$.dirty[1]&&Mm.set(Ku),2&t.$$.dirty[13]&&hh.set(Zi),4096&t.$$.dirty[1]&&lx.set(H),4096&t.$$.dirty[1]|134217728&t.$$.dirty[9]|16384&t.$$.dirty[11]&&r(306,Z=xt.reduce((ut,bt)=>{const _t=Z&&Z[bt.id];return ut[bt.id]=_t!==void 0?_t:bt.id===H?1:0,ut},{})),4096&t.$$.dirty[1]&&r(79,wt={name:Px,selected:H}),16384&t.$$.dirty[11]&&r(337,vt=xt.map(ut=>({id:ut.id,icon:ut.tabIcon,label:ut.tabLabel,title:ut.tabTitle}))),16384&t.$$.dirty[11]&&r(78,et=xt.map(ut=>ut.id)),524288&t.$$.dirty[7]&&r(77,Et=br(["PinturaRoot","PinturaRootComponent",_a])),8&t.$$.dirty[12]&&r(351,kt=Gt&&(Gt.width>1e3?"wide":Gt.width<600?"narrow":void 0)),8&t.$$.dirty[12]&&r(338,st=Gt&&(Gt.width<=320||Gt.height<=460)),8&t.$$.dirty[12]&&r(350,Ut=Gt&&(Gt.height>1e3?"tall":Gt.height<600?"short":void 0)),4&t.$$.dirty[0]&&r(317,rt=Qr&&Qr.parentNode&&Qr.parentNode.classList.contains("PinturaModal")),1&t.$$.dirty[1]|128&t.$$.dirty[10]|8&t.$$.dirty[12]&&r(343,X=rt&&Gt&&Yu>Gt.width),2&t.$$.dirty[1]|128&t.$$.dirty[10]|8&t.$$.dirty[12]&&r(342,q=rt&&Gt&&dh>Gt.height),6&t.$$.dirty[11]&&r(344,Ft=X&&q),1048576&t.$$.dirty[0]&&r(341,zt=pr),1024&t.$$.dirty[11]&&r(312,yt=kt==="narrow"),8192&t.$$.dirty[8]|8&t.$$.dirty[12]&&r(352,(ht=Gt,Rt=qo,Dt=Gt?Rt==="auto"?ht.width>ht.height?"landscape":"portrait":Rt==="horizontal"?ht.width<500?"portrait":"landscape":Rt==="vertical"?ht.height<400?"landscape":"portrait":void 0:"landscape")),2048&t.$$.dirty[11]&&r(76,Wt=Dt==="landscape"),4&t.$$.dirty[10]|512&t.$$.dirty[11]&&r(340,at=yt||Ut==="short"),1&t.$$.dirty[1]|8&t.$$.dirty[12]&&r(339,St=Im&&Gt&&Yu===Gt.width&&!km),4&t.$$.dirty[1]|1073741824&t.$$.dirty[12]&&r(313,pt=[...Bi||[],...Ju].filter(Boolean)),16384&t.$$.dirty[8]&&r(349,Xt="has-navigation-preference-"+Al),32768&t.$$.dirty[8]&&r(348,Zt="has-navigation-preference-"+x),65536&t.$$.dirty[8]&&r(345,ie="has-toolbar-preference-"+W),131072&t.$$.dirty[8]&&r(347,gt="has-controlgroups-preference-"+R),262144&t.$$.dirty[8]&&r(346,te="has-controltabs-preference-"+K),8&t.$$.dirty[12]&&r(354,xe=Gt!==void 0&&Gt.width>0&&Gt.height>0),4&t.$$.dirty[0]|8192&t.$$.dirty[11]&&r(353,_=xe&&Qr&&getComputedStyle(Qr)),4096&t.$$.dirty[11]&&_&&Am(),1024&t.$$.dirty[0]|4243456&t.$$.dirty[1]|34603008&t.$$.dirty[7]|1879048320&t.$$.dirty[10]|4095&t.$$.dirty[11]|805339136&t.$$.dirty[12]&&zc.set({...xn,layoutMode:vn,orientation:Dt,horizontalSpace:kt,verticalSpace:Ut,navigationHorizontalPreference:Xt,navigationVerticalPreference:Zt,controlGroupsVerticalPreference:gt,controlTabsVerticalpreference:te,toolbarVerticalPreference:ie,isModal:rt,isDisabled:Yi,isCentered:Ft,isCenteredHorizontally:X,isCenteredVertically:q,isAnimated:Br,isTransparent:zt,pointerAccuracy:lo,pointerHoverable:vo,isCompact:at,hasSwipeNavigation:St,hasLimitedSpace:st,hasToolbar:as,hasNavigation:Pt&&f,isIOS:Im,browserVersion:w0()?"chrome-"+(navigator.userAgent.match(/Chrome\/([0-9]+)/)||[])[1]:void 0}),32768&t.$$.dirty[12]&&r(75,Kt=Object.entries(xn).map(([ut,bt])=>/^is|has/.test(ut)?bt?Cb(ut):void 0:bt).filter(Boolean).join(" ")),4096&t.$$.dirty[1]&&H&&qu.set([]),4096&t.$$.dirty[1]|4&t.$$.dirty[8]|134217728&t.$$.dirty[10]|32768&t.$$.dirty[12]&&r(44,qt=mc(vt.map(ut=>({...ut,selected:H===ut.id})),{...xn},()=>tl.set({}))),8192&t.$$.dirty[1]&&r(74,le=!!qt.find(ut=>Array.isArray(ut))),201326592&t.$$.dirty[12]&&r(73,de=Ao&&Object.entries(xo).filter(([,ut])=>ut!=null).reduce((ut,[,bt])=>ut={...ut,...bt},{})),8388608&t.$$.dirty[12]&&r(334,pe=Tn&&Tn.task==="any-to-file"),16777216&t.$$.dirty[10]&&pe&&sa&&sa.clear(),33554432&t.$$.dirty[12]&&r(336,Oe=!!Io&&!!Io.translation),524288&t.$$.dirty[9]|67108864&t.$$.dirty[10]|16&t.$$.dirty[12]&&Oe&&he&&he!==td&&(r(298,td=he),Rx()),67108864&t.$$.dirty[10]|33554432&t.$$.dirty[12]&&Oe&&Fm(Io),16777216&t.$$.dirty[1]&&Go&&Go.length>1){let ut=[];sa.forEach((bt,_t)=>{_t!==0&&bt.get().opacity<=0&&ut.push(bt)}),ut.forEach(bt=>sa.remove(bt))}if(8&t.$$.dirty[0]|33554432&t.$$.dirty[10]&&r(39,Ct=Gr&&rr.length&&function(ut,bt){if(Vr(bt.labelSupportError))return bt.labelSupportError(ut);const _t=jt({features:ut},bt);return Ws(bt.labelSupportError,_t,"{","}")}(rr,Gr)),8388608&t.$$.dirty[12]&&r(326,ar=Tn&&!!Tn.error),8388608&t.$$.dirty[12]&&r(42,Ke=!Tn||!Tn.complete&&Tn.task===void 0),8388608&t.$$.dirty[12]&&r(327,Qe=Tn&&(Tn.taskLengthComputable?Tn.taskProgress:1/0)),16777216&t.$$.dirty[10]&&pe&&It(Ac,hi=!1,hi),4194304&t.$$.dirty[1]|1048576&t.$$.dirty[9]|8388608&t.$$.dirty[12]&&Tn&&Tn.complete){const ut=Br?250:0;clearTimeout(vh),r(299,vh=setTimeout(()=>{It(Ac,hi=!0,hi)},ut))}if(2048&t.$$.dirty[1]|65536&t.$$.dirty[10]|10485760&t.$$.dirty[12]&&r(331,Re=Tn&&!ar&&!Ke&&!hi),262144&t.$$.dirty[9]|16777232&t.$$.dirty[12]&&r(330,Je=!(!mi||he&&!Is)),4194304&t.$$.dirty[1]|2097152&t.$$.dirty[12]&&(hi?setTimeout(()=>Qu.set(1,{hard:!Br}),Br?500:0):Qu.set(0,{hard:!Br})),4259840&t.$$.dirty[12]&&r(325,ur=!!(Vn||Xn&&Xn.progress!==void 0&&!Xn.complete)),32768&t.$$.dirty[10]&&ur&&Rs(),2048&t.$$.dirty[1]|8388608&t.$$.dirty[12]&&r(328,$r=Tn&&!(Tn.error||Ke)),8&t.$$.dirty[0]|8388608&t.$$.dirty[12]&&r(329,zr=Gr&&function(ut,bt){const _t=ut?!ut.complete||ut.error?ut:{task:"blob-to-bitmap",progress:1/0}:void 0;let Ne=Vr(bt.statusLabelLoadImage)?bt.statusLabelLoadImage(_t):At({state:_t},bt);return ut&&ut.error&&ut.error.metadata&&(Ne=Ws(Ne,ut.error.metadata,"{","}")),Ne}(Tn,Gr)),8&t.$$.dirty[0]|4194304&t.$$.dirty[12]&&r(324,Dr=Xn&&Gr&&function(ut,bt){return Vr(bt.statusLabelProcessImage)?bt.statusLabelProcessImage(ut):ce({state:ut},bt)}(Xn,Gr)),4194304&t.$$.dirty[12]&&r(322,dr=Xn&&(Xn.taskLengthComputable?Xn.taskProgress:1/0)),4194304&t.$$.dirty[12]&&r(323,Y=Xn&&!Xn.error),4194304&t.$$.dirty[12]&&r(321,it=!(!Xn||!Xn.error)),8&t.$$.dirty[0]|2048&t.$$.dirty[1]|131072&t.$$.dirty[7]|4192256&t.$$.dirty[10])if(dt){let ut,bt,_t,Ne,wr;Ge(dt)&&(ut=dt),_e(dt)?bt=dt:Array.isArray(dt)&&([ut,bt,wr]=dt,bt===!1&&(Ne=!0),_e(bt)&&(_t=!0)),r(35,ds=(ut||bt)&&{text:ut,aside:Ne||_t,progressIndicator:{visible:_t,progress:bt},closeButton:Ne&&{label:Gr.statusLabelButtonClose,icon:Gr.statusIconButtonClose,onclick:wr||(()=>r(234,dt=void 0))}})}else r(35,ds=Gr&&Ke||ar||Re||Je?{text:zr,aside:ar||$r,progressIndicator:{visible:$r,progress:Qe},closeButton:ar&&{label:Gr.statusLabelButtonClose,icon:Gr.statusIconButtonClose,onclick:Ix}}:Gr&&ur&&Dr?{text:Dr,aside:it||Y,progressIndicator:{visible:Y,progress:dr},closeButton:it&&{label:Gr.statusLabelButtonClose,icon:Gr.statusIconButtonClose,onclick:Ex}}:void 0);if(131072&t.$$.dirty[7]&&r(333,G=dt!==void 0),4194304&t.$$.dirty[1]|128&t.$$.dirty[10]|4194304&t.$$.dirty[12]&&rt&&Xn&&Xn.complete&&(ed.set(!0),setTimeout(()=>ed.set(!1),Br?100:0)),4&t.$$.dirty[0]|4096&t.$$.dirty[1]|2097152&t.$$.dirty[12]&&hi&&Qr&&Qr.dispatchEvent(Fs("selectutil",H)),2304&t.$$.dirty[1]|11632640&t.$$.dirty[10]|1048576&t.$$.dirty[12]&&r(332,Bt=ui||Ct||Ke||ar||Re||Je||ur||G),4194304&t.$$.dirty[10]&&It(Bc,Ln=Bt?1:0,Ln),4194304&t.$$.dirty[1]|4194304&t.$$.dirty[10]&&Bc.set(Bt?1:0,{duration:Br?500:1}),8388608&t.$$.dirty[1]&&r(41,ae=Ln>0),16&t.$$.dirty[1]&&r(320,De=!(!ds||!ds.aside)),4195344&t.$$.dirty[1]|2097152&t.$$.dirty[9]|1024&t.$$.dirty[10]|524288&t.$$.dirty[12]&&ae&&ds){clearTimeout(od);const ut={hard:Br===!1};if(De){const bt=!!ds.error||!Br;nd.set(1,ut),rd.set(ci,{hard:bt}),r(300,od=setTimeout(()=>{Oc.set(16,ut)},1))}else nd.set(0,ut),r(300,od=setTimeout(()=>{Oc.set(0,ut)},1))}if(1024&t.$$.dirty[1]&&(ae||(id.set(void 0,{hard:!0}),rd.set(void 0,{hard:!0}),Oc.set(0,{hard:!0}))),262144&t.$$.dirty[12]&&r(319,we=.5*Zn),512&t.$$.dirty[10]|131072&t.$$.dirty[12]&&r(72,Ot=`translateX(${xa-we}px)`),256&t.$$.dirty[1]|48&t.$$.dirty[12]&&r(38,$t=he&&fe&&!Ct),128&t.$$.dirty[1]|384&t.$$.dirty[10]&&r(316,nr=Ce&&($t||rt)?zm:se),64&t.$$.dirty[10]&&r(71,lr=nr),64&t.$$.dirty[10]&&r(70,ot=nr),8&t.$$.dirty[0]|2097152&t.$$.dirty[1]|370&t.$$.dirty[8]|60&t.$$.dirty[10]|32768&t.$$.dirty[12]&&r(69,Yt=Gr&&na&&pu(()=>hc([["div","alpha",{class:"PinturaNavGroup"},[["div","alpha-set",{class:"PinturaNavSet"},[yc&&["Button","close",{label:Gr.labelClose,icon:Gr.iconButtonClose,onclick:()=>Co("close"),hideLabel:!0}],Il&&["Button","revert",{label:Gr.labelButtonRevert,icon:Gr.iconButtonRevert,disabled:!ct,onclick:xx,hideLabel:!0}]]]]],["div","beta",{class:"PinturaNavGroup PinturaNavGroupFloat"},[Ks&&["div","history",{class:"PinturaNavSet"},[["Button","undo",{label:Gr.labelButtonUndo,icon:Gr.iconButtonUndo,disabled:!ct,onclick:Za.undo,hideLabel:!0}],["Button","redo",{label:Gr.labelButtonRedo,icon:Gr.iconButtonRedo,disabled:!j,onclick:Za.redo,hideLabel:!0}]]],pt.length&&["div","plugin-tools",{class:"PinturaNavSet"},pt.filter(Boolean).map(([ut,bt,_t])=>[ut,bt,{..._t}])]]],["div","gamma",{class:"PinturaNavGroup"},[gc&&["Button","export",{label:Gr.labelButtonExport,icon:yt&&Gr.iconButtonExport,class:"PinturaButtonExport",onclick:kx,hideLabel:yt}]]]],{...xn},()=>tl.set({})))),2048&t.$$.dirty[12]&&r(308,ee=Xr&&!!Xr.length),536870912&t.$$.dirty[9]|2080&t.$$.dirty[12]&&r(307,Xe=ee&&S2(fe,Xr)),805306368&t.$$.dirty[9]|24592&t.$$.dirty[12]&&ee&&((ut,bt,_t,Ne)=>{if(!bt||!ut||Dm===bt&&Bm===ut)return;Bm=ut,Dm=bt;const wr={dataSizeScalar:_t};Ne&&Ne[3]>0&&(wr.backgroundColor=[...Ne]),bt(ut,wr).then(Zr=>{As&&ti(As),Zr.setAttribute("data-retain",!0),r(301,As=Zr)})})(he,kn,Xe,li),4194304&t.$$.dirty[9]|6176&t.$$.dirty[12]&&Xr&&As&&fe){const{width:ut,height:bt}=fe,_t=Fa()?"pixelated":hn==="auto"?"auto":"pixelated";r(302,kh=Xr.map(Ne=>{const wr=Wn(Ne.x,Ne.y,Ne.width,Ne.height),Zr=Ti(Fr(wr),Ne.rotation).map(nn=>lt(nn.x/ut,nn.y/bt));return{...Ne,id:"redaction",flipX:!1,flipY:!1,cornerRadius:0,strokeWidth:0,strokeColor:void 0,backgroundColor:[0,0,0,0],backgroundImage:As,backgroundImageRendering:_t,backgroundCorners:Zr}}))}8388608&t.$$.dirty[9]|1024&t.$$.dirty[12]&&r(37,Be=[...kh,...sn||[]]),32&t.$$.dirty[1]&&Wc&&Om.set(Wc),4&t.$$.dirty[0]|128&t.$$.dirty[1]&&$t&&Qr&&Qr.dispatchEvent(Fs("ready")),262144&t.$$.dirty[1]&&r(63,sd=!0),480&t.$$.dirty[12]&&r(64,ld=!0),131072&t.$$.dirty[1]&&r(65,cd=!0),65536&t.$$.dirty[1]&&r(66,ud=!0),64&t.$$.dirty[1]&&r(67,dd=!0),8&t.$$.dirty[12]&&r(305,Ae=!!Gt&&Gt.height>0),117440512&t.$$.dirty[9]&&!n&&Ae&&(clearTimeout(Ih),r(303,Ih=setTimeout(()=>{n||N2("locale")},32)))},r(368,b=!k0()),y=qc()===1?m=>{m&&(_o(m.origin,Math.round),_o(m.translation,Math.round))}:tn,r(335,rr=[!B3()&&"WebGL"].filter(Boolean)),r(318,Ce=Vo()||sp()&&Aa()),r(68,yr=((m,U=!0)=>ht=>{ht.type==="ping"&&(U&&ht.stopPropagation(),m(ht.detail.type,ht.detail.data))})(va.pub)),[Pi,Ri,Qr,Gr,no,bu,Ml,uc,os,Rl,as,bc,ne,Ee,sr,re,vr,Pe,ke,cn,pr,mn,ki,ai,Bn,qn,Kn,ja,Mp,ch,Za,Yu,dh,Ju,Ku,ds,Wc,Be,$t,Ct,Se,ae,Ke,H,qt,f,Pt,er,Er,en,ye,pi,na,Br,Ln,Go,to,Zo,Wi,Or,Na,Bo,Dc,sd,ld,cd,ud,dd,yr,Yt,ot,lr,Ot,de,le,Kt,Wt,Et,et,wt,Oi,Vi,F,oe,Ie,xr,Nr,Wr,or,Sr,qr,Pr,Jr,Hn,Sn,Rn,_r,Mi,ia,qs,Cs,rs,Oa,yp,xc,Ua,vc,tl,Su,Cp,Rp,el,Ip,ku,Ep,U0,Ap,Tu,Lp,Cu,Fp,Ta,Fl,Mu,Pu,Ru,Iu,Eu,Au,Lu,rl,zp,Fu,tm,em,rm,nm,im,om,am,Dp,Bp,Op,zu,Wp,_p,Du,Vp,kc,Bu,Tc,Np,Hp,zl,Dl,jp,Cc,nl,Ou,Wu,Mc,Up,_u,Vu,Nu,il,Pc,Zp,aa,Hu,Xp,um,Bl,Ol,Ga,qp,us,Wl,Kp,Ic,ol,Uu,Jp,gm,Gu,Ec,wm,ih,oh,ah,sh,lh,Ac,Lc,uh,Zu,Xu,zc,ph,Es,sa,qu,Pm,fh,gh,$h,(m,U)=>U[m],m=>xt.find(U=>U.id===m).view,yh,bh,xh,Qu,({target:m,propertyName:U})=>{m===Qr&&/background|outline/.test(U)&&_&&Am()},Lm,Bc,ed,rd,nd,Oc,wh,id,m=>{const U=!(!ds||!ds.closeButton)||!Br;wh.set(m.detail.width,{hard:U}),id.set(Math.round(.5*-m.detail.width),{hard:U})},Ax,sl,m=>{const{keyCode:U,metaKey:ht,ctrlKey:Rt,shiftKey:ut}=m;if(U===9&&Yi)return void m.preventDefault();if(m.target&&U===32&&Qr.contains(m.target)&&!Ja(m.target)&&(Uo&&o&&Sp(),m.preventDefault()),U===90&&(ht||Rt))return void(ut&&ht?Za.redo():Za.undo());if(U===89&&Rt)return void Za.redo();if(U===229||m.target&&(U===8||U===46)&&!Qr.contains(m.target)&&Ja(m.target))return;const bt=new Set([...Ci,U]);sl.set(Array.from(bt))},({key:m,keyCode:U})=>{if(m==="Meta")return sl.set([]);sl.set(Ci.filter(ht=>ht!==U))},()=>{sl.set([])},m=>{Ja(m.target)||m.preventDefault()},m=>{Js&&Sh(m.detail.resources[0])},()=>{ss&&Mb({accept:Qs}).then(Lx)},m=>{if(!El)return;const U=an((window.innerWidth-Math.abs(Gt.x))/Gt.width,0,1),ht=an((window.innerHeight-Math.abs(Gt.y))/Gt.height,0,1);U<.75&&ht<.75||Sh((m.clipboardData||window.clipboardData).files[0])},Wm,jm,m=>{me&&pa(m.detail,me)||It(nl,me=m.detail,me)},dt,Fc,_a,vn,ro,ln,fo,wa,Yi,Ms,is,Cl,Pl,dc,pc,hc,mc,fc,gc,Il,Ks,$c,yc,Js,El,ss,Qs,qo,Al,x,W,R,K,Q,At,ce,jt,Jt,Le,ve,Me,Ye,We,fi,io,()=>r(60,Na=void 0),(m,U,ht)=>{const{text:Rt="",placeholder:ut="",autoClose:bt=!0,align:_t="top",justify:Ne="center",buttonConfirm:wr,buttonCancel:Zr}=ht;r(60,Na={align:_t,justify:Ne,text:Rt,placeholder:ut,buttonConfirm:wr,buttonCancel:Zr,onconfirm:()=>{m(Bo.value),bt&&r(60,Na=void 0)},oncancel:()=>{U(void 0),r(60,Na=void 0)}})},Sa,Ha,ka,ls,wp,Rs,Ll,Sp,kp,Tp,V0,cs,vu,wu,wc,Gp,Is,td,vh,od,As,kh,Ih,n,Ae,Z,Xe,ee,o,ft,Ve,yt,pt,j,ct,nr,rt,Ce,we,De,it,dr,Y,Dr,ur,ar,Qe,$r,zr,Je,Re,Bt,G,pe,rr,Oe,vt,st,St,at,zt,q,X,Ft,ie,te,gt,Zt,Xt,Ut,kt,Dt,_,xe,xt,N,nt,L,E,V,z,C,M,S,P,h,w,b,v,s,d,a,u,i,Gt,he,fe,Cr,Mr,ir,je,sn,Xr,hn,li,kn,xn,Vn,xa,Zn,ci,ui,hi,Xn,Tn,mi,Io,xo,Ao,vo,lo,Bi,co,Zi,ii,uo,Yr,Nn,Cn,wo,oi,So,Pn,Yn,wi,po,O,Ue,be,$e,bn,Si,ho,Ze,Yo,gn,Fn,mo,zo,Ba,function(){r(31,Yu=gl.innerWidth),r(32,dh=gl.innerHeight)},m=>It(Cc,Ie=m.detail,Ie),({detail:m})=>r(43,H=m),function(m,U){t.$$.not_equal(Ri[U],m)&&(Ri[U]=m,r(1,Ri),r(283,ka),r(27,ja))},m=>fh(m),m=>gh(m),(m,{detail:U})=>$h(m,U),m=>It(Dl,Oi=m.detail,Oi),function(m){t.$$.not_equal(Ri[H],m)&&(Ri[H]=m,r(1,Ri),r(283,ka),r(27,ja))},()=>fh(H),()=>gh(H),({detail:m})=>$h(H,m),m=>{const U={...m,...Wm()},{annotationShapes:ht,decorationShapes:Rt,interfaceShapes:ut,frameShapes:bt,selectionShapes:_t}=Rl({annotationShapes:en,decorationShapes:Er,interfaceShapes:Sn,frameShapes:er,selectionShapes:Or},U);return jm(U,Be,ht,Rt,ut,bt,_t)},()=>{r(63,sd=!1),r(64,ld=!1),r(65,cd=!1),r(66,ud=!1),r(67,dd=!1)},function(m){jr[m?"unshift":"push"](()=>{Wc=m,r(36,Wc)})},function(m){Pi=m,r(0,Pi),r(271,Jt)},function(m){Ju=m,r(33,Ju)},function(m){Ku=m,r(34,Ku)},function(m){jr[m?"unshift":"push"](()=>{Bo=m,r(61,Bo)})},function(m){jr[m?"unshift":"push"](()=>{Qr=m,r(2,Qr)})},m=>It(Hp,pi=m.detail,pi)]}class S$ extends gr{constructor(e){super(),fr(this,e,nw,rw,cr,{class:236,layout:237,stores:238,locale:3,id:4,util:239,utils:240,animations:241,disabled:242,previewUpscale:243,previewPad:244,previewMaskOpacity:5,previewImageDataMaxSize:245,previewImageTextPixelRatio:6,markupMaskOpacity:7,zoomMaskOpacity:246,elasticityMultiplier:8,willRevert:247,willProcessImage:248,willRenderCanvas:9,willRenderToolbar:249,willRenderUtilTabs:250,willSetHistoryInitialState:251,enableButtonExport:252,enableButtonRevert:253,enableNavigateHistory:254,enableToolbar:10,enableUtils:255,enableButtonClose:256,enableDropImage:257,enablePasteImage:258,enableBrowseImage:259,accept:260,enableTransparencyGrid:11,layoutDirectionPreference:261,layoutHorizontalUtilsPreference:262,layoutVerticalUtilsPreference:263,layoutVerticalToolbarPreference:264,layoutVerticalControlGroupsPreference:265,layoutVerticalControlTabsPreference:266,supportedMediaTypes:267,status:234,formatStatusImageLoading:268,formatStatusImageProcessing:269,formatStatusSupportError:270,textDirection:12,markupEditorZoomLevel:271,markupEditorZoomLevels:13,markupEditorZoomAdjustStep:14,markupEditorZoomAdjustFactor:15,markupEditorZoomAdjustWheelFactor:16,markupEditorInteractionMode:272,muteAudio:273,willSetMediaInitialTimeOffset:274,enablePan:17,enableZoom:18,enableZoomControls:275,enableZoomInput:19,enablePanInput:276,enableCanvasAlpha:20,enablePanLimit:21,panLimitGutterScalar:22,pan:277,zoomPresetOptions:23,zoomAdjustStep:24,zoomAdjustFactor:25,zoomAdjustWheelFactor:26,zoomLevel:0,fixScrollDirection:278,hideTextInput:279,showTextInput:280,imagePreviewSrc:281,imageOrienter:282,pluginComponents:283,pluginOptions:27,sub:284,pluginInterface:1,root:2,play:285,pause:286,isPaused:287,togglePlayPause:288,mute:289,unmute:290,toggleMute:291,getDuration:292,getCurrentTime:293,setCurrentTime:294,imageSourceToImageData:28,imagePreview:29,imagePreviewCurrent:235,history:30},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get class(){return this.$$.ctx[236]}set class(e){this.$$set({class:e}),A()}get layout(){return this.$$.ctx[237]}set layout(e){this.$$set({layout:e}),A()}get stores(){return this.$$.ctx[238]}set stores(e){this.$$set({stores:e}),A()}get locale(){return this.$$.ctx[3]}set locale(e){this.$$set({locale:e}),A()}get id(){return this.$$.ctx[4]}set id(e){this.$$set({id:e}),A()}get util(){return this.$$.ctx[239]}set util(e){this.$$set({util:e}),A()}get utils(){return this.$$.ctx[240]}set utils(e){this.$$set({utils:e}),A()}get animations(){return this.$$.ctx[241]}set animations(e){this.$$set({animations:e}),A()}get disabled(){return this.$$.ctx[242]}set disabled(e){this.$$set({disabled:e}),A()}get previewUpscale(){return this.$$.ctx[243]}set previewUpscale(e){this.$$set({previewUpscale:e}),A()}get previewPad(){return this.$$.ctx[244]}set previewPad(e){this.$$set({previewPad:e}),A()}get previewMaskOpacity(){return this.$$.ctx[5]}set previewMaskOpacity(e){this.$$set({previewMaskOpacity:e}),A()}get previewImageDataMaxSize(){return this.$$.ctx[245]}set previewImageDataMaxSize(e){this.$$set({previewImageDataMaxSize:e}),A()}get previewImageTextPixelRatio(){return this.$$.ctx[6]}set previewImageTextPixelRatio(e){this.$$set({previewImageTextPixelRatio:e}),A()}get markupMaskOpacity(){return this.$$.ctx[7]}set markupMaskOpacity(e){this.$$set({markupMaskOpacity:e}),A()}get zoomMaskOpacity(){return this.$$.ctx[246]}set zoomMaskOpacity(e){this.$$set({zoomMaskOpacity:e}),A()}get elasticityMultiplier(){return this.$$.ctx[8]}set elasticityMultiplier(e){this.$$set({elasticityMultiplier:e}),A()}get willRevert(){return this.$$.ctx[247]}set willRevert(e){this.$$set({willRevert:e}),A()}get willProcessImage(){return this.$$.ctx[248]}set willProcessImage(e){this.$$set({willProcessImage:e}),A()}get willRenderCanvas(){return this.$$.ctx[9]}set willRenderCanvas(e){this.$$set({willRenderCanvas:e}),A()}get willRenderToolbar(){return this.$$.ctx[249]}set willRenderToolbar(e){this.$$set({willRenderToolbar:e}),A()}get willRenderUtilTabs(){return this.$$.ctx[250]}set willRenderUtilTabs(e){this.$$set({willRenderUtilTabs:e}),A()}get willSetHistoryInitialState(){return this.$$.ctx[251]}set willSetHistoryInitialState(e){this.$$set({willSetHistoryInitialState:e}),A()}get enableButtonExport(){return this.$$.ctx[252]}set enableButtonExport(e){this.$$set({enableButtonExport:e}),A()}get enableButtonRevert(){return this.$$.ctx[253]}set enableButtonRevert(e){this.$$set({enableButtonRevert:e}),A()}get enableNavigateHistory(){return this.$$.ctx[254]}set enableNavigateHistory(e){this.$$set({enableNavigateHistory:e}),A()}get enableToolbar(){return this.$$.ctx[10]}set enableToolbar(e){this.$$set({enableToolbar:e}),A()}get enableUtils(){return this.$$.ctx[255]}set enableUtils(e){this.$$set({enableUtils:e}),A()}get enableButtonClose(){return this.$$.ctx[256]}set enableButtonClose(e){this.$$set({enableButtonClose:e}),A()}get enableDropImage(){return this.$$.ctx[257]}set enableDropImage(e){this.$$set({enableDropImage:e}),A()}get enablePasteImage(){return this.$$.ctx[258]}set enablePasteImage(e){this.$$set({enablePasteImage:e}),A()}get enableBrowseImage(){return this.$$.ctx[259]}set enableBrowseImage(e){this.$$set({enableBrowseImage:e}),A()}get accept(){return this.$$.ctx[260]}set accept(e){this.$$set({accept:e}),A()}get enableTransparencyGrid(){return this.$$.ctx[11]}set enableTransparencyGrid(e){this.$$set({enableTransparencyGrid:e}),A()}get layoutDirectionPreference(){return this.$$.ctx[261]}set layoutDirectionPreference(e){this.$$set({layoutDirectionPreference:e}),A()}get layoutHorizontalUtilsPreference(){return this.$$.ctx[262]}set layoutHorizontalUtilsPreference(e){this.$$set({layoutHorizontalUtilsPreference:e}),A()}get layoutVerticalUtilsPreference(){return this.$$.ctx[263]}set layoutVerticalUtilsPreference(e){this.$$set({layoutVerticalUtilsPreference:e}),A()}get layoutVerticalToolbarPreference(){return this.$$.ctx[264]}set layoutVerticalToolbarPreference(e){this.$$set({layoutVerticalToolbarPreference:e}),A()}get layoutVerticalControlGroupsPreference(){return this.$$.ctx[265]}set layoutVerticalControlGroupsPreference(e){this.$$set({layoutVerticalControlGroupsPreference:e}),A()}get layoutVerticalControlTabsPreference(){return this.$$.ctx[266]}set layoutVerticalControlTabsPreference(e){this.$$set({layoutVerticalControlTabsPreference:e}),A()}get supportedMediaTypes(){return this.$$.ctx[267]}set supportedMediaTypes(e){this.$$set({supportedMediaTypes:e}),A()}get status(){return this.$$.ctx[234]}set status(e){this.$$set({status:e}),A()}get formatStatusImageLoading(){return this.$$.ctx[268]}set formatStatusImageLoading(e){this.$$set({formatStatusImageLoading:e}),A()}get formatStatusImageProcessing(){return this.$$.ctx[269]}set formatStatusImageProcessing(e){this.$$set({formatStatusImageProcessing:e}),A()}get formatStatusSupportError(){return this.$$.ctx[270]}set formatStatusSupportError(e){this.$$set({formatStatusSupportError:e}),A()}get textDirection(){return this.$$.ctx[12]}set textDirection(e){this.$$set({textDirection:e}),A()}get markupEditorZoomLevel(){return this.$$.ctx[271]}set markupEditorZoomLevel(e){this.$$set({markupEditorZoomLevel:e}),A()}get markupEditorZoomLevels(){return this.$$.ctx[13]}set markupEditorZoomLevels(e){this.$$set({markupEditorZoomLevels:e}),A()}get markupEditorZoomAdjustStep(){return this.$$.ctx[14]}set markupEditorZoomAdjustStep(e){this.$$set({markupEditorZoomAdjustStep:e}),A()}get markupEditorZoomAdjustFactor(){return this.$$.ctx[15]}set markupEditorZoomAdjustFactor(e){this.$$set({markupEditorZoomAdjustFactor:e}),A()}get markupEditorZoomAdjustWheelFactor(){return this.$$.ctx[16]}set markupEditorZoomAdjustWheelFactor(e){this.$$set({markupEditorZoomAdjustWheelFactor:e}),A()}get markupEditorInteractionMode(){return this.$$.ctx[272]}set markupEditorInteractionMode(e){this.$$set({markupEditorInteractionMode:e}),A()}get muteAudio(){return this.$$.ctx[273]}set muteAudio(e){this.$$set({muteAudio:e}),A()}get willSetMediaInitialTimeOffset(){return this.$$.ctx[274]}set willSetMediaInitialTimeOffset(e){this.$$set({willSetMediaInitialTimeOffset:e}),A()}get enablePan(){return this.$$.ctx[17]}set enablePan(e){this.$$set({enablePan:e}),A()}get enableZoom(){return this.$$.ctx[18]}set enableZoom(e){this.$$set({enableZoom:e}),A()}get enableZoomControls(){return this.$$.ctx[275]}set enableZoomControls(e){this.$$set({enableZoomControls:e}),A()}get enableZoomInput(){return this.$$.ctx[19]}set enableZoomInput(e){this.$$set({enableZoomInput:e}),A()}get enablePanInput(){return this.$$.ctx[276]}set enablePanInput(e){this.$$set({enablePanInput:e}),A()}get enableCanvasAlpha(){return this.$$.ctx[20]}set enableCanvasAlpha(e){this.$$set({enableCanvasAlpha:e}),A()}get enablePanLimit(){return this.$$.ctx[21]}set enablePanLimit(e){this.$$set({enablePanLimit:e}),A()}get panLimitGutterScalar(){return this.$$.ctx[22]}set panLimitGutterScalar(e){this.$$set({panLimitGutterScalar:e}),A()}get pan(){return this.$$.ctx[277]}set pan(e){this.$$set({pan:e}),A()}get zoomPresetOptions(){return this.$$.ctx[23]}set zoomPresetOptions(e){this.$$set({zoomPresetOptions:e}),A()}get zoomAdjustStep(){return this.$$.ctx[24]}set zoomAdjustStep(e){this.$$set({zoomAdjustStep:e}),A()}get zoomAdjustFactor(){return this.$$.ctx[25]}set zoomAdjustFactor(e){this.$$set({zoomAdjustFactor:e}),A()}get zoomAdjustWheelFactor(){return this.$$.ctx[26]}set zoomAdjustWheelFactor(e){this.$$set({zoomAdjustWheelFactor:e}),A()}get zoomLevel(){return this.$$.ctx[0]}set zoomLevel(e){this.$$set({zoomLevel:e}),A()}get fixScrollDirection(){return this.$$.ctx[278]}set fixScrollDirection(e){this.$$set({fixScrollDirection:e}),A()}get hideTextInput(){return this.$$.ctx[279]}get showTextInput(){return this.$$.ctx[280]}get imagePreviewSrc(){return this.$$.ctx[281]}set imagePreviewSrc(e){this.$$set({imagePreviewSrc:e}),A()}get imageOrienter(){return this.$$.ctx[282]}set imageOrienter(e){this.$$set({imageOrienter:e}),A()}get pluginComponents(){return this.$$.ctx[283]}set pluginComponents(e){this.$$set({pluginComponents:e}),A()}get pluginOptions(){return this.$$.ctx[27]}set pluginOptions(e){this.$$set({pluginOptions:e}),A()}get sub(){return this.$$.ctx[284]}get pluginInterface(){return this.$$.ctx[1]}get root(){return this.$$.ctx[2]}set root(e){this.$$set({root:e}),A()}get play(){return this.$$.ctx[285]}get pause(){return this.$$.ctx[286]}get isPaused(){return this.$$.ctx[287]}get togglePlayPause(){return this.$$.ctx[288]}get mute(){return this.$$.ctx[289]}get unmute(){return this.$$.ctx[290]}get toggleMute(){return this.$$.ctx[291]}get getDuration(){return this.$$.ctx[292]}get getCurrentTime(){return this.$$.ctx[293]}get setCurrentTime(){return this.$$.ctx[294]}get imageSourceToImageData(){return this.$$.ctx[28]}set imageSourceToImageData(e){this.$$set({imageSourceToImageData:e}),A()}get imagePreview(){return this.$$.ctx[29]}get imagePreviewCurrent(){return this.$$.ctx[235]}set imagePreviewCurrent(e){this.$$set({imagePreviewCurrent:e}),A()}get history(){return this.$$.ctx[30]}}typeof window<"u"&&(t=>{if(t&&t._zb8to4f)return;const[e,r,n]=[[99,111,110,115,111,108,101],[108,111,103],[84,104,105,115,32,118,101,114,115,105,111,110,32,111,102,32,80,105,110,116,117,114,97,32,105,115,32,102,111,114,32,116,101,115,116,105,110,103,32,112,117,114,112,111,115,101,115,32,111,110,108,121,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,32,116,111,32,112,117,114,99,104,97,115,101,32,97,32,108,105,99,101,110,115,101,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,47,99,104,97,116,32,105,102,32,121,111,117,32,104,97,118,101,32,97,110,121,32,113,117,101,115,116,105,111,110,115,46]].map(i=>i.map(o=>String.fromCharCode(o)).join(""));t&&t[e]&&t[e][r](n)})(window);const iw=["klass","stores","isVisible","isActive","isActiveFraction","locale"],ow=["history","klass","stores","navButtons","pluginComponents","pluginInterface","pluginOptions","sub","imagePreviewSrc","imagePreview","imagePreviewCurrent"],aw=["locale"];let h1;const Pb=new Set([]),Hd={},N1=new Map,Rb=(...t)=>{t.filter(e=>!!e.util).forEach(e=>{const[r,n,i=()=>!0]=e.util;N1.has(r)||(N1.set(r,{Component:n,isSupported:i}),T0(n).filter(o=>!iw.includes(o)).forEach(o=>{Pb.add(o),Hd[o]?Hd[o].push(r):Hd[o]=[r]}))})};var Ib=[...H2,"init","update","undo","redo","revert","writehistory","destroy","show","hide","close","ready","zoom","pan","loadpreview","selectshape","blurshape","updateshape","addshape","removeshape","selectstyle","markuptap","markupzoom","markuppan","selectutil","selectcontrol","selectiondown","selectionup","selectionchange"],sw=(t,e,r={})=>{const{prefix:n="pintura:"}=r;return Ib.map(i=>t.on(i,o=>nc(e)?((a,s,l)=>a.dispatchEvent(new CustomEvent(s,{detail:l,bubbles:!0,cancelable:!0})))(e,`${n}${i}`,o):e(i,o)))};const lw=t=>Ge(t[0]),cw=t=>!lw(t),Eb=t=>t[1],H1=t=>t[3]||[],uw=(t,e)=>{const r=j1(t,e);return bb(r,n=>Eb(n)===t),r},j1=(t,e)=>{if(cw(e)){if(e.find(n=>Eb(n)===t))return e;const r=e.find(n=>j1(t,H1(n)));return r&&r[3]}return j1(t,H1(e))},dw=()=>[.75,.25,.25,0,0,.25,.75,.25,0,0,.25,.25,.75,0,0,0,0,0,1,0],pw=()=>[1.398,-.316,.065,-.273,.201,-.051,1.278,-.08,-.273,.201,-.051,.119,1.151,-.29,.215,0,0,0,1,0],hw=()=>[1.073,-.015,.092,-.115,-.017,.107,.859,.184,-.115,-.017,.015,.077,1.104,-.115,-.017,0,0,0,1,0],mw=()=>[1.06,0,0,0,0,0,1.01,0,0,0,0,0,.93,0,0,0,0,0,1,0],fw=()=>[1.1,0,0,0,-.1,0,1.1,0,0,-.1,0,0,1.2,0,-.1,0,0,0,1,0],gw=()=>[.212,.715,.114,0,0,.212,.715,.114,0,0,.212,.715,.114,0,0,0,0,0,1,0],$w=()=>[.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,0,0,0,1,0],yw=()=>[.163,.518,.084,-.01,.208,.163,.529,.082,-.02,.21,.171,.529,.084,0,.214,0,0,0,1,0],bw=()=>[.338,.991,.117,.093,-.196,.302,1.049,.096,.078,-.196,.286,1.016,.146,.101,-.196,0,0,0,1,0],xw=()=>[.393,.768,.188,0,0,.349,.685,.167,0,0,.272,.533,.13,0,0,0,0,0,1,0],vw=()=>[.289,.62,.185,0,.077,.257,.566,.163,0,.115,.2,.43,.128,0,.188,0,0,0,1,0],ww=()=>[.269,.764,.172,.05,.1,.239,.527,.152,0,.176,.186,.4,.119,0,.159,0,0,0,1,0],Sw=()=>[.547,.764,.134,0,-.147,.281,.925,.12,0,-.135,.225,.558,.33,0,-.113,0,0,0,1,0],Ab={chrome:pw,fade:hw,pastel:dw,cold:fw,warm:mw,monoDefault:gw,monoWash:yw,monoNoir:$w,monoStark:bw,sepiaDefault:xw,sepiaRust:ww,sepiaBlues:vw,sepiaColor:Sw};var kw={filterFunctions:Ab,filterOptions:[["Default",[[void 0,t=>t.labelDefault]]],["Classic",[["chrome",t=>t.filterLabelChrome],["fade",t=>t.filterLabelFade],["cold",t=>t.filterLabelCold],["warm",t=>t.filterLabelWarm],["pastel",t=>t.filterLabelPastel]]],["Monochrome",[["monoDefault",t=>t.filterLabelMonoDefault],["monoNoir",t=>t.filterLabelMonoNoir],["monoStark",t=>t.filterLabelMonoStark],["monoWash",t=>t.filterLabelMonoWash]]],["Sepia",[["sepiaDefault",t=>t.filterLabelSepiaDefault],["sepiaRust",t=>t.filterLabelSepiaRust],["sepiaBlues",t=>t.filterLabelSepiaBlues],["sepiaColor",t=>t.filterLabelSepiaColor]]]]};const Tw={borderColor:"strokeColor",borderWidth:"strokeWidth",lineWidth:"strokeWidth",fontColor:"color",lineColor:"strokeColor",src:"backgroundImage",fit:"backgroundSize"},Pd=t=>t===0||t==="0%"||t==="0px"?0:/px$/.test(t)?parseInt(t,10):/\%$/.test(t)?t:t<=1?100*t+"%":void 0,Rd=(t,e)=>{let r,n;return/%$/.test(t)?(r=parseFloat(t),n=parseFloat(e),r+n+"%"):/px$/.test(t)?(r=parseInt(t,10),n=parseInt(e,10),r+n+"px"):void 0},k$=(t,e)=>{const r=t,n=e,i=1.5707963267948966-e,o=Math.sin(1.5707963267948966),a=Math.sin(n),s=Math.sin(i),l=Math.cos(i),c=r/o;return lt(l*(c*a),l*(c*s))},Cw=(t,{flip:e,aspectRatio:r,rotation:n,center:i,zoom:o,scaleToFit:a})=>{const s={flipX:!1,flipY:!1},l=!i||i&&i.x===.5&&i.y===.5;e&&e.horizontal&&(s.flipX=e.horizontal),e&&e.vertical&&(s.flipY=e.vertical);const c=((f,g)=>g!=null?1/g:f.width/f.height)(t,r),u=a!==!1,d=((f,g,$=1)=>{const b=f.height/f.width,v=g;let w=1,S=b;S>v&&(S=v,w=S/b);const P=Math.max(1/w,v/S),M=f.width/($*P*w);return{width:M,height:M*g}})(t,r,o),p=l?t:((f,g)=>{const $=g.x>.5?1-g.x:g.x,b=g.y>.5?1-g.y:g.y;return An(2*$*f.width,2*b*f.height)})(t,u?i:{x:.5,y:.5}),h=((f,g)=>{let $=f.width,b=$*g;b>f.height&&(b=f.height,$=b/g);const v=.5*(f.width-$),w=.5*(f.height-b);return Wn(v,w,$,b)})(t,r);if((r||!l||o)&&(s.crop=Ki(Ui(p),c)),typeof n=="number"&&n!==null&&n!==0){n!=null&&(s.rotation=n);const f=((C,z)=>{const V=C.width,L=C.height,y=k$(V,z),ct=k$(L,z),j=lt(C.x+Math.abs(y.x),C.y-Math.abs(y.y)),k=lt(C.x+C.width+Math.abs(ct.y),C.y+Math.abs(ct.x)),N=lt(C.x-Math.abs(ct.y),C.y+C.height-Math.abs(ct.x));return{width:Ni(j,k),height:Ni(j,N)}})(h,n),g=Math.max(f.width/p.width,f.height/p.height),$=lt(i.x*t.width,i.y*t.height),b=qy(t,n),v=xl(b),w=lt(.5*(b.width-t.width),.5*(b.height-t.height)),S=Ti({x:w.x+$.x-d.width/g*.5,y:w.y+$.y-d.height/g*.5,width:d.width/g,height:d.height/g},n),P=$s(S.map(He),n,v.x,v.y),M=Lr(ri(P)),E=$s(P.map(He),-2*n,M.x,M.y);s.crop=ri(E)}else o!=null&&Ei(s.crop,1/o);return u||(s.cropLimitToImage=!1),s};var rT=(t,e,r={})=>{const n={};if(!((o={})=>{if("markup"in o||"color"in o||"filter"in o)return!0;const{crop:a}=o;return!(!a||!("flip"in a||"center"in a||"aspectRatio"in a||"rotation"in a))})(r))return r;if(r.crop&&Object.assign(n,Cw(e,r.crop)),r.markup){const o=Array.isArray(r.markup)?r.markup:Object.values(r.markup);n.decoration=o.map(a=>((s,l,c)=>{const u=Object.keys(c).reduce((d,p)=>{let h=c[p];return p=Tw[p]||p,/px$/.test(h)?h=Pd(h):/^(?:x|y|left|right|top|bottom|width|height|fontSize|borderWidth|strokeWidth)$/.test(p)&&typeof h=="number"&&(p!=="strokeWidth"&&p!=="borderWidth"&&p!=="fontSize"||(h=Math.min(s.width,s.height)*h+"px"),h=Pd(h)),/color/i.test(p)&&h&&(h=np(h)),h===null&&(h=void 0),d[p]=h,d},{});if(l==="line"&&(u.lineDecoration.length>=1&&(u.lineEnd="arrow"),u.lineDecoration.length===2&&(u.lineStart="arrow"),u.x1=u.x,u.y1=u.y,u.x2=Rd(u.x,u.width),u.y2=Rd(u.y,u.height),delete u.x,delete u.y,delete u.width,delete u.height,delete u.lineDecoration,delete u.lineStyle),l==="text"){if(!_e(u.y)){const d=Math.min(s.width,s.height);u.y=d*(parseFloat(u.y)/100)}u.y=u.y-u.fontSize,delete u.width,delete u.height,delete u.borderStyle,u.lineHeight=u.lineHeight||"120%"}if(l==="ellipse"){let d,p;if(/%$/.test(u.width)){d=parseFloat(u.width)/100,p=parseFloat(u.height)/100;const h=d*s.width,f=p*s.height;d=h/s.width*100,p=f/s.height*100}else d=u.width,p=u.height;u.rx=.5*d,u.ry=.5*p,/%$/.test(u.width)&&(u.rx+="%",u.ry+="%"),u.x=Rd(u.x,u.rx),u.y=Rd(u.y,u.ry),delete u.width,delete u.height,delete u.borderStyle}if(l==="rect"&&delete u.borderStyle,l==="path"){let d,p=[];for(const h of u.points)d?Po(d,h)<1e-9||(p.push(h),d=h,d=h):(p.push(h),d=h);u.points=p.map(h=>({x:Pd(h.x),y:Pd(h.y)}))}return u})(n.crop||e,a[0],a[1]))}if(r.color||r.colors){const o=r.color||r.colors;Object.keys(o).filter(a=>o[a]).map(a=>[a,Array.isArray(o[a].matrix)?o[a].matrix:Object.values(o[a].matrix)]).forEach(([a,s])=>{n.colorMatrix||(n.colorMatrix={}),n.colorMatrix[a]=s})}if(r.filter||r.filters){const o=r.filters||r.filter;n.colorMatrix||(n.colorMatrix={});const a=t?t.filterFunctions:Ab;n.colorMatrix.filter=typeof o=="string"&&a[o]?a[o]():o.matrix}const i=r.size?r.size:!!r.resize&&r.resize.size;return i&&i.width&&i.height&&(n.targetSize={width:i.width,height:i.height}),n};const Mw={base:0,min:-.25,max:.25,getLabel:t=>Vs(t/.25),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.brightness)return t.brightness[4]},setValue:(t,e)=>t.update(r=>({...r,brightness:[1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0]}))},Pw={base:1,min:.5,max:1.5,getLabel:t=>Vs(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.contrast)return t.contrast[0]},setValue:(t,e)=>t.update(r=>({...r,contrast:[e,0,0,0,.5*(1-e),0,e,0,0,.5*(1-e),0,0,e,0,.5*(1-e),0,0,0,1,0]}))},Rw={base:1,min:0,max:2,getLabel:t=>Vs(t-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.saturation)return(t.saturation[0]-.213)/.787},setValue:(t,e)=>t.update(r=>({...r,saturation:[.213+.787*e,.715-.715*e,.072-.072*e,0,0,.213-.213*e,.715+.285*e,.072-.072*e,0,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,0,1,0]}))},Iw={base:1,min:.5,max:1.5,getLabel:t=>Vs(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.exposure)return t.exposure[0]},setValue:(t,e)=>t.update(r=>({...r,exposure:[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0]}))},Ew={base:1,min:.15,max:4,getLabel:t=>Vs(t<1?(t-.15)/.85-1:(t-1)/3),getStore:({imageGamma:t})=>t},Aw={base:0,min:-1,max:1,getStore:({imageVignette:t})=>t},Lw={base:0,min:-1,max:1,getStore:({imageConvolutionMatrix:t})=>t,getValue:t=>{if(t.clarity)return t.clarity[0]===0?t.clarity[1]/-1:t.clarity[1]/-2},setValue:(t,e)=>{t.update(r=>({...r,clarity:e>=0?[0,-1*e,0,-1*e,1+4*e,-1*e,0,-1*e,0]:[-1*e,-2*e,-1*e,-2*e,1+-3*e,-2*e,-1*e,-2*e,-1*e]}))}},Fw={base:0,min:-1,max:1,getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(!t.temperature)return;const e=t.temperature[0];return e>=1?(e-1)/.1:(1-e)/-.15},setValue:(t,e)=>t.update(r=>({...r,temperature:e>0?[1+.1*e,0,0,0,0,0,1,0,0,0,0,0,1+.1*-e,0,0,0,0,0,1,0]:[1+.15*e,0,0,0,0,0,1+.05*e,0,0,0,0,0,1+.15*-e,0,0,0,0,0,1,0]}))};var zw={finetuneControlConfiguration:{gamma:Ew,brightness:Mw,contrast:Pw,saturation:Rw,exposure:Iw,temperature:Fw,clarity:Lw,vignette:Aw},finetuneOptions:[["brightness",t=>t.finetuneLabelBrightness],["contrast",t=>t.finetuneLabelContrast],["saturation",t=>t.finetuneLabelSaturation],["exposure",t=>t.finetuneLabelExposure],["temperature",t=>t.finetuneLabelTemperature],["gamma",t=>t.finetuneLabelGamma],!k0()&&["clarity",t=>t.finetuneLabelClarity],["vignette",t=>t.finetuneLabelVignette]].filter(Boolean)};const bo=(t,e="thumb")=>["div",e,{style:t,textContent:" "}],Dw={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%"},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%"/>'},Bw={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%",frameRound:!0},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%" rx="12%"/>'},Ow={shape:{frameColor:[1,1,1],frameStyle:"line",frameInset:"2.5%",frameSize:".3125%",frameRadius:0},thumb:[bo("top:.5em;left:.5em;right:.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor")]},Ww={shape:{frameColor:[1,1,1],frameStyle:"line",frameAmount:2,frameInset:"2.5%",frameSize:".3125%",frameOffset:"1.25%",frameRadius:0},thumb:[bo("top:.75em;left:.75em;right:.75em;bottom:.75em; outline: 3px double")]},_w={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameOffset:"5%",frameSize:".3125%"},thumb:[bo("top:.75em;left:.5em;bottom:.75em;border-left:1px solid","a"),bo("top:.75em;right:.5em;bottom:.75em;border-right:1px solid","b"),bo("top:.5em;left:.75em;right:.75em;border-top:1px solid","c"),bo("bottom:.5em;left:.75em;right:.75em;border-bottom:1px solid","d")]},Vw={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameSize:".3125%"},thumb:[bo("top:-.5em;left:.5em;right:.5em;bottom:-.5em; box-shadow: inset 0 0 0 1px currentColor","a"),bo("top:.5em;left:-.5em;right:-.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor","b")]},Nw={shape:{frameColor:[1,1,1],frameStyle:"edge",frameOffset:"1.5%",frameSize:".3125%"},thumb:[bo("top:.3125em;left:.5em;bottom:.3125em;border-left:1px solid","a"),bo("top:.3125em;right:.5em;bottom:.3125em;border-right:1px solid","b"),bo("top:.5em;left:.3125em;right:.3125em;border-top:1px solid","c"),bo("bottom:.5em;left:.3125em;right:.3125em;border-bottom:1px solid","d")]},Hw={shape:{frameColor:[1,1,1],frameStyle:"hook",frameInset:"2.5%",frameSize:".3125%",frameLength:"5%"},thumb:[bo("top:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-top: 1px solid","a"),bo("top:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-top: 1px solid","b"),bo("bottom:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-bottom: 1px solid","c"),bo("bottom:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-bottom: 1px solid","d")]},jw={shape:{frameColor:[1,1,1],frameStyle:"polaroid"},thumb:'<rect stroke-width="20%" x="-5%" y="-5%" width="110%" height="96%"/>'};var Uw={frameStyles:{solidSharp:Dw,solidRound:Bw,lineSingle:Ow,lineMultiple:Ww,edgeSeparate:_w,edgeCross:Vw,edgeOverlap:Nw,hook:Hw,polaroid:jw},frameOptions:[[void 0,t=>t.labelNone],["solidSharp",t=>t.frameLabelMatSharp],["solidRound",t=>t.frameLabelMatRound],["lineSingle",t=>t.frameLabelLineSingle],["lineMultiple",t=>t.frameLabelLineMultiple],["edgeCross",t=>t.frameLabelEdgeCross],["edgeSeparate",t=>t.frameLabelEdgeSeparate],["edgeOverlap",t=>t.frameLabelEdgeOverlap],["hook",t=>t.frameLabelCornerHooks],["polaroid",t=>t.frameLabelPolaroid]]},ac=t=>t.charAt(0).toUpperCase()+t.slice(1);let Gc=null;var m1=()=>{if(Gc===null)if(ni())try{Gc=document.fonts.check("16px TestNonExistingFont")===!1}catch{Gc=!1}else Gc=!1;return Gc};const hu=(t,e)=>r=>r[e?`${e}${ac(t)}`:t],Gw=t=>[t,""+t],fp=(t,e)=>r=>[t[r],hu(r,e)],Lb=t=>Array.isArray(t)&&t.every(_e)?t.map(Gw):t,hl=[1,.2549,.2118],T$=[1,1,1,0],Zw=t=>{const{hideLabel:e=!0}=t||{};return sS(["new","add","subtract"].map(r=>[r,hu(r,"shapeLabelSelectionMode"),{icon:hu(r,"shapeIconSelectionMode"),hideLabel:e}]),{title:r=>r.shapeTitleSelectionMode,layout:"radio"})},Xw=t=>Db(t,{title:e=>e.shapeTitleBrushSize,layout:"radio",optionHideLabel:!0,optionIcon:(e,r)=>`<circle fill="currentColor" stroke-width=".05em" stroke="currentColor" fill-opacity=".25" cx="12" cy="12" r="${2+8*r}"/>`}),C$={eraser:()=>({eraseRadius:8,cursorStyle:"ellipse",cursorSize:"eraseRadius"}),path:()=>({points:[],disableAddPoints:!1}),line:()=>({x1:0,y1:0,x2:0,y2:0,disableErase:!1}),rectangle:()=>({x:0,y:0,width:0,height:0}),ellipse:()=>({x:0,y:0,rx:0,ry:0}),text:()=>({x:0,y:0,text:"Text",disableTextScale:!0})},hs=(t,e={},r)=>{if(!C$[t])return;const{position:n="relative",inputMode:i="drag",isSelection:o=!1,interpolateInput:a=!1}=r||{};return[{...C$[t](),...e},{position:n,inputMode:i,isSelection:o,interpolateInput:a}]},Fb=t=>{const e={sharpie:hs("path",{bitmap:!0,strokeJoin:"round",strokeCap:"round",strokeWidth:"0.5%",strokeColor:[...hl],cursorStyle:"ellipse",cursorSize:"strokeWidth",disableErase:!1,disableResize:!0,disableMove:!0},{interpolateInput:!0}),eraser:hs("eraser"),path:hs("path",{pathClose:void 0,strokeWidth:"0.5%",strokeColor:[...hl],backgroundColor:[0,0,0,0]},{inputMode:"step"}),line:hs("line",{strokeColor:[...hl],strokeWidth:"0.5%"}),arrow:hs("line",{lineStart:"none",lineEnd:"arrow-solid",strokeColor:[...hl],strokeWidth:"0.5%"}),rectangle:hs("rectangle",{strokeColor:[...T$],backgroundColor:[...hl]}),ellipse:hs("ellipse",{strokeColor:[...T$],backgroundColor:[...hl]}),text:hs("text",{color:[...hl],fontSize:"2%"})};return t&&Object.entries(t).forEach(([r,n])=>{Array.isArray(n)?e[r]=n:bs(n)&&e[r]&&(e[r]=[{...e[r][0],...n},e[r][1]])}),e},f1=(t,e,r)=>[t,e||hu(t,"shapeLabelTool"),{icon:hu(t,"shapeIconTool"),...r}],Yw=(t=["move","view","sharpie","eraser","path","line","arrow","rectangle","ellipse","text","preset"])=>t.map(e=>Ge(e)?f1(e):Array.isArray(e)?bs(e[1])?f1(e[0],void 0,e[1]):f1(e[0],e[1],e[2]):void 0).filter(Boolean),qw=t=>Object.keys(t).map(fp(t,"shapeTitleColor")),Kw=t=>Object.keys(t).map(fp(t,"labelSize")),Jw=t=>Object.keys(t).map(fp(t,"labelSize")),M$=t=>Object.keys(t).map(fp(t,"labelSize")),Qw=t=>[...t],tS=t=>t.map(e=>[e,r=>r["shapeLabelFontStyle"+e.filter(n=>n!=="normal").map(ac).join("")]]),eS=t=>t.map(e=>[Cb(e),r=>r["shapeTitleLineDecoration"+ac(e)],{icon:r=>r["shapeIconLineDecoration"+ac(e)]}]),Qa=(t,e)=>{const{defaultKey:r,defaultValue:n,defaultOptions:i}=e||{},o=[];return r&&(o[0]=[n,a=>a[r],{...i}]),[...o,...t]},P$=t=>t.split(",").map(e=>e.trim()).some(e=>document.fonts.check("16px "+e)),R$=(t={})=>["ToggleSlider",{...t}],rS=(t,e={defaultKey:"labelDefault"})=>["Dropdown",{title:r=>r.shapeTitleFontFamily,onload:({options:r=[]})=>{m1()&&r.map(([n])=>n).filter(Boolean).filter(n=>!P$(n)).forEach(n=>{const i="PinturaFontTest-"+n.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase();document.getElementById(i)||document.body.append(yn("span",{textContent:" ",id:i,class:"PinturaFontTest",style:`font-family:${n};font-size:0;color:transparent;`}))})},ondestroy:()=>{m1()&&document.querySelectorAll(".PinturaFontTest").forEach(r=>r.remove())},optionLabelStyle:r=>"font-family: "+r,options:Qa(t,e),optionFilter:r=>{if(!m1())return!0;const[n]=r;return n?P$(n):!0}}],E0=(t,e={})=>["ColorPicker",{options:Qa(t),...e}],nS=(t,e={})=>E0(t,{title:r=>r.labelColor,...e}),zb=t=>(e,r={})=>E0(e,{title:n=>n[t],...r}),iS=zb("shapeTitleBackgroundColor"),oS=zb("shapeTitleTextColor"),aS=(t,e={})=>E0(t,{title:r=>r.shapeTitleStrokeColor,options:Qa(t),buttonClass:"PinturaColorPickerButtonStroke",onchange:(r,n)=>{const i=n.strokeWidth;(_e(i)||Ge(i)?parseFloat(i):0)>0||(n.strokeWidth=e&&e.defaultStrokeWidth||"0.5%")},...e}),Db=(t,e)=>{const{title:r,optionHideLabel:n=!1,layout:i,optionIcon:o=!1}=e||{},a=Lb(t),s=t.map(([d])=>Ge(d)?parseFloat(d):d),l=Math.max(...s),c=Math.min(...s),u=l-c;return[i==="radio"?"RadioGroup":"Dropdown",{title:r===!1?void 0:r||(d=>d.shapeTitleStrokeWidth),options:d=>{const p=e?a.map(h=>{const[f,g,$={}]=h,b=Ge(f)?parseFloat(f):f,v=(b-c)/u;let w;return o==="line"?w=`<path stroke="currentColor" stroke-linecap="square" stroke-width="${.1+.875*v}em" d="M3,12 H20"/>`:o==="dot"?w=`<circle fill="currentColor" cx="12" cy="12" r="${2+8*v}"/>`:Ge(o)?w=o:Vr(o)&&(w=o(b,v)),[f,g,{icon:w,hideLabel:n,...$}]}):a;return Te(d,"backgroundColor")?Qa(p,{defaultKey:"shapeLabelStrokeNone"}):Qa(p)},onchange:(d,p)=>{if(!d)return;const h=p.strokeColor||[];if(h[3])return;const f=[...h];f[3]=1,p.strokeColor=f}}]},sS=(t,e)=>{const{title:r,layout:n}=e||{};return[n==="radio"?"RadioGroup":"Dropdown",{title:r,options:Qa(t)}]},Bb=(t,e,r)=>["Dropdown",{title:n=>n[e],options:Qa(t,{defaultKey:"labelNone",defaultOptions:{icon:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H14"/></g>'}}),optionIconStyle:r}],lS=t=>Bb(t,"shapeTitleLineStart","transform: scaleX(-1)"),cS=t=>Bb(t,"shapeTitleLineEnd"),uS=t=>["Dropdown",{title:e=>e.shapeTitleFontStyle,optionLabelStyle:e=>e&&`font-style:${e[0]};font-weight:${e[1]}`,options:Qa(t,{defaultKey:"shapeLabelFontStyleNormal"})}],Ob=t=>["ShorthandControl",t];function dS(t){return function(e){let r=1,n=0;for(;Math.round(e*r)/r!==e&&(r*=10,n++,!(n>10)););return n}(Ge(t)?parseFloat(t):t)<4}const Wb=(t,e,r,n)=>{n||t.find(([a])=>a===r)||(n={defaultKey:"labelAuto",defaultValue:r});const i=Lb(t),o=i.some(([a])=>Ge(a)&&a.endsWith("%"));return["Dropdown",{title:e,options:Qa(i,n),formatValue:a=>dS(a)?o?parseFloat(a)+"%":a:_e(a)&&!o?Math.floor(a):Math.floor(parseFloat(a))+"%",...n}]},pS=(t,e)=>Wb(t,r=>r.shapeTitleFontSize,"4%",e),hS=(t,e)=>Wb(t,r=>r.shapeTitleLineHeight,"120%",e),mS=t=>["RadioGroup",{title:e=>e.shapeTitleTextAlign,options:Qa(t)}],g1={colorOptions:()=>qw({transparent:[1,1,1,0],white:[1,1,1],silver:[.8667,.8667,.8667],gray:[.6667,.6667,.6667],black:[0,0,0],navy:[0,.1216,.2471],blue:[0,.4549,.851],aqua:[.498,.8588,1],teal:[.2235,.8,.8],olive:[.2392,.6,.4392],green:[.1804,.8,.251],yellow:[1,.8627,0],orange:[1,.5216,.1059],red:[1,.2549,.2118],maroon:[.5216,.0784,.2941],fuchsia:[.9412,.0706,.7451],purple:[.6941,.051,.7882]}),lineEndStyleOptions:()=>eS(["bar","arrow","arrowSolid","circle","circleSolid","square","squareSolid"]),fontFamilyOptions:()=>Qw([["Helvetica, Arial, Verdana, 'Droid Sans', sans-serif","Sans Serif"],["'Arial Black', 'Avenir-Black', 'Arial Bold'","Black"],["'Arial Narrow', 'Futura-CondensedMedium'","Narrow"],["'Trebuchet MS'","Humanist"],["Georgia, 'Avenir-Black', 'Times New Roman', 'Droid Serif', serif","Serif"],["Palatino","Old-Style"],["'Times New Roman', 'TimesNewRomanPSMT'","Transitional"],["Menlo, Monaco, 'Lucida Console', monospace","Monospaced"],["'Courier New', monospace","Slab Serif"]]),fontStyleOptions:()=>tS([["normal","bold"],["italic","normal"],["italic","bold"]]),textAlignOptions:()=>["left","center","right"].map(t=>[t,e=>e["shapeTitleTextAlign"+ac(t)],{hideLabel:!0,icon:e=>e["shapeIconTextAlign"+ac(t)]}]),strokeWidthOptions:()=>M$({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}),brushSizeOptions:()=>M$(Object.entries({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}).reduce((t,[e,r])=>(t[e]=2*parseFloat(r)+"%",t),{})),fontSizeOptions:()=>Kw({extraSmall:"2%",small:"4%",mediumSmall:"8%",medium:"10%",mediumLarge:"15%",large:"20%",extraLarge:"25%"}),lineHeightOptions:()=>Jw({extraSmall:"40%",small:"60%",mediumSmall:"100%",medium:"120%",mediumLarge:"140%",large:"180%",extraLarge:"220%"})},fS=new Intl.NumberFormat("default",{minimumFractionDigits:1,maximumFractionDigits:1}),_b=(t,e)=>Ge(e)?t+"%":t,Vb=(t,e,r,n)=>Ge(n)?Math.round(t/r*100)+"%":""+fS.format(t),$1={getValue:t=>parseFloat(t),setValue:_b,label:Vb,step:.05,labelClass:"PinturaPercentageLabel"},gS={factory:Ob,options:{title:"Text shadow",controls:[["ToggleSlider","x",{...$1,min:-100,max:100,labelPrefix:"X"}],["ToggleSlider","y",{...$1,min:-100,max:100,labelPrefix:"Y"}],["ToggleSlider","blur",{...$1,min:0,max:25,labelPrefix:t=>t.shapeTitleTextShadowBlur}],["ColorPicker","color",{enablePresets:!1}]]}},Id={defaultColor:{factory:nS,items:"colorOptions"},defaultNumber:{factory:R$},defaultPercentage:{factory:R$,options:{getValue:t=>parseFloat(t),setValue:t=>t+"%",step:.05,label:(t,e,r)=>Math.round(t/r*100)+"%",labelClass:"PinturaPercentageLabel"}},backgroundColor:{items:"colorOptions",factory:iS},strokeColor:{items:"colorOptions",factory:aS},strokeWidth:{items:"strokeWidthOptions",factory:Db},brushSize:{items:"brushSizeOptions",factory:Xw},drawMode:{factory:Zw},lineStart:{items:"lineEndStyleOptions",factory:lS},lineEnd:{items:"lineEndStyleOptions",factory:cS},color:{items:"colorOptions",factory:oS},fontFamily:{items:"fontFamilyOptions",factory:rS},fontStyle_fontWeight:{items:"fontStyleOptions",factory:uS},fontSize:{items:"fontSizeOptions",factory:pS},lineHeight:{items:"lineHeightOptions",factory:hS},textAlign:{items:"textAlignOptions",factory:mS},textShadowX_textShadowY_textShadowBlur_textShadowColor:gS,textOutlineWidth_textOutlineColor:{factory:Ob,options:{title:"Text outline",controls:[["ToggleSlider","width",{getValue:t=>parseFloat(t),setValue:_b,label:Vb,min:0,max:15,step:.05,labelClass:"PinturaPercentageLabel",labelPrefix:t=>t.shapeTitleTextOutlineWidth}],["ColorPicker","color",{enablePresets:!1}]]}},cornerRadius:{factory:"defaultPercentage",options:{min:0,max:50,title:t=>t.shapeTitleCornerRadius}},frameColor:{factory:"defaultColor"},frameSize:{factory:"defaultPercentage",options:{min:.2,max:10,title:t=>t.labelSize}},frameInset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameOffset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameRadius:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelRadius}},frameAmount:{factory:"defaultNumber",options:{min:1,max:5,step:1,title:t=>t.labelAmount}}},Nb=(t={})=>{const e={...Id,...t},r={};return Object.entries(e).forEach(([n,i])=>{if(!/Options$/.test(n))if(Id[n]&&bs(i)&&!En(i)){const{component:o,factory:a,items:s,options:l={}}=e[n];if(Ge(a))r[n]=[a,l];else{const c=Id[n].items;let u=Ge(c)?e[c]||g1[c]():void 0;Ge(s)&&g1[s]?u=e[s]?e[s].every(p=>!Array.isArray(p))?e[s].map(p=>[p,p]):e[s]:g1[s]():(s||l.items)&&(u=s||l.items);let d=a||Id[n].factory;Vr(d)?r[n]=u?d(u,l):d(l):o&&(r[n]=[o,{...l,items:s}])}}else r[n]=i}),r};function $S(t){let e,r,n,i,o;const a=t[7].default,s=yi(a,t,t[6],null);return{c(){e=mt("div"),r=mt("div"),s&&s.c(),T(r,"class","PinturaToolbarInner"),T(e,"class","PinturaToolbar"),T(e,"data-layout",t[1]),T(e,"data-overflow",t[0])},m(l,c){tt(l,e,c),Lt(e,r),s&&s.m(r,null),n=!0,i||(o=[Tt(r,"measure",t[3]),Tr(Di.call(null,r)),Tt(e,"measure",t[2]),Tr(Di.call(null,e))],i=!0)},p(l,[c]){s&&s.p&&(!n||64&c)&&xi(s,a,l,l[6],n?bi(a,l[6],c,null):vi(l[6]),null),(!n||2&c)&&T(e,"data-layout",l[1]),(!n||1&c)&&T(e,"data-overflow",l[0])},i(l){n||(I(s,l),n=!0)},o(l){B(s,l),n=!1},d(l){l&&J(e),s&&s.d(l),i=!1,Ur(o)}}}function yS(t,e,r){let n,i,{$$slots:o={},$$scope:a}=e,s=0,l=0,c=0;const u=()=>{r(0,i=n==="compact"&&s>c?"overflow":void 0)};return t.$$set=d=>{"$$scope"in d&&r(6,a=d.$$scope)},t.$$.update=()=>{48&t.$$.dirty&&r(1,n=l>c?"compact":"default")},[i,n,({detail:d})=>{const{width:p}=d;r(5,c=p),u()},({detail:d})=>{const{width:p}=d;p>l&&r(4,l=p),s=p,i||u()},l,c,a,o]}class Hb extends gr{constructor(e){super(),fr(this,e,yS,$S,cr,{})}}function bS(t){let e,r,n,i;const o=t[5].default,a=yi(o,t,t[4],null);return{c(){e=mt("div"),a&&a.c(),T(e,"class",t[0])},m(s,l){tt(s,e,l),a&&a.m(e,null),r=!0,n||(i=[Tt(e,"measure",function(){kr(t[1]&&t[3])&&(t[1]&&t[3]).apply(this,arguments)}),Tr(t[2].call(null,e))],n=!0)},p(s,[l]){t=s,a&&a.p&&(!r||16&l)&&xi(a,o,t,t[4],r?bi(o,t[4],l,null):vi(t[4]),null),(!r||1&l)&&T(e,"class",t[0])},i(s){r||(I(a,s),r=!0)},o(s){B(a,s),r=!1},d(s){s&&J(e),a&&a.d(s),n=!1,Ur(i)}}}function xS(t,e,r){let{$$slots:n={},$$scope:i}=e;const o=ba();let{class:a=null}=e;const s=$n("measurable");let l=!1;return xs(()=>r(1,l=!0)),t.$$set=c=>{"class"in c&&r(0,a=c.class),"$$scope"in c&&r(4,i=c.$$scope)},[a,l,s,({detail:c})=>o("measure",c),i,n]}class vS extends gr{constructor(e){super(),fr(this,e,xS,bS,cr,{class:0})}}const wS=t=>({}),I$=t=>({}),SS=t=>({}),E$=t=>({}),kS=t=>({}),A$=t=>({});function L$(t){let e,r;const n=t[4].header,i=yi(n,t,t[3],A$);return{c(){e=mt("div"),i&&i.c(),T(e,"class","PinturaUtilHeader")},m(o,a){tt(o,e,a),i&&i.m(e,null),r=!0},p(o,a){i&&i.p&&(!r||8&a)&&xi(i,n,o,o[3],r?bi(n,o[3],a,kS):vi(o[3]),A$)},i(o){r||(I(i,o),r=!0)},o(o){B(i,o),r=!1},d(o){o&&J(e),i&&i.d(o)}}}function F$(t){let e,r;const n=t[4].footer,i=yi(n,t,t[3],I$);return{c(){e=mt("div"),i&&i.c(),T(e,"class","PinturaUtilFooter")},m(o,a){tt(o,e,a),i&&i.m(e,null),r=!0},p(o,a){i&&i.p&&(!r||8&a)&&xi(i,n,o,o[3],r?bi(n,o[3],a,wS):vi(o[3]),I$)},i(o){r||(I(i,o),r=!0)},o(o){B(i,o),r=!1},d(o){o&&J(e),i&&i.d(o)}}}function TS(t){let e,r,n,i,o,a,s=t[1]&&L$(t);const l=t[4].main,c=yi(l,t,t[3],E$),u=c||function(p){let h,f;return h=new vS({props:{class:"PinturaStage"}}),h.$on("measure",p[5]),{c(){Ht(h.$$.fragment)},m(g,$){Vt(h,g,$),f=!0},p:qe,i(g){f||(I(h.$$.fragment,g),f=!0)},o(g){B(h.$$.fragment,g),f=!1},d(g){Nt(h,g)}}}(t);let d=t[2]&&F$(t);return{c(){s&&s.c(),e=ue(),r=mt("div"),u&&u.c(),n=ue(),d&&d.c(),i=ue(),o=Dn(),T(r,"class","PinturaUtilMain")},m(p,h){s&&s.m(p,h),tt(p,e,h),tt(p,r,h),u&&u.m(r,null),t[6](r),tt(p,n,h),d&&d.m(p,h),tt(p,i,h),tt(p,o,h),a=!0},p(p,[h]){p[1]?s?(s.p(p,h),2&h&&I(s,1)):(s=L$(p),s.c(),I(s,1),s.m(e.parentNode,e)):s&&(Fe(),B(s,1,1,()=>{s=null}),ze()),c&&c.p&&(!a||8&h)&&xi(c,l,p,p[3],a?bi(l,p[3],h,SS):vi(p[3]),E$),p[2]?d?(d.p(p,h),4&h&&I(d,1)):(d=F$(p),d.c(),I(d,1),d.m(i.parentNode,i)):d&&(Fe(),B(d,1,1,()=>{d=null}),ze())},i(p){a||(I(s),I(u,p),I(d),I(!1),a=!0)},o(p){B(s),B(u,p),B(d),B(!1),a=!1},d(p){s&&s.d(p),p&&J(e),p&&J(r),u&&u.d(p),t[6](null),p&&J(n),d&&d.d(p),p&&J(i),p&&J(o)}}}function CS(t,e,r){let{$$slots:n={},$$scope:i}=e,{hasHeader:o=!!e.$$slots.header}=e,{hasFooter:a=!!e.$$slots.footer}=e,{root:s}=e;return t.$$set=l=>{r(7,e=_n(_n({},e),lu(l))),"hasHeader"in l&&r(1,o=l.hasHeader),"hasFooter"in l&&r(2,a=l.hasFooter),"root"in l&&r(0,s=l.root),"$$scope"in l&&r(3,i=l.$$scope)},e=lu(e),[s,o,a,i,n,function(l){Ji.call(this,t,l)},function(l){jr[l?"unshift":"push"](()=>{s=l,r(0,s)})}]}class Tl extends gr{constructor(e){super(),fr(this,e,CS,TS,cr,{hasHeader:1,hasFooter:2,root:0})}}function z$(t){let e;return{c(){e=mt("div"),T(e,"class","PinturaRangeInputMeter"),Mt(e,"transform",`translateX(${t[10].x-t[13].x}px) translateY(${t[10].y-t[13].y}px)`)},m(r,n){tt(r,e,n),e.innerHTML=t[7]},p(r,n){128&n[0]&&(e.innerHTML=r[7]),1024&n[0]&&Mt(e,"transform",`translateX(${r[10].x-r[13].x}px) translateY(${r[10].y-r[13].y}px)`)},d(r){r&&J(e)}}}function MS(t){let e,r,n,i,o,a,s,l,c,u,d,p=t[10]&&z$(t);return{c(){e=mt("div"),r=mt("span"),n=ue(),i=mt("button"),o=Mn(t[1]),s=ue(),l=mt("div"),p&&p.c(),T(r,"class","PinturaRangeInputValue"),T(i,"class","PinturaRangeInputReset"),T(i,"type","button"),i.disabled=a=t[0]===t[2],T(l,"class","PinturaRangeInputInner"),T(l,"data-value-limited",t[5]),Mt(l,"--range-mask-from",t[9]),Mt(l,"--range-mask-to",t[8]),T(e,"class","PinturaRangeInput"),T(e,"tabindex","0")},m(h,f){tt(h,e,f),Lt(e,r),r.innerHTML=t[3],Lt(e,n),Lt(e,i),Lt(i,o),Lt(e,s),Lt(e,l),p&&p.m(l,null),u||(d=[Tt(i,"click",t[18]),Tt(l,"interactionstart",t[14]),Tt(l,"interactionupdate",t[16]),Tt(l,"interactionend",t[17]),Tt(l,"interactionrelease",t[15]),Tr(c=Ts.call(null,l,{inertia:t[6]})),Tt(l,"measure",t[39]),Tr(Di.call(null,l)),Tt(e,"wheel",t[20],{passive:!1}),Tt(e,"nudge",t[21]),Tr(Ss.call(null,e,{direction:"horizontal",preventDefault:!0}))],u=!0)},p(h,f){8&f[0]&&(r.innerHTML=h[3]),2&f[0]&&Gn(o,h[1]),5&f[0]&&a!==(a=h[0]===h[2])&&(i.disabled=a),h[10]?p?p.p(h,f):(p=z$(h),p.c(),p.m(l,null)):p&&(p.d(1),p=null),32&f[0]&&T(l,"data-value-limited",h[5]),c&&kr(c.update)&&64&f[0]&&c.update.call(null,{inertia:h[6]}),512&f[0]&&Mt(l,"--range-mask-from",h[9]),256&f[0]&&Mt(l,"--range-mask-to",h[8])},i:qe,o:qe,d(h){h&&J(e),p&&p.d(),u=!1,Ur(d)}}}function PS(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,{labelReset:g="Reset"}=e,{direction:$="x"}=e,{min:b=0}=e,{max:v=1}=e,{base:w=b}=e,{value:S=0}=e,{valueLabel:P=0}=e,{valueMin:M}=e,{valueMax:E}=e,{oninputstart:C=se}=e,{oninputmove:z=se}=e,{oninputend:V=se}=e,{elasticity:L=0}=e,{nudgeMultiplier:y}=e,{step:ct=8}=e;const j=$n("isAnimated");D(t,j,q=>r(6,p=q));const k=$n("fixScrollDirection");D(t,k,q=>r(45,h=q));const N=(q,Ft,zt)=>Math.ceil((q-zt)/Ft)*Ft+zt;let nt,ft,xt;const H={x:2,y:0},Z=(q,Ft,zt)=>`M ${q-zt} ${Ft} a ${zt} ${zt} 0 1 0 0 -1`;let wt,vt,et=!1,Pt={snap:!1,elastic:!1};const Et=(q,Ft,zt)=>{const yt=q[$]+Ft[$],Dt=an(yt,wt[1][$],wt[0][$]),Wt=L?Dt+Ds(yt-Dt,L):Dt,at=zt.elastic?Wt:Dt,St=lt(0,0);return St[$]=at,kt.set(St,{hard:zt.snap}),an(Ut(St,$),b,v)},kt=hr();D(t,kt,q=>r(10,f=q));const st=(q,Ft)=>{const zt=.5*(nt[Ft]-a[Ft])-(Kc(q,b,v)*a[Ft]-.5*a[Ft]);return{x:Ft==="x"?zt:0,y:Ft==="y"?zt:0}},Ut=(q,Ft)=>{const zt=-(q[Ft]-.5*nt[Ft])/a[Ft];return b+zt*n},rt=kt.subscribe(q=>{q&&vt&&z(an(Ut(q,$),b,v))}),X=q=>{const Ft=[st(M??b,$),st(E??v,$)],zt={x:$==="x"?f.x+q:0,y:$==="y"?f.y+q:0},yt=an(zt[$],Ft[1][$],Ft[0][$]),Dt={...f,[$]:yt};It(kt,f=Dt,f);const Wt=an(Ut(Dt,$),b,v);C(),z(Wt),V(Wt)};return jo(()=>{rt()}),t.$$set=q=>{"labelReset"in q&&r(1,g=q.labelReset),"direction"in q&&r(22,$=q.direction),"min"in q&&r(23,b=q.min),"max"in q&&r(24,v=q.max),"base"in q&&r(2,w=q.base),"value"in q&&r(0,S=q.value),"valueLabel"in q&&r(3,P=q.valueLabel),"valueMin"in q&&r(25,M=q.valueMin),"valueMax"in q&&r(26,E=q.valueMax),"oninputstart"in q&&r(27,C=q.oninputstart),"oninputmove"in q&&r(28,z=q.oninputmove),"oninputend"in q&&r(29,V=q.oninputend),"elasticity"in q&&r(30,L=q.elasticity),"nudgeMultiplier"in q&&r(31,y=q.nudgeMultiplier),"step"in q&&r(32,ct=q.step)},t.$$.update=()=>{if(25165824&t.$$.dirty[0]&&r(34,n=v-b),41943040&t.$$.dirty[0]&&r(36,i=M!=null?Math.max(M,b):b),83886080&t.$$.dirty[0]&&r(35,o=E!=null?Math.min(E,v):v),25165828&t.$$.dirty[0]&&r(38,s=Kc(w,b,v)),16&t.$$.dirty[0]|128&t.$$.dirty[1]&&nt){const q=.5*nt.y;let Ft,zt=40*s,yt="",Dt=nt.y,Wt="";for(let at=0;at<=40;at++){const St=H.x+10*at,pt=q;yt+=Z(St,pt,at%5==0?2:.75)+" ",Ft=St+H.x,at===zt&&(Wt=`<path d="M${St} ${pt-4} l2 3 l-2 -1 l-2 1 z"/>`)}r(7,ft=`<svg width="${Ft}" height="${Dt}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${Ft} ${Dt}" aria-hidden="true" focusable="false">
        ${Wt}
        <rect rx="4" ry="4" y="${q-4}"" height="8"/>
        <path fill-rule="evenodd" d="${yt.trim()}"/></svg>`),r(33,xt={x:Ft-2*H.x,y:Dt})}16&t.$$.dirty[0]|4&t.$$.dirty[1]&&(a=nt&&xt),25165824&t.$$.dirty[0]|48&t.$$.dirty[1]&&r(5,l=i!==b||o!==v),32&t.$$.dirty[0]|48&t.$$.dirty[1]&&r(37,c=l?function(q,Ft){const yt=Kc(q,b,v),Dt=Kc(Ft,b,v);return[100*mr(N(yt,.025,0)-.0125)+"%",100*mr(N(Dt,.025,0)-.0125)+"%"]}(i,o):void 0),64&t.$$.dirty[1]&&r(9,u=c?c[0]:""),64&t.$$.dirty[1]&&r(8,d=c?c[1]:""),4194385&t.$$.dirty[0]|8&t.$$.dirty[1]&&n&&nt&&nt.x&&nt.y&&kt.set(st(S,$),{hard:p===!1})},[S,g,w,P,nt,l,p,ft,d,u,f,j,k,H,()=>{et=!1,vt=Ea(kt),wt=[st(M??b,$),st(E??v,$)],C()},()=>{et=!0},({detail:q})=>{Pt.snap=!et,Pt.elastic=!et,Et(vt,q.translation,Pt)},({detail:q})=>{Pt.snap=!1,Pt.elastic=!1;const Ft=Et(vt,q.translation,Pt);if(vt=void 0,wt=void 0,Math.abs(Ft-w)<.01)return V(w);V(Ft)},()=>{r(0,S=an(w,i,o)),C(),V(S)},kt,q=>{q.preventDefault(),q.stopPropagation();const Ft=yu(q,{fixScrollDirection:h})*ct;X(Ft)},({detail:q})=>{X(q[$]*Math.abs(y||8))},$,b,v,M,E,C,z,V,L,y,ct,xt,n,o,i,c,s,q=>r(4,nt=(Ft=>lt(Ft.width,Ft.height))(q.detail))]}class A0 extends gr{constructor(e){super(),fr(this,e,PS,MS,cr,{labelReset:1,direction:22,min:23,max:24,base:2,value:0,valueLabel:3,valueMin:25,valueMax:26,oninputstart:27,oninputmove:28,oninputend:29,elasticity:30,nudgeMultiplier:31,step:32},null,[-1,-1])}}var RS={[Ns]:t=>({x:t.x,y:t.y}),[fa]:t=>({x:t.x+t.width,y:t.y}),[Hs]:t=>({x:t.x+t.width,y:t.y}),[ga]:t=>({x:t.x+t.width,y:t.y+t.height}),[js]:t=>({x:t.x,y:t.y+t.height}),[$a]:t=>({x:t.x,y:t.y+t.height}),[Us]:t=>({x:t.x,y:t.y}),[ma]:t=>({x:t.x,y:t.y})};const jb={t:"top",r:"right",b:"bottom",l:"left"},Ub={t:"vertical",b:"vertical",r:"horizontal",l:"horizontal"};function D$(t,e,r){const n=t.slice();return n[15]=e[r].key,n[16]=e[r].translate,n[17]=e[r].scale,n[18]=e[r].type,n[19]=e[r].opacity,n[20]=e[r].role,n[21]=e[r].tabindex,n[22]=e[r].label,n[23]=e[r].orientation,n[24]=e[r].valuemin,n[25]=e[r].valuemax,n[26]=e[r].valuenow,n}function B$(t,e){let r,n,i,o,a,s,l,c,u,d,p,h;return{key:t,first:null,c(){r=mt("div"),T(r,"role",n=e[20]),T(r,"tabindex",i=e[21]),T(r,"aria-label",o=e[22]),T(r,"aria-orientation",a=e[23]),T(r,"aria-valuemin",s=e[24]),T(r,"aria-valuemax",l=e[25]),T(r,"aria-valuenow",c=e[26]),T(r,"class","PinturaRectManipulator"),T(r,"data-direction",u=e[15]),T(r,"data-shape",d=e[18]==="edge"?"edge":""+e[0]),Mt(r,"--tx",e[16].x),Mt(r,"--ty",e[16].y),Mt(r,"--sx",e[17].x),Mt(r,"--sy",e[17].y),Mt(r,"opacity",e[19]),this.first=r},m(f,g){tt(f,r,g),p||(h=[Tt(r,"nudge",function(){kr(e[6](e[15]))&&e[6](e[15]).apply(this,arguments)}),Tr(Ss.call(null,r,{preventDefault:!0})),Tt(r,"interactionstart",function(){kr(e[5]("resizestart",e[15]))&&e[5]("resizestart",e[15]).apply(this,arguments)}),Tt(r,"interactionupdate",function(){kr(e[5]("resizemove",e[15]))&&e[5]("resizemove",e[15]).apply(this,arguments)}),Tt(r,"interactionend",function(){kr(e[5]("resizeend",e[15]))&&e[5]("resizeend",e[15]).apply(this,arguments)}),Tr(Ts.call(null,r))],p=!0)},p(f,g){e=f,2&g&&n!==(n=e[20])&&T(r,"role",n),2&g&&i!==(i=e[21])&&T(r,"tabindex",i),2&g&&o!==(o=e[22])&&T(r,"aria-label",o),2&g&&a!==(a=e[23])&&T(r,"aria-orientation",a),2&g&&s!==(s=e[24])&&T(r,"aria-valuemin",s),2&g&&l!==(l=e[25])&&T(r,"aria-valuemax",l),2&g&&c!==(c=e[26])&&T(r,"aria-valuenow",c),2&g&&u!==(u=e[15])&&T(r,"data-direction",u),3&g&&d!==(d=e[18]==="edge"?"edge":""+e[0])&&T(r,"data-shape",d),2&g&&Mt(r,"--tx",e[16].x),2&g&&Mt(r,"--ty",e[16].y),2&g&&Mt(r,"--sx",e[17].x),2&g&&Mt(r,"--sy",e[17].y),2&g&&Mt(r,"opacity",e[19])},d(f){f&&J(r),p=!1,Ur(h)}}}function IS(t){let e,r=[],n=new Map,i=t[1];const o=a=>a[15];for(let a=0;a<i.length;a+=1){let s=D$(t,i,a),l=o(s);n.set(l,r[a]=B$(l,s))}return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=Dn()},m(a,s){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(a,s);tt(a,e,s)},p(a,[s]){99&s&&(i=a[1],r=es(r,s,o,1,a,i,n,e.parentNode,D2,B$,e,D$))},i:qe,o:qe,d(a){for(let s=0;s<r.length;s+=1)r[s].d(a);a&&J(e)}}}function ES(t,e,r){let n,i,o,a,{rect:s=null}=e,{bounds:l=null}=e,{visible:c=!1}=e,{cornerStyle:u}=e;const d=$n("isAnimated");D(t,d,$=>r(12,a=$));const p=hr(void 0,{precision:1e-4,stiffness:.2,damping:.4});D(t,p,$=>r(11,o=$));const h=hr(0,{precision:.001});let f;D(t,h,$=>r(10,i=$));const g=ba();return t.$$set=$=>{"rect"in $&&r(7,s=$.rect),"bounds"in $&&r(8,l=$.bounds),"visible"in $&&r(9,c=$.visible),"cornerStyle"in $&&r(0,u=$.cornerStyle)},t.$$.update=()=>{4608&t.$$.dirty&&p.set(c?1:.5,{hard:a===!1}),4608&t.$$.dirty&&h.set(c?1:0,{hard:a===!1}),3456&t.$$.dirty&&r(1,n=Object.keys(x1).map(($,b)=>{const v=x1[$],w=RS[v](s),S=v.length===1?"edge":"corner",P=S==="corner";let M;if(S==="edge"&&l){let E,C,z;v==="l"&&(E=l.x,C=Math.min(l.width,s.x+s.width),z=s.x),v==="t"&&(E=l.y,C=Math.min(l.height,s.y+s.height),z=s.y),v==="r"&&(E=s.x,C=l.width,z=s.x+s.width),v==="b"&&(E=s.y,C=l.height,z=s.y+s.height),M={role:"slider",tabindex:0,label:"Drag "+jb[v],orientation:""+Ub[v],valuemin:Math.round(E),valuemax:Math.round(C),valuenow:Math.round(z)}}return{key:v,type:S,scale:{x:/^(t|b)$/.test(v)?s.width:P?an(o,.5,1.25):1,y:/^(r|l)$/.test(v)?s.height:P?an(o,.5,1.25):1},translate:{x:w.x,y:w.y},opacity:i,...M}}))},[u,n,d,p,h,($,b)=>({detail:v})=>{f&&b!==f||$!=="resizestart"&&f===void 0||($==="resizestart"&&(f=b),$==="resizeend"&&(f=void 0),g($,{direction:b,translation:v&&v.translation}))},$=>({detail:b})=>{g("resizestart",{direction:$,translation:{x:0,y:0}}),g("resizemove",{direction:$,translation:b}),g("resizeend",{direction:$,translation:{x:0,y:0}})},s,l,c,i,o,a]}class AS extends gr{constructor(e){super(),fr(this,e,ES,IS,cr,{rect:7,bounds:8,visible:9,cornerStyle:0})}}var LS=t=>{function e(a,s){t.dispatchEvent(new CustomEvent(a,{detail:s}))}const r=a=>{a.preventDefault(),t.addEventListener("gesturechange",n),t.addEventListener("gestureend",i),e("gesturedown")},n=a=>{a.preventDefault(),e("gestureupdate",a.scale)},i=a=>{e("gestureup",a.scale),a.preventDefault(),o()},o=()=>{t.removeEventListener("gesturechange",n),t.removeEventListener("gestureend",i)};return t.addEventListener("gesturestart",r),{destroy:()=>{o(),t.removeEventListener("gesturestart",r)}}},L0={[Ns]:js,[Hs]:Us,[js]:Ns,[Us]:Hs,[ma]:ga,[fa]:$a,[ga]:ma,[$a]:fa},F0=t=>{const e=t===Us||t===Hs,r=t===Ns||t===js;return[t===Hs||t===fa||t===ga,t===Us||t===$a||t===ma,t===Ns||t===fa||t===ma,t===js||t===ga||t===$a,e,r,e||r]},O$=(t,e,r,n={})=>{const{target:i,translate:o}=e,{aspectRatio:a,minSize:s,maxSize:l}=n,c=nu[L0[i]],u=jn(lt(t.x,t.y),lt(c[0]*t.width,c[1]*t.height)),d=nu[i],p=jn(Fr(t),lt(d[0]*t.width,d[1]*t.height)),[h,f,g,$,b,v,w]=F0(i);let S=o.x,P=o.y;b?P=0:v&&(S=0);const{inner:M,outer:E}=FS(u,i,r,{aspectRatio:a,minSize:s,maxSize:l});let[C,z,V,L]=vl(t);if(h?L=u.x:f&&(z=u.x),$?C=u.y:g&&(V=u.y),h){const y=M.x+M.width,ct=E.x+E.width;z=an(p.x+S,y,ct)}else if(f){const y=E.x,ct=M.x;L=an(p.x+S,y,ct)}if($){const y=M.y+M.height,ct=E.y+E.height;V=an(p.y+P,y,ct)}else if(g){const y=E.y,ct=M.y;C=an(p.y+P,y,ct)}if(L>M.x&&(L=M.x),z<M.x+M.width&&(z=M.x+M.width),C>M.y&&(C=M.y),V<M.y+M.height&&(V=M.y+M.height),L<E.x){const y=E.x-L;L=E.x,z+=y}if(z>E.x+E.width){const y=z-(E.x+E.width);z=E.x+E.width,L-=y}if(C<E.y){const y=E.y-C;C=E.y,V+=y}if(V>E.y+E.height){const y=V-(E.y+E.height);V=E.y+E.height,C-=y}if(a)if(w){let y=z-L,ct=V-C;b?(ct=y/a,C=u.y-.5*ct,V=u.y+.5*ct):v&&(y=ct*a,L=u.x-.5*y,z=u.x+.5*y)}else{const y=lt(p.x+S-u.x,p.y+P-u.y);i===fa?(y.x=Math.max(0,y.x),y.y=Math.min(0,y.y)):i===ga?(y.x=Math.max(0,y.x),y.y=Math.max(0,y.y)):i===$a?(y.x=Math.min(0,y.x),y.y=Math.max(0,y.y)):i===ma&&(y.x=Math.min(0,y.x),y.y=Math.min(0,y.y));const ct=Bs(y),j=Bs(lt(M.width,M.height)),k=Bs(lt(E.width,E.height)),N=an(ct,j,k),nt=lt(a,1),ft=ji(yo(nt),N);i===fa?(z=u.x+ft.x,C=u.y-ft.y):i===ga?(z=u.x+ft.x,V=u.y+ft.y):i===$a?(L=u.x-ft.x,V=u.y+ft.y):i===ma&&(L=u.x-ft.x,C=u.y-ft.y)}return Wn(L,C,z-L,V-C)};const FS=(t,e,r,n)=>{const{aspectRatio:i,minSize:o,maxSize:a}=n,s=e===Hs||e===fa||e===ga,l=e===Us||e===$a||e===ma,c=e===Ns||e===fa||e===ma,u=e===js||e===ga||e===$a,d=e===Us||e===Hs,p=e===Ns||e===js,h=Fr(r);s?(h.x=t.x,h.width-=t.x):l&&(h.width=t.x),u?(h.y=t.y,h.height-=t.y):c&&(h.height=t.y);const f=((M,E)=>ya(0,0,M,E))(Math.min(h.width,a.width),Math.min(h.height,a.height));if(i){if(d){const M=Math.min(t.y,r.height-t.y);f.height=Math.min(2*M,f.height)}else if(p){const M=Math.min(t.x,r.width-t.x);f.width=Math.min(2*M,f.width)}}const g=i?bl(Zs(Ui(o),i)):o,$=i?bl(Ki(f,i)):f;let b,v,w,S;s?b=t.x:l&&(v=t.x),u?w=t.y:c&&(S=t.y),s?v=b+g.width:l&&(b=v-g.width),u?S=w+g.height:c&&(w=S-g.height),d?(w=t.y-.5*g.height,S=t.y+.5*g.height):p&&(b=t.x-.5*g.width,v=t.x+.5*g.width);const P=ri([lt(b,w),lt(v,S)]);return s?v=b+$.width:l&&(b=v-$.width),u?S=w+$.height:c&&(w=S-$.height),d?(w=t.y-.5*$.height,S=t.y+.5*$.height):p&&(b=t.x-.5*$.width,v=t.x+.5*$.width),b=Math.max(r.x,b),v=Math.min(r.x+r.width,v),w=Math.max(r.y,w),S=Math.min(r.y+r.height,S),{inner:P,outer:ri([lt(b,w),lt(v,S)])}};var W$=t=>180*t/Math.PI;function zS(t){let e,r,n;return r=new A0({props:{elasticity:t[5],min:t[9],max:t[10],value:t[11],valueMin:Math.max(t[9],t[0]),valueMax:Math.min(t[10],t[1]),labelReset:t[6],base:t[12],valueLabel:Math.round(W$(t[11]))+"&deg;",oninputstart:t[2],oninputmove:t[17],oninputend:t[18]}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"class","PinturaImageRotator")},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,[o]){const a={};32&o&&(a.elasticity=i[5]),512&o&&(a.min=i[9]),1024&o&&(a.max=i[10]),2048&o&&(a.value=i[11]),513&o&&(a.valueMin=Math.max(i[9],i[0])),1026&o&&(a.valueMax=Math.min(i[10],i[1])),64&o&&(a.labelReset=i[6]),4096&o&&(a.base=i[12]),2048&o&&(a.valueLabel=Math.round(W$(i[11]))+"&deg;"),4&o&&(a.oninputstart=i[2]),392&o&&(a.oninputmove=i[17]),400&o&&(a.oninputend=i[18]),r.$set(a)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function DS(t,e,r){let n,i,o,a,s,l,c,{rotation:u}=e,{valueMin:d}=e,{valueMax:p}=e,{oninputstart:h=se}=e,{oninputmove:f=se}=e,{oninputend:g=se}=e,{elasticity:$=0}=e,{labelReset:b}=e,{rotationMin:v}=e,{rotationMax:w}=e;return t.$$set=S=>{"rotation"in S&&r(13,u=S.rotation),"valueMin"in S&&r(0,d=S.valueMin),"valueMax"in S&&r(1,p=S.valueMax),"oninputstart"in S&&r(2,h=S.oninputstart),"oninputmove"in S&&r(3,f=S.oninputmove),"oninputend"in S&&r(4,g=S.oninputend),"elasticity"in S&&r(5,$=S.elasticity),"labelReset"in S&&r(6,b=S.labelReset),"rotationMin"in S&&r(14,v=S.rotationMin),"rotationMax"in S&&r(15,w=S.rotationMax)},t.$$.update=()=>{16384&t.$$.dirty&&r(9,n=v+1e-9),32768&t.$$.dirty&&r(10,i=w-1e-9),1536&t.$$.dirty&&r(12,o=n+.5*(i-n)),32768&t.$$.dirty&&r(16,a=2*w),8192&t.$$.dirty&&r(8,s=Math.sign(u)),73728&t.$$.dirty&&r(7,l=Math.round(Math.abs(u)/a)*a),8576&t.$$.dirty&&r(11,c=u-s*l)},[d,p,h,f,g,$,b,l,s,n,i,c,o,u,v,w,a,S=>f(s*l+S),S=>g(s*l+S)]}class BS extends gr{constructor(e){super(),fr(this,e,DS,zS,cr,{rotation:13,valueMin:0,valueMax:1,oninputstart:2,oninputmove:3,oninputend:4,elasticity:5,labelReset:6,rotationMin:14,rotationMax:15})}}function OS(t){let e,r;return e=new ws({props:{class:"PinturaPresetListFilter",layout:"row",options:t[8],selectedIndex:t[7],onchange:t[10]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};256&i&&(o.options=n[8]),128&i&&(o.selectedIndex=n[7]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function WS(t){let e,r;return e=new M0({props:{icon:t[0],label:t[1],labelClass:t[2],hideLabel:t[3],options:t[9],selectedIndex:t[4],onchange:t[5],optionMapper:t[6],$$slots:{controls:[OS]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,[i]){const o={};1&i&&(o.icon=n[0]),2&i&&(o.label=n[1]),4&i&&(o.labelClass=n[2]),8&i&&(o.hideLabel=n[3]),512&i&&(o.options=n[9]),16&i&&(o.selectedIndex=n[4]),32&i&&(o.onchange=n[5]),64&i&&(o.optionMapper=n[6]),262528&i&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}const _$='fill="none" stroke="currentColor"';function _S(t,e,r){let n,i,o,{icon:a}=e,{label:s}=e,{labelClass:l}=e,{hideLabel:c}=e,{options:u}=e,{selectedIndex:d}=e,{onchange:p}=e,{optionMapper:h}=e,{filter:f="landscape"}=e,{onfilterchange:g=se}=e;const $=(v,w,S,P,M)=>`
    <rect ${_$} x="${v}" y="${w}" width="${S}" height="${P}" rx="${M}"/>`,b=(v,w)=>`<path ${_$} d="M${v} ${w} l2 2 l3 -4"/>`;return t.$$set=v=>{"icon"in v&&r(0,a=v.icon),"label"in v&&r(1,s=v.label),"labelClass"in v&&r(2,l=v.labelClass),"hideLabel"in v&&r(3,c=v.hideLabel),"options"in v&&r(12,u=v.options),"selectedIndex"in v&&r(4,d=v.selectedIndex),"onchange"in v&&r(5,p=v.onchange),"optionMapper"in v&&r(6,h=v.optionMapper),"filter"in v&&r(11,f=v.filter),"onfilterchange"in v&&r(13,g=v.onfilterchange)},t.$$.update=()=>{6144&t.$$.dirty&&r(9,n=((v,w)=>(v||[]).map(S=>Ge(S[0])?(S[1]=S[1].map(w),S):w(S)))(u,(v=>w=>{const[S,P,M={}]=w;return _e(S)&&(M.hidden=v==="landscape"?S<1:S>1),[S,P,M]})(f))),2048&t.$$.dirty&&r(7,i=f==="landscape"?0:1),128&t.$$.dirty&&r(8,o=[["landscape","Landscape",{hideLabel:!0,icon:$(2,6,19,12,2)+(i===0?b(9,12):"")}],["portrait","Portrait",{hideLabel:!0,icon:$(5,3,13,18,2)+(i===1?b(9,12):"")}]])},[a,s,l,c,d,p,h,i,o,n,v=>{r(11,f=v.value),g(v.value)},f,u,g]}class VS extends gr{constructor(e){super(),fr(this,e,_S,WS,cr,{icon:0,label:1,labelClass:2,hideLabel:3,options:12,selectedIndex:4,onchange:5,optionMapper:6,filter:11,onfilterchange:13})}}const V$=t=>_o(t,e=>mr(e,6)),N$=t=>ta(t,e=>mr(e,6)),Ls=(t,e,r=1e-4)=>Math.abs(t-e)<r;var NS=(t,e,r,n,i={})=>{const{aspectRatio:o}=i;t=N$(t),n=n.map(V$);const a=Qm(t,L0[r.target]),s=_o(a,b=>mr(b,6)),l=o?Zs(i.minSize,o):i.minSize,c=o?Ki(i.maxSize,o):i.maxSize,u=Qm(e,r.target);if(Ni(u,a)<1){e=Fr(t);const b=Math.min(l.width/t.width,l.height/t.height);Ei(e,b,a)}e=Jm(Fr(e),l,c,a);let d=Fr(e);e=N$(e);const p=Xy(n,1),h=Oo(t),f=Oo(e),g=h.findIndex(b=>zs(_o(b,v=>mr(v,6)),s)),$=b=>p.map(v=>J1(v,b)).filter(Boolean).pop();if(o){const b=f.map((v,w)=>{if(w===g)return;const S=lt(a.x-v.x,a.y-v.y);yo(S),ji(S,.5);const P=lt(a.x-S.x,a.y-S.y),M=Gs(P,V$(v)),E=$(M);if(!E)return;const C=h[w];return{intersection:E,cornerDist:Ni(a,C),intersectionDist:Ni(a,E)}}).filter(Boolean);if(b.length){const v=b.reduce((w,S)=>{const P=S.intersectionDist/S.cornerDist;return P<w?P:w},Number.MAX_SAFE_INTEGER);d=Fr(t),Ei(d,v,a)}}else{const b=r.target.length===1,v=!(n[0].y===n[1].y||n[0].x===n[1].x),w=h.map((S,P)=>{if(P===g)return;const M=f[P],E=!Ls(M.x,s.x)&&!Ls(M.y,s.y);if(!b&&!v&&E||b&&(Ls(M.x,s.x)||Ls(M.y,s.y)))return;const C=He(b?S:a),z=Un(He(C),M);yo(z),ji(z,.5),b?jn(C,z):Un(C,z);const V=Gs(C,M);return $(V)||void 0}).filter(Boolean);if(w.length){const[S,P,M,E]=F0(r.target);let[C,z,V,L]=vl(e);w.forEach(({x:y,y:ct})=>{const j=mr(y,6),k=mr(ct,6);M&&!Ls(k,s.y)&&(C=Math.max(C,ct)),S&&!Ls(j,s.x)&&(z=Math.min(z,y)),E&&!Ls(k,s.y)&&(V=Math.min(V,ct)),P&&!Ls(j,s.x)&&(L=Math.max(L,y))}),d=Ux([C,z,V,L]),Ei(d,.9999,a)}}return Jm(d,l,c,a),d};function HS(t){let e,r;return e=new Qi({props:{items:t[12]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};4096&i[0]&&(o.items=n[12]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function jS(t){let e,r,n;return r=new Hb({props:{$$slots:{default:[HS]},$$scope:{ctx:t}}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"slot","header")},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};4096&o[0]|1024&o[7]&&(a.$$scope={dirty:o,ctx:i}),r.$set(a)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function H$(t){let e,r;return e=new ks({props:{onclick:t[90],label:t[4].cropLabelButtonRecenter,icon:t[4].cropIconButtonRecenter,disabled:!t[9],hideLabel:!0,class:"PinturaButtonCenter",style:`opacity:${t[31]};transform:translate3d(${t[32].x}px, ${t[32].y}px,0)`}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16&i[0]&&(o.label=n[4].cropLabelButtonRecenter),16&i[0]&&(o.icon=n[4].cropIconButtonRecenter),512&i[0]&&(o.disabled=!n[9]),3&i[1]&&(o.style=`opacity:${n[31]};transform:translate3d(${n[32].x}px, ${n[32].y}px,0)`),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function j$(t){let e,r;return e=new AS({props:{rect:t[8],bounds:t[14],visible:t[13],cornerStyle:t[1]}}),e.$on("resizestart",t[70]),e.$on("resizemove",t[71]),e.$on("resizeend",t[72]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};256&i[0]&&(o.rect=n[8]),16384&i[0]&&(o.bounds=n[14]),8192&i[0]&&(o.visible=n[13]),2&i[0]&&(o.cornerStyle=n[1]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function U$(t){let e,r;return{c(){e=mt("div"),r=mt("p"),T(e,"class","PinturaImageInfo"),T(e,"data-custom",t[24])},m(n,i){tt(n,e,i),Lt(e,r),r.innerHTML=t[23]},p(n,i){8388608&i[0]&&(r.innerHTML=n[23]),16777216&i[0]&&T(e,"data-custom",n[24])},d(n){n&&J(e)}}}function US(t){let e,r,n,i,o,a,s,l,c=t[22]&&t[10]&&H$(t),u=t[22]&&j$(t),d=t[11]&&U$(t);return{c(){e=mt("div"),r=mt("div"),c&&c.c(),n=ue(),u&&u.c(),o=ue(),d&&d.c(),T(r,"class","PinturaStage"),T(e,"slot","main")},m(p,h){tt(p,e,h),Lt(e,r),c&&c.m(r,null),Lt(r,n),u&&u.m(r,null),t[168](r),Lt(e,o),d&&d.m(e,null),a=!0,s||(l=[Tr(Di.call(null,r)),Tt(r,"measure",t[166]),Tt(r,"wheel",function(){kr(t[2]&&t[89])&&(t[2]&&t[89]).apply(this,arguments)},{passive:!1}),Tt(r,"interactionstart",t[76]),Tt(r,"interactionupdate",t[77]),Tt(r,"interactionrelease",t[79]),Tt(r,"interactionend",t[78]),Tr(i=Ts.call(null,r,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:Z$,getEventPosition:t[169]})),Tt(r,"gesturedown",t[86]),Tt(r,"gestureupdate",t[87]),Tt(r,"gestureup",t[88]),Tr(LS.call(null,r))],s=!0)},p(p,h){(t=p)[22]&&t[10]?c?(c.p(t,h),4195328&h[0]&&I(c,1)):(c=H$(t),c.c(),I(c,1),c.m(r,n)):c&&(Fe(),B(c,1,1,()=>{c=null}),ze()),t[22]?u?(u.p(t,h),4194304&h[0]&&I(u,1)):(u=j$(t),u.c(),I(u,1),u.m(r,null)):u&&(Fe(),B(u,1,1,()=>{u=null}),ze()),i&&kr(i.update)&&67108868&h[0]&&i.update.call(null,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:Z$,getEventPosition:t[169]}),t[11]?d?d.p(t,h):(d=U$(t),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},i(p){a||(I(c),I(u),a=!0)},o(p){B(c),B(u),a=!1},d(p){p&&J(e),c&&c.d(),u&&u.d(),t[168](null),d&&d.d(),s=!1,Ur(l)}}}function G$(t){let e,r,n,i;const o=[{class:"PinturaControlList"},{tabs:t[7]},t[19]];let a={$$slots:{default:[GS,({tab:c})=>({226:c}),({tab:c})=>[0,0,0,0,0,0,0,c?512:0]]},$$scope:{ctx:t}};for(let c=0;c<o.length;c+=1)a=_n(a,o[c]);e=new pp({props:a}),e.$on("select",t[167]);const s=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[18]},t[19]];let l={$$slots:{default:[YS,({panel:c})=>({225:c}),({panel:c})=>[0,0,0,0,0,0,0,c?256:0]]},$$scope:{ctx:t}};for(let c=0;c<s.length;c+=1)l=_n(l,s[c]);return n=new hp({props:l}),{c(){Ht(e.$$.fragment),r=ue(),Ht(n.$$.fragment)},m(c,u){Vt(e,c,u),tt(c,r,u),Vt(n,c,u),i=!0},p(c,u){const d=524416&u[0]?zi(o,[o[0],128&u[0]&&{tabs:c[7]},524288&u[0]&&Gi(c[19])]):{};1536&u[7]&&(d.$$scope={dirty:u,ctx:c}),e.$set(d);const p=786432&u[0]?zi(s,[s[0],s[1],262144&u[0]&&{panels:c[18]},524288&u[0]&&Gi(c[19])]):{};2046853144&u[0]|1280&u[7]&&(p.$$scope={dirty:u,ctx:c}),n.$set(p)},i(c){i||(I(e.$$.fragment,c),I(n.$$.fragment,c),i=!0)},o(c){B(e.$$.fragment,c),B(n.$$.fragment,c),i=!1},d(c){Nt(e,c),c&&J(r),Nt(n,c)}}}function GS(t){let e,r,n=t[226].label+"";return{c(){e=mt("span"),r=Mn(n)},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){512&o[7]&&n!==(n=i[226].label+"")&&Gn(r,n)},d(i){i&&J(e)}}}function ZS(t){let e,r;return e=new A0({props:{elasticity:t[27]*t[46],base:QS,min:t[25],max:JS,valueMin:t[29][0],valueMax:t[29][1],value:t[30],labelReset:t[4].labelReset,valueLabel:Math.round(100*t[30])+"%",oninputstart:t[83],oninputmove:t[84],oninputend:t[85]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};134217728&i[0]&&(o.elasticity=n[27]*n[46]),33554432&i[0]&&(o.min=n[25]),536870912&i[0]&&(o.valueMin=n[29][0]),536870912&i[0]&&(o.valueMax=n[29][1]),1073741824&i[0]&&(o.value=n[30]),16&i[0]&&(o.labelReset=n[4].labelReset),1073741824&i[0]&&(o.valueLabel=Math.round(100*n[30])+"%"),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function XS(t){let e,r;return e=new BS({props:{elasticity:t[27]*t[46],rotation:t[15],labelReset:t[4].labelReset,valueMin:t[28][0],valueMax:t[28][1],rotationMin:-t[3],rotationMax:t[3],oninputstart:t[73],oninputmove:t[74],oninputend:t[75]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};134217728&i[0]&&(o.elasticity=n[27]*n[46]),32768&i[0]&&(o.rotation=n[15]),16&i[0]&&(o.labelReset=n[4].labelReset),268435456&i[0]&&(o.valueMin=n[28][0]),268435456&i[0]&&(o.valueMax=n[28][1]),8&i[0]&&(o.rotationMin=-n[3]),8&i[0]&&(o.rotationMax=n[3]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function YS(t){let e,r,n,i;const o=[XS,ZS],a=[];function s(l,c){return l[225]===l[95]+"-rotation"?0:l[225]===l[95]+"-zoom"?1:-1}return~(e=s(t))&&(r=a[e]=o[e](t)),{c(){r&&r.c(),n=Dn()},m(l,c){~e&&a[e].m(l,c),tt(l,n,c),i=!0},p(l,c){let u=e;e=s(l),e===u?~e&&a[e].p(l,c):(r&&(Fe(),B(a[u],1,1,()=>{a[u]=null}),ze()),~e?(r=a[e],r?r.p(l,c):(r=a[e]=o[e](l),r.c()),I(r,1),r.m(n.parentNode,n)):r=null)},i(l){i||(I(r),i=!0)},o(l){B(r),i=!1},d(l){~e&&a[e].d(l),l&&J(n)}}}function qS(t){let e,r,n=t[20]&&G$(t);return{c(){e=mt("div"),n&&n.c(),T(e,"slot","footer"),Mt(e,"transform",t[17])},m(i,o){tt(i,e,o),n&&n.m(e,null),r=!0},p(i,o){i[20]?n?(n.p(i,o),1048576&o[0]&&I(n,1)):(n=G$(i),n.c(),I(n,1),n.m(e,null)):n&&(Fe(),B(n,1,1,()=>{n=null}),ze()),131072&o[0]&&Mt(e,"transform",i[17])},i(i){r||(I(n),r=!0)},o(i){B(n),r=!1},d(i){i&&J(e),n&&n.d()}}}function KS(t){let e,r,n;function i(a){t[170](a)}let o={hasHeader:t[21],$$slots:{footer:[qS],main:[US],header:[jS]},$$scope:{ctx:t}};return t[16]!==void 0&&(o.root=t[16]),e=new Tl({props:o}),jr.push(()=>Ro(e,"root",i)),e.$on("measure",t[171]),{c(){Ht(e.$$.fragment)},m(a,s){Vt(e,a,s),n=!0},p(a,s){const l={};2097152&s[0]&&(l.hasHeader=a[21]),2145320958&s[0]|3&s[1]|1024&s[7]&&(l.$$scope={dirty:s,ctx:a}),!r&&65536&s[0]&&(r=!0,l.root=a[16],No(()=>r=!1)),e.$set(l)},i(a){n||(I(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){Nt(e,a)}}}const JS=1,QS=0,Z$=(t,e)=>t.target===e;function t6(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,E,C,z,V,L,y,ct,j,k,N,nt,ft,xt,H,Z,wt,vt,et,Pt,Et,kt,st,Ut,rt,X,q,Ft,zt,yt,Dt,Wt,at,St,pt,Xt,Zt,ie,gt,te,xe,_,Kt,qt,le,de,Oe,rr,Ct,pe,ar,Ke,Qe,Re,Je,ur=qe,$r=()=>(ur(),ur=Hi(zr,F=>r(13,nt=F)),zr);t.$$.on_destroy.push(()=>ur());let{isActive:zr}=e;$r();let{stores:Dr}=e,{cropImageSelectionCornerStyle:dr="circle"}=e,{cropWillRenderImageSelectionGuides:Y=(F,oe)=>{const Ie=F=="rotate";return{rows:Ie?5:3,cols:Ie?5:3,opacity:.25*oe}}}=e,{cropAutoCenterImageSelectionTimeout:it}=e,{cropEnableZoomMatchImageAspectRatio:G=!0}=e,{cropEnableRotateMatchImageAspectRatio:Bt="never"}=e,{cropEnableRotationInput:ae=!0}=e,{cropEnableZoom:De=!0}=e,{cropEnableZoomInput:we=!0}=e,{cropEnableZoomAutoHide:Ot=!0}=e,{cropEnableImageSelection:Ce=!0}=e,{cropEnableInfoIndicator:nr=!1}=e,{cropEnableZoomTowardsWheelPosition:lr=!0}=e,{cropEnableLimitWheelInputToCropSelection:ot=!0}=e,{cropEnableCenterImageSelection:Yt=!0}=e,{cropEnableButtonRotateLeft:Ve=!0}=e,{cropEnableButtonRotateRight:Se=!1}=e,{cropEnableButtonFlipHorizontal:ee=!0}=e,{cropEnableButtonFlipVertical:Xe=!1}=e,{cropSelectPresetOptions:Be}=e,{cropEnableSelectPreset:yr=!0}=e,{cropEnableFilterMatchAspectRatio:$t=!0}=e,{cropSelectPresetFilter:Ae=!1}=e,{cropEnableButtonToggleCropLimit:Gt=!1}=e,{cropWillRenderTools:me=tn}=e,{cropWillRenderInfoIndicator:he}=e,{cropActiveTransformTool:er="rotation"}=e,{cropMinimizeToolbar:Er="auto"}=e,{cropInteractionFocus:fe="image"}=e,{cropRotationRange:Cr=ua}=e,{cropMaskOpacity:Mr=.85}=e,{locale:ir={}}=e,{cropFormatIconSelectPreset:en=function(F){const{aspectRatio:oe}=F,[Ie,xr,Nr]=oe?[oe<1?1:.3,oe===1?.85:.5,oe>1?1:.3]:[.2,.3,.4];return{a:Ie,b:xr,c:Nr}}}=e,{cropFormatIconCropBoundary:ye=function(F){const{isBoundToImage:oe}=F,[Ie,xr,Nr,Wr]=oe?[.3,1,0,0]:[0,0,.3,1];return{a:Ie,b:xr,c:Nr,d:Wr}}}=e;const tr=$n("isAnimated");D(t,tr,F=>r(144,ft=F));const je=$n("elasticityMultiplier");D(t,je,F=>r(27,pe=F));const pn=$n("redrawTrigger");D(t,pn,F=>r(165,Ct=F));const wn=$n("imageIsStatic");D(t,wn,F=>r(150,Pt=F));const sn=$n("imageStaticVisualCorners");D(t,sn,F=>r(187,_=F));const Xr=$n("fixScrollDirection");D(t,Xr,F=>r(181,pt=F));let hn="idle";const li=ge();D(t,li,F=>r(162,de=F));const kn=()=>te===void 0,Ci=F=>1/F,Uo=F=>{$t&&Ae!==F&&(r(97,Ae=F),te&&te!==1&&pi()&&(It(Pn,te=Ci(te),te),Br.write()))},pi=()=>{if(te===1||!n)return!1;const F=Ci(te);return!!_s(de).find(([oe])=>oe===F)},xn=(F,oe,Ie)=>Xa(Ie)?oe.width===Math.round(F.height)||oe.height===Math.round(F.width):oe.width===Math.round(F.width)||oe.height===Math.round(F.height),na=()=>(kn()||Bt==="always"&&pi())&&((F,oe,Ie)=>{const xr=La(Vy(so(oe),Ie),or=>Math.abs(Math.round(or))),Nr=xl(xr),Wr=Lr(F);return zs(Nr,Wr)})(kt,Dt,Wt)&&xn(kt,Dt,Wt),Vn=F=>{if(Bt!=="never"&&na()){It(ii,Wt+=F,Wt);const oe=Xa(Wt),Ie=oe?Dt.height:Dt.width,xr=oe?Dt.width:Dt.height;It(oi,kt=Wn(0,0,Ie,xr),kt),kn()||It(Pn,te=ca(Ie,xr),te)}else It(ii,Wt+=F,Wt)},{history:Br,env:xa,isInteracting:Zn,isInteractingFraction:ci,isTransformingImage:Ln,rootRect:ui,stageRect:hi,utilRect:Xn,utilRectPadded:Tn,rootLineColor:mi,allowPan:Go,allowZoom:Io,allowPlayPause:Eo,rangeInputElasticity:xo,presentationScalar:Ao,utilTools:vo,imagePreviewModifiers:lo,imageOutlineOpacity:Bi,imageFlipX:co,imageFlipY:Zi,imageRotation:ii,imageRotationRange:ei,imageOutputSize:Oi,imageSelectionRect:uo,imageSelectionRectSnapshot:Yr,imageSelectionRectIntent:Nn,imageSelectionRectPresentation:to,imageCropRectIntent:Cn,imageCropRectOrigin:wo,imageCropRect:oi,imageCropMinSize:Zo,imageCropMaxSize:Wi,imageCropRange:So,imageCropAspectRatio:Pn,imageCropLimitToImage:_i,imageSize:fn,imageScalar:Yn,imageOverlayMarkup:Lo,stagePadded:Fo,stageRecenter:eo}=Dr;function Xi(F,oe){return Vr(F.cropIconSelectPreset)?Fi(F.cropIconSelectPreset,F,oe):Ws(F.cropIconSelectPreset,en({aspectRatio:oe}),"{","}")}function ko(F,oe){return Vr(F.cropIconCropBoundary)?Fi(F.cropIconCropBoundary,F,oe):Ws(F.cropIconCropBoundary,ye({isBoundToImage:oe}),"{","}")}let wi;D(t,xa,F=>r(145,xt=F)),D(t,Zn,F=>r(149,et=F)),D(t,Ln,F=>r(179,zt=F)),D(t,ui,F=>r(26,Xt=F)),D(t,hi,F=>r(157,Ft=F)),D(t,Tn,F=>r(14,rt=F)),D(t,Ao,F=>r(154,Ut=F)),D(t,vo,F=>r(189,qt=F)),D(t,lo,F=>r(178,wt=F)),D(t,co,F=>r(164,rr=F)),D(t,Zi,F=>r(163,Oe=F)),D(t,ii,F=>r(15,Wt=F)),D(t,ei,F=>r(28,ar=F)),D(t,Oi,F=>r(151,Et=F)),D(t,uo,F=>r(156,q=F)),D(t,Yr,F=>r(155,X=F)),D(t,Nn,F=>r(188,Kt=F)),D(t,to,F=>r(148,vt=F)),D(t,Cn,F=>r(182,Zt=F)),D(t,wo,F=>r(184,gt=F)),D(t,oi,F=>r(152,kt=F)),D(t,Zo,F=>r(160,St=F)),D(t,Wi,F=>r(186,xe=F)),D(t,So,F=>r(183,ie=F)),D(t,Pn,F=>r(185,te=F)),D(t,_i,F=>r(159,at=F)),D(t,fn,F=>r(158,Dt=F)),D(t,Yn,F=>r(153,st=F)),D(t,Fo,F=>r(147,Z=F));const po=(F,oe)=>{const Ie={target:F,translate:oe},xr=md(so(St),Ut),Nr=md(so(xe),Ut);let Wr=O$(X,Ie,{...rt,x:0,y:0},{aspectRatio:te,minSize:xr,maxSize:Nr});if(Wr=((Sr,qr,Pr)=>{const[Jr,Hn,Sn,Rn]=vl(Sr),_r={...Sr};if(Jr<qr.y&&(Sr.height=Sr.height-(qr.y-Jr),Sr.y=qr.y),Hn>qr.x+qr.width&&(Sr.width=qr.x+qr.width-Sr.x),Sn>qr.y+qr.height&&(Sr.height=qr.y+qr.height-Sr.y),Rn<qr.x&&(Sr.width=Sr.width-(qr.x-Rn),Sr.x=qr.x),Pr){const Mi=Math.min(1,_r.width/Sr.width,_r.height/Sr.height);return yl(_r,Mi)}return Sr})(Wr,{...rt,x:0,y:0},te),!at)return{boundsLimited:Wr,boundsIntent:Wr};let or=NS(X,Wr,Ie,_,{aspectRatio:te,minSize:xr,maxSize:Nr});return{boundsLimited:or,boundsIntent:or}},To=(F,oe)=>{const Ie={target:F,translate:oe},xr=md(so(St),Ut),Nr=md(so(xe),Ut),Wr=((or,Sr,qr={})=>{const{target:Pr,translate:Jr}=Sr,{aspectRatio:Hn,minSize:Sn}=qr,Rn=nu[L0[Pr]],_r=jn(Fr(or),lt(Rn[0]*or.width,Rn[1]*or.height)),Mi=nu[Pr],ia=jn(Fr(or),lt(Mi[0]*or.width,Mi[1]*or.height)),[qs,Cs,rs,Oa,Wa,ns,va]=F0(Pr);let Co=Jr.x,_a=Jr.y;Wa?_a=0:ns&&(Co=0);let[vn,ro,Gr,no]=vl(or);if(qs?no=_r.x:Cs&&(ro=_r.x),Oa?vn=_r.y:rs&&(Gr=_r.y),qs?ro=ia.x+Co:Cs&&(no=ia.x+Co),Oa?Gr=ia.y+_a:rs&&(vn=ia.y+_a),Sn&&Wa&&Gr-vn<Sn.height){const ln=Sn.height-(Gr-vn);vn-=.5*ln,Gr+=.5*ln}if(Sn&&ns&&ro-no<Sn.width){const ln=Sn.width-(ro-no);no-=.5*ln,ro+=.5*ln}if(Hn)if(va){let ln=ro-no,fo=Gr-vn;Wa?(fo=ln/Hn,vn=_r.y-.5*fo,Gr=_r.y+.5*fo):ns&&(ln=fo*Hn,no=_r.x-.5*ln,ro=_r.x+.5*ln)}else{const ln=lt(ia.x+Co-_r.x,ia.y+_a-_r.y);Pr===fa?(ln.x=Math.max(0,ln.x),ln.y=Math.min(0,ln.y)):Pr===ga?(ln.x=Math.max(0,ln.x),ln.y=Math.max(0,ln.y)):Pr===$a?(ln.x=Math.min(0,ln.x),ln.y=Math.max(0,ln.y)):Pr===ma&&(ln.x=Math.min(0,ln.x),ln.y=Math.min(0,ln.y));const fo=Bs(ln),wa=lt(Hn,1),Yi=ji(yo(wa),fo);Pr===fa?(ro=_r.x+Yi.x,vn=_r.y-Yi.y):Pr===ga?(ro=_r.x+Yi.x,Gr=_r.y+Yi.y):Pr===$a?(no=_r.x-Yi.x,Gr=_r.y+Yi.y):Pr===ma&&(no=_r.x-Yi.x,vn=_r.y-Yi.y)}return Wn(no,vn,ro-no,Gr-vn)})(X,Ie,{aspectRatio:te,minSize:xr});return{boundsLimited:O$(X,Ie,{...rt,x:0,y:0},{aspectRatio:te,minSize:xr,maxSize:Nr}),boundsIntent:Wr}};let O,Qt;const Ar=({translation:F,scalar:oe})=>{Pt&&(oe=1,F=Kl(He(F)));const Ie=Math.min(q.width/kt.width,q.height/kt.height),xr=ji(He(F),1/Ie);let Nr;if(Qt){const Wr=Un(He(Qt),F);Qt=F,Nr=da(Fr(kt),Wr)}else Nr=da(Fr(O),Kl(He(xr))),oe!==void 0&&Ei(Nr,1/oe);It(Cn,Zt=Nr,Zt),It(oi,kt=Nr,kt)},Ue=Hr([So,oi],([F,oe],Ie)=>{if(!oe)return;const[xr,Nr]=F,Wr=$i(oe);Ie([bl(ta(Zs(xr,Wr),mr)),bl(ta(Ki(Nr,Wr),mr))])});D(t,Ue,F=>r(180,yt=F));const be=Hr([fn,_i,Zo,Wi,So,ii],([F,oe,Ie,xr,Nr,Wr],or)=>{if(!F)return;const Sr=Nr[0],qr=Nr[1];let Pr,Jr;oe?(Pr=((Hn,Sn,Rn)=>Xa(Rn)?1-1/Math.min(Hn.height/Sn.width,Hn.width/Sn.height):1-1/Math.min(Hn.width/Sn.width,Hn.height/Sn.height))(F,qr,Wr),Jr=Math.min(Sr.width/Ie.width,Sr.height/Ie.height)):(Pr=-1,Jr=1),or([Pr,Jr].map(Hn=>mr(Hn)))});D(t,be,F=>r(29,Ke=F));const $e=Hr([fn,oi,So,ii],([F,oe,Ie,xr],Nr)=>{if(!F||!oe)return Nr(0);let Wr;const or=Ie[0],Sr=Ie[1],qr=oe.width,Pr=oe.height,Jr=$i(oe),Hn=Xa(xr)?An(F.height,F.width):F,Sn=Ki(Hn,Jr);if(qr<=Sn.width||Pr<=Sn.height){const Rn=Sn.width-or.width,_r=Sn.height-or.height;Wr=Rn===0||_r===0?1:1-Math.min((qr-or.width)/Rn,(Pr-or.height)/_r)}else{const Rn=Sr.width-Sn.width,_r=Sr.height-Sn.height,Mi=Ki({width:Rn,height:_r},Jr);Wr=-Math.min((qr-Sn.width)/Mi.width,(Pr-Sn.height)/Mi.height)}Nr(Wr)});D(t,$e,F=>r(30,Qe=F));const Kr=F=>{const oe=$i(O);let Ie,xr,Nr;const Wr=Xa(Wt)?An(Dt.height,Dt.width):Dt,or=Ki(Wr,oe);if(F>=0){const Pr=or.width-ie[0].width,Jr=or.height-ie[0].height;Ie=or.width-Pr*F,xr=or.height-Jr*F,Nr=Zs({width:Ie,height:xr},oe)}else{const Pr=ie[1].width-or.width,Jr=ie[1].height-or.height;Ie=or.width+Pr*-F,xr=or.height+Jr*-F,Nr=Ki({width:Ie,height:xr},oe)}Ie=Nr.width,xr=Nr.height;const Sr=O.x+.5*O.width-.5*Ie,qr=O.y+.5*O.height-.5*xr;It(oi,kt={x:Sr,y:qr,width:Ie,height:xr},kt)};let Ir;const rn=F=>{const oe=Ei(Fr(Ir),1/F);It(Cn,Zt=oe,Zt),It(oi,kt=oe,kt)};let bn;const Or=()=>{eo.set({})};let Si;const ho=hr(0,{precision:1e-4});D(t,ho,F=>r(31,Re=F));const Ze=hr();D(t,Ze,F=>r(32,Je=F));const Xo=Hr([Pn,Oi,li],([F,oe,Ie],xr)=>{if(!n)return;const Nr=_s(Ie),Wr=[...Nr].map(or=>or[0]).sort((or,Sr)=>En(or[0])&&!En(Sr[0])?1:-1).find(or=>{if(En(or)&&oe){const[Sr,qr]=or,Pr=oe.width===Sr&&oe.height===qr,Jr=F===ca(Sr,qr);return Pr&&Jr}return or===F});if(!Wr)return xr(void 0);xr(Nr.map(or=>or[0]).findIndex(or=>En(or)?ys(or,Wr):or===Wr))});D(t,Xo,F=>r(161,le=F));const Vi=(F,oe)=>{if(!n||F===-1||F===void 0)return;const Ie=_s(oe)[F][0];return Ie?En(Ie)?ca(Ie[0],Ie[1]):Ie:void 0},Da=Hr([mi,to,ci],([F,oe,Ie],xr)=>{const{rows:Nr,cols:Wr,opacity:or}=Y(hn,Ie);if(!oe||or<=0)return xr([]);const{x:Sr,y:qr,width:Pr,height:Jr}=oe,Hn=Pr/Wr,Sn=Jr/Nr,Rn=[];for(let _r=1;_r<=Nr-1;_r++){const Mi=qr+Sn*_r;Rn.push({id:"image-selection-guide-row-"+_r,points:[lt(Sr,Mi),lt(Sr+Pr,Mi)],opacity:or,strokeWidth:1,strokeColor:F})}for(let _r=1;_r<=Wr-1;_r++){const Mi=Sr+Hn*_r;Rn.push({id:"image-selection-guide-col-"+_r,points:[lt(Mi,qr),lt(Mi,qr+Jr)],opacity:or,strokeWidth:1,strokeColor:F})}xr(Rn)});D(t,Da,F=>r(146,H=F));const Yo="crop-"+ra();let gn,Fn=Yo+"-"+(ae?er:"zoom"),mo=Fn,zo;const Ba=hr(ft?20:0);return D(t,Ba,F=>r(143,N=F)),t.$$set=F=>{"isActive"in F&&$r(r(0,zr=F.isActive)),"stores"in F&&r(99,Dr=F.stores),"cropImageSelectionCornerStyle"in F&&r(1,dr=F.cropImageSelectionCornerStyle),"cropWillRenderImageSelectionGuides"in F&&r(100,Y=F.cropWillRenderImageSelectionGuides),"cropAutoCenterImageSelectionTimeout"in F&&r(101,it=F.cropAutoCenterImageSelectionTimeout),"cropEnableZoomMatchImageAspectRatio"in F&&r(102,G=F.cropEnableZoomMatchImageAspectRatio),"cropEnableRotateMatchImageAspectRatio"in F&&r(103,Bt=F.cropEnableRotateMatchImageAspectRatio),"cropEnableRotationInput"in F&&r(104,ae=F.cropEnableRotationInput),"cropEnableZoom"in F&&r(2,De=F.cropEnableZoom),"cropEnableZoomInput"in F&&r(105,we=F.cropEnableZoomInput),"cropEnableZoomAutoHide"in F&&r(106,Ot=F.cropEnableZoomAutoHide),"cropEnableImageSelection"in F&&r(107,Ce=F.cropEnableImageSelection),"cropEnableInfoIndicator"in F&&r(108,nr=F.cropEnableInfoIndicator),"cropEnableZoomTowardsWheelPosition"in F&&r(109,lr=F.cropEnableZoomTowardsWheelPosition),"cropEnableLimitWheelInputToCropSelection"in F&&r(110,ot=F.cropEnableLimitWheelInputToCropSelection),"cropEnableCenterImageSelection"in F&&r(111,Yt=F.cropEnableCenterImageSelection),"cropEnableButtonRotateLeft"in F&&r(112,Ve=F.cropEnableButtonRotateLeft),"cropEnableButtonRotateRight"in F&&r(113,Se=F.cropEnableButtonRotateRight),"cropEnableButtonFlipHorizontal"in F&&r(114,ee=F.cropEnableButtonFlipHorizontal),"cropEnableButtonFlipVertical"in F&&r(115,Xe=F.cropEnableButtonFlipVertical),"cropSelectPresetOptions"in F&&r(116,Be=F.cropSelectPresetOptions),"cropEnableSelectPreset"in F&&r(117,yr=F.cropEnableSelectPreset),"cropEnableFilterMatchAspectRatio"in F&&r(118,$t=F.cropEnableFilterMatchAspectRatio),"cropSelectPresetFilter"in F&&r(97,Ae=F.cropSelectPresetFilter),"cropEnableButtonToggleCropLimit"in F&&r(119,Gt=F.cropEnableButtonToggleCropLimit),"cropWillRenderTools"in F&&r(120,me=F.cropWillRenderTools),"cropWillRenderInfoIndicator"in F&&r(121,he=F.cropWillRenderInfoIndicator),"cropActiveTransformTool"in F&&r(122,er=F.cropActiveTransformTool),"cropMinimizeToolbar"in F&&r(123,Er=F.cropMinimizeToolbar),"cropInteractionFocus"in F&&r(124,fe=F.cropInteractionFocus),"cropRotationRange"in F&&r(3,Cr=F.cropRotationRange),"cropMaskOpacity"in F&&r(125,Mr=F.cropMaskOpacity),"locale"in F&&r(4,ir=F.locale),"cropFormatIconSelectPreset"in F&&r(126,en=F.cropFormatIconSelectPreset),"cropFormatIconCropBoundary"in F&&r(127,ye=F.cropFormatIconCropBoundary)},t.$$.update=()=>{8192&t.$$.dirty[0]|1&t.$$.dirty[4]&&wn.set(fe==="selection"&&nt),8388608&t.$$.dirty[3]&&r(134,n=Be&&Array.isArray(Be)&&Be.length),8388608&t.$$.dirty[3]|1024&t.$$.dirty[4]&&li.set(n?Be:[]),8192&t.$$.dirty[0]|1048576&t.$$.dirty[4]&&nt&&Bi.set(1,{hard:!ft}),8192&t.$$.dirty[0]&&Go.set(!nt),8192&t.$$.dirty[0]&&Io.set(!nt),8192&t.$$.dirty[0]&&nt&&Eo.set(!0),2097152&t.$$.dirty[4]&&r(129,h=xt.layoutMode==="overlay"),16777216&t.$$.dirty[3]|32&t.$$.dirty[4]&&r(133,E=yr&&!h),16384&t.$$.dirty[0]|2&t.$$.dirty[5]&&r(142,l=rt&&q&&Bd(rt,q)),262144&t.$$.dirty[4]|2&t.$$.dirty[5]&&r(140,c=!(!q||!l)),327680&t.$$.dirty[4]|2&t.$$.dirty[5]&&r(138,u=c&&pa(q,l,F=>mr(F,5))),32784&t.$$.dirty[0]|209190928&t.$$.dirty[3]|2115072&t.$$.dirty[4]|2040&t.$$.dirty[5]&&r(12,i=Ct&&me([Ve&&["Button","rotate-left",{label:ir.cropLabelButtonRotateLeft,labelClass:"PinturaToolbarContentWide",icon:ir.cropIconButtonRotateLeft,onclick:()=>{Vn(-Math.PI/2),Br.write()}}],Se&&["Button","rotate-right",{label:ir.cropLabelButtonRotateRight,labelClass:"PinturaToolbarContentWide",icon:ir.cropIconButtonRotateRight,onclick:()=>{Vn(Math.PI/2),Br.write()}}],ee&&["Button","flip-horizontal",{label:ir.cropLabelButtonFlipHorizontal,labelClass:"PinturaToolbarContentWide",icon:ir.cropIconButtonFlipHorizontal,onclick:()=>{Xa(Wt)?It(Zi,Oe=!Oe,Oe):It(co,rr=!rr,rr),Br.write()}}],Xe&&["Button","flip-vertical",{label:ir.cropLabelButtonFlipVertical,labelClass:"PinturaToolbarContentWide",icon:ir.cropIconButtonFlipVertical,onclick:()=>{Xa(Wt)?It(co,rr=!rr,rr):It(Zi,Oe=!Oe,Oe),Br.write()}}],E&&n&&[Ae===!1?"Dropdown":VS,"select-preset",{icon:Xi(ir,Vi(le,de)),label:Fi(ir.cropLabelSelectPreset,ir,Vi(le,de)),labelClass:"PinturaToolbarContentWide",options:de,filter:Ae,onfilterchange:Uo,selectedIndex:le,onchange:({value:F})=>{En(F)?(It(Pn,te=ca(F[0],F[1]),te),It(Oi,Et=_y(F),Et)):It(Pn,te=F,te),u&&Or(),Br.write()},optionMapper:F=>{let oe=!1;const Ie=En(F.value)?F.value[0]/F.value[1]:F.value;if(Ie){const xr=ql(Dt,Wt,Ie);oe=xr.width<St.width||xr.height<St.height}return F.icon=((xr,Nr={})=>{const{width:Wr=24,height:or=24,bounds:Sr=16,radius:qr=3}=Nr;let Pr,Jr,Hn,Sn,Rn=En(xr)?ca(xr[0],xr[1]):xr,_r=!!Rn;return Rn=_r?Rn:1,Hn=Rn>1?Sr:Rn*Sr,Sn=Hn/Rn,Pr=Math.round(.5*(Wr-Hn)),Jr=Math.round(.5*(or-Sn)),`<rect fill="${_r?"currentColor":"none"}" stroke="${_r?"none":"currentColor"}" stroke-width="${Wr/16}" stroke-dasharray="${[Wr/12,Wr/6].join(" ")}" x="${Pr}" y="${Jr}" width="${Hn}" height="${Sn}" rx="${qr}"/>`})(F.value,{bounds:14}),{...F,disabled:oe}}}],Gt&&["Dropdown","select-crop-limit",{icon:ko(ir,at),label:ir.cropLabelCropBoundary,labelClass:"PinturaToolbarContentWide",onchange:({value:F})=>{It(_i,at=F,at),Br.write()},options:[[!0,ir.cropLabelCropBoundaryEdge,{icon:ko(ir,!0)}],[!1,ir.cropLabelCropBoundaryNone,{icon:ko(ir,!1)}]]}]].filter(Boolean),xt,()=>pn.set({})).filter(Boolean)),12288&t.$$.dirty[0]|1073741824&t.$$.dirty[3]|2097184&t.$$.dirty[4]&&It(vo,qt=nt&&Er!=="never"&&(Er==="always"||xt.verticalSpace==="short"||h)?i.map(([F,oe,Ie])=>Array.isArray(Ie)?[F,oe,Ie]:[F,oe,{...Ie,hideLabel:!0}]):[],qt),16&t.$$.dirty[5]&&r(25,o=at?0:-1),16384&t.$$.dirty[0]|4&t.$$.dirty[5]&&r(135,a=rt&&lt(-(Ft.x-rt.x),-(Ft.y-rt.y))),16779264&t.$$.dirty[4]&&r(136,s=vt&&a&&lt(du(vt.x+.5*vt.width+a.x),du(vt.y+.5*vt.height+a.y))),1&t.$$.dirty[5]&&r(139,d=X!=null),16384&t.$$.dirty[0]|262144&t.$$.dirty[4]&&r(141,p=rt&&l&&(l.height===rt.height||l.width===rt.width)),1610743808&t.$$.dirty[4]&&r(137,f=!p&&Ut<1&&st<1),122880&t.$$.dirty[4]&&r(9,g=c&&!d&&(!u||f)),32768&t.$$.dirty[3]|268435488&t.$$.dirty[4]&&r(11,$=nr&&!!kt&&!h),268435456&t.$$.dirty[3]&&r(24,b=!!he||void 0),2048&t.$$.dirty[0]|268435456&t.$$.dirty[3]|402653184&t.$$.dirty[4]&&r(23,v=$&&he?he(kt,Et):$&&function(F,oe){let Ie={};if(oe){const xr=F.width/F.height;oe.width&&!oe.height&&(Ie=An(oe.width,oe.width/xr)),oe.height&&!oe.width&&(Ie=An(oe.height*xr,oe.height)),Ie=so(oe)}else Ie=An(F.width,F.height);return`${Math.round(Ie.width)} &times; ${Math.round(Ie.height)}`}(kt,Et)),16779264&t.$$.dirty[4]&&r(8,P=vt&&a&&{x:vt.x+a.x,y:vt.y+a.y,width:vt.width,height:vt.height}),256&t.$$.dirty[0]|16384&t.$$.dirty[3]|32&t.$$.dirty[4]&&r(22,w=Ce&&!!P&&!h),262400&t.$$.dirty[3]|67112960&t.$$.dirty[4]&&r(10,S=Yt&&!!s&&!it&&!Pt),512&t.$$.dirty[0]|256&t.$$.dirty[3]|33554448&t.$$.dirty[4]&&g&&it&&!et&&(clearTimeout(Si),r(128,Si=setTimeout(Or,it))),33554448&t.$$.dirty[4]&&et&&clearTimeout(Si),1536&t.$$.dirty[0]|1048576&t.$$.dirty[4]&&ho.set(S&&g?1:0,{hard:ft===!1}),1052672&t.$$.dirty[4]&&Ze.set(s,{hard:ft===!1}),8192&t.$$.dirty[0]|8388608&t.$$.dirty[4]&&(nt&&!Z?(It(lo,wt.crop={maskOpacity:Mr,maskMarkupOpacity:Mr},wt),lo.set(wt)):(delete wt.crop,lo.set(wt))),4194304&t.$$.dirty[4]&&H&&Lo.update(F=>{const oe=F.filter(Ie=>!/^image\-selection\-guide/.test(Ie.id));return nt?[...oe,...H]:oe}),2097152&t.$$.dirty[4]&&r(132,M=xt.verticalSpace!=="short"),1073741824&t.$$.dirty[3]|288&t.$$.dirty[4]&&r(21,C=Er==="never"&&!h||M&&Er!=="always"),4&t.$$.dirty[0]|4096&t.$$.dirty[3]&&r(131,z=De&&we),8192&t.$$.dirty[3]|384&t.$$.dirty[4]&&r(130,V=Ot?M&&z:z),2048&t.$$.dirty[3]|64&t.$$.dirty[4]&&r(20,L=ae||V),64&t.$$.dirty[4]&&(V||r(5,mo=Fn)),32&t.$$.dirty[0]&&r(19,y={name:Yo,selected:mo}),16&t.$$.dirty[0]|2048&t.$$.dirty[3]|64&t.$$.dirty[4]&&r(7,ct=[ae&&{id:Yo+"-rotation",label:ir.cropLabelTabRotation},V&&{id:Yo+"-zoom",label:ir.cropLabelTabZoom}].filter(Boolean)),128&t.$$.dirty[0]&&r(18,j=ct.map(F=>F.id)),64&t.$$.dirty[0]|32&t.$$.dirty[4]&&gn&&!gn.children.length&&h&&gn.dispatchEvent(new CustomEvent("measure",{detail:gn.rect})),8192&t.$$.dirty[0]|1048576&t.$$.dirty[4]&&ft&&Ba.set(nt?0:20),524288&t.$$.dirty[4]&&r(17,k=N?`translateY(${N}px)`:"none")},[zr,dr,De,Cr,ir,mo,gn,ct,P,g,S,$,i,nt,rt,Wt,zo,k,j,y,L,C,w,v,b,o,Xt,pe,ar,Ke,Qe,Re,Je,tr,je,pn,wn,sn,Xr,li,xa,Zn,Ln,ui,hi,Tn,xo,Ao,vo,lo,co,Zi,ii,ei,Oi,uo,Yr,Nn,to,Cn,wo,oi,Zo,Wi,So,Pn,_i,fn,Yn,Fo,()=>{hn="select",It(Zn,et=!0,et),It(Yr,X=Fr(q),X),wi=Pt?po:To},({detail:F})=>{const{boundsLimited:oe,boundsIntent:Ie}=wi(F.direction,F.translation);It(Ln,zt=!0,zt),It(Nn,Kt=Ie,Kt),It(uo,q=oe,q)},({detail:F})=>{const{boundsLimited:oe}=wi(F.direction,F.translation);It(Ln,zt=!1,zt),It(Zn,et=!1,et),It(Nn,Kt=void 0,Kt),Bs(F.translation)&&(It(uo,q=oe,q),Br.write()),It(Yr,X=void 0,X),hn=void 0},()=>{hn="rotate",It(Zn,et=!0,et),It(wo,gt=Fr(kt),gt)},F=>{It(Ln,zt=!0,zt),It(ii,Wt=F,Wt)},F=>{It(Ln,zt=!1,zt),It(Zn,et=!1,et),It(ii,Wt=F,Wt),Br.write(),It(wo,gt=void 0,gt)},()=>{hn="pan",Qt=void 0,It(Zn,et=!0,et),O=Fr(kt)},({detail:F})=>{It(Ln,zt=!0,zt),Ar(F)},({detail:F})=>{It(Ln,zt=!1,zt),It(Zn,et=!1,et),(Bs(F.translation)>0||F.scalar!==0)&&(Ar(F),Br.write()),It(Cn,Zt=void 0,Zt),O=void 0},({detail:{translation:F}})=>{Pt&&(F=Kl(He(F))),Qt=F,It(Zn,et=!1,et)},Ue,be,$e,()=>{hn="zoom",It(Zn,et=!0,et),O=Fr(kt)},F=>{It(Ln,zt=!1,zt),Kr(F)},F=>{Kr(F),Br.write(),It(Ln,zt=!1,zt),It(Zn,et=!1,et),O=void 0},()=>{hn="zoom",O||(Ir=Fr(kt),It(Zn,et=!0,et))},({detail:F})=>{Ir&&(It(Ln,zt=!0,zt),rn(F))},({detail:F})=>{Ir&&(It(Ln,zt=!1,zt),It(Zn,et=!1,et),rn(F),It(Cn,Zt=void 0,Zt),Ir=void 0,Br.write())},F=>{const oe=W1(F,Xt,Ft);if(ot&&!Zd(q,oe))return;hn="zoom",It(Zn,et=!0,et),It(Ln,zt=!0,zt),F.preventDefault(),F.stopPropagation();const Ie=yu(F,{fixScrollDirection:pt}),xr=1+Ie/100,Nr=Fr(kt),Wr=Math.min(kt.width/St.width,kt.height/St.height)===1;if(G&&at){const qr=xn(kt,Dt,Wt);if(kn()&&qr&&Ie>0&&u){It(Zn,et=!1,et),It(Ln,zt=!1,zt);const Pr=Xa(Wt)?Ui({height:Dt.width,width:Dt.height}):Ui(Dt);return pa(Nr,Pr)||(clearTimeout(bn),pa(Br.state.crop,Pr))?void 0:(It(oi,kt=Pr,kt),void Br.write())}}let or=Lr(kt);if(lr&&fe!=="selection"&&Ie<0&&!Wr){const qr=Un(He(oe),q),Pr=Math.min(q.width/kt.width,q.height/kt.height),Jr=Ei(Fr(q),1.1);or=Zd(Jr,oe)?jn(Fr(kt),ji(qr,1/Pr)):or}let Sr=Ei(Fr(kt),xr,or);if(Gd(yt[1],Sr)||(Sr=Km(Lr(Sr),yt[1])),Gd(Sr,yt[0])||(Sr=Km(Lr(Sr),yt[0])),pa(Nr,Sr,mr))return It(Zn,et=!1,et),void It(Ln,zt=!1,zt);It(oi,kt=ta(Sr,qr=>mr(qr,5)),kt),It(Zn,et=!1,et),It(Ln,zt=!1,zt),clearTimeout(bn),bn=setTimeout(()=>{Br.write()},500)},Or,ho,Ze,Xo,Da,Yo,Ba,Ae,"crop",Dr,Y,it,G,Bt,ae,we,Ot,Ce,nr,lr,ot,Yt,Ve,Se,ee,Xe,Be,yr,$t,Gt,me,he,er,Er,fe,Mr,en,ye,Si,h,V,z,M,E,n,a,s,f,u,d,c,p,l,N,ft,xt,H,Z,vt,et,Pt,Et,kt,st,Ut,X,q,Ft,Dt,at,St,le,de,Oe,rr,Ct,function(F){Ji.call(this,t,F)},({detail:F})=>r(5,mo=F),function(F){jr[F?"unshift":"push"](()=>{gn=F,r(6,gn)})},F=>I0(F),function(F){zo=F,r(16,zo)},function(F){Ji.call(this,t,F)}]}var e6={util:["crop",class extends gr{constructor(t){super(),fr(this,t,t6,KS,cr,{name:98,isActive:0,stores:99,cropImageSelectionCornerStyle:1,cropWillRenderImageSelectionGuides:100,cropAutoCenterImageSelectionTimeout:101,cropEnableZoomMatchImageAspectRatio:102,cropEnableRotateMatchImageAspectRatio:103,cropEnableRotationInput:104,cropEnableZoom:2,cropEnableZoomInput:105,cropEnableZoomAutoHide:106,cropEnableImageSelection:107,cropEnableInfoIndicator:108,cropEnableZoomTowardsWheelPosition:109,cropEnableLimitWheelInputToCropSelection:110,cropEnableCenterImageSelection:111,cropEnableButtonRotateLeft:112,cropEnableButtonRotateRight:113,cropEnableButtonFlipHorizontal:114,cropEnableButtonFlipVertical:115,cropSelectPresetOptions:116,cropEnableSelectPreset:117,cropEnableFilterMatchAspectRatio:118,cropSelectPresetFilter:97,cropEnableButtonToggleCropLimit:119,cropWillRenderTools:120,cropWillRenderInfoIndicator:121,cropActiveTransformTool:122,cropMinimizeToolbar:123,cropInteractionFocus:124,cropRotationRange:3,cropMaskOpacity:125,locale:4,cropFormatIconSelectPreset:126,cropFormatIconCropBoundary:127},null,[-1,-1,-1,-1,-1,-1,-1,-1])}get name(){return this.$$.ctx[98]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),A()}get stores(){return this.$$.ctx[99]}set stores(t){this.$$set({stores:t}),A()}get cropImageSelectionCornerStyle(){return this.$$.ctx[1]}set cropImageSelectionCornerStyle(t){this.$$set({cropImageSelectionCornerStyle:t}),A()}get cropWillRenderImageSelectionGuides(){return this.$$.ctx[100]}set cropWillRenderImageSelectionGuides(t){this.$$set({cropWillRenderImageSelectionGuides:t}),A()}get cropAutoCenterImageSelectionTimeout(){return this.$$.ctx[101]}set cropAutoCenterImageSelectionTimeout(t){this.$$set({cropAutoCenterImageSelectionTimeout:t}),A()}get cropEnableZoomMatchImageAspectRatio(){return this.$$.ctx[102]}set cropEnableZoomMatchImageAspectRatio(t){this.$$set({cropEnableZoomMatchImageAspectRatio:t}),A()}get cropEnableRotateMatchImageAspectRatio(){return this.$$.ctx[103]}set cropEnableRotateMatchImageAspectRatio(t){this.$$set({cropEnableRotateMatchImageAspectRatio:t}),A()}get cropEnableRotationInput(){return this.$$.ctx[104]}set cropEnableRotationInput(t){this.$$set({cropEnableRotationInput:t}),A()}get cropEnableZoom(){return this.$$.ctx[2]}set cropEnableZoom(t){this.$$set({cropEnableZoom:t}),A()}get cropEnableZoomInput(){return this.$$.ctx[105]}set cropEnableZoomInput(t){this.$$set({cropEnableZoomInput:t}),A()}get cropEnableZoomAutoHide(){return this.$$.ctx[106]}set cropEnableZoomAutoHide(t){this.$$set({cropEnableZoomAutoHide:t}),A()}get cropEnableImageSelection(){return this.$$.ctx[107]}set cropEnableImageSelection(t){this.$$set({cropEnableImageSelection:t}),A()}get cropEnableInfoIndicator(){return this.$$.ctx[108]}set cropEnableInfoIndicator(t){this.$$set({cropEnableInfoIndicator:t}),A()}get cropEnableZoomTowardsWheelPosition(){return this.$$.ctx[109]}set cropEnableZoomTowardsWheelPosition(t){this.$$set({cropEnableZoomTowardsWheelPosition:t}),A()}get cropEnableLimitWheelInputToCropSelection(){return this.$$.ctx[110]}set cropEnableLimitWheelInputToCropSelection(t){this.$$set({cropEnableLimitWheelInputToCropSelection:t}),A()}get cropEnableCenterImageSelection(){return this.$$.ctx[111]}set cropEnableCenterImageSelection(t){this.$$set({cropEnableCenterImageSelection:t}),A()}get cropEnableButtonRotateLeft(){return this.$$.ctx[112]}set cropEnableButtonRotateLeft(t){this.$$set({cropEnableButtonRotateLeft:t}),A()}get cropEnableButtonRotateRight(){return this.$$.ctx[113]}set cropEnableButtonRotateRight(t){this.$$set({cropEnableButtonRotateRight:t}),A()}get cropEnableButtonFlipHorizontal(){return this.$$.ctx[114]}set cropEnableButtonFlipHorizontal(t){this.$$set({cropEnableButtonFlipHorizontal:t}),A()}get cropEnableButtonFlipVertical(){return this.$$.ctx[115]}set cropEnableButtonFlipVertical(t){this.$$set({cropEnableButtonFlipVertical:t}),A()}get cropSelectPresetOptions(){return this.$$.ctx[116]}set cropSelectPresetOptions(t){this.$$set({cropSelectPresetOptions:t}),A()}get cropEnableSelectPreset(){return this.$$.ctx[117]}set cropEnableSelectPreset(t){this.$$set({cropEnableSelectPreset:t}),A()}get cropEnableFilterMatchAspectRatio(){return this.$$.ctx[118]}set cropEnableFilterMatchAspectRatio(t){this.$$set({cropEnableFilterMatchAspectRatio:t}),A()}get cropSelectPresetFilter(){return this.$$.ctx[97]}set cropSelectPresetFilter(t){this.$$set({cropSelectPresetFilter:t}),A()}get cropEnableButtonToggleCropLimit(){return this.$$.ctx[119]}set cropEnableButtonToggleCropLimit(t){this.$$set({cropEnableButtonToggleCropLimit:t}),A()}get cropWillRenderTools(){return this.$$.ctx[120]}set cropWillRenderTools(t){this.$$set({cropWillRenderTools:t}),A()}get cropWillRenderInfoIndicator(){return this.$$.ctx[121]}set cropWillRenderInfoIndicator(t){this.$$set({cropWillRenderInfoIndicator:t}),A()}get cropActiveTransformTool(){return this.$$.ctx[122]}set cropActiveTransformTool(t){this.$$set({cropActiveTransformTool:t}),A()}get cropMinimizeToolbar(){return this.$$.ctx[123]}set cropMinimizeToolbar(t){this.$$set({cropMinimizeToolbar:t}),A()}get cropInteractionFocus(){return this.$$.ctx[124]}set cropInteractionFocus(t){this.$$set({cropInteractionFocus:t}),A()}get cropRotationRange(){return this.$$.ctx[3]}set cropRotationRange(t){this.$$set({cropRotationRange:t}),A()}get cropMaskOpacity(){return this.$$.ctx[125]}set cropMaskOpacity(t){this.$$set({cropMaskOpacity:t}),A()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),A()}get cropFormatIconSelectPreset(){return this.$$.ctx[126]}set cropFormatIconSelectPreset(t){this.$$set({cropFormatIconSelectPreset:t}),A()}get cropFormatIconCropBoundary(){return this.$$.ctx[127]}set cropFormatIconCropBoundary(t){this.$$set({cropFormatIconCropBoundary:t}),A()}}]};function r6(t){let e,r,n,i,o,a,s,l=t[77],c=(Vr(t[77].label)?t[77].label(t[2]):t[77].label)+"";function u(...h){return t[51](t[77],...h)}const d=()=>t[52](r,l),p=()=>t[52](null,l);return{c(){e=mt("div"),r=mt("div"),n=ue(),i=mt("span"),o=Mn(c),T(r,"class",Gb),T(e,"slot","option"),T(e,"class","PinturaFilterOption")},m(h,f){tt(h,e,f),Lt(e,r),d(),Lt(e,n),Lt(e,i),Lt(i,o),a||(s=[Tt(r,"measure",u),Tr(Di.call(null,r))],a=!0)},p(h,f){l!==(t=h)[77]&&(p(),l=t[77],d()),4&f[0]|32768&f[2]&&c!==(c=(Vr(t[77].label)?t[77].label(t[2]):t[77].label)+"")&&Gn(o,c)},d(h){h&&J(e),p(),a=!1,Ur(s)}}}function n6(t){let e,r;return e=new ws({props:{locale:t[2],layout:"row",options:t[3],selectedIndex:t[12],onchange:t[32],$$slots:{option:[r6,({option:n})=>({77:n}),({option:n})=>[0,0,n?32768:0]]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};4&i[0]&&(o.locale=n[2]),8&i[0]&&(o.options=n[3]),4096&i[0]&&(o.selectedIndex=n[12]),1028&i[0]|98304&i[2]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function i6(t){let e,r,n,i,o,a,s,l;function c(h){t[54](h)}function u(h){t[55](h)}function d(h){t[56](h)}let p={elasticity:t[13]*t[19],onscroll:t[53],$$slots:{default:[n6]},$$scope:{ctx:t}};return t[4]!==void 0&&(p.maskFeatherStartOpacity=t[4]),t[5]!==void 0&&(p.maskFeatherEndOpacity=t[5]),t[6]!==void 0&&(p.maskFeatherSize=t[6]),r=new za({props:p}),jr.push(()=>Ro(r,"maskFeatherStartOpacity",c)),jr.push(()=>Ro(r,"maskFeatherEndOpacity",u)),jr.push(()=>Ro(r,"maskFeatherSize",d)),r.$on("measure",t[57]),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"slot","footer"),Mt(e,"transform",t[11])},m(h,f){tt(h,e,f),Vt(r,e,null),a=!0,s||(l=[Tt(e,"transitionend",t[30]),Tt(e,"measure",t[58]),Tr(Di.call(null,e,{observePosition:!0}))],s=!0)},p(h,f){const g={};8192&f[0]&&(g.elasticity=h[13]*h[19]),128&f[0]&&(g.onscroll=h[53]),5132&f[0]|65536&f[2]&&(g.$$scope={dirty:f,ctx:h}),!n&&16&f[0]&&(n=!0,g.maskFeatherStartOpacity=h[4],No(()=>n=!1)),!i&&32&f[0]&&(i=!0,g.maskFeatherEndOpacity=h[5],No(()=>i=!1)),!o&&64&f[0]&&(o=!0,g.maskFeatherSize=h[6],No(()=>o=!1)),r.$set(g),2048&f[0]&&Mt(e,"transform",h[11])},i(h){a||(I(r.$$.fragment,h),a=!0)},o(h){B(r.$$.fragment,h),a=!1},d(h){h&&J(e),Nt(r),s=!1,Ur(l)}}}function o6(t){let e,r;return e=new Tl({props:{$$slots:{footer:[i6]},$$scope:{ctx:t}}}),e.$on("measure",t[59]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16380&i[0]|65536&i[2]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}let Gb="PinturaFilterPreview";function a6(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,E=qe,C=()=>(E(),E=Hi(y,Ct=>r(43,u=Ct)),y),z=qe,V=()=>(z(),z=Hi(L,Ct=>r(49,w=Ct)),L);t.$$.on_destroy.push(()=>E()),t.$$.on_destroy.push(()=>z());let{isActive:L}=e;V();let{isActiveFraction:y}=e;C();let{stores:ct}=e,{locale:j}=e,{filterFunctions:k}=e,{filterOptions:N}=e;const nt=$n("elasticityMultiplier");D(t,nt,Ct=>r(13,M=Ct));const{history:ft,interfaceImages:xt,stageRectBase:H,utilRect:Z,animation:wt,scrollElasticity:vt,imageSize:et,imagePreview:Pt,imageCropRect:Et,imageRotation:kt,imageFlipX:st,imageFlipY:Ut,imageBackgroundColor:rt,imageGamma:X,imageColorMatrix:q,allowPan:Ft,allowZoom:zt,allowZoomControls:yt,allowPlayPause:Dt}=ct;D(t,xt,Ct=>r(60,d=Ct)),D(t,H,Ct=>r(48,v=Ct)),D(t,Z,Ct=>r(47,b=Ct)),D(t,wt,Ct=>r(50,S=Ct)),D(t,et,Ct=>r(62,h=Ct)),D(t,Pt,Ct=>r(42,c=Ct)),D(t,rt,Ct=>r(61,p=Ct)),D(t,X,Ct=>r(44,f=Ct)),D(t,q,Ct=>r(40,s=Ct));const Wt=ge({});D(t,Wt,Ct=>r(46,$=Ct));const at=(Ct,pe)=>It(Wt,$[Ct.value]=pe,$),St=Hr(Wt,Ct=>{if(!Ct[void 0])return;const pe=Ct[void 0];return P&&iu(P,pe)?P:so(pe)});D(t,St,Ct=>r(63,P=Ct));const pt=Hr([L,St,Et,et,kt,st,Ut],([Ct,pe,ar,Ke,Qe,Re,Je],ur)=>{if(!Ct||!pe||!Ke)return g;const $r=Ui(Ke),zr=Lr($r),Dr=g0(Ke,ar,Qe),dr=Lr(Dr),Y=Un(He(zr),dr),it=Kl(He(Y)),G=Math.max(pe.width/ar.width,pe.height/ar.height);ur({origin:it,translation:Y,rotation:{x:Je?Math.PI:0,y:Re?Math.PI:0,z:Qe},scale:G})});D(t,pt,Ct=>r(45,g=Ct));const Xt=hr(S?20:0);let Zt;D(t,Xt,Ct=>r(39,a=Ct));const ie={};let gt,te,xe,_,Kt,qt,le={x:0,y:0};const de=ge([]);D(t,de,Ct=>r(41,l=Ct));const Oe=Ct=>{const pe={...Ct,data:c,size:h,offset:{...Ct.offset},mask:{...Ct.mask},backgroundColor:p};return pe.opacity=u,pe.offset.y+=a,pe.mask.y+=a,pe.id="filter",pe},rr=()=>d.filter(Ct=>Ct.id!=="filter");return jo(()=>{xt.set([])}),t.$$set=Ct=>{"isActive"in Ct&&V(r(0,L=Ct.isActive)),"isActiveFraction"in Ct&&C(r(1,y=Ct.isActiveFraction)),"stores"in Ct&&r(34,ct=Ct.stores),"locale"in Ct&&r(2,j=Ct.locale),"filterFunctions"in Ct&&r(35,k=Ct.filterFunctions),"filterOptions"in Ct&&r(3,N=Ct.filterOptions)},t.$$.update=()=>{if(262144&t.$$.dirty[1]&&Ft.set(w),262144&t.$$.dirty[1]&&zt.set(w),262144&t.$$.dirty[1]&&yt.set(w),262144&t.$$.dirty[1]&&w&&Dt.set(!1),8&t.$$.dirty[0]&&r(38,n=_s(N)),640&t.$$.dirty[1]&&r(12,i=((Ct,pe)=>{if(!Ct||!Ct.filter||!pe)return 0;const ar=Ct.filter;return pe.findIndex(([Ke])=>{if(!k[Ke])return!1;const Qe=k[Ke]();return ys(Qe,ar)})})(s,n)),786432&t.$$.dirty[1]&&S&&Xt.set(w?0:20),512&t.$$.dirty[0]|458752&t.$$.dirty[1]&&w&&b&&v&&qt&&r(37,Kt={x:v.x-b.x,y:v.y-b.y+qt.y}),496&t.$$.dirty[0]|58096&t.$$.dirty[1]&&g&&Kt&&le&&_&&Zt){const Ct=Kt.x+_.x+le.x,pe=Kt.y,ar=_.x+Kt.x,Ke=ar+_.width;de.set(n.map(([Qe],Re)=>{const Je=$[Qe],ur=le.x+Je.x,$r=ur+Je.width;if($r<0||ur>_.width)return!1;const zr=Ct+Je.x,Dr=pe+Je.y,dr=(it=>({origin:He(it.origin),translation:He(it.translation),rotation:{...it.rotation},scale:it.scale}))(g);dr.offset=lt(.5*Je.width+zr,.5*Je.height+Dr),dr.maskOpacity=1,dr.mask=Wn(zr+0,Dr,Je.width+0,Je.height),dr.maskFeather=[1,0,1,0,1,Ke,1,Ke],ur<xe&&gt<1&&(dr.maskFeather[0]=gt,dr.maskFeather[1]=ar,dr.maskFeather[2]=1,dr.maskFeather[3]=ar+xe),$r>_.width-xe&&te<1&&(dr.maskFeather[4]=te,dr.maskFeather[5]=Ke-xe,dr.maskFeather[6]=1,dr.maskFeather[7]=Ke),dr.maskCornerRadius=Zt[Qe];let Y=s&&Object.keys(s).filter(it=>it!="filter").map(it=>s[it])||[];return Vr(k[Qe])&&Y.push(k[Qe]()),dr.colorMatrix=Y.length?$u(Y):void 0,dr.gamma=f,dr}).filter(Boolean))}if(7424&t.$$.dirty[1])if(u>0&&l){const Ct=[...rr(),...l.map(Oe)];xt.set(Ct)}else xt.set(rr());256&t.$$.dirty[1]&&r(11,o=a?`translateY(${a}px)`:"none")},[L,y,j,N,gt,te,xe,le,_,qt,ie,o,i,M,nt,xt,H,Z,wt,vt,et,Pt,rt,X,q,Wt,at,St,pt,Xt,Ct=>{Ct.target.className===Gb&&r(36,Zt=Object.keys(ie).reduce((pe,ar)=>{const Ke=ie[ar],Qe=getComputedStyle(Ke),Re=["top-left","top-right","bottom-left","bottom-right"].map(Je=>Qe.getPropertyValue(`border-${Je}-radius`)).map(xb).map(Je=>1.25*Je);return pe[ar]=Re,pe},{}))},de,({value:Ct})=>{It(q,s={...s,filter:Vr(k[Ct])?k[Ct]():void 0},s),ft.write()},"filter",ct,k,Zt,Kt,n,a,s,l,c,u,f,g,$,b,v,w,S,(Ct,pe)=>at(Ct,pe.detail),function(Ct,pe){jr[Ct?"unshift":"push"](()=>{ie[pe.value]=Ct,r(10,ie)})},Ct=>r(7,le=Ct),function(Ct){gt=Ct,r(4,gt)},function(Ct){te=Ct,r(5,te)},function(Ct){xe=Ct,r(6,xe)},Ct=>r(8,_=Ct.detail),Ct=>r(9,qt=Ct.detail),function(Ct){Ji.call(this,t,Ct)}]}var s6={util:["filter",class extends gr{constructor(t){super(),fr(this,t,a6,o6,cr,{name:33,isActive:0,isActiveFraction:1,stores:34,locale:2,filterFunctions:35,filterOptions:3},null,[-1,-1,-1])}get name(){return this.$$.ctx[33]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),A()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),A()}get stores(){return this.$$.ctx[34]}set stores(t){this.$$set({stores:t}),A()}get locale(){return this.$$.ctx[2]}set locale(t){this.$$set({locale:t}),A()}get filterFunctions(){return this.$$.ctx[35]}set filterFunctions(t){this.$$set({filterFunctions:t}),A()}get filterOptions(){return this.$$.ctx[3]}set filterOptions(t){this.$$set({filterOptions:t}),A()}}]};function X$(t){let e,r,n,i;e=new za({props:{elasticity:t[6]*t[9],class:"PinturaControlListScroller",$$slots:{default:[c6]},$$scope:{ctx:t}}});const o=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[4]},t[5]];let a={$$slots:{default:[u6,({panel:s})=>({44:s}),({panel:s})=>[0,s?8192:0]]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=_n(a,o[s]);return n=new hp({props:a}),{c(){Ht(e.$$.fragment),r=ue(),Ht(n.$$.fragment)},m(s,l){Vt(e,s,l),tt(s,r,l),Vt(n,s,l),i=!0},p(s,l){const c={};64&l[0]&&(c.elasticity=s[6]*s[9]),38&l[0]|32768&l[1]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c);const u=48&l[0]?zi(o,[o[0],o[1],16&l[0]&&{panels:s[4]},32&l[0]&&Gi(s[5])]):{};128&l[0]|40960&l[1]&&(u.$$scope={dirty:l,ctx:s}),n.$set(u)},i(s){i||(I(e.$$.fragment,s),I(n.$$.fragment,s),i=!0)},o(s){B(e.$$.fragment,s),B(n.$$.fragment,s),i=!1},d(s){Nt(e,s),s&&J(r),Nt(n,s)}}}function l6(t){let e,r,n=t[45].label+"";return{c(){e=mt("span"),r=Mn(n)},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){16384&o[1]&&n!==(n=i[45].label+"")&&Gn(r,n)},d(i){i&&J(e)}}}function c6(t){let e,r;const n=[{class:"PinturaControlList"},{tabs:t[1]},t[5]];let i={$$slots:{default:[l6,({tab:o})=>({45:o}),({tab:o})=>[0,o?16384:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new pp({props:i}),e.$on("select",t[24]),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=34&a[0]?zi(n,[n[0],2&a[0]&&{tabs:o[1]},32&a[0]&&Gi(o[5])]):{};49152&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){Nt(e,o)}}}function u6(t){let e,r;const n=[t[7][t[44]]];let i={};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new A0({props:i}),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=128&a[0]|8192&a[1]?zi(n,[Gi(o[7][o[44]])]):{};e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){Nt(e,o)}}}function d6(t){let e,r,n=t[5]&&X$(t);return{c(){e=mt("div"),n&&n.c(),T(e,"slot","footer"),Mt(e,"transform",t[3])},m(i,o){tt(i,e,o),n&&n.m(e,null),r=!0},p(i,o){i[5]?n?(n.p(i,o),32&o[0]&&I(n,1)):(n=X$(i),n.c(),I(n,1),n.m(e,null)):n&&(Fe(),B(n,1,1,()=>{n=null}),ze()),8&o[0]&&Mt(e,"transform",i[3])},i(i){r||(I(n),r=!0)},o(i){B(n),r=!1},d(i){i&&J(e),n&&n.d()}}}function p6(t){let e,r;return e=new Tl({props:{$$slots:{footer:[d6]},$$scope:{ctx:t}}}),e.$on("measure",t[25]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};254&i[0]|32768&i[1]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function h6(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g=qe,$=()=>(g(),g=Hi(v,st=>r(21,u=st)),v);t.$$.on_destroy.push(()=>g());let{stores:b}=e,{isActive:v}=e;$();let{locale:w={}}=e,{finetuneControlConfiguration:S}=e,{finetuneOptions:P}=e,{finetuneNudgePrecision:M}=e;const{history:E,animation:C,scrollElasticity:z,rangeInputElasticity:V,imageColorMatrix:L,imageConvolutionMatrix:y,imageGamma:ct,imageVignette:j,imageNoise:k,allowPan:N,allowZoom:nt,allowZoomControls:ft,allowPlayPause:xt}=b;D(t,C,st=>r(22,d=st));const H={imageColorMatrix:L,imageConvolutionMatrix:y,imageGamma:ct,imageVignette:j,imageNoise:k},Z=$n("elasticityMultiplier");D(t,Z,st=>r(6,h=st));const wt="finetune-"+ra(),vt=ge({});D(t,vt,st=>r(23,p=st));const et=ge({});D(t,et,st=>r(7,f=st));const Pt=(st,Ut)=>{st.update(rt=>{const X={};return Ut.forEach(q=>{rt[q]&&(X[q]=rt[q])}),X})};let Et=[];const kt=hr(d?20:0);return D(t,kt,st=>r(20,c=st)),t.$$set=st=>{"stores"in st&&r(15,b=st.stores),"isActive"in st&&$(r(0,v=st.isActive)),"locale"in st&&r(16,w=st.locale),"finetuneControlConfiguration"in st&&r(17,S=st.finetuneControlConfiguration),"finetuneOptions"in st&&r(18,P=st.finetuneOptions),"finetuneNudgePrecision"in st&&r(19,M=st.finetuneNudgePrecision)},t.$$.update=()=>{var st;2097152&t.$$.dirty[0]&&N.set(u),2097152&t.$$.dirty[0]&&nt.set(u),2097152&t.$$.dirty[0]&&ft.set(u),2097152&t.$$.dirty[0]&&u&&xt.set(!0),327680&t.$$.dirty[0]&&r(1,n=P?P.map(([Ut,rt])=>({id:Ut,label:Vr(rt)?rt(w):rt})):[]),2&t.$$.dirty[0]&&r(2,i=n.length?n[0].id:void 0),4&t.$$.dirty[0]&&r(5,o=i&&{name:wt,selected:i}),2&t.$$.dirty[0]&&r(4,a=n.map(Ut=>Ut.id)),131072&t.$$.dirty[0]&&(s=[...Object.keys(S||{}),"filter"]),131072&t.$$.dirty[0]&&S&&(st=S,Et&&Et.forEach(Ut=>Ut()),Et=a.map(Ut=>{const{getStore:rt,getValue:X=tn}=st[Ut];return rt(H).subscribe(q=>{const Ft=q!=null?X(q):q;It(vt,p={...p,[Ut]:Ft},p)})})),8519680&t.$$.dirty[0]&&S&&p&&It(et,f=Object.keys(p).reduce((Ut,rt)=>{const{base:X,min:q,max:Ft,getLabel:zt,getStore:yt,setValue:Dt=(St,pt)=>St.set(pt)}=S[rt],Wt=yt(H),at=p[rt]!=null?p[rt]:X;return Ut[rt]={base:X,min:q,max:Ft,value:at,valueLabel:zt?zt(at,q,Ft,Ft-q):Math.round(100*at),oninputmove:St=>{Dt(Wt,St),Wt===L&&Pt(Wt,s)},oninputend:St=>{Dt(Wt,St),Wt===L&&Pt(Wt,s),E.write()},elasticity:h*V,labelReset:w.labelReset,nudgeMultiplier:M},Ut},{}),f),6291456&t.$$.dirty[0]&&d&&kt.set(u?0:20),1048576&t.$$.dirty[0]&&r(3,l=c?`translateY(${c}px)`:"none")},[v,n,i,l,a,o,h,f,C,z,Z,vt,et,kt,"finetune",b,w,S,P,M,c,u,d,p,({detail:st})=>r(2,i=st),function(st){Ji.call(this,t,st)}]}var m6={util:["finetune",class extends gr{constructor(t){super(),fr(this,t,h6,p6,cr,{name:14,stores:15,isActive:0,locale:16,finetuneControlConfiguration:17,finetuneOptions:18,finetuneNudgePrecision:19},null,[-1,-1])}get name(){return this.$$.ctx[14]}get stores(){return this.$$.ctx[15]}set stores(t){this.$$set({stores:t}),A()}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),A()}get locale(){return this.$$.ctx[16]}set locale(t){this.$$set({locale:t}),A()}get finetuneControlConfiguration(){return this.$$.ctx[17]}set finetuneControlConfiguration(t){this.$$set({finetuneControlConfiguration:t}),A()}get finetuneOptions(){return this.$$.ctx[18]}set finetuneOptions(t){this.$$set({finetuneOptions:t}),A()}get finetuneNudgePrecision(){return this.$$.ctx[19]}set finetuneNudgePrecision(t){this.$$set({finetuneNudgePrecision:t}),A()}}]},ip=(t,e)=>{const r=e.length;return t<0?t%r+r:t>=r?t%r:t};function Y$(t,e,r){const n=t.slice();return n[51]=e[r].key,n[52]=e[r].index,n[53]=e[r].translate,n[16]=e[r].scale,n[54]=e[r].selected,n[15]=e[r].rotate,n[55]=e[r].dir,n[56]=e[r].center,n[57]=e[r].type,n[4]=e[r].visible,n[58]=e[r].role,n[59]=e[r].tabindex,n[60]=e[r].label,n[61]=e[r].orientation,n[62]=e[r].valuemin,n[63]=e[r].valuemax,n[64]=e[r].valuenow,n}function q$(t){let e;return{c(){e=mt("div"),T(e,"class","PinturaShapeManipulator"),T(e,"data-control","point"),Mt(e,"pointer-events","none"),Mt(e,"opacity",t[6]),Mt(e,"transform",`translate3d(${t[56].x}px, ${t[56].y}px, 0) scale(${t[7]}, ${t[7]})`)},m(r,n){tt(r,e,n)},p(r,n){64&n[0]&&Mt(e,"opacity",r[6]),160&n[0]&&Mt(e,"transform",`translate3d(${r[56].x}px, ${r[56].y}px, 0) scale(${r[7]}, ${r[7]})`)},d(r){r&&J(e)}}}function K$(t,e){let r,n,i,o,a,s,l,c,u,d,p,h,f,g;function $(...v){return e[23](e[52],...v)}let b=e[57]==="edge"&&e[4]&&q$(e);return{key:t,first:null,c(){r=mt("div"),p=ue(),b&&b.c(),h=Dn(),T(r,"role",n=e[58]),T(r,"tabindex",i=e[59]),T(r,"aria-label",o=e[60]),T(r,"aria-orientation",a=e[61]),T(r,"aria-valuemin",s=e[62]),T(r,"aria-valuemax",l=e[63]),T(r,"aria-valuenow",c=e[64]),T(r,"class","PinturaShapeManipulator"),T(r,"data-control",u=e[57]),T(r,"data-selected",d=e[54]),Mt(r,"cursor",e[55]?e[55]+"-resize":"move"),Mt(r,"opacity",e[6]),Mt(r,"--tx",e[53].x),Mt(r,"--ty",e[53].y),Mt(r,"--r",(e[57]==="edge"?e[15]:0)+"rad"),Mt(r,"--sx",e[57]==="point"?e[7]:e[16].x),Mt(r,"--sy",e[57]==="point"?e[7]:e[16].y),this.first=r},m(v,w){tt(v,r,w),tt(v,p,w),b&&b.m(v,w),tt(v,h,w),f||(g=[Tt(r,"nudge",$),Tr(Ss.call(null,r,{preventDefault:!0})),Tt(r,"interactionstart",function(){kr(e[11]("start",e[52]))&&e[11]("start",e[52]).apply(this,arguments)}),Tt(r,"interactionupdate",function(){kr(e[11]("move",e[52]))&&e[11]("move",e[52]).apply(this,arguments)}),Tt(r,"interactionend",function(){kr(e[11]("end",e[52]))&&e[11]("end",e[52]).apply(this,arguments)}),Tr(Ts.call(null,r,{observeKeys:!0}))],f=!0)},p(v,w){e=v,32&w[0]&&n!==(n=e[58])&&T(r,"role",n),32&w[0]&&i!==(i=e[59])&&T(r,"tabindex",i),32&w[0]&&o!==(o=e[60])&&T(r,"aria-label",o),32&w[0]&&a!==(a=e[61])&&T(r,"aria-orientation",a),32&w[0]&&s!==(s=e[62])&&T(r,"aria-valuemin",s),32&w[0]&&l!==(l=e[63])&&T(r,"aria-valuemax",l),32&w[0]&&c!==(c=e[64])&&T(r,"aria-valuenow",c),32&w[0]&&u!==(u=e[57])&&T(r,"data-control",u),32&w[0]&&d!==(d=e[54])&&T(r,"data-selected",d),32&w[0]&&Mt(r,"cursor",e[55]?e[55]+"-resize":"move"),64&w[0]&&Mt(r,"opacity",e[6]),32&w[0]&&Mt(r,"--tx",e[53].x),32&w[0]&&Mt(r,"--ty",e[53].y),32&w[0]&&Mt(r,"--r",(e[57]==="edge"?e[15]:0)+"rad"),160&w[0]&&Mt(r,"--sx",e[57]==="point"?e[7]:e[16].x),160&w[0]&&Mt(r,"--sy",e[57]==="point"?e[7]:e[16].y),e[57]==="edge"&&e[4]?b?b.p(e,w):(b=q$(e),b.c(),b.m(h.parentNode,h)):b&&(b.d(1),b=null)},d(v){v&&J(r),v&&J(p),b&&b.d(v),v&&J(h),f=!1,Ur(g)}}}function J$(t){let e,r,n;return{c(){e=mt("div"),T(e,"role","button"),T(e,"aria-label","Drag rotator"),T(e,"tabindex","0"),T(e,"class","PinturaShapeManipulator"),T(e,"data-control","rotate"),Mt(e,"transform",`translate3d(${t[0].x}px, ${t[0].y}px, 0) scale(${t[7]}, ${t[7]})`),Mt(e,"opacity",t[6])},m(i,o){tt(i,e,o),r||(n=[Tt(e,"nudge",t[13]),Tr(Ss.call(null,e,{preventDefault:!0})),Tt(e,"interactionstart",t[15]("start")),Tt(e,"interactionupdate",t[15]("move")),Tt(e,"interactionend",t[15]("end")),Tr(Ts.call(null,e,{observeKeys:!0}))],r=!0)},p(i,o){129&o[0]&&Mt(e,"transform",`translate3d(${i[0].x}px, ${i[0].y}px, 0) scale(${i[7]}, ${i[7]})`),64&o[0]&&Mt(e,"opacity",i[6])},d(i){i&&J(e),r=!1,Ur(n)}}}function Q$(t){let e,r,n;return{c(){e=mt("div"),T(e,"role","button"),T(e,"aria-label","Drag scalar"),T(e,"tabindex","0"),T(e,"class","PinturaShapeManipulator"),T(e,"data-control","scale"),Mt(e,"transform",`translate3d(${t[1].x}px, ${t[1].y}px, 0) scale(${t[7]}, ${t[7]})`),Mt(e,"opacity",t[6])},m(i,o){tt(i,e,o),r||(n=[Tt(e,"nudge",t[14]),Tr(Ss.call(null,e,{preventDefault:!0})),Tt(e,"interactionstart",t[16]("start")),Tt(e,"interactionupdate",t[16]("move")),Tt(e,"interactionend",t[16]("end")),Tr(Ts.call(null,e,{observeKeys:!0}))],r=!0)},p(i,o){130&o[0]&&Mt(e,"transform",`translate3d(${i[1].x}px, ${i[1].y}px, 0) scale(${i[7]}, ${i[7]})`),64&o[0]&&Mt(e,"opacity",i[6])},d(i){i&&J(e),r=!1,Ur(n)}}}function f6(t){let e,r,n,i=[],o=new Map,a=t[5];const s=u=>u[51];for(let u=0;u<a.length;u+=1){let d=Y$(t,a,u),p=s(d);o.set(p,i[u]=K$(p,d))}let l=t[2]&&t[0]&&J$(t),c=t[3]&&t[1]&&Q$(t);return{c(){for(let u=0;u<i.length;u+=1)i[u].c();e=ue(),l&&l.c(),r=ue(),c&&c.c(),n=Dn()},m(u,d){for(let p=0;p<i.length;p+=1)i[p]&&i[p].m(u,d);tt(u,e,d),l&&l.m(u,d),tt(u,r,d),c&&c.m(u,d),tt(u,n,d)},p(u,d){6368&d[0]&&(a=u[5],i=es(i,d,s,1,u,a,o,e.parentNode,D2,K$,e,Y$)),u[2]&&u[0]?l?l.p(u,d):(l=J$(u),l.c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null),u[3]&&u[1]?c?c.p(u,d):(c=Q$(u),c.c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null)},i:qe,o:qe,d(u){for(let d=0;d<i.length;d+=1)i[d].d(u);u&&J(e),l&&l.d(u),u&&J(r),c&&c.d(u),u&&J(n)}}}function g6(t,e,r){let n,i,o,a;const s=ba(),l=.5*ua,c=ea-l,u=ea+l,d=-ea,p=d-l,h=d+l,f=Dh-l,g=-Dh+l,$=l,b=-l,v=ea-ua,w=v-l,S=v+l,P=Dh-ua,M=P-l,E=P+l,C=d-ua,z=C+l,V=C-l,L=d+ua,y=L+l,ct=L-l;let{visible:j=!1}=e,{points:k=[]}=e,{rotatorPoint:N}=e,{bounds:nt=null}=e,{scalarPoint:ft}=e,{selectedPoint:xt}=e,{enableDragEdges:H=!0}=e,{enableDragPoints:Z=!0}=e,{enableRotatePoints:wt=!0}=e,{enableScalePoints:vt=!0}=e;const et=$n("isAnimated");D(t,et,rt=>r(22,i=rt));const Pt=hr(.5,{precision:1e-4,stiffness:.3,damping:.7});D(t,Pt,rt=>r(7,a=rt));const Et=hr(0,{precision:.001,stiffness:.3,damping:.7});D(t,Et,rt=>r(6,o=rt));const kt=rt=>{let X="";return(rt<=u&&rt>=c||rt>=p&&rt<=h)&&(X="ns"),(rt<=g||rt>=f||rt>=b&&rt<=$)&&(X="ew"),(rt>=M&&rt<=E||rt<=y&&rt>=ct)&&(X="nesw"),(rt>=w&&rt<=S||rt<=z&&rt>=V)&&(X="nwse"),X},st=(rt,X)=>{let q=0;const Ft=Qo(rt),zt=[],yt=rt.length,[Dt,Wt,at,St]=rt.reduce(([pt,Xt,Zt,ie],{x:gt,y:te})=>(ie=Math.min(ie,gt),Xt=Math.max(Xt,gt),[pt=Math.min(pt,te),Xt,Zt=Math.max(Zt,te),ie]),[1/0,-1/0,-1/0,1/0]);for(;q<yt;q++){const pt=ip(q-1,rt),Xt=ip(q+1,rt),Zt=rt[pt],ie=rt[q],gt=rt[Xt],te=Math.atan2(gt.y-ie.y,gt.x-ie.x);if(Z){const de=yo(lt(Zt.x-ie.x,Zt.y-ie.y)),Oe=yo(lt(gt.x-ie.x,gt.y-ie.y)),rr=lt(de.x+Oe.x,de.y+Oe.y),Ct=H?Z&&kt(Math.atan2(rr.y,rr.x)):void 0;zt.push({index:[q],key:"point-"+q,type:"point",selected:xt===q,scale:{x:1,y:1},translate:{x:ie.x,y:ie.y},angle:void 0,rotate:wt,center:ie,dir:Ct})}if(!H||Array.isArray(H)&&!H.some(([de,Oe])=>q===de&&Xt===Oe))continue;const xe=lt(ie.x+.5*(gt.x-ie.x),ie.y+.5*(gt.y-ie.y)),_=["t","r","b","l"][q];let Kt,qt,le;_==="l"&&(Kt=nt.x,qt=Wt,le=St),_==="t"&&(Kt=nt.y,qt=at,le=Dt),_==="r"&&(Kt=St,qt=nt.width,le=Wt),_==="b"&&(Kt=Dt,qt=nt.height,le=at),zt.push({index:[q,Xt],key:"edge-"+q,type:"edge",scale:{x:Ni(ie,gt),y:1},translate:{x:ie.x,y:ie.y},angle:te,rotate:te,center:xe,visible:Array.isArray(H),dir:kt(Math.atan2(Ft.y-xe.y,Ft.x-xe.x)),role:"slider",tabindex:0,label:"Drag "+jb[_],orientation:""+Ub[_],valuemin:Math.round(Kt),valuemax:Math.round(qt),valuenow:Math.round(le)})}return zt},Ut=(rt,X)=>{s("resizestart",{indexes:rt,translation:dn(),isNudge:!0}),s("resizemove",{indexes:rt,translation:X,isNudge:!0}),s("resizeend",{indexes:rt,translation:dn(),isNudge:!0})};return t.$$set=rt=>{"visible"in rt&&r(4,j=rt.visible),"points"in rt&&r(17,k=rt.points),"rotatorPoint"in rt&&r(0,N=rt.rotatorPoint),"bounds"in rt&&r(18,nt=rt.bounds),"scalarPoint"in rt&&r(1,ft=rt.scalarPoint),"selectedPoint"in rt&&r(19,xt=rt.selectedPoint),"enableDragEdges"in rt&&r(20,H=rt.enableDragEdges),"enableDragPoints"in rt&&r(21,Z=rt.enableDragPoints),"enableRotatePoints"in rt&&r(2,wt=rt.enableRotatePoints),"enableScalePoints"in rt&&r(3,vt=rt.enableScalePoints)},t.$$.update=()=>{4194320&t.$$.dirty[0]&&Pt.set(j?1:.5,{hard:i===!1}),4194320&t.$$.dirty[0]&&Et.set(j?1:0,{hard:i===!1}),131072&t.$$.dirty[0]&&r(5,n=st(k))},[N,ft,wt,vt,j,n,o,a,et,Pt,Et,(rt,X)=>({detail:q})=>{const Ft=q&&q.translation?q.translation:lt(0,0);s("resize"+rt,{...q,indexes:X,translation:Ft})},Ut,({detail:rt})=>{s("rotatestart",{translation:dn(),isNudge:!0}),s("rotatemove",{translation:rt,isNudge:!0}),s("rotateend",{translation:dn(),isNudge:!0})},({detail:rt})=>{s("scalestart",{translation:dn(),isNudge:!0}),s("scalemove",{translation:rt,isNudge:!0}),s("scaleend",{translation:dn(),isNudge:!0})},rt=>({detail:X})=>{const q=X&&X.translation?X.translation:lt(0,0);s("rotate"+rt,{...X,translation:q})},rt=>({detail:X})=>{const q=X&&X.translation?X.translation:lt(0,0);s("scale"+rt,{...X,translation:q})},k,nt,xt,H,Z,i,(rt,{detail:X})=>Ut(rt,X)]}class $6 extends gr{constructor(e){super(),fr(this,e,g6,f6,cr,{visible:4,points:17,rotatorPoint:0,bounds:18,scalarPoint:1,selectedPoint:19,enableDragEdges:20,enableDragPoints:21,enableRotatePoints:2,enableScalePoints:3},null,[-1,-1,-1])}}var U1=(t,e)=>{const r=I0(t);return Un(r,e)},Ed=t=>document.createTextNode(t),Zb=t=>(Fa()&&t.endsWith("<div><br></div>")?t.replace(/<div><br><\/div>$/,"<br><br>"):t).replace(/<div><br><\/div>/g,"<br>").replace(/<\/div>/g,"").replace(/<div>/g,"<br>");function ty(t){let e,r,n,i;return{c(){e=mt("pre"),T(e,"class","PinturaContentEditable")},m(o,a){tt(o,e,a),e.innerHTML=t[0],n||(i=Tr(r=vs.call(null,e,t[7]+";position:absolute;z-index:-1;pointer-events:none;")),n=!0)},p(o,a){1&a[0]&&(e.innerHTML=o[0]),r&&kr(r.update)&&128&a[0]&&r.update.call(null,o[7]+";position:absolute;z-index:-1;pointer-events:none;")},d(o){o&&J(e),n=!1,i()}}}function y6(t){let e,r,n,i,o,a,s=t[8]&&ty(t);return{c(){s&&s.c(),e=ue(),r=mt("pre"),T(r,"class","PinturaContentEditable"),T(r,"data-wrap-content",n=t[4]||t[5]?"wrap":"nowrap"),T(r,"contenteditable",""),T(r,"spellcheck",t[1]),T(r,"autocorrect",t[2]),T(r,"autocapitalize",t[3])},m(l,c){s&&s.m(l,c),tt(l,e,c),tt(l,r,c),t[26](r),o||(a=[Tr(i=vs.call(null,r,t[8]?t[15](t[7]):t[7])),Tt(r,"input",t[13]),Tt(r,"compositionend",t[12]),Tt(r,"paste",t[14]),Tt(r,"keydown",t[10]),Tt(r,"keyup",t[11]),Tt(r,"blur",t[9])],o=!0)},p(l,c){l[8]?s?s.p(l,c):(s=ty(l),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),48&c[0]&&n!==(n=l[4]||l[5]?"wrap":"nowrap")&&T(r,"data-wrap-content",n),2&c[0]&&T(r,"spellcheck",l[1]),4&c[0]&&T(r,"autocorrect",l[2]),8&c[0]&&T(r,"autocapitalize",l[3]),i&&kr(i.update)&&384&c[0]&&i.update.call(null,l[8]?l[15](l[7]):l[7])},i:qe,o:qe,d(l){s&&s.d(l),l&&J(e),l&&J(r),t[26](null),o=!1,Ur(a)}}}function b6(t,e,r){let n,i,{spellcheck:o="false"}=e,{autocorrect:a="off"}=e,{autocapitalize:s="off"}=e,{wrapLines:l=!0}=e,{allowNewline:c=!0}=e,{textFormat:u="text"}=e,{formatInput:d=tn}=e,{formatPaste:p=tn}=e,{styles:h}=e,{innerHTML:f}=e,{oninput:g=se}=e,{enableTextStyleShortcuts:$=!1}=e;const b=()=>{if(!w)return;const k=document.createRange();k.selectNodeContents(w);const N=V();N.removeAllRanges(),N.addRange(k)},v=ba();let w;document.execCommand("defaultParagraphSeparator",!1,"br");const S=k=>k.replace(/<\/?(?:i|b|em|u|s|strike|strong|font)>/,"").replace(/style=".*?"/g,"").replace(/\n/gim,"<br>"),P=()=>{r(0,f=w.innerHTML);const k=Zb(f);v("input",k),g(k),requestAnimationFrame(()=>w&&w.scrollTo(0,0))},M=()=>{L(w);const k=u==="html"?w.innerHTML:S(w.innerHTML);r(6,w.innerHTML=d(k),w),y(w),P()},E={b:"bold",i:"italic",u:"underline",s:"strikethrough"},C=k=>{const N=yn("span");return N.dataset.bookmark=k,N},z=(k,N,nt)=>{const ft=C(nt);if(k.nodeType===Node.TEXT_NODE){const xt=k.textContent;if(nt==="start"){const H=Ed(xt.substring(0,N)),Z=Ed(xt.substring(N));k.replaceWith(H,ft,Z)}else{const H=Ed(xt.substring(0,N)),Z=Ed(xt.substring(N));k.replaceWith(H,ft,Z)}}else k.nodeType===Node.ELEMENT_NODE&&k.insertBefore(ft,k.childNodes[N])},V=()=>{const k=w.getRootNode();return"getSelection"in k?k.getSelection():document.getSelection()},L=k=>{const N=V();if(!N.getRangeAt||!N.rangeCount)return;const nt=N.getRangeAt(0),{startOffset:ft,endOffset:xt,startContainer:H,endContainer:Z}=nt;if(k.contains(nt.startContainer)&&k.contains(nt.endContainer))if(H.nodeType===Node.TEXT_NODE&&H===Z){const wt=H.textContent,vt=wt.substring(0,ft),et=C("start"),Pt=xt-ft>0?wt.substring(ft,xt):"",Et=C("end"),kt=wt.substring(xt);H.replaceWith(vt,et,Pt,Et,kt)}else z(H,ft,"start"),z(Z,xt+(H===Z?1:0),"end")},y=k=>{const N=ct(k,"start"),nt=ct(k,"end");if(!N||!nt)return;const ft=document.createRange();ft.setStart(N,0),ft.setEnd(nt,0);const xt=V();xt.removeAllRanges(),xt.addRange(ft),N.remove(),nt.remove()},ct=(k,N)=>{const nt=k.children;for(let ft=0;ft<nt.length;ft++){const xt=nt[ft];if(xt.dataset.bookmark===N)return xt;if(xt.children.length){const H=ct(xt,N);if(H)return H}}};let j;return t.$$set=k=>{"spellcheck"in k&&r(1,o=k.spellcheck),"autocorrect"in k&&r(2,a=k.autocorrect),"autocapitalize"in k&&r(3,s=k.autocapitalize),"wrapLines"in k&&r(4,l=k.wrapLines),"allowNewline"in k&&r(5,c=k.allowNewline),"textFormat"in k&&r(16,u=k.textFormat),"formatInput"in k&&r(17,d=k.formatInput),"formatPaste"in k&&r(18,p=k.formatPaste),"styles"in k&&r(19,h=k.styles),"innerHTML"in k&&r(0,f=k.innerHTML),"oninput"in k&&r(20,g=k.oninput),"enableTextStyleShortcuts"in k&&r(21,$=k.enableTextStyleShortcuts)},t.$$.update=()=>{var k;if(64&t.$$.dirty[0]&&r(25,n=!!w),33554433&t.$$.dirty[0]&&n&&f&&(k=f)!==w.innerHTML&&(r(6,w.innerHTML=k,w),w===document.activeElement&&b()),524336&t.$$.dirty[0])if(!l&&c){const N=h.includes(":right")?"text-indent:-100px!important":h.includes(":center")?"":"min-width:calc(100% + 100px)!important";r(7,j=h+";overflow:visible;"+N)}else r(7,j=h);524288&t.$$.dirty[0]&&r(8,i=h.includes("text-stroke"))},[f,o,a,s,l,c,w,j,i,()=>{v("blur")},k=>{if(/escape/i.test(k.code))return k.stopPropagation(),void v("cancel");const N=k.ctrlKey||k.metaKey;if(u==="html"&&N&&/b|i|u|s/.test(k.key))return $&&(nt=>{const ft=E[nt];ft&&document.execCommand(ft)})(k.key),void k.preventDefault();/enter/i.test(k.key)&&(k.stopPropagation(),k.isComposing||(N?v("confirm"):(c||k.preventDefault(),document.execCommand("insertLineBreak"),k.preventDefault())))},()=>{},k=>{k.data!==""&&M()},k=>{const{inputType:N}=k;N!=="insertCompositionText"&&N!=="deleteCompositionText"&&M()},k=>{k.preventDefault();const N=k.clipboardData.getData("text/plain"),nt=u==="html"?N:S(N),ft=p(nt);if(!ft.length)return;const xt=V().getRangeAt(0);xt.deleteContents(),xt.insertNode(document.createTextNode(ft)),P()},k=>k.replace("-webkit-text-stroke","--text-stroke").replace("text-shadow","--text-shadow"),u,d,p,h,g,$,()=>M(),()=>w&&w.focus(),b,n,function(k){jr[k?"unshift":"push"](()=>{w=k,r(6,w)})}]}class x6 extends gr{constructor(e){super(),fr(this,e,b6,y6,cr,{spellcheck:1,autocorrect:2,autocapitalize:3,wrapLines:4,allowNewline:5,textFormat:16,formatInput:17,formatPaste:18,styles:19,innerHTML:0,oninput:20,enableTextStyleShortcuts:21,confirm:22,focus:23,select:24},null,[-1,-1])}get spellcheck(){return this.$$.ctx[1]}set spellcheck(e){this.$$set({spellcheck:e}),A()}get autocorrect(){return this.$$.ctx[2]}set autocorrect(e){this.$$set({autocorrect:e}),A()}get autocapitalize(){return this.$$.ctx[3]}set autocapitalize(e){this.$$set({autocapitalize:e}),A()}get wrapLines(){return this.$$.ctx[4]}set wrapLines(e){this.$$set({wrapLines:e}),A()}get allowNewline(){return this.$$.ctx[5]}set allowNewline(e){this.$$set({allowNewline:e}),A()}get textFormat(){return this.$$.ctx[16]}set textFormat(e){this.$$set({textFormat:e}),A()}get formatInput(){return this.$$.ctx[17]}set formatInput(e){this.$$set({formatInput:e}),A()}get formatPaste(){return this.$$.ctx[18]}set formatPaste(e){this.$$set({formatPaste:e}),A()}get styles(){return this.$$.ctx[19]}set styles(e){this.$$set({styles:e}),A()}get innerHTML(){return this.$$.ctx[0]}set innerHTML(e){this.$$set({innerHTML:e}),A()}get oninput(){return this.$$.ctx[20]}set oninput(e){this.$$set({oninput:e}),A()}get enableTextStyleShortcuts(){return this.$$.ctx[21]}set enableTextStyleShortcuts(e){this.$$set({enableTextStyleShortcuts:e}),A()}get confirm(){return this.$$.ctx[22]}get focus(){return this.$$.ctx[23]}get select(){return this.$$.ctx[24]}}const ey=["i","b","u","strike"].map(t=>({tag:t,tagOpen:new RegExp(`<${t}>`,"g"),tagClose:new RegExp(`</${t}>`,"g"),placeholderOpen:new RegExp(`___${t}O___`,"g"),placeholderClose:new RegExp(`___${t}C___`,"g")}));var v6=t=>t=((e,r=ey)=>(r.forEach(({tag:n,placeholderOpen:i,placeholderClose:o})=>{e=e.replace(i,`<${n}>`).replace(o,`</${n}>`)}),e))(t=(t=((e,r=ey)=>(r.forEach(({tag:n,tagOpen:i,tagClose:o})=>{e=e.replace(i,`___${n}O___`).replace(o,`___${n}C___`)}),e))(t)).replace(/ {2,}/g," ").replace(/\u00a0/g,"&nbsp;").split(`
`).join("<br>")),Ad=(t,e)=>Ge(t)?parseFloat(t)/100*e:t,Zc=(t,e)=>({x:$o(t.x,e.width),y:$o(t.y,e.height)});function ry(t,e,r){const n=t.slice();return n[318]=e[r],n[320]=r,n}function ny(t,e){let r,n,i,o,a,s,l,c,u,d,p,h=e[318].name+"";function f(){return e[198](e[320])}return i=new R0({props:{color:e[318].color}}),{key:t,first:null,c(){r=mt("li"),n=mt("button"),Ht(i.$$.fragment),o=ue(),a=mt("span"),s=Mn(h),c=ue(),T(n,"class","PinturaShapeListItem"),T(n,"type","button"),T(n,"aria-label",l="Select shape "+e[318].name),this.first=r},m(g,$){tt(g,r,$),Lt(r,n),Vt(i,n,null),Lt(n,o),Lt(n,a),Lt(a,s),Lt(r,c),u=!0,d||(p=Tt(n,"click",f),d=!0)},p(g,$){e=g;const b={};8388608&$[0]&&(b.color=e[318].color),i.$set(b),(!u||8388608&$[0])&&h!==(h=e[318].name+"")&&Gn(s,h),(!u||8388608&$[0]&&l!==(l="Select shape "+e[318].name))&&T(n,"aria-label",l)},i(g){u||(I(i.$$.fragment,g),u=!0)},o(g){B(i.$$.fragment,g),u=!1},d(g){g&&J(r),Nt(i),d=!1,p()}}}function iy(t){let e,r;return e=new $6({props:{visible:!0,points:t[14],bounds:t[4],rotatorPoint:t[31],scalarPoint:t[30],selectedPoint:t[19],enableDragEdges:t[20],enableDragPoints:t[33],enableRotatePoints:t[18],enableScalePoints:t[16]}}),e.$on("resizestart",t[42]),e.$on("resizemove",t[43]),e.$on("resizeend",t[44]),e.$on("rotatestart",t[45]),e.$on("rotatemove",t[46]),e.$on("rotateend",t[47]),e.$on("scalestart",t[48]),e.$on("scalemove",t[49]),e.$on("scaleend",t[50]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16384&i[0]&&(o.points=n[14]),16&i[0]&&(o.bounds=n[4]),1&i[1]&&(o.rotatorPoint=n[31]),1073741824&i[0]&&(o.scalarPoint=n[30]),524288&i[0]&&(o.selectedPoint=n[19]),1048576&i[0]&&(o.enableDragEdges=n[20]),4&i[1]&&(o.enableDragPoints=n[33]),262144&i[0]&&(o.enableRotatePoints=n[18]),65536&i[0]&&(o.enableScalePoints=n[16]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function oy(t){let e,r,n,i;const o=[S6,w6],a=[];function s(l,c){return l[5]==="modal"?0:l[5]==="inline"?1:-1}return~(e=s(t))&&(r=a[e]=o[e](t)),{c(){r&&r.c(),n=Dn()},m(l,c){~e&&a[e].m(l,c),tt(l,n,c),i=!0},p(l,c){let u=e;e=s(l),e===u?~e&&a[e].p(l,c):(r&&(Fe(),B(a[u],1,1,()=>{a[u]=null}),ze()),~e?(r=a[e],r?r.p(l,c):(r=a[e]=o[e](l),r.c()),I(r,1),r.m(n.parentNode,n)):r=null)},i(l){i||(I(r),i=!0)},o(l){B(r),i=!1},d(l){~e&&a[e].d(l),l&&J(n)}}}function w6(t){let e,r,n,i,o,a,s={formatInput:t[52],wrapLines:!!t[15].width,textFormat:t[15].format,enableTextStyleShortcuts:t[6],allowNewline:t[32],styles:t[29]};return r=new x6({props:s}),t[202](r),r.$on("input",t[53]),r.$on("keyup",t[57]),r.$on("cancel",t[59]),r.$on("confirm",t[58]),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"class","PinturaInlineInput")},m(l,c){tt(l,e,c),Vt(r,e,null),i=!0,o||(a=[Tr(n=vs.call(null,e,t[28])),Tt(e,"focusout",t[203])],o=!0)},p(l,c){const u={};32768&c[0]&&(u.wrapLines=!!l[15].width),32768&c[0]&&(u.textFormat=l[15].format),64&c[0]&&(u.enableTextStyleShortcuts=l[6]),2&c[1]&&(u.allowNewline=l[32]),536870912&c[0]&&(u.styles=l[29]),r.$set(u),n&&kr(n.update)&&268435456&c[0]&&n.update.call(null,l[28])},i(l){i||(I(r.$$.fragment,l),i=!0)},o(l){B(r.$$.fragment,l),i=!1},d(l){l&&J(e),t[202](null),Nt(r),o=!1,Ur(a)}}}function S6(t){let e,r;return e=new kb({props:{panelOffset:t[2],onconfirm:t[58],oncancel:t[59],buttonCancel:{icon:t[7].shapeIconInputCancel,label:t[7].shapeLabelInputCancel},buttonConfirm:{icon:t[7].shapeIconInputConfirm,label:t[7].shapeLabelInputConfirm,hideLabel:!0},willHandleKeydown:t[201],$$slots:{default:[k6]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};4&i[0]&&(o.panelOffset=n[2]),128&i[0]&&(o.buttonCancel={icon:n[7].shapeIconInputCancel,label:n[7].shapeLabelInputCancel}),128&i[0]&&(o.buttonConfirm={icon:n[7].shapeIconInputConfirm,label:n[7].shapeLabelInputConfirm,hideLabel:!0}),4096&i[0]&&(o.willHandleKeydown=n[201]),671088896&i[0]|2048&i[10]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function k6(t){let e,r,n,i;return{c(){e=mt("textarea"),T(e,"spellcheck","false"),T(e,"autocorrect","off"),T(e,"autocapitalize","off")},m(o,a){tt(o,e,a),t[199](e),Af(e,t[27]),n||(i=[Tt(e,"keydown",t[55]),Tt(e,"keypress",t[54]),Tt(e,"keyup",t[57]),Tt(e,"input",t[53]),Tt(e,"input",t[200]),Tr(r=vs.call(null,e,t[29]))],n=!0)},p(o,a){134217728&a[0]&&Af(e,o[27]),r&&kr(r.update)&&536870912&a[0]&&r.update.call(null,o[29])},d(o){o&&J(e),t[199](null),n=!1,Ur(i)}}}function ay(t){let e,r,n,i,o;return r=new Qi({props:{items:t[24],key:t[11]}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"class","PinturaShapeControls"),Mt(e,"transform",t[26]),Mt(e,"opacity",t[25])},m(a,s){tt(a,e,s),Vt(r,e,null),n=!0,i||(o=[Tt(e,"measure",t[204]),Tr(Di.call(null,e))],i=!0)},p(a,s){const l={};16777216&s[0]&&(l.items=a[24]),2048&s[0]&&(l.key=a[11]),r.$set(l),67108864&s[0]&&Mt(e,"transform",a[26]),33554432&s[0]&&Mt(e,"opacity",a[25])},i(a){n||(I(r.$$.fragment,a),n=!0)},o(a){B(r.$$.fragment,a),n=!1},d(a){a&&J(e),Nt(r),i=!1,Ur(o)}}}function T6(t){let e,r,n,i,o,a,s,l,c,u,d=[],p=new Map,h=t[23];const f=v=>v[318].id;for(let v=0;v<h.length;v+=1){let w=ry(t,h,v),S=f(w);p.set(S,d[v]=ny(S,w))}let g=t[17]&&iy(t),$=t[13]&&oy(t),b=t[21]>0&&ay(t);return{c(){e=mt("div"),r=mt("nav"),n=mt("ul");for(let v=0;v<d.length;v+=1)d[v].c();i=ue(),g&&g.c(),o=ue(),$&&$.c(),a=ue(),b&&b.c(),T(r,"class","PinturaShapeList"),T(r,"data-visible",t[22]),T(e,"class","PinturaShapeEditor"),T(e,"tabindex","0")},m(v,w){tt(v,e,w),Lt(e,r),Lt(r,n);for(let S=0;S<d.length;S+=1)d[S]&&d[S].m(n,null);Lt(e,i),g&&g.m(e,null),Lt(e,o),$&&$.m(e,null),Lt(e,a),b&&b.m(e,null),t[205](e),l=!0,c||(u=[Tt(r,"focusin",t[62]),Tt(r,"focusout",t[63]),Tt(e,"keydown",function(){kr(t[0]?se:t[51])&&(t[0]?se:t[51]).apply(this,arguments)}),Tt(e,"nudge",function(){kr(t[0]?se:t[61])&&(t[0]?se:t[61]).apply(this,arguments)}),Tt(e,"measure",t[197]),Tt(e,"pointermove",function(){kr(t[0]?se:t[64])&&(t[0]?se:t[64]).apply(this,arguments)}),Tt(e,"pointerleave",function(){kr(t[0]?se:t[65])&&(t[0]?se:t[65]).apply(this,arguments)}),Tt(e,"interactionstart",function(){kr(t[0]?se:t[36])&&(t[0]?se:t[36]).apply(this,arguments)}),Tt(e,"interactionupdate",function(){kr(t[0]?se:t[38])&&(t[0]?se:t[38]).apply(this,arguments)}),Tt(e,"interactioncancel",function(){kr(t[0]?se:t[37])&&(t[0]?se:t[37]).apply(this,arguments)}),Tt(e,"interactionrelease",function(){kr(t[0]?se:t[39])&&(t[0]?se:t[39]).apply(this,arguments)}),Tt(e,"interactionend",function(){kr(t[0]?se:t[40])&&(t[0]?se:t[40]).apply(this,arguments)}),Tr(Di.call(null,e)),Tr(Ss.call(null,e)),Tr(s=Ts.call(null,e,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:sy,getEventPosition:t[206]}))],c=!0)},p(v,w){t=v,8388608&w[0]|16&w[2]&&(h=t[23],Fe(),d=es(d,w,f,1,t,h,p,n,Ys,ny,null,ry),ze()),(!l||4194304&w[0])&&T(r,"data-visible",t[22]),t[17]?g?(g.p(t,w),131072&w[0]&&I(g,1)):(g=iy(t),g.c(),I(g,1),g.m(e,o)):g&&(Fe(),B(g,1,1,()=>{g=null}),ze()),t[13]?$?($.p(t,w),8192&w[0]&&I($,1)):($=oy(t),$.c(),I($,1),$.m(e,a)):$&&(Fe(),B($,1,1,()=>{$=null}),ze()),t[21]>0?b?(b.p(t,w),2097152&w[0]&&I(b,1)):(b=ay(t),b.c(),I(b,1),b.m(e,null)):b&&(Fe(),B(b,1,1,()=>{b=null}),ze()),s&&kr(s.update)&&8&w[0]&&s.update.call(null,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:sy,getEventPosition:t[206]})},i(v){if(!l){for(let w=0;w<h.length;w+=1)I(d[w]);I(g),I($),I(b),l=!0}},o(v){for(let w=0;w<d.length;w+=1)B(d[w]);B(g),B($),B(b),l=!1},d(v){v&&J(e);for(let w=0;w<d.length;w+=1)d[w].d();g&&g.d(),$&&$.d(),b&&b.d(),t[205](null),c=!1,Ur(u)}}}const sy=(t,e)=>t.target===e||t.target.className==="PinturaContentEditable";function C6(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,E,C,z,V,L,y,ct,j,k,N,nt,ft,xt,H,Z,wt,vt,et,Pt,Et,kt,st,Ut,rt,X,q,Ft,zt,yt,Dt,Wt,at,St,pt,Xt,Zt,ie,gt,te,xe,_,Kt,qt,le,de,Oe,rr=qe,Ct=()=>(rr(),rr=Hi(Qe,x=>r(193,Kt=x)),Qe);t.$$.on_destroy.push(()=>rr());let{uid:pe=ra()}=e,{ui:ar}=e,{disabled:Ke=!1}=e,{shapes:Qe}=e;Ct();let{selection:Re}=e,{offset:Je}=e,{contextRotation:ur=0}=e,{contextFlipX:$r=!1}=e,{contextFlipY:zr=!1}=e,{contextZoom:Dr=1}=e,{active:dr=!1}=e,{opacity:Y=1}=e,{parentRect:it}=e,{rootRect:G}=e,{utilRect:Bt}=e,{hoverColor:ae}=e,{caretColor:De}=e,{gridColor:we}=e,{snapColor:Ot}=e,{textInputMode:Ce="inline"}=e,{oninteractionstart:nr=se}=e,{oninteractionupdate:lr=se}=e,{oninteractionrelease:ot=se}=e,{oninteractionend:Yt=se}=e,{oninteractioncancel:Ve=se}=e,{onaddshape:Se=se}=e,{onupdateshape:ee=se}=e,{onselectshape:Xe=se}=e,{onblurshape:Be=se}=e,{onremoveshape:yr=se}=e,{ontapshape:$t=se}=e,{onhovershape:Ae=se}=e,{ontriggerhistorywrite:Gt=se}=e,{onhovercanvas:me=se}=e,{ontapcanvas:he=se}=e,{onleavecanvas:er=se}=e,{beforeSelectShape:Er=()=>!0}=e,{beforeDeselectShape:fe=()=>!0}=e,{beforeRemoveShape:Cr=()=>!0}=e,{beforeUpdateShape:Mr=(x,W,R)=>W}=e,{willRenderShapeControls:ir=tn}=e,{willRenderShapeTextControls:en=tn}=e,{willStartInteraction:ye=(x,W)=>!0}=e,{mapEditorPointToImagePoint:tr}=e,{mapImagePointToEditorPoint:je}=e,{eraseRadius:pn}=e,{selectRadius:wn}=e,{enableButtonFlipVertical:sn=!1}=e,{enableTapToAddText:Xr=!0}=e,{enableMultiSelect:hn=!1}=e,{enableTextStyleControls:li=!0}=e,{locale:kn}=e,{snapThreshold:Ci=0}=e,{snapPointer:Uo=!0}=e,{enableSnapToContext:pi=!0}=e,{gridSize:xn=0}=e;const na=x=>{if(Ci===0)return[];let W;return pi&&(W={...it,x:0,y:0}),[...Kt.filter(R=>R!==x).filter(R=>!ao(R)).filter(R=>(K=>K.disableAcceptSnap!==!0)(R)).map(R=>On({...R},it)),W].filter(Boolean)},Vn=(x,W,R,K)=>x===0?{snapTargets:[]}:{snapThreshold:x,gridSize:W,gridRect:R,snapTargets:na(K)},Br=$n("isAnimated");D(t,Br,x=>r(194,le=x));const xa=$n("softKeyboardState"),Zn=x=>x.set(Ea(x)),ci=x=>Ea(x).find(ao),Ln=(x,W)=>{if(!ci(W))return S1(x),Tn(x,W)},ui=x=>{ci(x)&&x.update(W=>W.filter(R=>!ao(R)))},hi=x=>{const W=ci(x);if(W)return bf(W),Zn(x),W},Xn=(x,W,R=(K,Q)=>({...K,...Q}))=>{ci(W)&&W.update(K=>K.map(Q=>ao(Q)?R(Q,x):Q))},Tn=(x,W=Qe)=>(W.update(R=>[...R,x]),x),mi=(x,W,R)=>{const K=Mr({...x},W,{...R});return Ia(x,K,R),x},Go=(x,W)=>{const R=Ni(x,W),K=hd(x,W),Q=Math.PI/8,dt=Q*Math.round(K/Q)-ur%Q;W.x=x.x+R*Math.cos(dt),W.y=x.y+R*Math.sin(dt)},Io=$n("keysPressed");D(t,Io,x=>r(195,de=x));const Eo=(x,W,R)=>x===0||W&&R?x:W||R?-x:x,xo=x=>{if(x.x===null&&x.y===null)return Ao();x.x&&r(149,vo=tr({x:x.x,y:0}).x),x.y&&r(150,lo=tr({x:0,y:x.y}).y)},Ao=()=>{r(149,vo=null),r(150,lo=null)};let vo=null,lo=null;const Bi=(x,W)=>{const R=je(x);return tr(jn(R,W))},co=(x,W,R)=>{const K=(R-W)/x+1;return Array.from({length:K},(Q,dt)=>W+dt*x)},Zi=x=>{let W=[],R=[],K=x.points;if(x.x1!==void 0&&(K=[{x:x.x1,y:x.y1},{x:x.x2,y:x.y2}]),K){const Q=K.map(je),dt=ri(Q),At=Q[0],ce=Q[Q.length-1];W=[dt.x,dt.x+.5*dt.width,dt.x+dt.width,At.x,ce.x],R=[dt.y,dt.y+.5*dt.height,dt.y+dt.height,At.y,ce.y]}else if(x.text||x.width!==void 0||x.rx!==void 0){let Q;if(x.text&&x.height===void 0){const Ee=oo(x.text,x);Q=Wn(x.x,x.y,Ee.width,Ee.height)}else Q=x.width!==void 0?Ya(x):Ya({x:x.x-x.rx,y:x.y-x.ry,width:2*x.rx,height:2*x.ry});const dt=Oo(Q).map(je),At=Math.abs(x.rotation)>0?Ti(Q,x.rotation).map(je):dt,ce=ri(At),jt=Lr(ce),ne=.5*ce.width,Jt=.5*ce.height;W=[jt.x-ne,jt.x,jt.x+ne],R=[jt.y-Jt,jt.y,jt.y+Jt]}else if(x.x!==void 0){const Q=je(x);W=[Q.x],R=[Q.y]}return{x:W,y:R}},ii=(x,W,R)=>{let K,Q,dt,At=Number.Infinity,ce=null,jt=null;for(let ne=0;ne<x.length;ne++){Q=x[ne];for(let Jt=0;Jt<W.length;Jt++)dt=W[Jt],K=Math.abs(Q-dt),K<R&&(jt===null||K<At)&&(At=K,ce=Q,jt=dt)}return{origin:ce,target:jt}},ei=(x,W,R,K,Q)=>{const dt={x:null,y:null},At={x:null,y:null},ce=W.map(Zi);if(K>0){const jt=je({x:0,y:0}),ne=je({x:K,y:K}),Jt=je({x:Q.width,y:Q.height}),Ee=ne.x-jt.x,sr=co(Ee,jt.x,Jt.x),re=co(Ee,jt.y,Jt.y);ce.push({x:sr,y:re})}return ce.forEach(jt=>{const{snapTranslation:ne,snapLine:Jt}=((Ee,sr,re)=>{const vr={x:null,y:null},Le={x:null,y:null},ve=ii(Ee.x,sr.x,re);ve.target!==null&&(vr.x=ve.target,Le.x=ve.target-ve.origin);const Me=ii(Ee.y,sr.y,re);return Me.target!==null&&(vr.y=Me.target,Le.y=Me.target-Me.origin),{snapTranslation:Le,snapLine:vr}})(x,jt,R);ne.x!==null&&(At.x===null||Math.abs(ne.x)<Math.abs(At.x))&&(At.x=ne.x||0,dt.x=Jt.x),ne.y!==null&&(At.y===null||Math.abs(ne.y)<Math.abs(At.y))&&(At.y=ne.y||0,dt.y=Jt.y)}),{snapTranslation:At,snapLines:dt}},Oi=(x,W)=>(W.x!==null&&(x.x+=W.x),W.y!==null&&(x.y+=W.y),x),uo=(x,W,R,K)=>{const{snapThreshold:Q=0,gridSize:dt=0,gridRect:At,snapTargets:ce=[]}=K||{};let jt=null;if(Ii(x)){if(Q){const Ee=On({...x},it),sr=Bi(ms(W),R),re=Bi(fs(W),R),vr=Zi({...Ee,x1:sr.x,y1:sr.y,x2:re.x,y2:re.y}),{snapTranslation:Le,snapLines:ve}=ei(vr,ce,Q,dt,At);Oi(R,Le),xo(ve)}const ne=Bi(ms(W),R),Jt=Bi(fs(W),R);jt={x1:ne.x,y1:ne.y,x2:Jt.x,y2:Jt.y}}else if(x.points){if(Hh(Ze)&&fn(Ze,{selectedPoint:void 0}),Q){const ne=On({...x},it),Jt=Zi({...ne,points:W.points.map(re=>Bi(re,R))}),{snapTranslation:Ee,snapLines:sr}=ei(Jt,ce,Q,dt,At);Oi(R,Ee),xo(sr)}jt={points:W.points.map(ne=>Bi(ne,R))}}else if(Wo(x)||Qn(x)||di(x)){if(Q){const ne=On({...x},it),Jt=Bi(W,R),Ee=Zi({...ne,...Jt}),{snapTranslation:sr,snapLines:re}=ei(Ee,ce,Q,dt,At);Oi(R,sr),xo(re)}jt=Bi(W,R)}jt&&(mi(x,jt,it),Pn())},Yr={0:1,1:0,2:3,3:2},Nn={0:3,1:2,2:1,3:0},to=(x,W,R,K,Q)=>{const{shiftKey:dt,snapThreshold:At=0,gridSize:ce=0,gridRect:jt,snapTargets:ne=[],aspectRatio:Jt,beforeResizeShape:Ee=se}=Q||{},sr=At?(re,vr,Le)=>{const{snapTranslation:ve,snapLines:Me}=ei(Zi(re),ne,At,ce,jt);Oi(vr,ve),xo(Me);const Pe=Bi(Le(),vr);re.x=Pe.x,re.y=Pe.y}:se;if(Ii(x)||Jn(x)&&Te(x,"pathClose")){const[re]=R,vr=dt?Go:(ke,Ye)=>Ye;let Le,ve,Me;if(Ii(x))re===0?(Le=()=>ms(W),ve=ke=>vr(fs(W),ke),Me=(ke,Ye)=>{mi(ke,{x1:Ye.x,y1:Ye.y},it)}):re===1&&(Le=()=>fs(W),ve=ke=>vr(ms(W),ke),Me=(ke,Ye)=>{mi(ke,{x2:Ye.x,y2:Ye.y},it)});else{const ke=W.points;Le=()=>({...ke[re]}),ve=Ye=>{const cn=ke[ip(re-1,ke)],We=ke[ip(re+1,ke)];vr(cn,Ye),vr(We,Ye)},Me=(Ye,cn)=>{mi(Ye,{points:Ye.points.map((We,pr)=>re===pr?cn:We)},it)}}const Pe=Bi(Le(),K);sr(Pe,K,Le),ve(Pe),Me(x,Pe)}else if(ml(x)||di(x)||Qn(x)){let re,vr=!1,Le=!1;if(di(W))re=Dd(W);else if(ml(W))re=Ya(W);else if(Te(W,"width")){vr=!0,re=Ya(W);const We=oo(W.text,W);re.height=We.height}else{Le=!0,re=Ya(W);const We=oo(W.text,W);re.width=We.width,re.height=We.height}let ve=Jt;x.aspectRatio?ve=x.aspectRatio:!Q.shiftKey||vr||Le||(ve=re.width/re.height);const Me=Ya(re),Pe=Lr(Me),ke=x.rotation,Ye=Oo(Me),cn=Ti(Me,ke);if(R.length===1){let We=R[0];x.flipX&&(We=Yr[We]),x.flipY&&(We=Nn[We]);const[pr,mn,ki,fi]=Ye,ai=je(cn[We]),Bn=jn({...ai},K),qn=tr(Bn);sr(qn,K,()=>tr(ai));const Kn=lt(qn.x-cn[We].x,qn.y-cn[We].y),Pi=qi(He(Kn),-ke),io=lt(Ye[We].x+Pi.x,Ye[We].y+Pi.y);let Do;We===0&&(Do=ki),We===1&&(Do=fi),We===2&&(Do=pr),We===3&&(Do=mn);const Mo=ri([Do,io]);if(ve){const{width:Ha,height:ka}=Ki(Mo,ve),[ja,ls,Ri]=vl(Mo);Mo.width=Ha,Mo.height=ka,io.y<Do.y&&(Mo.y=Ri-ka),io.x<Do.x&&(Mo.x=ls-Ha)}const Ps=Ti(Mo,ke,Pe),Va=Qo(Ps),Na=qi(Ps[0],-ke,Va),Bo=qi(Ps[2],-ke,Va),Sa=ri([Na,Bo]);Ee(Sa),mi(x,di(x)?Xm(Sa):Sa,it)}else{R=R.map(Qr=>(x.flipX&&(Qr=Yr[Qr]),x.flipY&&(Qr=Nn[Qr]),Qr));const[We,pr]=R.map(Qr=>cn[Qr]),mn={x:We.x+.5*(pr.x-We.x),y:We.y+.5*(pr.y-We.y)},[ki,fi]=R.map(Qr=>Ye[Qr]),[ai,Bn]=R.map(Qr=>{const oa=Qr+2;return oa<4?Ye[oa]:Ye[oa-4]}),qn={x:ai.x+.5*(Bn.x-ai.x),y:ai.y+.5*(Bn.y-ai.y)},Kn=je(mn),Pi=jn({...Kn},K),io=tr(Pi);sr(io,K,()=>tr(Kn));const Do=lt(io.x-mn.x,io.y-mn.y),Mo=qi(He(Do),-ke),Ps=Un(He(ki),fi),Va=_o(Ps,Qr=>1-Math.abs(Math.sign(Qr))),Na=lt(Mo.x*Va.x,Mo.y*Va.y);jn(ki,Na),jn(fi,Na);const Bo=ri(Ye);if(ve){let Qr=Bo.width,oa=Bo.height;Va.y===0?oa=Qr/ve:Qr=oa*ve,Bo.width=Qr,Bo.height=oa,Va.y===0?Bo.y=qn.y-.5*oa:Bo.x=qn.x-.5*Qr}const Sa=Ti(Bo,ke,Pe),Ha=Qo(Sa),ka=qi(Sa[0],-ke,Ha),ja=qi(Sa[2],-ke,Ha),ls=ri([ka,ja]);let Ri;di(x)?Ri=Xm(ls):ml(x)?Ri=ls:vr&&(Ri={x:ls.x,y:ls.y,width:ls.width}),mi(x,Ri,it)}}Pn()};let Cn;const wo=(x,W)=>{const R=x.points.filter((K,Q)=>Q!==W);mi(x,{points:R,selectedPoint:void 0},it),Pn()},oi=()=>{if(Kt.length)return Kt.find(ao)},Zo=()=>{if(Kt.length)return Kt.findIndex(ao)},Wi=()=>{const x=oi();if(x)return bf(x),Pn(),x},So=()=>{if(!oi())return;const x=[...Kt];x.splice(Zo(),1),Qe.set(x)},Pn=()=>{Qe.set(Kt)},_i=(x,W=[],R=!0)=>{W.filter(Boolean).forEach(K=>delete x[K]),R&&Pn()},fn=(x,W,R=!0)=>{x=Object.assign(x,W),R&&Pn()},Yn=(x,W,R,K=!0)=>{x[W]=R,K&&Pn()},Lo=(x,W=!0)=>{Kt.forEach(R=>fn(R,x,!1)),W&&Pn()},Fo=()=>[...Kt].reverse().filter(Pa),eo=()=>[...Kt].reverse().find(Pa),Xi=()=>!!eo(),ko=(x,W=!0,R=!1)=>{const K=Kt.filter(At=>$d(At)&&Ca(At)),Q=K.findIndex(At=>At===x);if(((At,ce=!1)=>{if(!Cr(At))return!1;Qe.set(Kt.filter(jt=>jt!==At)),ce||yr(At)})(x,R)===!1)return;if(po=x,K.length-1<=0)return To();if(!W)return!0;const dt=Q-1<0?K.length-1:Q-1;return Qt(K[dt]),!0},wi=()=>{if(a){const W=[];return o.forEach((R,K)=>{$d(R)&&ko(R,K===o.length-1,!0)&&W.push(R)}),void(W.length&&Gt())}const x=eo();x&&ko(x)};let po;const To=(x={})=>{const{storePrevious:W=!0}=x;Object.keys(is).forEach(K=>is[K]={});const R=O();W&&(po=R),Lo({isSelected:!1,isEditing:!1,_prerender:!1}),R&&Be(R)},O=()=>Kt.find(Pa),Qt=(x,W=!0,R=!1)=>{if(ao(x))return;const K=O()||po,Q=Pa(x);po=void 0,Er(K,x)&&(R||To(),(dt=>{dt.isSelected=!0})(x),!Q&&Xe(x),W&&Pn())},Ar=x=>{vn&&vn.confirm&&x.isEditing&&vn.confirm();const W={isSelected:!1,isEditing:!1,_prerender:!1};x.selectedPoint>-1&&(W.selectedPoint=void 0),fn(x,W),Be(x)},Ue=x=>{fn(x,{isSelected:!0,isEditing:!0,_prerender:Ce==="inline"})},be=x=>{fn(x,{isSelected:!0,isEditing:!1,_prerender:!1})},$e=x=>{if(!x.length)return[];const W=x.filter(Cr);return Qe.set(Kt.filter(R=>!W.includes(R))),W},Kr=x=>{const W=oo(x.text,x);return Wn(x.x,x.y,x.width?Math.min(x.width,W.width):W.width,x.height?Math.min(x.height,W.height):W.height)},Ir=x=>{if(ml(x))return Ya(x);if(di(x))return Dd(x);const W=Kr(x);return W.width=Math.max(0,x.width||W.width),W},rn=(x,W,R=0,K=()=>!0)=>[...x].reverse().filter(K).map(Q=>({shape:Q,priority:1})).filter(Q=>{const{shape:dt}=Q,At=On(In(dt),it),ce=R+.5*(At.strokeWidth||0);if(Wo(At))return Bh(W,ce,At,dt.rotation);if(Qn(At)){const jt=Ir(At),ne=Bh(W,ce,jt,dt.rotation);let Jt=!1;if(ne&&!Pa(dt)){const Ee=Kr(At);dt.textAlign!=="right"||dt.flipX||(Ee.x=jt.x+jt.width-Ee.width),dt.textAlign==="center"&&(Ee.x=jt.x+.5*jt.width-.5*Ee.width),Jt=Bh(W,ce,Ee,dt.rotation,Lr(jt)),Jt||(Q.priority=-1)}return ne}return di(At)?((jt,ne,Jt,Ee,sr,re)=>{const vr=Xd(lt(Jt.x,Jt.y),Jt.rx,Jt.ry,Ee,sr,re,12);return w1(jt,ne,vr)})(W,ce,At,dt.rotation,dt.flipX,dt.flipY):Ii(At)?Yd(W,Math.max(16,ce),ms(At),fs(At)):Jn(At)&&At.pathClose?w1(W,ce,At.points):!!Jn(At)&&(At.points.length===1?Po(W,At.points[0])<ce*ce:Yy(W,Math.max(16,ce),At.points))}).sort((Q,dt)=>Q.priority<dt.priority?1:Q.priority>dt.priority?-1:0).map(Q=>Q.shape),bn=(x,W,R,K=0)=>{const Q=Math.abs(K),dt=Gs(W,R),At=K1(dt,Q),ce=(({start:jt,end:ne},Jt)=>{if(Jt===0)return[lt(jt.x,jt.y),lt(jt.x,jt.y),lt(ne.x,ne.y),lt(ne.x,ne.y)];const Ee=Math.atan2(ne.y-jt.y,ne.x-jt.x),sr=Math.sin(Ee)*Jt,re=Math.cos(Ee)*Jt;return[lt(sr+jt.x,-re+jt.y),lt(-sr+jt.x,re+jt.y),lt(-sr+ne.x,re+ne.y),lt(sr+ne.x,-re+ne.y)]})(At,Q);return x.filter(jt=>{const ne=On(In(jt),it);if(Ii(ne)||Jn(ne)){const Jt=ne.points?[...ne.points]:[ms(ne),fs(ne)];return!!Gy(At,Jt)}return((Jt,Ee)=>!!Jt.find(sr=>v1(sr,Ee))||!!Ee.find(sr=>v1(sr,Jt)))(ce,((Jt,Ee=12)=>{if(Wo(Jt))return Ti(Jt,Jt.rotation,Lr(Jt));if(Qn(Jt)){const sr=Ir(Jt);return Ti(sr,Jt.rotation,Lr(sr))}return di(Jt)?Xd(lt(Jt.x,Jt.y),Jt.rx,Jt.ry,Jt.rotation,Jt.flipX,Jt.flipY,Ee):[]})(ne))})};let Or,Si,ho,Ze,Xo,Vi,Da=!1,Yo=!1,gn=!1,Fn=!1,mo;const zo=x=>{mo=x.map(W=>({shape:W,shapeOrigin:In(W),shapeOriginComputed:On(In(W),it)}))},Ba=()=>{clearTimeout(Si),Si=void 0,r(152,Fn=!1),Ao()};let F=null;const oe=x=>{const W=_e(x.rotation)&&x.rotation!==0;if(Wo(x)){const R=Lr(x),K=Oo(x);return(x.flipX||x.flipY)&&Jl(K,x.flipX,x.flipY,R.x,R.y),W?$s(K,x.rotation,R.x,R.y):K}if(di(x)){const R=x,K=Oo(Dd(x));return(x.flipX||x.flipY)&&Jl(K,x.flipX,x.flipY,R.x,R.y),W?$s(K,x.rotation,R.x,R.y):K}if(Ii(x))return[ms(x),fs(x)];if(Jn(x)){if(x.bitmap&&!Te(x,"pathClose")){const R=ri(x.points);return R.x-=.5*x.strokeWidth,R.y-=.5*x.strokeWidth,R.width+=x.strokeWidth,R.height+=x.strokeWidth,oe({...x,...R})}return[...x.points]}if(Qn(x)){const R=Ir(x),K=Lr(R),Q=Oo(R);return(x.flipX||x.flipY)&&Jl(Q,x.flipX,x.flipY,K.x,K.y),W?$s(Q,x.rotation,K.x,K.y):Q}return[]},Ie=x=>{const W=oe(x);let R,K;return x.flipY?(R=Qo([W[0],W[1]]),K=yo(lt(W[1].x-W[2].x,W[1].y-W[2].y))):(R=Qo([W[2],W[3]]),K=yo(lt(W[2].x-W[1].x,W[2].y-W[1].y))),ji(K,20/Dr),{origin:R,dir:K}},xr=x=>W=>W.id===x,Nr=x=>{const W=xr(x);return R=>R.filter((K=>Q=>!K(Q))(W))},Wr=x=>{const W=xr(x),R=Nr(x);return()=>ar.update(K=>K.some(W)?R(K):K)},or=x=>{const W=Nr(x);return(...R)=>{ar.update(K=>[...W(K),...R.filter(Boolean)])}},Sr=Wr("markup-hover"),qr=or("markup-hover");let Pr;const Jr="markup-manipulator-segment-"+pe,Hn=Wr(Jr),Sn=or(Jr),Rn=(x,W)=>{const R=x[W],K=W-1<0?x[x.length-1]:x[W-1],Q=W+1<x.length?x[W+1]:x[0],dt=Un(He(K),R);yo(dt);const At=jn(ji(dt,10),R),ce=Un(He(Q),R);return yo(ce),[At,R,jn(ji(ce,10),R)]},_r=()=>{r(153,Pr=void 0),Sr()},Mi="markup-multi-selection-segment-"+pe,ia=Wr(Mi),qs=or(Mi),Cs=(x,W)=>{if(Ci<=0)return x;if(W)return Ao(),x;const R=tr(x),K=na(),{snapTranslation:Q,snapLines:dt}=ei(Zi(R),K,Ci,xn,n);return xo(dt),Oi(x,Q),x},rs=hr(0);D(t,rs,x=>r(196,Oe=x));const Oa="markup-grid-line-"+pe,Wa=Wr(Oa),ns=or(Oa),va="markup-snap-line",Co=Wr(va),_a=or(va);let vn;xa.subscribe(x=>{Ce==="inline"&&i&&i.isEditing&&x==="hidden"&&fo()});const ro=x=>{r(8,vn.innerHTML=v6(x),vn)},Gr=x=>{const W=x.value===void 0?x.innerHTML:x.value,R=i.format==="text"?Zb(W).split(/<br>|<br\/>/g).join(`
`).replace(/&nbsp;/g,"Â ").replace(/&amp;/g,"&"):W;return Kd(i)&&i.disableNewline!==!1?(K=>{const Q=K.split(/[\n\r]/g);return Q.length>1?Q.map(dt=>dt.trim()).filter(dt=>dt.length).join(" "):Q[0]})(R):R},no=()=>{const x=Gr(vn),W=Hl(i,x),R=W===!0?x:W;let K=vt.x,Q=vt.y;if(!i.height){const dt=Ti({...Pt},i.rotation),At=oo(R,d),ce=Ti({x:K,y:Q,...At},i.rotation),[jt,,ne]=dt,[Jt,,Ee]=ce;let sr=jt,re=Jt;i.flipX&&(sr=ne,re=Ee);const vr=Un(He(sr),re);K+=vr.x,Q+=vr.y}mi(i,{x:K,y:Q,text:R},it),Pn()},ln=x=>{const{key:W,ctrlKey:R,metaKey:K,altKey:Q}=x;return W==="Enter"&&(R||Q||K)},fo=()=>{c&&Wi(),vn&&vn.confirm&&vn.confirm(),vn&&no(),be(i),ee(i)},wa=()=>{c?So():(fn(i,{text:wt.text,x:wt.x,y:wt.y}),be(i))},Yi=(x,W,{flipX:R,flipY:K,rotation:Q},dt="top left")=>{let At,ce;const[jt,ne,Jt,Ee]=Ti(x,Q),[sr,re,vr,Le]=Ti(W,Q);return dt==="top center"?(At=Qo(K?[Ee,Jt]:[jt,ne]),ce=Qo(K?[Le,vr]:[sr,re])):dt==="top right"&&!R||dt==="top left"&&R?(At=K?Jt:ne,ce=K?vr:re):(At=K?Ee:jt,ce=K?Le:sr),Un(He(At),ce)},Ms=(x,W,R)=>lt(Ge(x.x)?$o(W.x+R.x,it.width):W.x+R.x,Ge(x.y)?$o(W.y+R.y,it.height):W.y+R.y),is={},bu=()=>wo(i,i.selectedPoint),Cl=()=>Ue(i),Ml=(x,W,R)=>{const{width:K,height:Q,...dt}=R,At=oo(W.text,dt),ce=Yi(Wn(R.x,R.y,x.width,x.height),Wn(R.x,R.y,At.width,At.height),R,"top "+W.textAlign),jt=R.disableNewline!==!1;_i(W,["width","height",jt&&"textAlign"]),fn(W,{...Ms(W,R,ce)})},uc=(x,W,R,K,Q={})=>{const{height:dt,...At}=R,ce=La(oo(W.text,At),Ee=>Math.ceil(Ee)),jt=An(Q.width||R.width||K.width,ce.height),ne=Q.textAlign||"left",Jt=Yi(Wn(R.x,R.y,x.width,x.height),Wn(R.x,R.y,jt.width,jt.height),R,"top "+ne);_i(W,["height"]),fn(W,{...Ms(W,R,Jt),width:Ge(W.width)?$o(jt.width,it.width):jt.width,textAlign:ne})},Pl=(x,W,R,K,Q={})=>{const dt=An(Q.width||K.width,Q.height||K.height),At=Q.textAlign||"left",ce=Yi(Wn(R.x,R.y,x.width,x.height),Wn(R.x,R.y,dt.width,dt.height),R,"top "+At);fn(W,{...Ms(W,R,ce),width:Ge(W.width)?$o(dt.width,it.width):dt.width,height:Ge(W.width)?$o(dt.height,it.height):dt.height,textAlign:At})},os=()=>{const x=La(oo(i.text,d),dt=>Math.ceil(dt)),W=Te(i,"height"),R=!W&&Te(i,"width"),K=i.id;let Q=is[K];if(Q||(is[K]={},Q=is[K]),W){Q.textAlign=i.textAlign,Q.width=d.width,Q.height=d.height;const dt=An(d.width,d.height);cl(i,"auto-height")?uc(dt,i,d,x,Q):cl(i,"auto-width")&&Ml(dt,i,d)}else if(R){Q.textAlign=i.textAlign,Q.width=d.width;const dt=An(d.width,x.height);cl(i,"auto-width")?Ml(dt,i,d):cl(i,"fixed-size")&&Pl(dt,i,d,x,Q)}else{Q.textAlign=i.textAlign||Q.textAlign;const dt=An(Math.ceil(x.width),Math.ceil(x.height));cl(i,"fixed-size")?Pl(dt,i,d,x,Q):cl(i,"auto-height")&&uc(dt,i,d,x,Q)}},dc=x=>{x.stopPropagation();const W=i.flipX||!1;Yn(i,"flipX",!W),ee(i)},pc=x=>{x.stopPropagation();const W=i.flipY||!1;Yn(i,"flipY",!W),ee(i)},Rl=x=>{Yn(i,"opacity",x)},hc=x=>{Rl(x),ee(i)},mc=x=>{x.stopPropagation(),x.target.blur(),wi()},fc=x=>{x.stopPropagation(),Kt.findIndex(W=>W===i)!==Kt.length-1&&(Qe.set(Kt.filter(W=>W!==i).concat([i])),ee(i))},gc=x=>{x.stopPropagation(),Il()},Il=()=>{const x=(a?o:[i]).filter(xf).map(W=>{const R=In(W);R.id=ra();const K=lt(50,-50);if(Te(R,"points")){const Q=Ql(R,["points"],it);Q.points.forEach(dt=>{dt.x+=K.x,dt.y+=K.y}),Ia(R,Q,it)}else if(Ii(R)){const Q=Ql(R,["x1","y1","x2","y2"],it);Q.x1+=K.x,Q.y1+=K.y,Q.x2+=K.x,Q.y2+=K.y,Ia(R,Q,it)}else{const Q=Ql(R,["x","y"],it);Q.x+=50,Q.y-=50,Ia(R,Q,it)}return Qe.set([...Kt,R]),Se(R),R});if(x.length>1)return To(),void x.forEach(W=>{Qt(W,!0,!0)});Qt(x[0])},Ks=hr(0,{stiffness:.2,damping:.7});D(t,Ks,x=>r(21,qt=x));let as;const $c=(x,W)=>{const{disableTextLayout:R=[]}=W;return"height"in W?R.includes("auto-height")?x.shapeIconButtonTextLayoutAutoWidth:x.shapeIconButtonTextLayoutAutoHeight:"width"in W?R.includes("auto-width")?x.shapeIconButtonTextLayoutFixedSize:x.shapeIconButtonTextLayoutAutoWidth:R.includes("fixed-size")?x.shapeIconButtonTextLayoutAutoHeight:x.shapeIconButtonTextLayoutFixedSize},yc=(x,W)=>{const{disableTextLayout:R=[]}=W;return"height"in W?R.includes("auto-height")?x.shapeTitleButtonTextLayoutAutoWidth:x.shapeTitleButtonTextLayoutAutoHeight:"width"in W?R.includes("auto-width")?x.shapeTitleButtonTextLayoutFixedSize:x.shapeTitleButtonTextLayoutAutoWidth:R.includes("fixed-size")?x.shapeTitleButtonTextLayoutAutoHeight:x.shapeTitleButtonTextLayoutFixedSize};let Js=!1,El=dn(),ss;const Qs=x=>{Ae(x),r(153,Pr=x)},bc=x=>{Qt(Kt[x])};let qo;function Al(x){Tb(x)&&x.target===qo&&x.preventDefault()}return jo(()=>{Co(),Wa(),Hn(),Sr(),qo.removeEventListener("touchmove",Al,!1)}),t.$$set=x=>{"uid"in x&&r(67,pe=x.uid),"ui"in x&&r(68,ar=x.ui),"disabled"in x&&r(0,Ke=x.disabled),"shapes"in x&&Ct(r(1,Qe=x.shapes)),"selection"in x&&r(69,Re=x.selection),"offset"in x&&r(2,Je=x.offset),"contextRotation"in x&&r(70,ur=x.contextRotation),"contextFlipX"in x&&r(71,$r=x.contextFlipX),"contextFlipY"in x&&r(72,zr=x.contextFlipY),"contextZoom"in x&&r(73,Dr=x.contextZoom),"active"in x&&r(74,dr=x.active),"opacity"in x&&r(75,Y=x.opacity),"parentRect"in x&&r(76,it=x.parentRect),"rootRect"in x&&r(3,G=x.rootRect),"utilRect"in x&&r(4,Bt=x.utilRect),"hoverColor"in x&&r(77,ae=x.hoverColor),"caretColor"in x&&r(78,De=x.caretColor),"gridColor"in x&&r(79,we=x.gridColor),"snapColor"in x&&r(80,Ot=x.snapColor),"textInputMode"in x&&r(5,Ce=x.textInputMode),"oninteractionstart"in x&&r(81,nr=x.oninteractionstart),"oninteractionupdate"in x&&r(82,lr=x.oninteractionupdate),"oninteractionrelease"in x&&r(83,ot=x.oninteractionrelease),"oninteractionend"in x&&r(84,Yt=x.oninteractionend),"oninteractioncancel"in x&&r(85,Ve=x.oninteractioncancel),"onaddshape"in x&&r(86,Se=x.onaddshape),"onupdateshape"in x&&r(87,ee=x.onupdateshape),"onselectshape"in x&&r(88,Xe=x.onselectshape),"onblurshape"in x&&r(89,Be=x.onblurshape),"onremoveshape"in x&&r(90,yr=x.onremoveshape),"ontapshape"in x&&r(91,$t=x.ontapshape),"onhovershape"in x&&r(92,Ae=x.onhovershape),"ontriggerhistorywrite"in x&&r(93,Gt=x.ontriggerhistorywrite),"onhovercanvas"in x&&r(94,me=x.onhovercanvas),"ontapcanvas"in x&&r(95,he=x.ontapcanvas),"onleavecanvas"in x&&r(96,er=x.onleavecanvas),"beforeSelectShape"in x&&r(97,Er=x.beforeSelectShape),"beforeDeselectShape"in x&&r(98,fe=x.beforeDeselectShape),"beforeRemoveShape"in x&&r(99,Cr=x.beforeRemoveShape),"beforeUpdateShape"in x&&r(100,Mr=x.beforeUpdateShape),"willRenderShapeControls"in x&&r(101,ir=x.willRenderShapeControls),"willRenderShapeTextControls"in x&&r(102,en=x.willRenderShapeTextControls),"willStartInteraction"in x&&r(103,ye=x.willStartInteraction),"mapEditorPointToImagePoint"in x&&r(104,tr=x.mapEditorPointToImagePoint),"mapImagePointToEditorPoint"in x&&r(105,je=x.mapImagePointToEditorPoint),"eraseRadius"in x&&r(106,pn=x.eraseRadius),"selectRadius"in x&&r(107,wn=x.selectRadius),"enableButtonFlipVertical"in x&&r(108,sn=x.enableButtonFlipVertical),"enableTapToAddText"in x&&r(109,Xr=x.enableTapToAddText),"enableMultiSelect"in x&&r(110,hn=x.enableMultiSelect),"enableTextStyleControls"in x&&r(6,li=x.enableTextStyleControls),"locale"in x&&r(7,kn=x.locale),"snapThreshold"in x&&r(111,Ci=x.snapThreshold),"snapPointer"in x&&r(112,Uo=x.snapPointer),"enableSnapToContext"in x&&r(113,pi=x.enableSnapToContext),"gridSize"in x&&r(114,xn=x.gridSize)},t.$$.update=()=>{var x,W;if(16384&t.$$.dirty[2]|2097152&t.$$.dirty[3]&&r(180,n=xn>0?{x:0,y:0,...it}:void 0),1&t.$$.dirty[0]|128&t.$$.dirty[6]&&r(12,i=!Ke&&Kt&&(oi()||eo())),131072&t.$$.dirty[3]|128&t.$$.dirty[6]&&r(172,o=hn?Kt.filter(Pa):[]),131072&t.$$.dirty[5]&&r(171,a=o.length>1),16384&t.$$.dirty[2]|196608&t.$$.dirty[5]&&r(192,s=a?o.map(R=>On(In(R),it)):[]),4096&t.$$.dirty[0]&&r(189,l=!!i),4096&t.$$.dirty[0]&&r(174,c=i&&ao(i)),4096&t.$$.dirty[0]|524288&t.$$.dirty[5]&&r(11,u=i&&!c?i.id:void 0),4104&t.$$.dirty[0]|16384&t.$$.dirty[2]&&r(15,d=G&&i&&On(In(i),it)),4096&t.$$.dirty[0]|524288&t.$$.dirty[5]&&r(155,p=!(!i||!c)),36864&t.$$.dirty[0]|8192&t.$$.dirty[2]&&r(187,h=i&&Y&&oe(d)||[]),65536&t.$$.dirty[5]|64&t.$$.dirty[6]&&r(184,f=a?s.map(oe):[]),4096&t.$$.dirty[0]|65536&t.$$.dirty[5]&&r(191,g=!a&&i&&T1(x=i)&&$l(x)&&x.disableResize!==!0&&(ml(x)||_d(x)||di(x)||Ii(x)||Jn(x)&&Te(x,"pathClose"))&&!ps(i)),4096&t.$$.dirty[0]|65536&t.$$.dirty[5]&&r(18,$=!a&&i&&(R=>T1(R)&&R.disableRotate!==!0&&(ml(R)||Te(R,"text")||di(R)))(i)&&!ps(i)),4096&t.$$.dirty[0]&&r(16,b=i&&Qn(i)&&!_d(i)&&!ps(i)&&i.disableTextScale===!1),4096&t.$$.dirty[0]|32&t.$$.dirty[6]&&r(20,v=!!g&&function(R){return!!R&&(Qn(R)&&!R.height?[[1,2],[3,0]]:!Ii(R)&&!Jn(R))}(i)),1052672&t.$$.dirty[0]|32&t.$$.dirty[6]&&r(33,w=!!i&&!Array.isArray(v)&&g),196608&t.$$.dirty[5]&&r(190,S=a?(R=>{const K=R.map(dt=>oe(On(dt,it))).flat(),Q=ri(K);return Oo(Q)})(o):[]),4096&t.$$.dirty[0]|65536&t.$$.dirty[5]|2&t.$$.dirty[6]&&r(17,P=i&&h.length>1||a),4096&t.$$.dirty[3]|65536&t.$$.dirty[5]|18&t.$$.dirty[6]&&r(185,M=a?S.map(je):h.map(je)),4&t.$$.dirty[0]|1073741824&t.$$.dirty[5]&&r(14,E=M.map(R=>lt(R.x-Je.x,R.y-Je.y))),4096&t.$$.dirty[0]&&r(19,C=i&&i.points&&_e(i.selectedPoint)?i.selectedPoint:-1),524288&t.$$.dirty[0]&&r(164,z=C>=0),540672&t.$$.dirty[0]|512&t.$$.dirty[5]&&r(169,V=z?E[C]:void 0),4096&t.$$.dirty[0]|8&t.$$.dirty[6]&&r(32,L=l&&(_d(i)?!Te(i,"disableNewline")||!i.disableNewline:i.disableNewline===!1)),4096&t.$$.dirty[3]|536870912&t.$$.dirty[4]&&(Pr&&je&&!Pa(Pr)&&Ca(Pr)?(R=>{const K=oe(On(In(R),it));if(!K)return;const Q=K.map(je);let dt=!1;R.pathClose===!0?dt=!0:Jn(R)?dt=!Te(R,"pathClose"):Q.length>2&&(dt=!0);const At=R.selectionStyle==="hook",ce=At?Q.map((ne,Jt,Ee)=>({id:"markup-hover",points:Rn(Ee,Jt),strokeColor:[0,0,0,.1],strokeWidth:2})):[{id:"markup-hover",points:Q.map(ne=>lt(ne.x+1,ne.y+1)),strokeColor:[0,0,0,.1],strokeWidth:2,pathClose:dt}],jt=At?Q.map((ne,Jt,Ee)=>({id:"markup-hover",points:Rn(Ee,Jt),strokeColor:ae,strokeWidth:2})):[{id:"markup-hover",points:Q,strokeColor:ae,strokeWidth:2,pathClose:dt}];qr(...ce,...jt)})(Pr):Sr()),442368&t.$$.dirty[0]|8192&t.$$.dirty[2]&&r(186,y=P&&$&&Y&&E?(R=>{const K=Ie(R),Q=je({x:K.origin.x+K.dir.x,y:K.origin.y+K.dir.y});return{origin:je(K.origin),position:Q}})(d):void 0),4&t.$$.dirty[0]|1&t.$$.dirty[6]&&r(31,ct=y&&lt(y.position.x-Je.x,y.position.y-Je.y)),245760&t.$$.dirty[0]|8192&t.$$.dirty[2]&&r(188,j=P&&b&&Y&&E?(R=>{const K=oe(R);let Q=2;R.flipX&&R.flipY?Q=0:R.flipX?Q=3:R.flipY&&(Q=1);const dt={...K[Q]};return je({x:dt.x,y:dt.y})})(d):void 0),4&t.$$.dirty[0]|4&t.$$.dirty[6]&&r(30,k=j&&lt(j.x-Je.x,j.y-Je.y)),512&t.$$.dirty[6]&&r(179,xt=!!(de||[]).find(R=>[91,93,17].includes(R))),524288&t.$$.dirty[3]|16777216&t.$$.dirty[5]&&r(181,N=!(xt||!Uo)),4096&t.$$.dirty[0]|8192&t.$$.dirty[2]|1073741824&t.$$.dirty[4]|1141374976&t.$$.dirty[5]&&i&&M&&Y>0&&(i===Pr&&_r(),((R,K,Q)=>{if(!Ca(K))return;const dt=Jn(K),At=dt&&Te(K,"pathClose"),ce=At&&(Bn=>Bn.strokeWidth&&((qn,Kn)=>{const Pi=qn.strokeColor;return!!Pi&&(Pi.length===3||Pi[3]>0)})(Bn))(K),jt=ao(K),ne=ps(K),Jt=K.selectionStyle==="hook",Ee=K.disableShowPoints!==!0,{selectionOpacity:sr=1}=K;if(jt&&dt&&!At)return;const re=[],vr=[...M],Le=vr[vr.length-1],ve=vr[0],Me=(ne?.05:.1)*R*sr,Pe=Me>0,ke=(ne?.5:1)*R*sr,Ye=ke>0,cn=[0,0,0],We=[1,1,1],pr=ne?1:1.5;de.includes(16)&&Le&&Q&&Go(Le,Q);const mn=(vr.length&&At&&jt&&Q?Po(ve,Q):1/0)<=256,ki=(vr.length&&At&&jt&&Q?Po(Le,Q):1/0)<=256;!mn&&Q&&vr.push(Q);const fi=vr.length>1;let ai=!1;K.pathClose===!0?ai=!0:Jn(K)?ai=ao(K)?mn:!Te(K,"pathClose"):vr.length>2&&(ai=!0),fi&&Pe&&(Jt?re.push(...vr.map((Bn,qn,Kn)=>({id:Jr,points:Rn(Kn,qn),strokeColor:cn,opacity:Me}))):re.push({id:Jr,points:vr.map(Bn=>lt(Bn.x+1,Bn.y+1)),pathClose:ai,strokeColor:cn,strokeWidth:2,opacity:Me})),At&&Pe&&Ee&&re.push(...vr.map(Bn=>({id:Jr,...Bn,rx:2*pr,ry:2*pr,backgroundColor:cn,opacity:Me}))),y&&Pe&&re.push({id:Jr,points:[lt(y.origin.x+1,y.origin.y+1),lt(y.position.x+1,y.position.y+1)],strokeColor:cn,strokeWidth:2,opacity:Me}),fi&&Ye&&(Jt?re.push(...vr.map((Bn,qn,Kn)=>({id:Jr,points:Rn(Kn,qn),strokeColor:We,strokeWidth:pr,opacity:ke}))):re.push({id:Jr,points:vr,pathClose:ai,strokeColor:We,strokeWidth:pr,backgroundColor:jt&&At&&K.backgroundColor&&K.backgroundColor[3]>0?K.backgroundColor:[0,0,0,0],opacity:ke})),At&&Ee&&re.push(...vr.map(Bn=>({id:Jr,...Bn,rx:3*pr,ry:3*pr,backgroundColor:[.5,.5,.5],strokeWidth:pr,strokeColor:We}))),At&&jt&&Ee&&M.length>=3&&re.push({...ve,id:Jr,rx:pr*(mn?5:4),ry:pr*(mn?5:4),backgroundColor:mn?ae:[.5,.5,.5],strokeWidth:pr,strokeColor:We}),At&&jt&&ce&&Ee&&!mn&&h.length>=2&&re.push({...Le,id:Jr,rx:pr*(ki?5:4),ry:pr*(ki?5:4),backgroundColor:ki?ae:[.5,.5,.5],strokeWidth:pr,strokeColor:We}),y&&Ye&&!Jt&&re.push({id:Jr,points:[{x:y.origin.x,y:y.origin.y},{x:y.position.x,y:y.position.y}],strokeColor:We,strokeWidth:pr,opacity:ke}),Sn(...re)})(Y,i,c&&Jn(i)?Cs({...ss},!N):void 0)),4096&t.$$.dirty[0]&&(i||(_r(),Hn())),4096&t.$$.dirty[3]|536870912&t.$$.dirty[5])if(f.length){ia();const R=f.map(K=>({id:Mi,points:K.map(je),strokeWidth:1,strokeColor:[1,1,1,.5],pathClose:!0}));qs(...R)}else ia();536870912&t.$$.dirty[4]&&r(182,nt=!!Pr),134217728&t.$$.dirty[4]&&r(183,ft=!!Ze),1073741824&t.$$.dirty[4]|469762048&t.$$.dirty[5]&&(!ss||ft||nt||Cs({...ss},!N)),131072&t.$$.dirty[2]|2101248&t.$$.dirty[3]|33554432&t.$$.dirty[5]|1024&t.$$.dirty[6]&&xn>0&&n&&je&&((R,K,Q,dt)=>{const At=je({x:0,y:0}),ce=je({x:R,y:R}),jt=je({x:K.width,y:K.height}),ne=ce.x-At.x;if(rs.set(ne>6?1:0),dt<=0)return Wa();const Jt=co(ne,At.x,jt.x).map(sr=>({id:Oa,opacity:dt,points:[{x:sr,y:At.y},{x:sr,y:jt.y}],strokeWidth:1,strokeColor:Q})),Ee=co(ne,At.y,jt.y).map(sr=>({id:Oa,opacity:dt,points:[{x:At.x,y:sr},{x:jt.x,y:sr}],strokeWidth:1,strokeColor:Q}));ns(...Ee,...Jt)})(xn,n,we,Oe),262144&t.$$.dirty[2]|4096&t.$$.dirty[3]|100663296&t.$$.dirty[4]|16777216&t.$$.dirty[5]&&je&&(xt?Co():((R,K,Q)=>{if(R===null&&K===null)return Co();let dt,At;R!==null&&(dt={id:va,strokeColor:Q,strokeWidth:1.5,points:[je({x:R,y:0}),je({x:R,y:it.height})]}),K!==null&&(At={id:va,strokeColor:Q,strokeWidth:1.5,points:[je({x:0,y:K}),je({x:it.width,y:K})]}),_a(dt,At)})(vo,lo,Ot)),4096&t.$$.dirty[2]&&(R=>{if(!R)return Lo({_prerender:!1});const K=Kt.find(Q=>Q.isEditing);K&&fn(K,{_prerender:Ce==="inline"})})(dr),512&t.$$.dirty[6]&&de&&de.length&&(()=>{const[R]=de;R!==8&&R!==46||Xi()&&(i.isEditing||$d(i)&&(Ja(document.activeElement)||(Jn(i)&&_e(i.selectedPoint)?setTimeout(()=>wo(i,i.selectedPoint),0):setTimeout(()=>wi(),0))))})(),288&t.$$.dirty[0]&&vn&&Ce==="inline"&&vn.focus(),4096&t.$$.dirty[0]&&r(178,H=i&&Qn(i)),4096&t.$$.dirty[0]|8388608&t.$$.dirty[5]&&r(13,Z=H&&Hl(i)!==!1&&ps(i)),8192&t.$$.dirty[0]&&r(173,wt=Z?{...i}:void 0),16384&t.$$.dirty[2]|262144&t.$$.dirty[5]&&r(175,vt=wt&&On({...wt},it)),1048576&t.$$.dirty[5]&&r(177,et=vt&&oo(vt.text,vt)),5242880&t.$$.dirty[5]&&(Pt=vt&&Wn(vt.x,vt.y,et.width,et.height)),12288&t.$$.dirty[0]&&r(27,Et=Z?i.text:""),12296&t.$$.dirty[0]|16384&t.$$.dirty[2]&&r(176,kt=G&&i&&Z&&On({...In(i),width:_e(i.width)?Math.floor(i.width):void 0,height:_e(i.height)?Math.floor(i.height):void 0},it)),8224&t.$$.dirty[0]|2097152&t.$$.dirty[5]&&r(29,st=Z&&((R,K)=>{const{textAlign:Q="left",fontFamily:dt="sans-serif",fontWeight:At="normal",fontStyle:ce="normal",letterSpacing:jt="normal",textShadowX:ne=0,textShadowY:Jt=0,textShadowBlur:Ee=0,textShadowColor:sr,textOutlineWidth:re=0,textOutlineColor:vr}=R,Le="!important",ve=`caret-color:${rt};text-align:${Q}${Le};font-family:${dt}${Le};font-weight:${At}${Le};font-style:${ce}${Le};letter-spacing:${_e(jt)?jt+"px":"normal"}${Le}`;if(K==="modal")return ve;const Me=re?`;-webkit-text-stroke:${2*re}px ${Ai(vr)} ${Le}`:"",Pe=Ee||ne||Jt?`;text-shadow:${ne}px ${Jt}px ${Ee}px ${Ai(sr)} ${Le}`:"";let ke=R.fontSize,Ye=1,cn="";ke>1e3&&Aa()&&(Ye=ke/1e3,cn=`transform-origin:0 0;transform:scale(${Ye})`,ke=1e3);let We=R.lineHeight/Ye;const pr=Ai(R.color),mn=.5*Math.max(0,ke-We);return`--font-scalar:${Ye};--bottom-inset:${mn}px;padding:${mn}px 0 0${Le};color:${pr}${Le};font-size:${ke}px${Le};line-height:${We}px${Le};${ve};${cn}${Me}${Pe}`})(kt,Ce)),8196&t.$$.dirty[0]|2304&t.$$.dirty[2]|2097152&t.$$.dirty[5]&&r(28,Ut=Z&&((R,K,Q,dt)=>{let At,ce;R.width&&R.height?(At=Lr(R),ce=ts(R)):(ce=oo(i.text,d),ce.width=d.width||ce.width,At=lt(R.x+.5*ce.width,R.y+.5*ce.height));const jt=Math.max(0,R.fontSize-R.lineHeight)+R.lineHeight,ne=je(At);let Jt=ne.x-K.x-.5*ce.width,Ee=ne.y-K.y-.5*ce.height,sr=R.flipX,re=R.flipY,vr=R.rotation;$r&&zr?(sr=!sr,re=!re):$r?(sr=!sr,vr=-vr):zr&&(re=!re,vr=-vr),vr+=dt;const Le=Q*(sr?-1:1),ve=Q*(re?-1:1);return`--line-height:${jt}px;width:${ce.width}px;height:${ce.height}px;transform:translate(${Jt}px,${Ee}px) rotate(${vr}rad) scale(${Le}, ${ve})`})(kt,Je,Dr,ur)),65536&t.$$.dirty[2]&&(rt=De?Ai(De):"auto"),8480&t.$$.dirty[0]&&Z&&vn&&Ce==="inline"&&ro(Et),4096&t.$$.dirty[0]|33&t.$$.dirty[5]&&r(160,X=i&&!p?i:X),32&t.$$.dirty[5]&&r(162,q=X&&$v(X)),32&t.$$.dirty[5]&&r(157,Ft=X&&cl(X)),32&t.$$.dirty[5]&&r(159,zt=X&&xf(X)),32&t.$$.dirty[5]&&r(158,yt=X&&$d(X)),65568&t.$$.dirty[5]&&r(161,Dt=!a&&X&&(R=>R.disableReorder!==!0)(X)),32&t.$$.dirty[5]&&r(156,Wt=X&&Hl(X)!==!1),32&t.$$.dirty[5]&&r(163,at=X&&Te(X,"backgroundImage")&&k1(X,"opacity")),4128&t.$$.dirty[0]&&r(166,St=i&&i.format==="html"&&Ce==="inline"),4096&t.$$.dirty[0]|2049&t.$$.dirty[5]&&r(170,pt=i&&(!p||St)),268435456&t.$$.dirty[4]|32768&t.$$.dirty[5]|256&t.$$.dirty[6]&&Ks.set(pt&&!Fn?1:0,{hard:le===!1}),16384&t.$$.dirty[0]|40960&t.$$.dirty[5]&&r(168,Xt=pt&&E.length?(W=ri(E),_o(lt(W.x+.5*W.width,W.y),du)):Xt),528&t.$$.dirty[0]|24576&t.$$.dirty[5]&&r(167,Zt=(V||Xt)&&as&&Bt&&((R,K,Q,dt)=>{const At=R.x,ce=R.y,jt=At+R.width;let ne=Math.max(K.x-.5*Q.width,At),Jt=Math.max(K.y-Q.height+dt,ce);return ne+Q.width>jt&&(ne=jt-Q.width),lt(ne,Jt)})(Bt,V||Xt,as,-16)),4096&t.$$.dirty[5]&&r(26,ie=Zt?`translate(${Zt.x}px, ${Zt.y}px)`:void 0),2097152&t.$$.dirty[0]|4096&t.$$.dirty[5]&&r(25,gt=Zt?qt:void 0),8192&t.$$.dirty[0]&&r(165,te=Z?"text":"shape"),6272&t.$$.dirty[0]|33536&t.$$.dirty[3]|4094&t.$$.dirty[5]|128&t.$$.dirty[6]&&r(24,xe=te==="text"&&en&&St?pu(()=>en([["div","text-styles",{class:"PinturaShapeControlsGroup"},[...[["bold",{label:"B",style:"font-weight:900;",title:"Bold",shortcut:["CMD","B"]}],["italic",{label:"I",style:"font-family:Times New Roman;font-style:italic;",title:"Italic",shortcut:["CMD","I"]}],["underline",{label:"U",style:"text-decoration:underline;",title:"Underline",shortcut:["CMD","U"]}],["strikeThrough",{label:"S",style:"text-decoration:line-through;",title:"Strikethrough",shortcut:["CMD","S"]}]].map(([R,K])=>["Button","style-"+R,{onclick:()=>document.execCommand(R),...K,style:"font-size:1.25em;text-underline-offset:1px;text-decoration-thickness:1.5px;font-weight:400;"+K.style}])]],["div","text-reset",{class:"PinturaShapeControlsGroup"},[["Button","style-reset",{onclick:()=>document.execCommand("removeFormat"),style:"font-weight:400",title:"Remove styles",label:[["span","T",{style:"font-size:1.25em;font-style:italic;font-family:Times New Roman;text-decoration:underline",textContent:"T"}],["span","x",{style:"position:relative;top:.175rem;",innerHTML:"&times;"}]]}]]]],u)):te==="shape"&&ir&&u?pu(()=>ir(z?[["div","epsilon",{class:"PinturaShapeControlsGroup"},[["Button","remove-point",{onclick:bu,label:kn.shapeTitleButtonRemove,icon:kn.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]]]]:[at&&["div","alpha",{class:"PinturaShapeControlsGroup"},[["ToggleSlider","adjust-opacity",{onrelease:hc,onchange:Rl,step:.01,value:Te(i,"opacity")?i.opacity:1,label:(R,K,Q)=>Math.round(R/Q*100)+"%",min:0,max:1,direction:"x"}]]],["div","beta",{class:"PinturaShapeControlsGroup"},[q&&["Button","flip-horizontal",{onclick:dc,label:kn.shapeTitleButtonFlipHorizontal,icon:kn.shapeIconButtonFlipHorizontal,hideLabel:!0}],q&&sn&&["Button","flip-vertical",{onclick:pc,label:kn.shapeTitleButtonFlipVertical,icon:kn.shapeIconButtonFlipVertical,hideLabel:!0}],Dt&&["Button","to-front",{onclick:fc,label:kn.shapeTitleButtonMoveToFront,icon:kn.shapeIconButtonMoveToFront,hideLabel:!0,disabled:Kt[Kt.length-1]===X}],zt&&["Button","duplicate",{onclick:gc,label:kn.shapeTitleButtonDuplicate,icon:kn.shapeIconButtonDuplicate,shortcut:["CMD","D"],hideLabel:!0}],yt&&["Button","remove",{onclick:mc,label:kn.shapeTitleButtonRemove,icon:kn.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]].filter(Boolean)],Wt&&Ft&&["div","gamma",{class:"PinturaShapeControlsGroup"},[["Button","text-layout",{onclick:os,label:Fi(yc,kn,i),icon:Fi($c,kn,i),hideLabel:!0}]]],Wt&&["div","delta",{class:"PinturaShapeControlsGroup"},[["Button","edit-text",{label:kn.shapeLabelInputText,onclick:Cl}]]]].filter(Boolean),u)):[]),128&t.$$.dirty[0]|128&t.$$.dirty[6]&&r(23,_=Kt.filter(Ca).filter(R=>R.id).filter(R=>!ao(R)).map(R=>({id:R.id,color:Qn(R)?R.color:Ii(R)?R.strokeColor:R.backgroundColor,name:R.name||kn["shapeLabelTool"+W2(vv(R))]}))),1024&t.$$.dirty[0]&&qo&&qo.addEventListener("touchmove",Al,!1)},[Ke,Qe,Je,G,Bt,Ce,li,kn,vn,as,qo,u,i,Z,E,d,b,P,$,C,v,qt,Js,_,xe,gt,ie,Et,Ut,st,k,ct,L,w,Br,Io,x=>{const{origin:W}=x.detail,R=hn&&de.includes(16);mo=void 0,r(151,Ze=void 0),Xo=void 0,Vi=void 0,Da=!1,ho=void 0,Yo=!1,gn=!1,Ao(),clearTimeout(Si),Si=setTimeout(()=>r(152,Fn=!0),250);const K=oi();if(!K||Jn(K)&&Te(K,"pathClose")||Wi(),Or=tr(He(W)),K&&Jn(K)&&Te(K,"pathClose"))return nr(x);const Q=rn(Kt,Or,wn,At=>Ca(At)),dt=Q.length&&Q.shift();if(i&&ps(i))if(dt!==i)fo();else{const At=Te(i,"height"),ce=!At&&Te(i,"width");if(At||ce){const jt=In(i),ne=In(jt);On(ne,it);const Jt=La(oo(jt.text,ne),re=>Math.ceil(re)),Ee=An(ne.width,ne.height||Jt.height);Ml(Ee,jt,ne),gn=rn([{...jt,strokeWidth:"5%"}],Or,0).length===0}}if(i&&Xr&&(Yo=!0),!dt&&i&&ps(i)&&Ar(i),!!ye(W)){if(dt&&Pa(dt))return Da=!0,r(151,Ze=dt),a?(R&&Ar(dt),void zo(o)):(Xo=In(Ze),void(Vi=On(In(Ze),it)));if(ho=dt||void 0,!nr(x)&&dt){if(Qt(dt,!0,R),r(151,Ze=dt),a)return zo(o);Xo=In(Ze),Vi=On(In(Ze),it)}}},x=>{Ba(),Ve(x)},x=>{const{translation:W,ctrlKey:R,metaKey:K,shiftKey:Q,position:dt}=x.detail;if(Ze){if(!$l(Ze))return;if(ps(Ze)){if(!gn)return;fo()}if(Q){let ce=Math.abs(W.x),jt=Math.abs(W.y);F==="x"&&(jt-=64),F==="y"&&(ce-=64),ce>jt?(W.y=0,F="x"):jt>ce&&(W.x=0,F="y")}else F=null;const At=R||K;return mo?o.every($l)?void mo.forEach(({shape:ce,shapeOriginComputed:jt})=>{uo(ce,jt,W,{...Vn(0,xn,n,ce)})}):void 0:uo(Ze,Vi,W,{...Vn(At?0:Ci,xn,n,Ze)})}lr(x)},x=>{if(Ba(),Ze){if(!a)if(x.detail.isTap&&Jn(Ze)&&p2(Ze)){const{position:W}=x.detail,R=tr(He(W));((K,Q)=>{const dt=K.points,At=[];for(let Jt=0;Jt<dt.length-1;Jt++)At.push([dt[Jt],dt[Jt+1]]);At.push([dt[dt.length-1],dt[0]]);const ce=At.findIndex(([Jt,Ee])=>Yd(Q,6,Jt,Ee));let jt;const ne=[];for(let Jt=0;Jt<At.length;Jt++)ne.push(At[Jt][0]),Jt===ce&&(jt=Jt+1,ne.push(Q));mi(K,{points:ne,selectedPoint:jt},it),Pn()})(Ze,R)}else x.detail.isTap&&Da&&Qn(Ze)&&Hl(Ze)!==!1&&Ue(Ze)}else ot(x)},x=>{const W=ho&&x.detail.isTap,R=hn&&de.includes(16);if(x.detail.isTap&&setTimeout(()=>{he({target:Ze||ho,position:Or},0)}),Ze)return $t(Ze),K=Ze,Q=Xo,JSON.stringify(K)!==JSON.stringify(Q)&&ee(Ze),void r(151,Ze=void 0);var K,Q;let dt=!0;if(!R){const At=O();dt=!At||fe(At,ho||void 0),dt&&To({storePrevious:!1})}Yt(x),dt&&W&&Qt(ho,!0,R)},rs,x=>{r(152,Fn=!0),r(151,Ze=i),Vi=d},x=>{if(!Ze)return void r(152,Fn=!1);const{translation:W,indexes:R,shiftKey:K,ctrlKey:Q,metaKey:dt,isNudge:At}=x.detail;to(Ze,Vi,R,W,{shiftKey:!At&&K,...Vn(Q||dt?0:Ci,xn,n,Ze)}),Hh(Ze)&&Po(W)>16&&fn(Ze,{selectedPoint:void 0})},x=>{if(!Ze)return void r(152,Fn=!1);Qt(Ze);const{isTap:W,translation:R,indexes:K}=x.detail;W&&(Hh(Ze)&&fn(Ze,{selectedPoint:Ze.selectedPoint===K[0]?void 0:K[0]}),$t(Ze)),r(151,Ze=void 0),r(152,Fn=!1),ee(i)},x=>{Cn=Ie(d).origin,r(152,Fn=!0),r(151,Ze=i),Vi=d},x=>{if(!Ze)return void r(152,Fn=!1);const{translation:W,shiftKey:R}=x.detail;((K,Q,dt,At)=>{const ce=Ir(On(In(K),it)),jt=Lr(ce),ne=Bi(Cn,dt);let Jt=hd(ne,jt)+Math.PI/2;if(At.shiftKey){const Ee=Math.PI/16;Jt=Ee*Math.round(Jt/Ee)-ur%Ee}mi(K,{rotation:Jt},it),Pn()})(Ze,0,W,{shiftKey:R})},()=>{Ze?(Qt(Ze),r(151,Ze=void 0),r(152,Fn=!1),ee(i)):r(152,Fn=!1)},x=>{r(152,Fn=!0),r(151,Ze=i),Vi=d},x=>{if(!Ze)return void r(152,Fn=!1);const{translation:W,ctrlKey:R,metaKey:K}=x.detail;((Q,dt,At,ce)=>{const jt=Ya(dt),ne=oo(dt.text,dt);jt.width||(jt.width=ne.width),jt.height||(jt.height=ne.height);let Jt=2;Q.flipX&&Q.flipY?Jt=0:Q.flipX?Jt=3:Q.flipY&&(Jt=1),to(Q,dt,[Jt],At,{...ce,aspectRatio:jt.width/jt.height,beforeResizeShape:Ee=>{const sr=Ee.width/jt.width;Ee.fontSize=dt.fontSize*sr,dt.width||delete Ee.width,dt.height||delete Ee.height}})})(Ze,Vi,W,{...Vn(R||K?0:Ci,xn,n,Ze)})},()=>{Ze?(Qt(Ze),r(151,Ze=void 0),r(152,Fn=!1),ee(i)):r(152,Fn=!1)},x=>{const{key:W}=x,R=/escape/i.test(W);if(Xi())return R?(x.preventDefault(),x.stopPropagation(),Ar(i)):void(zt&&W==="d"&&(x.metaKey||x.ctrlKey)&&(x.preventDefault(),x.stopPropagation(),Il()))},x=>{const W=Hl(i,x);return W===!0?x:W},no,x=>{const{target:W,key:R}=x,K=W.value||W.innerText,Q=W.selectionStart||0,dt=W.selectionEnd||K.length,At=K.substring(0,Q)+R+K.substring(dt);if(Hl(i,At)!==At)return x.preventDefault()},x=>Kd(i)&&/enter/i.test(x.key)&&i.disableNewline!==!1?x.preventDefault():/arrow/i.test(x.code)?x.stopPropagation():/escape/i.test(x.key)?wa():void 0,ln,x=>{if(ln(x))return fo()},fo,wa,Ks,x=>{const W=Fo();W&&(W.find(ps)||W.find(R=>!$l(R))||W.forEach(R=>{r(151,Ze=R),Vi=On(In(Ze),it),uo(Ze,Vi,x.detail)}))},x=>{r(22,Js=!0)},({relatedTarget:x})=>{x&&x.classList.contains("shape-selector__button")||r(22,Js=!1)},x=>{if(x.pointerType==="touch"||x.target.className!=="PinturaShapeEditor")return void er();(Fn||Si)&&Qs(void 0);const W=U1(x,G);r(154,ss=He(W));const R=_o(tr(W),Q=>Math.round(Q));if(zs(R,El)||(El=He(R),me(Fn,W,R),Fn||Si)||p)return;const[K]=rn(Kt,R,0,Ca);K&&ao(K)||Qs(K)},x=>{x.pointerType!=="touch"&&er()},bc,pe,ar,Re,ur,$r,zr,Dr,dr,Y,it,ae,De,we,Ot,nr,lr,ot,Yt,Ve,Se,ee,Xe,Be,yr,$t,Ae,Gt,me,he,er,Er,fe,Cr,Mr,ir,en,ye,tr,je,pn,wn,sn,Xr,hn,Ci,Uo,pi,xn,Zn,ci,Ln,ui,hi,Xn,Tn,(x,W={})=>{let R,K,Q,dt=[],At=di(x),ce=Qn(x),jt=W.position==="relative";const ne=W.interpolateInput,Jt=na(),Ee=Le=>{if(!Ci)return Le;const ve=tr(Le),{snapTranslation:Me,snapLines:Pe}=ei(Zi(ve),Jt,Ci,xn,n);return Oi(Le,Me),xo(Pe),Le},sr=!!O(),re=W.isSelection?Re:Qe,vr=W.inputMode==="step";if(Jn(x)){if(vr){let Le=!1;const ve=(Me,Pe)=>{const ke=ci(re),Ye=Me&&lt(Ad(Me.x,it.width),Ad(Me.y,it.height)),cn=Ye&&je(Ye);de.includes(16)&&cn&&Go(cn,Pe);const We=tr(Pe),pr=ke.points.length?ke.points[0]:We,mn=lt(Ad(pr.x,it.width),Ad(pr.y,it.height)),ki=je(mn),fi=Po(ki,Pe);if(!Le&&ke.points.length===1&&fi<36)return ui(re);if(ke.points.length>2&&fi<=256){ke.pathClose=!0,Ca(ke)&&Qt(ke);const qn=hi(re);return void Se(qn)}const ai=ke.strokeWidth&&ke.strokeColor&&(ke.strokeColor[3]===void 0||ke.strokeColor[3]>0),Bn=Po(cn,Pe);if(ai&&ke.points.length>1&&Bn<256){ke.pathClose=!1,ke.backgroundColor=[0,0,0,0],Ca(ke)&&Qt(ke);const qn=hi(re);Se(qn)}else if(!(ke.points.length>0&&Bn<100))return jt?Zc(We,it):We};return{start:Me=>{const Pe=ci(re),{origin:ke}=Me.detail;if(K=4,R=Ee(He(ke)),Q=He(R),Pe){const Ye=Pe.points[Pe.points.length-1],cn=ve(Ye,R);return cn&&(Pe.points=[...Pe.points,cn]),void Xn({points:Pe.points},re)}Le=!0},update:Me=>{if(!Le)return;const Pe=ci(re);if(!Pe)return;const ke=Pe.points[0],Ye=ve(ke,lt(R.x+Me.detail.translation.x,R.y+Me.detail.translation.y));Ye&&(Pe.points[1]=Ye,Xn({points:Pe.points},re))},release:Me=>Me.detail.preventInertia(),cancel:()=>{ui(re)},end:Me=>{if(!Le)return;const Pe=tr(R),ke=jt?Zc(Pe,it):Pe,{isTap:Ye}=Me.detail;if(Ye&&rn(Kt,Pe,0,Ca).length)return ui(re);Ln({...x,points:[ke]},re)}}}return{start:Le=>{const{origin:ve}=Le.detail;K=4,R=He(ve),Q=He(R),dt.push({...Q});const Me=tr(R),Pe=jt?Zc(Me,it):Me;Ln({...x,points:[Pe]},re)},update:Le=>{const ve=ci(re);if(!ve)return;const{translation:Me}=Le.detail,Pe=lt(R.x+Me.x,R.y+Me.y),ke=Ni(Q,Pe);if(mr(ke,5)<=K)return;const Ye=[],cn=hd(Pe,Q),We=K-ke,pr={x:Q.x+We*Math.cos(cn),y:Q.y+We*Math.sin(cn)};if(dt.push({...pr}),ne&&ve.points.length>1){const mn=dt.length,ki=Math.ceil(ke/10);let fi=ke/30;const ai=dt[mn-3],Bn=dt[mn-2],qn=dt[mn-1];dt[mn-4]||(fi*=.1),Ye.push(...Zx(ai,Bn,qn,ki,fi).slice(1,-1)),dt.splice(mn-1,0,...Ye)}Ye.push(pr),Q.x=pr.x,Q.y=pr.y,Xn({points:ve.points.concat(Ye.map(mn=>{const ki=tr(mn);return jt?Zc(ki,it):ki}))},re)},release:Le=>Le.detail.preventInertia(),cancel:()=>{ui(re)},end:Le=>{const ve=ci(re);if(!ve)return;if(Le.detail.isTap){let Pe=!1;if(ve.bitmap?(ho&&(Pe=!0),sr&&(Pe=!0)):Pe=!0,Pe)return ui(re)}const Me=hi(re);Se(Me)}}}return At||ce||Wo(x)?{start:Le=>{const{origin:ve}=Le.detail;R=Ee(He(ve));const Me=tr(R),Pe=jt?Zc(Me,it):Me,ke=-1*Eo(ur,$r,zr),Ye={...x,rotation:ke,...Pe};Ye.flipX=$r,Ye.flipY=zr,delete Ye.position,Ye.opacity=0,(At?["rx","ry"]:["width","height"]).forEach(cn=>{Ye[cn]=jt?"0%":0}),Ln(Ye,re)},update:Le=>{const ve=ci(re);if(!ve)return;ve.opacity=1;let{aspectRatio:Me}=ve,{translation:Pe,shiftKey:ke,ctrlKey:Ye}=Le.detail;!Me&&ke&&(Me=1);const cn=Ee(lt(R.x+Pe.x,R.y+Pe.y)),We=tr(R),pr=tr(cn);if(Me){const Pi=ri([We,pr]),io=Ki(Pi,Me),Do=pr.x<We.x?-1:1,Mo=pr.y<We.y?-1:1;pr.x=We.x+io.width*Do,pr.y=We.y+io.height*Mo}const mn={x:We.x+.5*(pr.x-We.x),y:We.y+.5*(pr.y-We.y)},ki=Eo(ur,$r,zr);qi(We,ki,mn),qi(pr,ki,mn);const fi=Math.min(We.x,pr.x),ai=Math.min(We.y,pr.y);let Bn=Math.max(We.x,pr.x)-fi,qn=Math.max(We.y,pr.y)-ai,Kn={};At?(Ye?(Kn.x=We.x,Kn.y=We.y):(Kn.x=fi+.5*Bn,Kn.y=ai+.5*qn),Kn.rx=.5*Bn,Kn.ry=.5*qn):(Ye?(Kn.x=We.x-.5*Bn,Kn.y=We.y-.5*qn):(Kn.x=fi,Kn.y=ai),Kn.width=Bn,Kn.height=qn),Xn(Kn,re,(Pi,io)=>mi(Pi,io,it))},release:Le=>{Le.detail.preventInertia()},cancel:()=>{ui(re)},end:Le=>{const ve=ci(re);if(ve){if(Le.detail.isTap){if(Qn(ve)&&Xr&&Yo||!Qn(ve)||!Xr||ho)return ui(re);delete ve.width,delete ve.height,ve.disableNewline!==!1&&delete ve.textAlign;const Me=On({...ve},it),Pe=oo(ve.text,Me),ke=tr({x:R.x,y:R.y-.5*Pe.height}),Ye=tr({x:R.x+Pe.width,y:R.y+.5*Pe.height}),cn={x:ke.x+.5*(Ye.x-ke.x),y:ke.y+.5*(Ye.y-ke.y)},We=Eo(ur,$r,zr);qi(ke,We,cn),qi(Ye,We,cn);let pr=Math.min(ke.x,Ye.x),mn=Math.min(ke.y,Ye.y);pr<0&&(pr=0),mn<0&&(mn=0),pr+Pe.width>it.width&&(pr=it.width-Pe.width),mn+Pe.height>it.height&&(mn=it.height-Pe.height),ve.x=Ge(ve.x)?$o(pr,it.width):pr,ve.y=Ge(ve.y)?$o(mn,it.height):mn}if(ve.opacity=1,Qn(ve)){const Me=On({...ve},it);if(_e(Me.width)&&Me.width<1||_e(Me.height)&&Me.height<1)return ui(re);Se(ve)}else{const Me=hi(re);Se(Me)}Ca(ve)&&Qt(ve),Qn(ve)&&Ue(ve)}}}:Ii(x)?{start:Le=>{const{origin:ve}=Le.detail,Me=tr(Ee(ve)),Pe=_o(Me,du);R=He(ve),Ln({...x,x1:jt?$o(Pe.x,it.width):Pe.x,y1:jt?$o(Pe.y,it.height):Pe.y,x2:jt?$o(Pe.x,it.width):Pe.x,y2:jt?$o(Pe.y,it.height):Pe.y,opacity:0},re)},update:Le=>{if(!ci(re))return;const{translation:ve}=Le.detail,Me=Ee(jn(He(R),ve));if(de.includes(16)){const ke=Ni(R,Me),Ye=hd(R,Me),cn=Math.PI/4,We=cn*Math.round(Ye/cn);Me.x=R.x+ke*Math.cos(We),Me.y=R.y+ke*Math.sin(We)}const Pe=tr(Me);Xn({x2:jt?$o(Pe.x,it.width):Pe.x,y2:jt?$o(Pe.y,it.height):Pe.y,opacity:1},re)},release:Le=>Le.detail.preventInertia(),cancel:()=>{ui(re)},end:Le=>{const ve=ci(re);if(!ve)return;if(Le.detail.isTap)return ui(re);ve.opacity=1;const Me=hi(re);Se(Me),Ca(ve)&&Qt(Me)}}:void 0},()=>{let x,W;const R=pn*pn,K=(Q,dt,At=!1)=>{const ce=Po(Q,dt);if(!At&&ce<2)return!1;const jt=Kt.filter(gv);let ne;return ne=ce<R?rn(jt,tr(dt),pn):bn(jt,tr(Q),tr(dt),pn),$e(ne).forEach(yr),!0};return{start:Q=>{x=lt(Math.round(Q.detail.origin.x),Math.round(Q.detail.origin.y)),K(x,x,!0),W=x},update:Q=>{const{translation:dt}=Q.detail,At=lt(Math.round(x.x+dt.x),Math.round(x.y+dt.y));K(W,At)&&(W=He(At))},release:Q=>Q.detail.preventInertia(),cancel:()=>{ui(collection)},end:()=>{}}},oi,Zo,x=>{if(!oi())return S1(x),Tn(x)},Wi,So,(x={})=>({id:ra(),...x}),Pn,_i,fn,Yn,(x,W,R=!0)=>{Kt.forEach(K=>Yn(K,x,W,!1)),R&&Pn()},Lo,Fo,eo,Xi,To,Qt,Ar,Ue,be,$e,Kr,Ir,rn,bn,vo,lo,Ze,Fn,Pr,ss,p,Wt,Ft,yt,zt,X,Dt,q,at,z,te,St,Zt,Xt,V,pt,a,o,wt,c,vt,kt,et,H,xt,n,N,nt,ft,f,M,y,h,j,l,S,g,s,Kt,le,de,Oe,function(x){Ji.call(this,t,x)},x=>bc(x),function(x){jr[x?"unshift":"push"](()=>{vn=x,r(8,vn)})},function(){Et=this.value,r(27,Et),r(13,Z),r(12,i),r(178,H),r(0,Ke),r(193,Kt)},x=>{const{key:W}=x;if(W==="Enter"){if(ln(x))return!0;if(i.disableNewline===!1)return!1}return!0},function(x){jr[x?"unshift":"push"](()=>{vn=x,r(8,vn)})},()=>{qo&&qo.focus()},x=>r(9,as=x.detail),function(x){jr[x?"unshift":"push"](()=>{qo=x,r(10,qo)})},x=>U1(x,G)]}class M6 extends gr{constructor(e){super(),fr(this,e,C6,T6,cr,{uid:67,ui:68,disabled:0,shapes:1,selection:69,offset:2,contextRotation:70,contextFlipX:71,contextFlipY:72,contextZoom:73,active:74,opacity:75,parentRect:76,rootRect:3,utilRect:4,hoverColor:77,caretColor:78,gridColor:79,snapColor:80,textInputMode:5,oninteractionstart:81,oninteractionupdate:82,oninteractionrelease:83,oninteractionend:84,oninteractioncancel:85,onaddshape:86,onupdateshape:87,onselectshape:88,onblurshape:89,onremoveshape:90,ontapshape:91,onhovershape:92,ontriggerhistorywrite:93,onhovercanvas:94,ontapcanvas:95,onleavecanvas:96,beforeSelectShape:97,beforeDeselectShape:98,beforeRemoveShape:99,beforeUpdateShape:100,willRenderShapeControls:101,willRenderShapeTextControls:102,willStartInteraction:103,mapEditorPointToImagePoint:104,mapImagePointToEditorPoint:105,eraseRadius:106,selectRadius:107,enableButtonFlipVertical:108,enableTapToAddText:109,enableMultiSelect:110,enableTextStyleControls:6,locale:7,snapThreshold:111,snapPointer:112,enableSnapToContext:113,gridSize:114,syncShapeCollection:115,getShapeDraft:116,addShapeDraft:117,discardShapeDraft:118,confirmShapeDraft:119,updateShapeDraft:120,addShape:121,createShape:122,eraseShape:123,getMarkupItemDraft:124,getMarkupItemDraftIndex:125,addMarkupItemDraft:126,confirmMarkupItemDraft:127,discardMarkupItemDraft:128,createMarkupItem:129,syncShapes:130,removeMarkupShapeProps:131,updateMarkupShape:132,updateMarkupShapeProperty:133,updateMarkupItemsShapeProperty:134,updateMarkupShapeItems:135,getActiveMarkupItems:136,getActiveMarkupItem:137,hasActiveMarkupItem:138,blurShapes:139,selectShape:140,deselectMarkupItem:141,editMarkupItem:142,finishEditMarkupItem:143,removeMarkupItems:144,getTextShapeRect:145,getMarkupShapeRect:146,getShapesNearPosition:147,getShapesBetweenPoints:148},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get syncShapeCollection(){return this.$$.ctx[115]}get getShapeDraft(){return this.$$.ctx[116]}get addShapeDraft(){return this.$$.ctx[117]}get discardShapeDraft(){return this.$$.ctx[118]}get confirmShapeDraft(){return this.$$.ctx[119]}get updateShapeDraft(){return this.$$.ctx[120]}get addShape(){return this.$$.ctx[121]}get createShape(){return this.$$.ctx[122]}get eraseShape(){return this.$$.ctx[123]}get getMarkupItemDraft(){return this.$$.ctx[124]}get getMarkupItemDraftIndex(){return this.$$.ctx[125]}get addMarkupItemDraft(){return this.$$.ctx[126]}get confirmMarkupItemDraft(){return this.$$.ctx[127]}get discardMarkupItemDraft(){return this.$$.ctx[128]}get createMarkupItem(){return this.$$.ctx[129]}get syncShapes(){return this.$$.ctx[130]}get removeMarkupShapeProps(){return this.$$.ctx[131]}get updateMarkupShape(){return this.$$.ctx[132]}get updateMarkupShapeProperty(){return this.$$.ctx[133]}get updateMarkupItemsShapeProperty(){return this.$$.ctx[134]}get updateMarkupShapeItems(){return this.$$.ctx[135]}get getActiveMarkupItems(){return this.$$.ctx[136]}get getActiveMarkupItem(){return this.$$.ctx[137]}get hasActiveMarkupItem(){return this.$$.ctx[138]}get blurShapes(){return this.$$.ctx[139]}get selectShape(){return this.$$.ctx[140]}get deselectMarkupItem(){return this.$$.ctx[141]}get editMarkupItem(){return this.$$.ctx[142]}get finishEditMarkupItem(){return this.$$.ctx[143]}get removeMarkupItems(){return this.$$.ctx[144]}get getTextShapeRect(){return this.$$.ctx[145]}get getMarkupShapeRect(){return this.$$.ctx[146]}get getShapesNearPosition(){return this.$$.ctx[147]}get getShapesBetweenPoints(){return this.$$.ctx[148]}}function P6(t){let e,r,n;return r=new Qi({props:{items:t[2]}}),{c(){e=mt("ul"),Ht(r.$$.fragment),T(e,"class","PinturaShapeStyleList")},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};4&o&&(a.items=i[2]),r.$set(a)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function R6(t){let e,r;return e=new za({props:{class:"PinturaShapeStyles",elasticity:t[0],$$slots:{default:[I6]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};1&i&&(o.elasticity=n[0]),524292&i&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function I6(t){let e,r,n;return r=new Qi({props:{items:t[2]}}),{c(){e=mt("ul"),Ht(r.$$.fragment),T(e,"class","PinturaShapeStyleList")},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};4&o&&(a.items=i[2]),r.$set(a)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function E6(t){let e,r,n,i;const o=[R6,P6],a=[];function s(l,c){return l[1]?0:1}return r=s(t),n=a[r]=o[r](t),{c(){e=mt("div"),n.c(),Mt(e,"opacity",t[5]),Mt(e,"pointer-events",t[4]),Mt(e,"visibility",t[3])},m(l,c){tt(l,e,c),a[r].m(e,null),i=!0},p(l,[c]){let u=r;r=s(l),r===u?a[r].p(l,c):(Fe(),B(a[u],1,1,()=>{a[u]=null}),ze(),n=a[r],n?n.p(l,c):(n=a[r]=o[r](l),n.c()),I(n,1),n.m(e,null)),32&c&&Mt(e,"opacity",l[5]),16&c&&Mt(e,"pointer-events",l[4]),8&c&&Mt(e,"visibility",l[3])},i(l){i||(I(n),i=!0)},o(l){B(n),i=!1},d(l){l&&J(e),a[r].d()}}}function A6(t,e,r){let n,i,o,a,s,l,c,u,{isActive:d=!1}=e,{controls:p=[]}=e,{locale:h}=e,{scrollElasticity:f}=e,{scrollEnable:g=!0}=e,{hideTitles:$=!1}=e,{willRenderControls:b=tn}=e;const v=$n("redrawTrigger");D(t,v,M=>r(16,l=M));const w=$n("env");D(t,w,M=>r(15,s=M));const S=$n("isAnimated");D(t,S,M=>r(18,u=M));const P=hr(0,{stiffness:.25,damping:.9});return D(t,P,M=>r(17,c=M)),t.$$set=M=>{"isActive"in M&&r(10,d=M.isActive),"controls"in M&&r(11,p=M.controls),"locale"in M&&r(12,h=M.locale),"scrollElasticity"in M&&r(0,f=M.scrollElasticity),"scrollEnable"in M&&r(1,g=M.scrollEnable),"hideTitles"in M&&r(13,$=M.hideTitles),"willRenderControls"in M&&r(14,b=M.willRenderControls)},t.$$.update=()=>{263168&t.$$.dirty&&P.set(d?1:0,{hard:u===!1}),131072&t.$$.dirty&&r(5,n=c),1024&t.$$.dirty&&r(4,i=d?"auto":"none"),131072&t.$$.dirty&&r(3,o=c<=0?"hidden":"visible"),129024&t.$$.dirty&&r(2,a=l&&b(p.map(M=>["ShapeStyle",M.id,{title:M.componentProps.title,locale:h,hideTitle:$,items:[[M.component,M.id,M.componentProps]]}]),s,()=>v.set({})))},[f,g,a,o,i,n,v,w,S,P,d,p,h,$,b,s,l,c,u]}class L6 extends gr{constructor(e){super(),fr(this,e,A6,E6,cr,{isActive:10,controls:11,locale:12,scrollElasticity:0,scrollEnable:1,hideTitles:13,willRenderControls:14})}}function ly(t,e,r){const n=t.slice();return n[15]=e[r].key,n[6]=e[r].controls,n[16]=e[r].isActive,n}function cy(t,e){let r,n,i;return n=new L6({props:{isActive:e[16],controls:e[6],locale:e[1],scrollElasticity:e[2],scrollEnable:e[3],hideTitles:e[4],willRenderControls:e[5]}}),{key:t,first:null,c(){r=Dn(),Ht(n.$$.fragment),this.first=r},m(o,a){tt(o,r,a),Vt(n,o,a),i=!0},p(o,a){e=o;const s={};128&a&&(s.isActive=e[16]),128&a&&(s.controls=e[6]),2&a&&(s.locale=e[1]),4&a&&(s.scrollElasticity=e[2]),8&a&&(s.scrollEnable=e[3]),16&a&&(s.hideTitles=e[4]),32&a&&(s.willRenderControls=e[5]),n.$set(s)},i(o){i||(I(n.$$.fragment,o),i=!0)},o(o){B(n.$$.fragment,o),i=!1},d(o){o&&J(r),Nt(n,o)}}}function F6(t){let e,r,n,i=[],o=new Map,a=t[7];const s=l=>l[15];for(let l=0;l<a.length;l+=1){let c=ly(t,a,l),u=s(c);o.set(u,i[l]=cy(u,c))}return{c(){e=mt("div");for(let l=0;l<i.length;l+=1)i[l].c();T(e,"class",r=br(["PinturaShapeStyleEditor",!t[3]&&"PinturaShapeStyleEditorOverflow",t[0]]))},m(l,c){tt(l,e,c);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);n=!0},p(l,[c]){190&c&&(a=l[7],Fe(),i=es(i,c,s,1,l,a,o,e,Ys,cy,null,ly),ze()),(!n||9&c&&r!==(r=br(["PinturaShapeStyleEditor",!l[3]&&"PinturaShapeStyleEditorOverflow",l[0]])))&&T(e,"class",r)},i(l){if(!n){for(let c=0;c<a.length;c+=1)I(i[c]);n=!0}},o(l){for(let c=0;c<i.length;c+=1)B(i[c]);n=!1},d(l){l&&J(e);for(let c=0;c<i.length;c+=1)i[c].d()}}}function z6(t,e,r){let n,i,o,{class:a}=e,{controls:s={}}=e,{shapeProps:l}=e,{onchange:c}=e,{locale:u}=e,{scrollElasticity:d}=e,{scrollEnable:p=!0}=e,{hideTitles:h=!1}=e,{willRenderControls:f}=e;const g=[];return t.$$set=$=>{"class"in $&&r(0,a=$.class),"controls"in $&&r(6,s=$.controls),"shapeProps"in $&&r(8,l=$.shapeProps),"onchange"in $&&r(9,c=$.onchange),"locale"in $&&r(1,u=$.locale),"scrollElasticity"in $&&r(2,d=$.scrollElasticity),"scrollEnable"in $&&r(3,p=$.scrollEnable),"hideTitles"in $&&r(4,h=$.hideTitles),"willRenderControls"in $&&r(5,f=$.willRenderControls)},t.$$.update=()=>{64&t.$$.dirty&&r(11,n=Object.keys(s).filter($=>s[$])),2304&t.$$.dirty&&r(10,i=l&&Object.keys(l).length&&n&&k1(l)?($=>n.filter(b=>b.split("_").every(v=>Te($,v)&&k1($,v))).map(b=>{const v=($.settings&&$.settings[b]||{}).control||b,w=b.split("_");let S=w.length>1?w.map(C=>$[C]):$[b];if(Vr(s[v])){const{title:C,component:z}=s[v](S,V=>{c({[b]:V})},{selectedShapeId:$.id});return{id:v,component:Qi,componentProps:{title:C,items:z}}}let[P,M]=s[v];if(Ge(P)&&s[P]){const C={...M};[P,M]=s[P],M={...M,...C}}const E=Vr(M.options)?M.options($):M.options;return P==="RadioGroup"&&(M.selectedIndex=-1),Vr(M.formatValue)&&(S=M.formatValue(S)),{id:v,component:P,componentProps:{...M,options:E,locale:u,value:S,optionLabelClass:"PinturaButtonLabel",onchange:C=>{let z=bs(C)&&!En(C)?C.value:C;Vr(M.formatValue)&&(z=M.formatValue(z)),M.onchange&&M.onchange(z,$);const V=w.length>1?w.reduce((L,y,ct)=>({...L,[y]:Array.isArray(z)?z[ct]:z}),{}):{[b]:z};c(V)}}}}).filter(Boolean))(l):[]),1280&t.$$.dirty&&r(7,o=(($,b)=>{let v=g.find(w=>w.key===$);return v||(v={key:$,controls:b},g.push(v)),g.forEach(w=>w.isActive=!1),v.controls=b,v.isActive=!0,g})(l&&Object.keys(l).length?Object.keys(l).join("_"):"none",i||[]))},[a,u,d,p,h,f,s,o,l,c,i,n]}class gp extends gr{constructor(e){super(),fr(this,e,z6,F6,cr,{class:0,controls:6,shapeProps:8,onchange:9,locale:1,scrollElasticity:2,scrollEnable:3,hideTitles:4,willRenderControls:5})}}var Xb=t=>/<svg /.test(t);function D6(t){let e,r;return e=new Qi({props:{items:t[10]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};1024&i&&(o.items=n[10]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function B6(t){let e,r,n,i;const o=[W6,O6],a=[];function s(l,c){return l[8]?0:1}return e=s(t),r=a[e]=o[e](t),{c(){r.c(),n=Dn()},m(l,c){a[e].m(l,c),tt(l,n,c),i=!0},p(l,c){let u=e;e=s(l),e===u?a[e].p(l,c):(Fe(),B(a[u],1,1,()=>{a[u]=null}),ze(),r=a[e],r?r.p(l,c):(r=a[e]=o[e](l),r.c()),I(r,1),r.m(n.parentNode,n))},i(l){i||(I(r),i=!0)},o(l){B(r),i=!1},d(l){a[e].d(l),l&&J(n)}}}function O6(t){let e,r,n,i,o=t[10]&&uy(t);return n=new za({props:{scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[_6]},$$scope:{ctx:t}}}),{c(){e=mt("div"),o&&o.c(),r=ue(),Ht(n.$$.fragment),T(e,"class","PinturaShapePresetsFlat")},m(a,s){tt(a,e,s),o&&o.m(e,null),Lt(e,r),Vt(n,e,null),i=!0},p(a,s){a[10]?o?(o.p(a,s),1024&s&&I(o,1)):(o=uy(a),o.c(),I(o,1),o.m(e,r)):o&&(Fe(),B(o,1,1,()=>{o=null}),ze());const l={};512&s&&(l.scrollAutoCancel=a[9]),1&s&&(l.elasticity=a[0]),536871070&s&&(l.$$scope={dirty:s,ctx:a}),n.$set(l)},i(a){i||(I(o),I(n.$$.fragment,a),i=!0)},o(a){B(o),B(n.$$.fragment,a),i=!1},d(a){a&&J(e),o&&o.d(),Nt(n)}}}function W6(t){let e,r,n,i,o;r=new za({props:{elasticity:t[0],class:"PinturaShapePresetsGroups",$$slots:{default:[H6]},$$scope:{ctx:t}}});const a=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[11]},t[12]];let s={$$slots:{default:[U6,({panel:l,panelIsActive:c})=>({26:l,27:c}),({panel:l,panelIsActive:c})=>(l?67108864:0)|(c?134217728:0)]},$$scope:{ctx:t}};for(let l=0;l<a.length;l+=1)s=_n(s,a[l]);return i=new hp({props:s}),{c(){e=mt("div"),Ht(r.$$.fragment),n=ue(),Ht(i.$$.fragment),T(e,"class","PinturaShapePresetsGrouped")},m(l,c){tt(l,e,c),Vt(r,e,null),Lt(e,n),Vt(i,e,null),o=!0},p(l,c){const u={};1&c&&(u.elasticity=l[0]),536876128&c&&(u.$$scope={dirty:c,ctx:l}),r.$set(u);const d=6144&c?zi(a,[a[0],a[1],2048&c&&{panels:l[11]},4096&c&&Gi(l[12])]):{};738206239&c&&(d.$$scope={dirty:c,ctx:l}),i.$set(d)},i(l){o||(I(r.$$.fragment,l),I(i.$$.fragment,l),o=!0)},o(l){B(r.$$.fragment,l),B(i.$$.fragment,l),o=!1},d(l){l&&J(e),Nt(r),Nt(i)}}}function uy(t){let e,r;return e=new Qi({props:{items:t[10]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};1024&i&&(o.items=n[10]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function _6(t){let e,r;return e=new C0({props:{items:t[7],onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};128&i&&(o.items=n[7]),2&i&&(o.onclickitem=n[1]),4&i&&(o.ongrabitem=n[2]),8&i&&(o.ondragitem=n[3]),16&i&&(o.ondropitem=n[4]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function dy(t){let e,r;return e=new Qi({props:{items:t[10]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};1024&i&&(o.items=n[10]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function py(t){let e,r;return e=new Ho({props:{$$slots:{default:[V6]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};805306368&i&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function V6(t){let e,r=t[28].icon+"";return{c(){e=Li("g")},m(n,i){tt(n,e,i),e.innerHTML=r},p(n,i){268435456&i&&r!==(r=n[28].icon+"")&&(e.innerHTML=r)},d(n){n&&J(e)}}}function hy(t){let e,r,n=t[28].label+"";return{c(){e=mt("span"),r=Mn(n)},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){268435456&o&&n!==(n=i[28].label+"")&&Gn(r,n)},d(i){i&&J(e)}}}function N6(t){let e,r,n,i=t[28].icon&&py(t),o=!t[28].hideLabel&&hy(t);return{c(){i&&i.c(),e=ue(),o&&o.c(),r=Dn()},m(a,s){i&&i.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,r,s),n=!0},p(a,s){a[28].icon?i?(i.p(a,s),268435456&s&&I(i,1)):(i=py(a),i.c(),I(i,1),i.m(e.parentNode,e)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze()),a[28].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=hy(a),o.c(),o.m(r.parentNode,r))},i(a){n||(I(i),n=!0)},o(a){B(i),n=!1},d(a){i&&i.d(a),a&&J(e),o&&o.d(a),a&&J(r)}}}function H6(t){let e,r,n,i=t[10]&&dy(t);const o=[{class:"PinturaControlList"},{tabs:t[5]},t[12],{layout:"compact"}];let a={$$slots:{default:[N6,({tab:s})=>({28:s}),({tab:s})=>s?268435456:0]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=_n(a,o[s]);return r=new pp({props:a}),r.$on("select",t[18]),{c(){i&&i.c(),e=ue(),Ht(r.$$.fragment)},m(s,l){i&&i.m(s,l),tt(s,e,l),Vt(r,s,l),n=!0},p(s,l){s[10]?i?(i.p(s,l),1024&l&&I(i,1)):(i=dy(s),i.c(),I(i,1),i.m(e.parentNode,e)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze());const c=4128&l?zi(o,[o[0],32&l&&{tabs:s[5]},4096&l&&Gi(s[12]),o[3]]):{};805306368&l&&(c.$$scope={dirty:l,ctx:s}),r.$set(c)},i(s){n||(I(i),I(r.$$.fragment,s),n=!0)},o(s){B(i),B(r.$$.fragment,s),n=!1},d(s){i&&i.d(s),s&&J(e),Nt(r,s)}}}function j6(t){let e,r;return e=new C0({props:{items:t[13][t[26]].items,disabled:t[13][t[26]].disabled,onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};67117056&i&&(o.items=n[13][n[26]].items),67117056&i&&(o.disabled=n[13][n[26]].disabled),2&i&&(o.onclickitem=n[1]),4&i&&(o.ongrabitem=n[2]),8&i&&(o.ondragitem=n[3]),16&i&&(o.ondropitem=n[4]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function U6(t){let e,r;return e=new za({props:{scroll:t[27]?{scrollOffset:0,animate:!1}:void 0,scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[j6]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};134217728&i&&(o.scroll=n[27]?{scrollOffset:0,animate:!1}:void 0),512&i&&(o.scrollAutoCancel=n[9]),1&i&&(o.elasticity=n[0]),603987998&i&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function G6(t){let e,r,n,i;const o=[B6,D6],a=[];function s(l,c){return l[9]?0:l[10]?1:-1}return~(r=s(t))&&(n=a[r]=o[r](t)),{c(){e=mt("div"),n&&n.c(),T(e,"class","PinturaShapePresetsPalette")},m(l,c){tt(l,e,c),~r&&a[r].m(e,null),i=!0},p(l,[c]){let u=r;r=s(l),r===u?~r&&a[r].p(l,c):(n&&(Fe(),B(a[u],1,1,()=>{a[u]=null}),ze()),~r?(n=a[r],n?n.p(l,c):(n=a[r]=o[r](l),n.c()),I(n,1),n.m(e,null)):n=null)},i(l){i||(I(n),i=!0)},o(l){B(n),i=!1},d(l){l&&J(e),~r&&a[r].d()}}}function Z6(t,e,r){let n,i,o,a,s,l,c,u,d,{locale:p}=e,{presets:h}=e,{scrollElasticity:f}=e,{enableSelectImage:g=!0}=e,{willRenderPresetToolbar:$=tn}=e,{onaddpreset:b=se}=e,{ongrabpreset:v}=e,{ondragpreset:w}=e,{ondroppreset:S}=e;const P="presets-"+ra(),M=(V,L="")=>Xb(V)?V:qd(V)?a2(V,L):`<img src="${V}" alt="${L}"/>`,E=V=>Wy(Q1(V)),C=["src","alt","thumb","shape","id","mount","disabled"],z=V=>V.map(L=>(y=>En(y)&&Ge(y[0])&&En(y[1]))(L)?{...L[2],id:`${P}-${L[0].toLowerCase()}`,label:L[0],items:z(L[1])}:(y=>{let ct,j,k,N,nt,ft,xt,H=y;return Ge(y)?qd(y)?(ct=y,nt=y,N=M(ct,nt)):(ct=y,nt=E(ct),N=M(ct,nt)):(ct=y.src,nt=y.alt||(Ge(ct)?E(ct):Ge(y.thumb)?E(y.thumb):void 0),N=M(y.thumb||ct,nt),j=y.shape,ft=y.mount,xt=y.disabled,k=Object.keys(y).reduce((Z,wt)=>(C.includes(wt)||(Z[wt]=y[wt]),Z),{})),{id:H,src:ct,thumb:N,shape:j,shapeProps:k,alt:nt,title:nt,mount:ft,disabled:xt}})(L));return t.$$set=V=>{"locale"in V&&r(14,p=V.locale),"presets"in V&&r(15,h=V.presets),"scrollElasticity"in V&&r(0,f=V.scrollElasticity),"enableSelectImage"in V&&r(16,g=V.enableSelectImage),"willRenderPresetToolbar"in V&&r(17,$=V.willRenderPresetToolbar),"onaddpreset"in V&&r(1,b=V.onaddpreset),"ongrabpreset"in V&&r(2,v=V.ongrabpreset),"ondragpreset"in V&&r(3,w=V.ondragpreset),"ondroppreset"in V&&r(4,S=V.ondroppreset)},t.$$.update=()=>{32768&t.$$.dirty&&r(7,n=z(h)),128&t.$$.dirty&&r(9,i=n.length),640&t.$$.dirty&&r(8,o=i&&n.some(V=>!!V.items)),384&t.$$.dirty&&r(5,a=o&&n),384&t.$$.dirty&&r(13,s=o&&n.reduce((V,L)=>(V[L.id]=L,V),{})),96&t.$$.dirty&&r(6,l=l||a&&(a.find(V=>!V.disabled)||{}).id),64&t.$$.dirty&&r(12,c={name:P,selected:l}),32&t.$$.dirty&&r(11,u=a&&a.map(V=>V.id)),212994&t.$$.dirty&&r(10,d=p&&$([g&&["Button","browse",{label:p.shapeLabelButtonSelectSticker,icon:p.shapeIconButtonSelectSticker,onclick:()=>{Mb().then(V=>{V&&b(V)})}}]]))},[f,b,v,w,S,a,l,n,o,i,d,u,c,s,p,h,g,$,({detail:V})=>r(6,l=V)]}class Yb extends gr{constructor(e){super(),fr(this,e,Z6,G6,cr,{locale:14,presets:15,scrollElasticity:0,enableSelectImage:16,willRenderPresetToolbar:17,onaddpreset:1,ongrabpreset:2,ondragpreset:3,ondroppreset:4})}}function X6(t){let e,r,n,i;return e=new Qi({props:{items:t[30]}}),n=new gp({props:{locale:t[4],shapeProps:t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[165]}}),{c(){Ht(e.$$.fragment),r=ue(),Ht(n.$$.fragment)},m(o,a){Vt(e,o,a),tt(o,r,a),Vt(n,o,a),i=!0},p(o,a){const s={};1073741824&a[0]&&(s.items=o[30]),e.$set(s);const l={};16&a[0]&&(l.locale=o[4]),262144&a[1]&&(l.shapeProps=o[49]),512&a[0]&&(l.controls=o[9]),n.$set(l)},i(o){i||(I(e.$$.fragment,o),I(n.$$.fragment,o),i=!0)},o(o){B(e.$$.fragment,o),B(n.$$.fragment,o),i=!1},d(o){Nt(e,o),o&&J(r),Nt(n,o)}}}function Y6(t){let e,r,n;return r=new Hb({props:{$$slots:{default:[X6]},$$scope:{ctx:t}}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"slot","header")},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};1073742352&o[0]|262144&o[1]|134217728&o[6]&&(a.$$scope={dirty:o,ctx:i}),r.$set(a)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function my(t){let e,r;const n=[{locale:t[4]},{ui:t[69]},{shapes:t[5]},{selection:t[58]},{uid:t[20]},{parentRect:t[37]},{rootRect:t[55]},{utilRect:t[39]},{offset:t[50]},{disabled:t[38]},{contextRotation:t[23]},{contextFlipX:t[24]},{contextFlipY:t[25]},{contextZoom:t[36]?t[36].scale:void 0},{active:t[35]},{opacity:t[56]},{hoverColor:t[57]},{caretColor:t[57]},{snapColor:t[57]},{gridColor:[1,1,1,.125]},{eraseRadius:t[47]},{selectRadius:t[6]},{enableButtonFlipVertical:t[10]},{enableMultiSelect:t[14]},{mapEditorPointToImagePoint:t[21]},{mapImagePointToEditorPoint:t[22]},{enableTapToAddText:t[13]},{textInputMode:t[8]},{snapThreshold:t[16]},{snapPointer:!t[48]},{enableSnapToContext:t[17]},{gridSize:t[15]},{willStartInteraction:t[95]},{oninteractionstart:t[79]},{oninteractionupdate:t[80]},{oninteractionrelease:t[81]},{oninteractionend:t[83]},{oninteractioncancel:t[82]},{onleavecanvas:t[87]},{onhovercanvas:t[86]},{onhovershape:t[89]},{ontapcanvas:t[88]},{onaddshape:t[156]},{onselectshape:t[157]},{onblurshape:t[158]},{ontapshape:t[159]},{onupdateshape:t[160]},{onremoveshape:t[161]},{ontriggerhistorywrite:t[162]},t[42]];let i={};for(let o=0;o<n.length;o+=1)i=_n(i,n[o]);return e=new M6({props:i}),t[163](e),{c(){Ht(e.$$.fragment)},m(o,a){Vt(e,o,a),r=!0},p(o,a){const s=66315632&a[0]|252381681&a[1]|255721600&a[2]|12&a[3]?zi(n,[16&a[0]&&{locale:o[4]},128&a[2]&&{ui:o[69]},32&a[0]&&{shapes:o[5]},134217728&a[1]&&{selection:o[58]},1048576&a[0]&&{uid:o[20]},64&a[1]&&{parentRect:o[37]},16777216&a[1]&&{rootRect:o[55]},256&a[1]&&{utilRect:o[39]},524288&a[1]&&{offset:o[50]},128&a[1]&&{disabled:o[38]},8388608&a[0]&&{contextRotation:o[23]},16777216&a[0]&&{contextFlipX:o[24]},33554432&a[0]&&{contextFlipY:o[25]},32&a[1]&&{contextZoom:o[36]?o[36].scale:void 0},16&a[1]&&{active:o[35]},33554432&a[1]&&{opacity:o[56]},67108864&a[1]&&{hoverColor:o[57]},67108864&a[1]&&{caretColor:o[57]},67108864&a[1]&&{snapColor:o[57]},n[19],65536&a[1]&&{eraseRadius:o[47]},64&a[0]&&{selectRadius:o[6]},1024&a[0]&&{enableButtonFlipVertical:o[10]},16384&a[0]&&{enableMultiSelect:o[14]},2097152&a[0]&&{mapEditorPointToImagePoint:o[21]},4194304&a[0]&&{mapImagePointToEditorPoint:o[22]},8192&a[0]&&{enableTapToAddText:o[13]},256&a[0]&&{textInputMode:o[8]},65536&a[0]&&{snapThreshold:o[16]},131072&a[1]&&{snapPointer:!o[48]},131072&a[0]&&{enableSnapToContext:o[17]},32768&a[0]&&{gridSize:o[15]},4&a[3]&&{willStartInteraction:o[95]},131072&a[2]&&{oninteractionstart:o[79]},262144&a[2]&&{oninteractionupdate:o[80]},524288&a[2]&&{oninteractionrelease:o[81]},2097152&a[2]&&{oninteractionend:o[83]},1048576&a[2]&&{oninteractioncancel:o[82]},33554432&a[2]&&{onleavecanvas:o[87]},16777216&a[2]&&{onhovercanvas:o[86]},134217728&a[2]&&{onhovershape:o[89]},67108864&a[2]&&{ontapcanvas:o[88]},1&a[1]|8&a[3]&&{onaddshape:o[156]},1&a[1]&&{onselectshape:o[157]},1&a[1]&&{onblurshape:o[158]},1&a[1]&&{ontapshape:o[159]},1&a[1]|8&a[3]&&{onupdateshape:o[160]},1&a[1]|8&a[3]&&{onremoveshape:o[161]},8&a[3]&&{ontriggerhistorywrite:o[162]},2048&a[1]&&Gi(o[42])]):{};e.$set(s)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){B(e.$$.fragment,o),r=!1},d(o){t[163](null),Nt(e,o)}}}function q6(t){let e,r,n,i,o,a=t[51]&&my(t);return{c(){e=mt("div"),a&&a.c(),T(e,"slot","main"),Mt(e,"cursor",t[46])},m(s,l){tt(s,e,l),a&&a.m(e,null),t[164](e),n=!0,i||(o=[Tt(e,"keydown",t[84]),Tr(r=sb.call(null,e,{disabled:!t[12]})),Tt(e,"dropfiles",t[94]),Tr(Di.call(null,e)),Tt(e,"measure",t[152])],i=!0)},p(s,l){s[51]?a?(a.p(s,l),1048576&l[1]&&I(a,1)):(a=my(s),a.c(),I(a,1),a.m(e,null)):a&&(Fe(),B(a,1,1,()=>{a=null}),ze()),r&&kr(r.update)&&4096&l[0]&&r.update.call(null,{disabled:!s[12]}),32768&l[1]&&Mt(e,"cursor",s[46])},i(s){n||(I(a),n=!0)},o(s){B(a),n=!1},d(s){s&&J(e),a&&a.d(),t[164](null),i=!1,Ur(o)}}}function K6(t){let e,r;return e=new Yb({props:{locale:t[4],presets:t[19],enableSelectImage:t[11],willRenderPresetToolbar:t[43],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[44]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16&i[0]&&(o.locale=n[4]),524288&i[0]&&(o.presets=n[19]),2048&i[0]&&(o.enableSelectImage=n[11]),4096&i[1]&&(o.willRenderPresetToolbar=n[43]),8192&i[1]&&(o.scrollElasticity=n[44]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function J6(t){let e,r,n,i=t[7]==="stack"&&fy(t),o=(t[53]&&t[34]||t[7]==="row")&&gy(t);return{c(){i&&i.c(),e=ue(),o&&o.c(),r=Dn()},m(a,s){i&&i.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,r,s),n=!0},p(a,s){a[7]==="stack"?i?(i.p(a,s),128&s[0]&&I(i,1)):(i=fy(a),i.c(),I(i,1),i.m(e.parentNode,e)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze()),a[53]&&a[34]||a[7]==="row"?o?(o.p(a,s),128&s[0]|4194312&s[1]&&I(o,1)):(o=gy(a),o.c(),I(o,1),o.m(r.parentNode,r)):o&&(Fe(),B(o,1,1,()=>{o=null}),ze())},i(a){n||(I(i),I(o),n=!0)},o(a){B(i),B(o),n=!1},d(a){i&&i.d(a),a&&J(e),o&&o.d(a),a&&J(r)}}}function fy(t){let e,r,n,i;const o=[t8,Q6],a=[];function s(l,c){return l[45]?0:1}return r=s(t),n=a[r]=o[r](t),{c(){e=mt("div"),n.c(),T(e,"class","PinturaControlPanels")},m(l,c){tt(l,e,c),a[r].m(e,null),i=!0},p(l,c){let u=r;r=s(l),r===u?a[r].p(l,c):(Fe(),B(a[u],1,1,()=>{a[u]=null}),ze(),n=a[r],n?n.p(l,c):(n=a[r]=o[r](l),n.c()),I(n,1),n.m(e,null))},i(l){i||(I(n),i=!0)},o(l){B(n),i=!1},d(l){l&&J(e),a[r].d()}}}function Q6(t){let e,r,n;return r=new gp({props:{locale:t[4],shapeProps:t[49],onchange:t[85],controls:t[9],scrollElasticity:t[44],willRenderControls:t[18]}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"class","PinturaControlPanel")},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};16&o[0]&&(a.locale=i[4]),262144&o[1]&&(a.shapeProps=i[49]),512&o[0]&&(a.controls=i[9]),8192&o[1]&&(a.scrollElasticity=i[44]),262144&o[0]&&(a.willRenderControls=i[18]),r.$set(a)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function t8(t){let e,r,n;return r=new Yb({props:{locale:t[4],presets:t[19],enableSelectImage:t[11],willRenderPresetToolbar:t[43],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[44]}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"class","PinturaControlPanel")},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};16&o[0]&&(a.locale=i[4]),524288&o[0]&&(a.presets=i[19]),2048&o[0]&&(a.enableSelectImage=i[11]),4096&o[1]&&(a.willRenderPresetToolbar=i[43]),8192&o[1]&&(a.scrollElasticity=i[44]),r.$set(a)},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function gy(t){let e,r;return e=new za({props:{class:"PinturaControlListScroller",elasticity:t[44],$$slots:{default:[n8]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};8192&i[1]&&(o.elasticity=n[44]),262801&i[0]|262154&i[1]|134217728&i[6]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function $y(t){let e,r;return e=new ws({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[32],selectedIndex:t[32].findIndex(t[153]),onchange:t[78],$$slots:{option:[r8,({option:n})=>({212:n}),({option:n})=>[0,0,0,0,0,0,n?67108864:0]]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16&i[0]&&(o.locale=n[4]),2&i[1]&&(o.options=n[32]),1&i[0]|2&i[1]&&(o.selectedIndex=n[32].findIndex(n[153])),16&i[0]|201326592&i[6]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function yy(t){let e,r;return e=new Ho({props:{$$slots:{default:[e8]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16&i[0]|201326592&i[6]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function e8(t){let e,r=(Vr(t[212].icon)?t[212].icon(t[4]):t[212].icon)+"";return{c(){e=Li("g")},m(n,i){tt(n,e,i),e.innerHTML=r},p(n,i){16&i[0]|67108864&i[6]&&r!==(r=(Vr(n[212].icon)?n[212].icon(n[4]):n[212].icon)+"")&&(e.innerHTML=r)},d(n){n&&J(e)}}}function by(t){let e,r,n=(Vr(t[212].label)?t[212].label(t[4]):t[212].label)+"";return{c(){e=mt("span"),r=Mn(n)},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){16&o[0]|67108864&o[6]&&n!==(n=(Vr(i[212].label)?i[212].label(i[4]):i[212].label)+"")&&Gn(r,n)},d(i){i&&J(e)}}}function r8(t){let e,r,n,i=t[212].icon&&yy(t),o=!t[212].hideLabel&&by(t);return{c(){e=mt("div"),i&&i.c(),r=ue(),o&&o.c(),T(e,"slot","option")},m(a,s){tt(a,e,s),i&&i.m(e,null),Lt(e,r),o&&o.m(e,null),n=!0},p(a,s){a[212].icon?i?(i.p(a,s),67108864&s[6]&&I(i,1)):(i=yy(a),i.c(),I(i,1),i.m(e,r)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze()),a[212].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=by(a),o.c(),o.m(e,null))},i(a){n||(I(i),n=!0)},o(a){B(i),n=!1},d(a){a&&J(e),i&&i.d(),o&&o.d()}}}function xy(t){let e,r;return e=new gp({props:{locale:t[4],shapeProps:t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[154]}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16&i[0]&&(o.locale=n[4]),262144&i[1]&&(o.shapeProps=n[49]),512&i[0]&&(o.controls=n[9]),262144&i[0]&&(o.willRenderControls=n[154]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function n8(t){let e,r,n,i=t[34]&&$y(t),o=t[7]==="row"&&xy(t);return{c(){i&&i.c(),e=ue(),o&&o.c(),r=Dn()},m(a,s){i&&i.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,r,s),n=!0},p(a,s){a[34]?i?(i.p(a,s),8&s[1]&&I(i,1)):(i=$y(a),i.c(),I(i,1),i.m(e.parentNode,e)):i&&(Fe(),B(i,1,1,()=>{i=null}),ze()),a[7]==="row"?o?(o.p(a,s),128&s[0]&&I(o,1)):(o=xy(a),o.c(),I(o,1),o.m(r.parentNode,r)):o&&(Fe(),B(o,1,1,()=>{o=null}),ze())},i(a){n||(I(i),I(o),n=!0)},o(a){B(i),B(o),n=!1},d(a){i&&i.d(a),a&&J(e),o&&o.d(a),a&&J(r)}}}function vy(t){let e,r;return e=new za({props:{class:"PinturaControlListScroller",elasticity:t[44],$$slots:{default:[a8]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};8192&i[1]&&(o.elasticity=n[44]),134217744&i[0]|8388608&i[1]|134217728&i[6]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function wy(t){let e,r;return e=new Ho({props:{$$slots:{default:[i8]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16&i[0]|201326592&i[6]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function i8(t){let e,r=(Vr(t[212].icon)?t[212].icon(t[4]):t[212].icon)+"";return{c(){e=Li("g")},m(n,i){tt(n,e,i),e.innerHTML=r},p(n,i){16&i[0]|67108864&i[6]&&r!==(r=(Vr(n[212].icon)?n[212].icon(n[4]):n[212].icon)+"")&&(e.innerHTML=r)},d(n){n&&J(e)}}}function o8(t){let e,r,n,i,o,a=(Vr(t[212].label)?t[212].label(t[4]):t[212].label)+"",s=t[212].icon&&wy(t);return{c(){e=mt("div"),s&&s.c(),r=ue(),n=mt("span"),i=Mn(a),T(e,"slot","option")},m(l,c){tt(l,e,c),s&&s.m(e,null),Lt(e,r),Lt(e,n),Lt(n,i),o=!0},p(l,c){l[212].icon?s?(s.p(l,c),67108864&c[6]&&I(s,1)):(s=wy(l),s.c(),I(s,1),s.m(e,r)):s&&(Fe(),B(s,1,1,()=>{s=null}),ze()),(!o||16&c[0]|67108864&c[6])&&a!==(a=(Vr(l[212].label)?l[212].label(l[4]):l[212].label)+"")&&Gn(i,a)},i(l){o||(I(s),o=!0)},o(l){B(s),o=!1},d(l){l&&J(e),s&&s.d()}}}function a8(t){let e,r;return e=new ws({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[54],selectedIndex:t[54].findIndex(t[155]),onchange:t[77],$$slots:{option:[o8,({option:n})=>({212:n}),({option:n})=>[0,0,0,0,0,0,n?67108864:0]]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};16&i[0]&&(o.locale=n[4]),8388608&i[1]&&(o.options=n[54]),134217728&i[0]|8388608&i[1]&&(o.selectedIndex=n[54].findIndex(n[155])),16&i[0]|201326592&i[6]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function s8(t){let e,r,n,i,o;const a=[J6,K6],s=[];function l(u,d){return u[52]?0:u[45]?1:-1}~(r=l(t))&&(n=s[r]=a[r](t));let c=t[33]&&vy(t);return{c(){e=mt("div"),n&&n.c(),i=ue(),c&&c.c(),T(e,"slot","footer"),Mt(e,"transform",t[40])},m(u,d){tt(u,e,d),~r&&s[r].m(e,null),Lt(e,i),c&&c.m(e,null),o=!0},p(u,d){let p=r;r=l(u),r===p?~r&&s[r].p(u,d):(n&&(Fe(),B(s[p],1,1,()=>{s[p]=null}),ze()),~r?(n=s[r],n?n.p(u,d):(n=s[r]=a[r](u),n.c()),I(n,1),n.m(e,i)):n=null),u[33]?c?(c.p(u,d),4&d[1]&&I(c,1)):(c=vy(u),c.c(),I(c,1),c.m(e,null)):c&&(Fe(),B(c,1,1,()=>{c=null}),ze()),512&d[1]&&Mt(e,"transform",u[40])},i(u){o||(I(n),I(c),o=!0)},o(u){B(n),B(c),o=!1},d(u){u&&J(e),~r&&s[r].d(),c&&c.d()}}}function l8(t){let e,r;return e=new Tl({props:{hasHeader:t[41],$$slots:{footer:[s8],main:[q6],header:[Y6]},$$scope:{ctx:t}}}),e.$on("measure",t[166]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};1024&i[1]&&(o.hasHeader=n[41]),2080374769&i[0]|134216703&i[1]|134217728&i[6]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function c8(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,E,C,z,V,L,y,ct,j,k,N,nt,ft,xt,H,Z,wt,vt,et,Pt,Et,kt,st,Ut,rt,X,q,Ft,zt,yt,Dt,Wt,at,St,pt,Xt,Zt,ie,gt,te,xe,_,Kt,qt,le,de,Oe,rr,Ct,pe=qe,ar=()=>(pe(),pe=Hi(dr,O=>r(35,X=O)),dr),Ke=qe,Qe=()=>(Ke(),Ke=Hi(ae,O=>r(145,yt=O)),ae),Re=qe,Je=()=>(Re(),Re=Hi(Xr,O=>r(37,Zt=O)),Xr),ur=qe,$r=()=>(ur(),ur=Hi(it,O=>r(151,le=O)),it),zr=qe,Dr=()=>(zr(),zr=Hi(Y,O=>r(56,rr=O)),Y);t.$$.on_destroy.push(()=>pe()),t.$$.on_destroy.push(()=>Ke()),t.$$.on_destroy.push(()=>Re()),t.$$.on_destroy.push(()=>ur()),t.$$.on_destroy.push(()=>zr());let{isActive:dr}=e;ar();let{isActiveFraction:Y}=e;Dr();let{isVisible:it}=e;$r();let{stores:G}=e,{locale:Bt={}}=e,{shapes:ae}=e;Qe();let{toolbar:De=[]}=e,{toolShapes:we={}}=e,{toolActive:Ot}=e,{toolSelectRadius:Ce}=e,{toolRetainStyles:nr=!1}=e,{toolbarLayout:lr="stack"}=e,{textInputMode:ot}=e,{shapeControls:Yt={}}=e,{enableButtonFlipVertical:Ve=!1}=e,{enablePresetSelectImage:Se=!0}=e,{enablePresetDropImage:ee=!0}=e,{enableSelectToolToAddShape:Xe=!1}=e,{enableAutoSelectMoveTool:Be=["line","arrow","path","rectangle","ellipse","text"]}=e,{enableTapToAddText:yr=!1}=e,{enableMoveTool:$t=!1}=e,{enableViewTool:Ae=!1}=e,{enableToolShareStyles:Gt=!0}=e,{enableMultiSelect:me=!1}=e,{gridSize:he=0}=e,{snapThreshold:er=0}=e,{enableSnapToContext:Er=!0}=e,{willRenderHeaderTools:fe=tn}=e,{willRenderPresetToolbar:Cr}=e,{willRenderShapeStyleControls:Mr}=e,{willStartInteraction:ir}=e,{shapePresets:en=[]}=e,{utilKey:ye}=e,{mapScreenPointToImagePoint:tr}=e,{mapImagePointToScreenPoint:je}=e,{imageRotation:pn=0}=e,{imageFlipX:wn=!1}=e,{imageFlipY:sn=!1}=e,{parentRect:Xr}=e;Je();let{hooks:hn={}}=e;const li=$n("selection");D(t,li,O=>r(150,_=O));const kn=$n("isAnimated");D(t,kn,O=>r(142,q=O));const Ci=$n("elasticityMultiplier");D(t,Ci,O=>r(146,Dt=O));const Uo=$n("ui");D(t,Uo,O=>r(177,Kt=O));const pi=$n("keysPressed");let xn;D(t,pi,O=>r(149,xe=O));const{env:na,history:Vn,rootRect:Br,rootColorSecondary:xa,enablePanInput:Zn,enablePanInputStatus:ci,enableZoomInput:Ln,stageRect:ui,utilRectPadded:hi,scrollElasticity:Xn,imageOverlayMarkup:Tn,imagePreviewModifiers:mi,imageCropRect:Go,stageScalar:Io,imageSelectionRect:Eo,imageTransformsInterpolated:xo,imageSelectionPan:Ao,imageSize:vo,allowPan:lo,allowZoom:Bi,allowZoomControls:co,allowPlayPause:Zi}=G;D(t,na,O=>r(143,Ft=O)),D(t,Br,O=>r(55,Oe=O)),D(t,xa,O=>r(57,Ct=O)),D(t,ci,O=>r(38,gt=O)),D(t,ui,O=>r(147,Wt=O)),D(t,hi,O=>r(39,qt=O)),D(t,mi,O=>r(178,de=O)),D(t,Go,O=>r(176,ie=O)),D(t,Io,O=>r(174,pt=O)),D(t,Eo,O=>r(175,Xt=O)),D(t,xo,O=>r(36,at=O)),D(t,Ao,O=>r(173,St=O)),D(t,vo,O=>r(148,te=O));let ii=0,ei={};const Oi=O=>{const[Qt,Ar]=xn[O];let Ue,be,$e=Ar.position==="relative";const Kr=$e?"0%":0,Ir=$e?"0%":0;Wo(Qt)||Qn(Qt)?(be=$e?"20%":.2*Zt.width,Ue=In(Qt),M1(Ue),P1(Ue),Ue.x=Kr,Ue.y=Ir,Ia(Ue,{width:be,height:be},Zt)):di(Qt)?(be=$e?"10%":.1*Zt.width,Ue=In(Qt),Ue.x=Kr,Ue.y=Ir,Ia(Ue,{rx:be,ry:be},Zt)):Ii(Qt)&&(be=$e?"10%":.1*Zt.width,Ue=In(Qt),Ue.x1=Kr,Ue.y1=Ir,Ue.x2=Kr,Ue.y2=Ir),Ue&&Promise.resolve().then(()=>{Fo(Yn(Ue,void 0,be))})},uo=O=>tr(U1(O,Oe));let Yr,Nn={},to,Cn;const wo=O=>{if(!(Jn(O)&&Te(O,"pathClose")))return;const Qt=[...O.strokeColor];Qt[3]=1,Yr.updateMarkupShape(O,{pathClose:!1,strokeColor:Qt},!1),Yr.removeMarkupShapeProps(O,["backgroundColor"],!1),Yr.confirmMarkupItemDraft(),Yr.selectShape(O),vt("addshape",O),Vn.write()},oi=O=>{const Qt=In(O);return Object.assign(Qt,Kt[ye]?Kt[ye][Ot]:{}),h2(Qt),Qt};let Zo;const Wi=(O,Qt)=>{const Ar={};return Object.entries(O).forEach(([Ue,be])=>{Te(Qt,Ue)&&(Ar[Ue]=be)}),Ar},So=(O,Qt)=>{if(_e(O))return O;if(O.endsWith("%"))return parseFloat(O)/100*Qt.width};let Pn,_i,fn;const Yn=(O,Qt,Ar)=>{let Ue=!1;Qt||(Ue=!0,Qt=wt?tr(Lr(Wt)):Lr(ie)),Qt.x-=Zt.x||0,Qt.y-=Zt.y||0,(wn||sn)&&(O.flipX=wn,O.flipY=sn);const be=Yr.getShapesNearPosition(yt,Qt);if(Ue&&be.length){const $e=.1*Math.min(ie.width,ie.height);Qt.x+=Math.round(-$e+Math.random()*$e*2),Qt.y+=Math.round(-$e+Math.random()*$e*2)}if(pn!==0&&(O.rotation=wn&&sn?-pn:wn||sn?pn:-pn),Te(O,"width")&&Te(O,"height")){const{width:$e,height:Kr}=Ql(O,["width","height"],Zt);Ia(O,{x:Qt.x-.5*$e,y:Qt.y-.5*Kr},Zt)}else if(di(O))Ia(O,{x:Qt.x,y:Qt.y},Zt);else if(Ii(O)){const{x1:$e,y1:Kr,x2:Ir,y2:rn}=Ql(O,["x1","y1","x2","y2"],Zt),bn=Ni(lt($e,Kr),lt(Ir,rn)),Or=Ge(Ar)?Jd(Ar,Zt.width):bn;Ia(O,{x1:Qt.x-Or,y1:Qt.y+Or,x2:Qt.x+Or,y2:Qt.y-Or},Zt)}else if(Jn(O)){const{points:$e}=Ql(O,["points"],Zt),Kr=Qo($e);Ia(O,{points:$e.map(Ir=>({x:Ir.x+Qt.x-Kr.x,y:Ir.y+Qt.y-Kr.y}))},Zt)}return O},Lo=(O,Qt)=>{const Ar=Yn(yf(O,ie),Qt);return O.shape&&(Te(O.shape,"x")&&(Ar.x=O.shape.x),Te(O.shape,"y")&&(Ar.y=O.shape.y)),Fo(Ar)},Fo=O=>{const{beforeAddShape:Qt=()=>!0}=hn;if(Qt(O))return Yr.addShape(O),Yr.selectShape(O),vt("addshape",O),Vn.write(),O};let eo=!1;const Xi=()=>{Vn.write()};let ko;const wi=$n("redrawTrigger");D(t,wi,O=>r(144,zt=O));const po=[],To=hr(q?20:0);return D(t,To,O=>r(141,rt=O)),t.$$set=O=>{"isActive"in O&&ar(r(1,dr=O.isActive)),"isActiveFraction"in O&&Dr(r(2,Y=O.isActiveFraction)),"isVisible"in O&&$r(r(3,it=O.isVisible)),"stores"in O&&r(100,G=O.stores),"locale"in O&&r(4,Bt=O.locale),"shapes"in O&&Qe(r(5,ae=O.shapes)),"toolbar"in O&&r(101,De=O.toolbar),"toolShapes"in O&&r(102,we=O.toolShapes),"toolActive"in O&&r(0,Ot=O.toolActive),"toolSelectRadius"in O&&r(6,Ce=O.toolSelectRadius),"toolRetainStyles"in O&&r(103,nr=O.toolRetainStyles),"toolbarLayout"in O&&r(7,lr=O.toolbarLayout),"textInputMode"in O&&r(8,ot=O.textInputMode),"shapeControls"in O&&r(9,Yt=O.shapeControls),"enableButtonFlipVertical"in O&&r(10,Ve=O.enableButtonFlipVertical),"enablePresetSelectImage"in O&&r(11,Se=O.enablePresetSelectImage),"enablePresetDropImage"in O&&r(12,ee=O.enablePresetDropImage),"enableSelectToolToAddShape"in O&&r(104,Xe=O.enableSelectToolToAddShape),"enableAutoSelectMoveTool"in O&&r(105,Be=O.enableAutoSelectMoveTool),"enableTapToAddText"in O&&r(13,yr=O.enableTapToAddText),"enableMoveTool"in O&&r(106,$t=O.enableMoveTool),"enableViewTool"in O&&r(107,Ae=O.enableViewTool),"enableToolShareStyles"in O&&r(108,Gt=O.enableToolShareStyles),"enableMultiSelect"in O&&r(14,me=O.enableMultiSelect),"gridSize"in O&&r(15,he=O.gridSize),"snapThreshold"in O&&r(16,er=O.snapThreshold),"enableSnapToContext"in O&&r(17,Er=O.enableSnapToContext),"willRenderHeaderTools"in O&&r(109,fe=O.willRenderHeaderTools),"willRenderPresetToolbar"in O&&r(110,Cr=O.willRenderPresetToolbar),"willRenderShapeStyleControls"in O&&r(18,Mr=O.willRenderShapeStyleControls),"willStartInteraction"in O&&r(111,ir=O.willStartInteraction),"shapePresets"in O&&r(19,en=O.shapePresets),"utilKey"in O&&r(20,ye=O.utilKey),"mapScreenPointToImagePoint"in O&&r(21,tr=O.mapScreenPointToImagePoint),"mapImagePointToScreenPoint"in O&&r(22,je=O.mapImagePointToScreenPoint),"imageRotation"in O&&r(23,pn=O.imageRotation),"imageFlipX"in O&&r(24,wn=O.imageFlipX),"imageFlipY"in O&&r(25,sn=O.imageFlipY),"parentRect"in O&&Je(r(26,Xr=O.parentRect)),"hooks"in O&&r(112,hn=O.hooks)},t.$$.update=()=>{var O,Qt,Ar,Ue;if(33554432&t.$$.dirty[4]&&r(124,n=xe.includes(18)),1049088&t.$$.dirty[3]&&(xn&&we===xn||r(113,xn=we)),16&t.$$.dirty[1]&&lo.set(X),16&t.$$.dirty[1]&&Bi.set(X),16&t.$$.dirty[1]&&co.set(X),256&t.$$.dirty[3]&&r(33,i=Array.isArray(De)&&De.length>1&&Array.isArray(De[0][1])),4&t.$$.dirty[1]|256&t.$$.dirty[3]&&r(54,o=i?De.map((be,$e)=>[$e,be[0]]):[]),134217728&t.$$.dirty[0]|4&t.$$.dirty[1]|256&t.$$.dirty[3]&&r(140,a=i?De[ii][1]:De),524288&t.$$.dirty[0]|155648&t.$$.dirty[3]|65536&t.$$.dirty[4]&&r(32,s=((be,{willRenderPresetToolbar:$e,shapePresets:Kr,enableViewTool:Ir,enableMoveTool:rn})=>{let bn=Kr.length!==0||$e?be:be.filter(Or=>Or[0]!=="preset");return i&&(bn=[["move",Or=>Or.shapeLabelToolMove,{icon:Or=>Or.shapeIconToolMove}],["view",Or=>Or.shapeLabelToolView,{icon:Or=>Or.shapeIconToolView}],...bn]),bn=rn?bn:bn.filter(Or=>Or[0]!=="move"),Ir?bn:bn.filter(Or=>Or[0]!=="view")})(a,{willRenderPresetToolbar:Cr,shapePresets:en,enableMoveTool:$t,enableViewTool:Ae})),2&t.$$.dirty[1]&&r(138,u=!!s.length),1&t.$$.dirty[0]|2&t.$$.dirty[1]|16384&t.$$.dirty[4]&&u&&Ot===void 0&&r(0,Ot=s[0][0]),134217729&t.$$.dirty[0]|4&t.$$.dirty[1]|2097152&t.$$.dirty[3]|65536&t.$$.dirty[4]&&i&&r(114,ei={...ei,[ii]:a.map(([be])=>be).includes(Ot)?Ot:ei[ii]||a[0][0]}),512&t.$$.dirty[0]&&r(137,l=!!Object.keys(Yt).length),2&t.$$.dirty[1]&&r(34,c=s.length>1),12&t.$$.dirty[1]&&r(53,d=c||i),1&t.$$.dirty[0]&&r(139,p=Ot!==void 0),57344&t.$$.dirty[4]&&r(52,h=(!p||u)&&l),536870912&t.$$.dirty[0]&&r(31,vt=ko&&(O=ko,(be,$e)=>{O.dispatchEvent(Fs(be,$e))})),1&t.$$.dirty[0]|17&t.$$.dirty[1]&&X&&vt&&vt("selectcontrol",Ot),16&t.$$.dirty[1]&&(X?It(mi,de[ye]={maskMarkupOpacity:.85},de):delete de[ye]),1&t.$$.dirty[0]|1048576&t.$$.dirty[3]&&r(136,f=Ot&&xn[Ot]?xn[Ot][1]:void 0),4096&t.$$.dirty[4]&&r(125,g=f&&f.isSelection?"selection":"shapes"),3&t.$$.dirty[4]&&(be=>{if(!Yr)return;const $e=Yr.getShapeDraft(li);$e&&(be&&(to=$e.drawMode),Yr.updateShapeDraft({drawMode:be?"subtract":to},li))})(g==="selection"&&n),268435457&t.$$.dirty[0]&&Ot&&Yr){const be=Yr.getMarkupItemDraft();be&&wo(be)}if(1&t.$$.dirty[0]&&Ot&&Yr&&Ot!=="move"&&Yr.blurShapes(),16&t.$$.dirty[1]|134217728&t.$$.dirty[4]&&r(51,$=le&&X),256&t.$$.dirty[1]|8388608&t.$$.dirty[4]&&r(50,b=qt&&lt(Wt.x-qt.x,Wt.y-qt.y)),512&t.$$.dirty[0]&&r(135,v=Object.keys(Yt)),16384&t.$$.dirty[0]|16&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&r(122,w=me?X&&yt.filter(Pa):[]),536870912&t.$$.dirty[3]&&r(123,S=w.length>1),16&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&r(119,P=X&&yt.filter(Pa)[0]),16&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&r(130,M=X&&yt.find(be=>Nh(be))),16&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&r(133,E=X&&yt.find(be=>ao(be))),1&t.$$.dirty[0]|16&t.$$.dirty[1]|1048576&t.$$.dirty[3]&&r(127,C=X&&xn[Ot]?oi(xn[Ot][0]):{}),1048576&t.$$.dirty[3]&&xn&&r(115,Nn={}),1&t.$$.dirty[0]|4227072&t.$$.dirty[3]|2056&t.$$.dirty[4]&&r(126,z=C&&Object.keys(C).reduce((be,$e)=>{const Kr=$e==="disableStyle",Ir=$e==="settings",rn=!!v.find(Si=>Si.split("_").includes($e));if(!Kr&&!Ir&&!rn||C[$e]===void 0||C.disableStyle===!0||C.disableStyle&&C.disableStyle.includes($e))return be;if($e==="strokeWidth"&&Object.keys(Nn).includes("strokeWidth")&&Nn[$e]===void 0&&Te(C,"points"))return be[$e]=C[$e],be;const{share:bn=!0}=C.settings&&C.settings[$e]||{},Or=Gt&&bn?Nn:Nn[Ot]||{};return be[$e]=Te(Or,$e)?Or[$e]:C[$e],be},{})),1048577&t.$$.dirty[0]|1024&t.$$.dirty[3]|4&t.$$.dirty[4]&&(nr?((be,$e,Kr)=>{const Ir=Kt[be],rn=Ir?Ir[$e]:{};Uo.set({...Kt,[be]:{...Ir,[$e]:{...rn,...Kr}}})})(ye,Ot,z):(Qt=ye,Uo.set({[Qt]:{}}))),16&t.$$.dirty[1]|67108864&t.$$.dirty[3]|67108868&t.$$.dirty[4]&&r(134,V=_&&X?P||z:void 0),1610612736&t.$$.dirty[3]|1536&t.$$.dirty[4]&&r(49,L=S?function(be){const $e={};return be.forEach(Kr=>{Object.entries(Kr).filter(([Ir])=>!Ir.startsWith("_")).forEach(([Ir,rn])=>{Te($e,Ir)?Ir==="disableStyle"&&En(rn)&&$e[Ir].push(...rn):$e[Ir]=rn})}),$e}(w):V||E),1&t.$$.dirty[0]|8&t.$$.dirty[4]&&r(48,y=Te(C,"eraseRadius")||Te(C,"points")&&!Te(C,"pathClose")||Ot==="move"||Ot==="view"),64&t.$$.dirty[1]|8&t.$$.dirty[4]&&r(47,ct=C&&C.eraseRadius!==void 0?So(C.eraseRadius,Zt):void 0),16&t.$$.dirty[1]|33554432&t.$$.dirty[4]&&r(131,j=X&&xe.includes(32)),1&t.$$.dirty[0]|16&t.$$.dirty[1]&&r(132,k=X&&Ot==="view"),384&t.$$.dirty[4]&&r(129,N=k||j),96&t.$$.dirty[4]&&r(128,nt=!!N&&(!!M||Ja(document.activeElement))),16&t.$$.dirty[1]|48&t.$$.dirty[4]&&Zn.set(!X||N&&!nt),16&t.$$.dirty[1]|16&t.$$.dirty[4]&&Ln.set(!X||!nt),64&t.$$.dirty[1]|12&t.$$.dirty[4]&&r(120,ft=C.cursorStyle?(({cursorStyle:be,cursorSize:$e},Kr,Ir)=>{let rn;const bn=Kr[$e];if(bn===void 0?rn=So($e,Ir):_e(bn)?rn=bn:Ge(bn)&&(rn=kv($e,Kr[$e],Ir),$e==="strokeWidth"&&(rn*=.5)),!(rn<=0||rn===void 0))return{size:rn,style:be}})(C,{...C,...z},Zt):void 0),33554432&t.$$.dirty[3]|16777216&t.$$.dirty[4]&&r(121,xt=fn&&(Ue=te,(Ar=fn).x>=0&&Ar.y>=0&&Ar.x<=Ue.width&&Ar.y<=Ue.height)),1048576&t.$$.dirty[0]|160&t.$$.dirty[1]|427819008&t.$$.dirty[3]|3&t.$$.dirty[4])if(xt&&!Pn&&ft&&!gt){const be=ft.size*at.scale,$e={id:"cursor-"+ye,x:_i.x,y:_i.y,strokeWidth:.5,strokeColor:[0,0,0]};ft.style==="ellipse"&&($e.rx=be,$e.ry=be);const Kr={strokeWidth:2.5,strokeColor:[1,1,1],opacity:.75},Ir=[{...$e,...Kr},$e];if(g==="selection"&&n){const rn=be,bn=_i.x+rn,Or=_i.y+rn+4,Si={id:"cursor-"+ye,strokeWidth:.75,strokeColor:[0,0,0],points:[{x:bn,y:Or},{x:bn+4,y:Or}]};Ir.push({...Si,...Kr,strokeWidth:2,points:[{x:bn-.5,y:Or},{x:bn+4.5,y:Or}]},Si)}(rn=>{Tn.update(bn=>[...bn.filter(Or=>Or.id!=="cursor-"+ye),...rn])})(Ir)}else Tn.update(be=>be.filter($e=>$e.id!=="cursor-"+ye));1&t.$$.dirty[0]|128&t.$$.dirty[1]|478150656&t.$$.dirty[3]&&r(46,H=xt?((be,$e,Kr,Ir,rn,bn)=>{if(Ir)return rn?"grabbing":"grab";if(be&&!$e)return"none";if(!$e)return bn==="move"?"default":"crosshair";let Or=$e||Kr;return Pa(Or)?Nh(Or)?ot==="modal"?"default":"text":!$l(Or)||S&&!w.every($l)?"default":"move":"default"})(ft,Pn,P,gt,!1,Ot):"default"),526337&t.$$.dirty[0]|131072&t.$$.dirty[3]&&r(45,Z=Ot==="preset"&&(en.length>0||Se||Cr)),64&t.$$.dirty[1]&&(wt=!Te(Zt,"x")&&!Te(Zt,"y")),4194304&t.$$.dirty[4]&&r(44,et=Dt*Xn),131072&t.$$.dirty[3]|1572864&t.$$.dirty[4]&&r(43,Pt=zt&&Cr?be=>pu(()=>Cr(be,Lo,{...Ft},()=>wi.set({}))):tn),524288&t.$$.dirty[3]&&r(42,Et=Object.keys(hn).reduce((be,$e)=>($e==="beforeAddShape"||hn[$e]===void 0||(be[$e]=hn[$e]),be),{})),16&t.$$.dirty[1]&&(be=>{yt&&ae.update($e=>$e.map(Kr=>(Kr._prerender=!!be&&Nh(Kr),Kr)))})(X),65536&t.$$.dirty[3]|1572864&t.$$.dirty[4]&&r(30,kt=zt&&fe([],Ft,()=>wi.set({}))),1073742336&t.$$.dirty[0]&&r(41,st=!!kt.length||!!Object.keys(Yt).some(be=>po.includes(be))),16&t.$$.dirty[1]|262144&t.$$.dirty[4]&&q&&To.set(X?0:20),t.$$.dirty[4],131072&t.$$.dirty[4]&&r(40,Ut=rt?`translateY(${rt}px)`:"none")},Zi.set(!1),[Ot,dr,Y,it,Bt,ae,Ce,lr,ot,Yt,Ve,Se,ee,yr,me,he,er,Er,Mr,en,ye,tr,je,pn,wn,sn,Xr,ii,Yr,ko,kt,vt,s,i,c,X,at,Zt,gt,qt,Ut,st,Et,Pt,et,Z,H,ct,y,L,b,$,h,d,o,Oe,rr,Ct,li,kn,Ci,Uo,pi,na,Br,xa,ci,ui,hi,Tn,mi,Go,Io,Eo,xo,Ao,vo,({index:O},Qt)=>{r(27,ii=O),r(0,Ot=ei[O])},({value:O},Qt)=>{r(0,Ot=O),(Xe||/enter/i.test(Qt.key))&&Oi(O)},O=>{if(Ot==="eraser")Cn=Yr.eraseShape();else if(Ot&&xn[Ot]){const[Qt,Ar={}]=xn[Ot],Ue=In(Qt);M1(Ue),P1(Ue);const{drawMode:be}=V;g==="selection"&&be==="new"&&li.set([]);let $e={};g==="selection"&&(vt("selectiondown",[..._]),n&&(to=Ue.drawMode,$e.drawMode="subtract")),Cn=Yr.createShape({...Ue,...z,...$e},Ar)}else Cn=void 0;return!!Cn&&(Cn.start(O),!0)},O=>!!Cn&&(Cn.update(O),!0),O=>!!Cn&&(Cn.release(O),!0),O=>!!Cn&&(Cn.cancel(O),Cn=void 0,!0),O=>{if(!Cn)return!1;if(Cn.end(O),Cn=void 0,g==="selection"){if(O.detail.isTap){const[Ue]=xn[Ot];Ue.bitmap||li.set([])}vt("selectionup",[..._])}const Qt=Yr.getMarkupItemDraft(),Ar=$t&&(Be===!0||Array.isArray(Be)&&Be.includes(Ot));return Qt&&!Qt.isEditing||!Ar||r(0,Ot="move"),!0},O=>{const{key:Qt}=O,Ar=Yr.getMarkupItemDraft();/escape/i.test(Qt)&&Ar&&(O.preventDefault(),O.stopPropagation(),Yr.discardMarkupItemDraft(),Cn=void 0),/enter/i.test(Qt)&&Ar&&(O.preventDefault(),O.stopPropagation(),wo(Ar),Cn=void 0)},function(O){Object.keys(O).forEach(Qt=>{const{retain:Ar=!0,share:Ue=!0}=C.settings&&C.settings[Qt]||{};Ar&&(Gt&&Ue?r(115,Nn[Qt]=O[Qt],Nn):(Nn[Ot]||r(115,Nn[Ot]={},Nn),r(115,Nn[Ot][Qt]=O[Qt],Nn)))}),vt("selectstyle",O),P&&(S?w.forEach(Qt=>{Yr.updateMarkupShape(Qt,Wi(O,Qt))}):Yr.updateMarkupShape(P,O),clearTimeout(Zo),Zo=setTimeout(()=>{Xi()},200))},(O,Qt,Ar)=>{r(117,_i=Qt),r(118,fn=Ar)},()=>{r(118,fn=void 0),r(117,_i=void 0)},O=>{vt("markuptap",O)},O=>r(116,Pn=O),()=>{eo=!1},(O,Qt)=>{if(eo)return;const{beforeAddShape:Ar=()=>!0}=hn,Ue=uo(Qt),be=Yr.getMarkupItemDraft(),$e=Zd(ie,{x:Ue.x+(Zt.x||0),y:Ue.y+(Zt.y||0)});if(be&&!$e&&Yr.discardMarkupItemDraft(),$e){if(!be){const Kr=yf(O,ie),Ir=Yn(Kr,Ue);return Ar(Ir)?(S1(Ir),void Yr.addShape(Ir)):(eo=!0,void Qt.preventDefault())}Wo(be)&&(Ue.x-=.5*be.width,Ue.y-=.5*be.height),O.shape&&(Te(O.shape,"x")&&(Ue.x=O.shape.x),Te(O.shape,"y")&&(Ue.y=O.shape.y)),Yr.updateMarkupShape(be,Ue)}},(O,Qt)=>{if(eo)return;const Ar=uo(Qt);if(!Zd(ie,{x:Ar.x+(Zt.x||0),y:Ar.y+(Zt.y||0)}))return void Yr.discardMarkupItemDraft();const Ue=Yr.confirmMarkupItemDraft();Yr.selectShape(Ue),vt("addshape",Ue),Vn.write()},O=>Lo(O),O=>{return Qt=O.detail.resources,Ar=uo(O.detail.event),Qt.filter(Ue=>gu(Ue)).forEach(Ue=>Lo(Ue,Ar));var Qt,Ar},O=>{if(!ir)return!0;const Qt=rectClone(Xt);return rectScale(Qt,1/pt),rectTranslate(Qt,St),rectScale(Qt,at.scale),ir(O,{...Qt,x:Qt.x+Wt.x,y:Qt.y+Wt.y})},Xi,wi,po,To,G,De,we,nr,Xe,Be,$t,Ae,Gt,fe,Cr,ir,hn,xn,ei,Nn,Pn,_i,fn,P,ft,xt,w,S,n,g,z,C,nt,N,M,j,k,E,V,v,f,l,u,p,a,rt,q,Ft,zt,yt,Dt,Wt,te,xe,_,le,function(O){Ji.call(this,t,O)},O=>O[0]===Ot,(O,Qt,Ar)=>{const Ue=O.filter(([,be])=>!po.includes(be));return Mr?Mr(Ue,Qt,Ar):Ue},O=>O[0]===ii,O=>{Promise.resolve().then(()=>{vt("addshape",O),Xi()})},O=>{vt("selectshape",O)},O=>{Promise.resolve().then(()=>{vt("blurshape",O)})},O=>{vt("tapshape",O)},O=>{vt("updateshape",O),Xi()},O=>{vt("removeshape",O),Xi()},()=>{Xi()},function(O){jr[O?"unshift":"push"](()=>{Yr=O,r(28,Yr)})},function(O){jr[O?"unshift":"push"](()=>{ko=O,r(29,ko)})},O=>O.filter(([,Qt])=>po.includes(Qt)),function(O){Ji.call(this,t,O)}]}class $p extends gr{constructor(e){super(),fr(this,e,c8,l8,cr,{isActive:1,isActiveFraction:2,isVisible:3,stores:100,locale:4,shapes:5,toolbar:101,toolShapes:102,toolActive:0,toolSelectRadius:6,toolRetainStyles:103,toolbarLayout:7,textInputMode:8,shapeControls:9,enableButtonFlipVertical:10,enablePresetSelectImage:11,enablePresetDropImage:12,enableSelectToolToAddShape:104,enableAutoSelectMoveTool:105,enableTapToAddText:13,enableMoveTool:106,enableViewTool:107,enableToolShareStyles:108,enableMultiSelect:14,gridSize:15,snapThreshold:16,enableSnapToContext:17,willRenderHeaderTools:109,willRenderPresetToolbar:110,willRenderShapeStyleControls:18,willStartInteraction:111,shapePresets:19,utilKey:20,mapScreenPointToImagePoint:21,mapImagePointToScreenPoint:22,imageRotation:23,imageFlipX:24,imageFlipY:25,parentRect:26,hooks:112},null,[-1,-1,-1,-1,-1,-1,-1])}get isActive(){return this.$$.ctx[1]}set isActive(e){this.$$set({isActive:e}),A()}get isActiveFraction(){return this.$$.ctx[2]}set isActiveFraction(e){this.$$set({isActiveFraction:e}),A()}get isVisible(){return this.$$.ctx[3]}set isVisible(e){this.$$set({isVisible:e}),A()}get stores(){return this.$$.ctx[100]}set stores(e){this.$$set({stores:e}),A()}get locale(){return this.$$.ctx[4]}set locale(e){this.$$set({locale:e}),A()}get shapes(){return this.$$.ctx[5]}set shapes(e){this.$$set({shapes:e}),A()}get toolbar(){return this.$$.ctx[101]}set toolbar(e){this.$$set({toolbar:e}),A()}get toolShapes(){return this.$$.ctx[102]}set toolShapes(e){this.$$set({toolShapes:e}),A()}get toolActive(){return this.$$.ctx[0]}set toolActive(e){this.$$set({toolActive:e}),A()}get toolSelectRadius(){return this.$$.ctx[6]}set toolSelectRadius(e){this.$$set({toolSelectRadius:e}),A()}get toolRetainStyles(){return this.$$.ctx[103]}set toolRetainStyles(e){this.$$set({toolRetainStyles:e}),A()}get toolbarLayout(){return this.$$.ctx[7]}set toolbarLayout(e){this.$$set({toolbarLayout:e}),A()}get textInputMode(){return this.$$.ctx[8]}set textInputMode(e){this.$$set({textInputMode:e}),A()}get shapeControls(){return this.$$.ctx[9]}set shapeControls(e){this.$$set({shapeControls:e}),A()}get enableButtonFlipVertical(){return this.$$.ctx[10]}set enableButtonFlipVertical(e){this.$$set({enableButtonFlipVertical:e}),A()}get enablePresetSelectImage(){return this.$$.ctx[11]}set enablePresetSelectImage(e){this.$$set({enablePresetSelectImage:e}),A()}get enablePresetDropImage(){return this.$$.ctx[12]}set enablePresetDropImage(e){this.$$set({enablePresetDropImage:e}),A()}get enableSelectToolToAddShape(){return this.$$.ctx[104]}set enableSelectToolToAddShape(e){this.$$set({enableSelectToolToAddShape:e}),A()}get enableAutoSelectMoveTool(){return this.$$.ctx[105]}set enableAutoSelectMoveTool(e){this.$$set({enableAutoSelectMoveTool:e}),A()}get enableTapToAddText(){return this.$$.ctx[13]}set enableTapToAddText(e){this.$$set({enableTapToAddText:e}),A()}get enableMoveTool(){return this.$$.ctx[106]}set enableMoveTool(e){this.$$set({enableMoveTool:e}),A()}get enableViewTool(){return this.$$.ctx[107]}set enableViewTool(e){this.$$set({enableViewTool:e}),A()}get enableToolShareStyles(){return this.$$.ctx[108]}set enableToolShareStyles(e){this.$$set({enableToolShareStyles:e}),A()}get enableMultiSelect(){return this.$$.ctx[14]}set enableMultiSelect(e){this.$$set({enableMultiSelect:e}),A()}get gridSize(){return this.$$.ctx[15]}set gridSize(e){this.$$set({gridSize:e}),A()}get snapThreshold(){return this.$$.ctx[16]}set snapThreshold(e){this.$$set({snapThreshold:e}),A()}get enableSnapToContext(){return this.$$.ctx[17]}set enableSnapToContext(e){this.$$set({enableSnapToContext:e}),A()}get willRenderHeaderTools(){return this.$$.ctx[109]}set willRenderHeaderTools(e){this.$$set({willRenderHeaderTools:e}),A()}get willRenderPresetToolbar(){return this.$$.ctx[110]}set willRenderPresetToolbar(e){this.$$set({willRenderPresetToolbar:e}),A()}get willRenderShapeStyleControls(){return this.$$.ctx[18]}set willRenderShapeStyleControls(e){this.$$set({willRenderShapeStyleControls:e}),A()}get willStartInteraction(){return this.$$.ctx[111]}set willStartInteraction(e){this.$$set({willStartInteraction:e}),A()}get shapePresets(){return this.$$.ctx[19]}set shapePresets(e){this.$$set({shapePresets:e}),A()}get utilKey(){return this.$$.ctx[20]}set utilKey(e){this.$$set({utilKey:e}),A()}get mapScreenPointToImagePoint(){return this.$$.ctx[21]}set mapScreenPointToImagePoint(e){this.$$set({mapScreenPointToImagePoint:e}),A()}get mapImagePointToScreenPoint(){return this.$$.ctx[22]}set mapImagePointToScreenPoint(e){this.$$set({mapImagePointToScreenPoint:e}),A()}get imageRotation(){return this.$$.ctx[23]}set imageRotation(e){this.$$set({imageRotation:e}),A()}get imageFlipX(){return this.$$.ctx[24]}set imageFlipX(e){this.$$set({imageFlipX:e}),A()}get imageFlipY(){return this.$$.ctx[25]}set imageFlipY(e){this.$$set({imageFlipY:e}),A()}get parentRect(){return this.$$.ctx[26]}set parentRect(e){this.$$set({parentRect:e}),A()}get hooks(){return this.$$.ctx[112]}set hooks(e){this.$$set({hooks:e}),A()}}var z0=(t,e,r,n,i,o,a,s,l)=>{const c=He(t),u=.5*r.width,d=.5*r.height,p=.5*e.width,h=.5*e.height,f=i.x+n.x,g=i.y+n.y;s&&(c.x=r.width-c.x),l&&(c.y=r.height-c.y);const $=Math.cos(o),b=Math.sin(o);c.x-=u,c.y-=d;const v=c.x*$-c.y*b,w=c.x*b+c.y*$;c.x=u+v,c.y=d+w,c.x*=a,c.y*=a,c.x+=p,c.y+=h,c.x+=f,c.y+=g,c.x-=u*a,c.y-=d*a;const S=(i.x-f)*a,P=(i.y-g)*a,M=S*$-P*b,E=S*b+P*$;return c.x+=M,c.y+=E,c},D0=(t,e,r,n,i,o,a,s,l)=>{const c=He(t),u=xl(r),d=xl(e),p=lt(i.x+n.x,i.y+n.y),h=Math.cos(o),f=Math.sin(o);c.x-=d.x,c.y-=d.y;const g=(i.x-p.x)*a,$=(i.y-p.y)*a,b=g*h-$*f,v=g*f+$*h;c.x-=b,c.y-=v,c.x-=p.x,c.y-=p.y,c.x/=a,c.y/=a;const w=c.x*h+c.y*f,S=c.x*f-c.y*h;return c.x=w,c.y=-S,c.x+=u.x,c.y+=u.y,s&&(c.x=r.width-c.x),l&&(c.y=r.height-c.y),c},sc=t=>typeof t=="boolean";function u8(t){let e,r,n;function i(a){t[61](a)}let o={utilKey:t[1],stores:t[5],locale:t[6],isActive:t[2],isActiveFraction:t[3],isVisible:t[4],mapScreenPointToImagePoint:t[46],mapImagePointToScreenPoint:t[45],imageRotation:t[47],imageFlipX:t[44],imageFlipY:t[43],shapes:t[49],toolbar:t[21]||t[7],toolShapes:t[22]||t[8],toolRetainStyles:t[9],enableSelectToolToAddShape:t[31],enableTapToAddText:t[32],enableViewTool:t[30],enableMoveTool:t[34],enableAutoSelectMoveTool:t[33],enableMultiSelect:t[35],snapThreshold:t[16],gridSize:_e(t[18])?t[18]:t[15],enableSnapToContext:sc(t[19])?t[19]:t[17],enableToolShareStyles:t[13],shapeControls:t[23]||t[10],shapePresets:t[27],enableButtonFlipVertical:t[24],parentRect:t[50],enablePresetDropImage:t[26],enablePresetSelectImage:t[25],toolSelectRadius:t[11],textInputMode:t[12],willStartInteraction:t[14],willRenderPresetToolbar:t[28]||t[20],willRenderShapeStyleControls:t[29],hooks:{willRenderShapeControls:t[36],willRenderShapeTextControls:t[37],beforeAddShape:t[38],beforeRemoveShape:t[39],beforeDeselectShape:t[40],beforeSelectShape:t[41],beforeUpdateShape:t[42]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new $p({props:o}),jr.push(()=>Ro(e,"toolActive",i)),e.$on("measure",t[62]),{c(){Ht(e.$$.fragment)},m(a,s){Vt(e,a,s),n=!0},p(a,s){const l={};32&s[0]&&(l.stores=a[5]),64&s[0]&&(l.locale=a[6]),4&s[0]&&(l.isActive=a[2]),8&s[0]&&(l.isActiveFraction=a[3]),16&s[0]&&(l.isVisible=a[4]),32768&s[1]&&(l.mapScreenPointToImagePoint=a[46]),16384&s[1]&&(l.mapImagePointToScreenPoint=a[45]),65536&s[1]&&(l.imageRotation=a[47]),8192&s[1]&&(l.imageFlipX=a[44]),4096&s[1]&&(l.imageFlipY=a[43]),2097280&s[0]&&(l.toolbar=a[21]||a[7]),4194560&s[0]&&(l.toolShapes=a[22]||a[8]),512&s[0]&&(l.toolRetainStyles=a[9]),1&s[1]&&(l.enableSelectToolToAddShape=a[31]),2&s[1]&&(l.enableTapToAddText=a[32]),1073741824&s[0]&&(l.enableViewTool=a[30]),8&s[1]&&(l.enableMoveTool=a[34]),4&s[1]&&(l.enableAutoSelectMoveTool=a[33]),16&s[1]&&(l.enableMultiSelect=a[35]),65536&s[0]&&(l.snapThreshold=a[16]),294912&s[0]&&(l.gridSize=_e(a[18])?a[18]:a[15]),655360&s[0]&&(l.enableSnapToContext=sc(a[19])?a[19]:a[17]),8192&s[0]&&(l.enableToolShareStyles=a[13]),8389632&s[0]&&(l.shapeControls=a[23]||a[10]),134217728&s[0]&&(l.shapePresets=a[27]),16777216&s[0]&&(l.enableButtonFlipVertical=a[24]),67108864&s[0]&&(l.enablePresetDropImage=a[26]),33554432&s[0]&&(l.enablePresetSelectImage=a[25]),2048&s[0]&&(l.toolSelectRadius=a[11]),4096&s[0]&&(l.textInputMode=a[12]),16384&s[0]&&(l.willStartInteraction=a[14]),269484032&s[0]&&(l.willRenderPresetToolbar=a[28]||a[20]),536870912&s[0]&&(l.willRenderShapeStyleControls=a[29]),4064&s[1]&&(l.hooks={willRenderShapeControls:a[36],willRenderShapeTextControls:a[37],beforeAddShape:a[38],beforeRemoveShape:a[39],beforeDeselectShape:a[40],beforeSelectShape:a[41],beforeUpdateShape:a[42]}),!r&&1&s[0]&&(r=!0,l.toolActive=a[0],No(()=>r=!1)),e.$set(l)},i(a){n||(I(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){Nt(e,a)}}}function d8(t,e,r){let n,i,o,a,s,l,c,u,d,p,{isActive:h}=e,{isActiveFraction:f}=e,{isVisible:g}=e,{stores:$}=e,{locale:b={}}=e,{markupEditorToolbar:v}=e,{markupEditorToolStyles:w}=e,{markupEditorToolRetainStyles:S}=e,{markupEditorShapeStyleControls:P}=e,{markupEditorToolSelectRadius:M}=e,{markupEditorTextInputMode:E}=e,{markupEditorToolShareStyles:C}=e,{markupEditorWillStartInteraction:z}=e,{markupEditorGridSize:V=0}=e,{markupEditorSnapThreshold:L=0}=e,{markupEditorSnapToContext:y=!1}=e,{annotateGridSize:ct}=e,{annotateSnapToContext:j}=e,{willRenderShapePresetToolbar:k}=e,{annotateTools:N}=e,{annotateToolShapes:nt}=e,{annotateShapeControls:ft}=e,{annotateActiveTool:xt}=e,{annotateEnableButtonFlipVertical:H=!1}=e,{annotateEnableSelectImagePreset:Z=!1}=e,{annotateEnableDropImagePreset:wt=!0}=e,{annotatePresets:vt=[]}=e,{annotateWillRenderShapePresetToolbar:et}=e,{annotateWillRenderShapeStyleControls:Pt}=e,{enableViewTool:Et}=e,{enableSelectToolToAddShape:kt}=e,{enableTapToAddText:st}=e,{enableAutoSelectMoveTool:Ut}=e,{enableMoveTool:rt}=e,{enableMultiSelect:X}=e,{willRenderShapeControls:q}=e,{willRenderShapeTextControls:Ft}=e,{beforeAddShape:zt}=e,{beforeRemoveShape:yt}=e,{beforeDeselectShape:Dt}=e,{beforeSelectShape:Wt}=e,{beforeUpdateShape:at}=e;const{rootRect:St,imageAnnotation:pt,imageSize:Xt,imageRotation:Zt,imageFlipX:ie,imageFlipY:gt,imageTransforms:te,imageTransformsInterpolated:xe}=$;return D(t,St,_=>r(59,u=_)),D(t,Xt,_=>r(58,c=_)),D(t,Zt,_=>r(47,p=_)),D(t,ie,_=>r(44,s=_)),D(t,gt,_=>r(43,a=_)),D(t,te,_=>r(60,d=_)),D(t,xe,_=>r(57,l=_)),t.$$set=_=>{"isActive"in _&&r(2,h=_.isActive),"isActiveFraction"in _&&r(3,f=_.isActiveFraction),"isVisible"in _&&r(4,g=_.isVisible),"stores"in _&&r(5,$=_.stores),"locale"in _&&r(6,b=_.locale),"markupEditorToolbar"in _&&r(7,v=_.markupEditorToolbar),"markupEditorToolStyles"in _&&r(8,w=_.markupEditorToolStyles),"markupEditorToolRetainStyles"in _&&r(9,S=_.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in _&&r(10,P=_.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in _&&r(11,M=_.markupEditorToolSelectRadius),"markupEditorTextInputMode"in _&&r(12,E=_.markupEditorTextInputMode),"markupEditorToolShareStyles"in _&&r(13,C=_.markupEditorToolShareStyles),"markupEditorWillStartInteraction"in _&&r(14,z=_.markupEditorWillStartInteraction),"markupEditorGridSize"in _&&r(15,V=_.markupEditorGridSize),"markupEditorSnapThreshold"in _&&r(16,L=_.markupEditorSnapThreshold),"markupEditorSnapToContext"in _&&r(17,y=_.markupEditorSnapToContext),"annotateGridSize"in _&&r(18,ct=_.annotateGridSize),"annotateSnapToContext"in _&&r(19,j=_.annotateSnapToContext),"willRenderShapePresetToolbar"in _&&r(20,k=_.willRenderShapePresetToolbar),"annotateTools"in _&&r(21,N=_.annotateTools),"annotateToolShapes"in _&&r(22,nt=_.annotateToolShapes),"annotateShapeControls"in _&&r(23,ft=_.annotateShapeControls),"annotateActiveTool"in _&&r(0,xt=_.annotateActiveTool),"annotateEnableButtonFlipVertical"in _&&r(24,H=_.annotateEnableButtonFlipVertical),"annotateEnableSelectImagePreset"in _&&r(25,Z=_.annotateEnableSelectImagePreset),"annotateEnableDropImagePreset"in _&&r(26,wt=_.annotateEnableDropImagePreset),"annotatePresets"in _&&r(27,vt=_.annotatePresets),"annotateWillRenderShapePresetToolbar"in _&&r(28,et=_.annotateWillRenderShapePresetToolbar),"annotateWillRenderShapeStyleControls"in _&&r(29,Pt=_.annotateWillRenderShapeStyleControls),"enableViewTool"in _&&r(30,Et=_.enableViewTool),"enableSelectToolToAddShape"in _&&r(31,kt=_.enableSelectToolToAddShape),"enableTapToAddText"in _&&r(32,st=_.enableTapToAddText),"enableAutoSelectMoveTool"in _&&r(33,Ut=_.enableAutoSelectMoveTool),"enableMoveTool"in _&&r(34,rt=_.enableMoveTool),"enableMultiSelect"in _&&r(35,X=_.enableMultiSelect),"willRenderShapeControls"in _&&r(36,q=_.willRenderShapeControls),"willRenderShapeTextControls"in _&&r(37,Ft=_.willRenderShapeTextControls),"beforeAddShape"in _&&r(38,zt=_.beforeAddShape),"beforeRemoveShape"in _&&r(39,yt=_.beforeRemoveShape),"beforeDeselectShape"in _&&r(40,Dt=_.beforeDeselectShape),"beforeSelectShape"in _&&r(41,Wt=_.beforeSelectShape),"beforeUpdateShape"in _&&r(42,at=_.beforeUpdateShape)},t.$$.update=()=>{536870912&t.$$.dirty[1]&&r(56,n=d?d.rotation.z:0),503328768&t.$$.dirty[1]&&r(46,i=_=>D0(_,u,c,l.origin,l.translation,n,l.scale,s,a)),503328768&t.$$.dirty[1]&&r(45,o=_=>z0(_,u,c,l.origin,l.translation,n,l.scale,s,a))},[xt,"annotate",h,f,g,$,b,v,w,S,P,M,E,C,z,V,L,y,ct,j,k,N,nt,ft,H,Z,wt,vt,et,Pt,Et,kt,st,Ut,rt,X,q,Ft,zt,yt,Dt,Wt,at,a,s,o,i,p,St,pt,Xt,Zt,ie,gt,te,xe,n,l,c,u,d,function(_){xt=_,r(0,xt)},function(_){Ji.call(this,t,_)}]}var p8={util:["annotate",class extends gr{constructor(t){super(),fr(this,t,d8,u8,cr,{name:1,isActive:2,isActiveFraction:3,isVisible:4,stores:5,locale:6,markupEditorToolbar:7,markupEditorToolStyles:8,markupEditorToolRetainStyles:9,markupEditorShapeStyleControls:10,markupEditorToolSelectRadius:11,markupEditorTextInputMode:12,markupEditorToolShareStyles:13,markupEditorWillStartInteraction:14,markupEditorGridSize:15,markupEditorSnapThreshold:16,markupEditorSnapToContext:17,annotateGridSize:18,annotateSnapToContext:19,willRenderShapePresetToolbar:20,annotateTools:21,annotateToolShapes:22,annotateShapeControls:23,annotateActiveTool:0,annotateEnableButtonFlipVertical:24,annotateEnableSelectImagePreset:25,annotateEnableDropImagePreset:26,annotatePresets:27,annotateWillRenderShapePresetToolbar:28,annotateWillRenderShapeStyleControls:29,enableViewTool:30,enableSelectToolToAddShape:31,enableTapToAddText:32,enableAutoSelectMoveTool:33,enableMoveTool:34,enableMultiSelect:35,willRenderShapeControls:36,willRenderShapeTextControls:37,beforeAddShape:38,beforeRemoveShape:39,beforeDeselectShape:40,beforeSelectShape:41,beforeUpdateShape:42},null,[-1,-1,-1])}get name(){return this.$$.ctx[1]}get isActive(){return this.$$.ctx[2]}set isActive(t){this.$$set({isActive:t}),A()}get isActiveFraction(){return this.$$.ctx[3]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),A()}get isVisible(){return this.$$.ctx[4]}set isVisible(t){this.$$set({isVisible:t}),A()}get stores(){return this.$$.ctx[5]}set stores(t){this.$$set({stores:t}),A()}get locale(){return this.$$.ctx[6]}set locale(t){this.$$set({locale:t}),A()}get markupEditorToolbar(){return this.$$.ctx[7]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),A()}get markupEditorToolStyles(){return this.$$.ctx[8]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),A()}get markupEditorToolRetainStyles(){return this.$$.ctx[9]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),A()}get markupEditorShapeStyleControls(){return this.$$.ctx[10]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),A()}get markupEditorToolSelectRadius(){return this.$$.ctx[11]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),A()}get markupEditorTextInputMode(){return this.$$.ctx[12]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),A()}get markupEditorToolShareStyles(){return this.$$.ctx[13]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),A()}get markupEditorWillStartInteraction(){return this.$$.ctx[14]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),A()}get markupEditorGridSize(){return this.$$.ctx[15]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),A()}get markupEditorSnapThreshold(){return this.$$.ctx[16]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),A()}get markupEditorSnapToContext(){return this.$$.ctx[17]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),A()}get annotateGridSize(){return this.$$.ctx[18]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),A()}get annotateSnapToContext(){return this.$$.ctx[19]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),A()}get willRenderShapePresetToolbar(){return this.$$.ctx[20]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),A()}get annotateTools(){return this.$$.ctx[21]}set annotateTools(t){this.$$set({annotateTools:t}),A()}get annotateToolShapes(){return this.$$.ctx[22]}set annotateToolShapes(t){this.$$set({annotateToolShapes:t}),A()}get annotateShapeControls(){return this.$$.ctx[23]}set annotateShapeControls(t){this.$$set({annotateShapeControls:t}),A()}get annotateActiveTool(){return this.$$.ctx[0]}set annotateActiveTool(t){this.$$set({annotateActiveTool:t}),A()}get annotateEnableButtonFlipVertical(){return this.$$.ctx[24]}set annotateEnableButtonFlipVertical(t){this.$$set({annotateEnableButtonFlipVertical:t}),A()}get annotateEnableSelectImagePreset(){return this.$$.ctx[25]}set annotateEnableSelectImagePreset(t){this.$$set({annotateEnableSelectImagePreset:t}),A()}get annotateEnableDropImagePreset(){return this.$$.ctx[26]}set annotateEnableDropImagePreset(t){this.$$set({annotateEnableDropImagePreset:t}),A()}get annotatePresets(){return this.$$.ctx[27]}set annotatePresets(t){this.$$set({annotatePresets:t}),A()}get annotateWillRenderShapePresetToolbar(){return this.$$.ctx[28]}set annotateWillRenderShapePresetToolbar(t){this.$$set({annotateWillRenderShapePresetToolbar:t}),A()}get annotateWillRenderShapeStyleControls(){return this.$$.ctx[29]}set annotateWillRenderShapeStyleControls(t){this.$$set({annotateWillRenderShapeStyleControls:t}),A()}get enableViewTool(){return this.$$.ctx[30]}set enableViewTool(t){this.$$set({enableViewTool:t}),A()}get enableSelectToolToAddShape(){return this.$$.ctx[31]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),A()}get enableTapToAddText(){return this.$$.ctx[32]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),A()}get enableAutoSelectMoveTool(){return this.$$.ctx[33]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),A()}get enableMoveTool(){return this.$$.ctx[34]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),A()}get enableMultiSelect(){return this.$$.ctx[35]}set enableMultiSelect(t){this.$$set({enableMultiSelect:t}),A()}get willRenderShapeControls(){return this.$$.ctx[36]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),A()}get willRenderShapeTextControls(){return this.$$.ctx[37]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),A()}get beforeAddShape(){return this.$$.ctx[38]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),A()}get beforeRemoveShape(){return this.$$.ctx[39]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),A()}get beforeDeselectShape(){return this.$$.ctx[40]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),A()}get beforeSelectShape(){return this.$$.ctx[41]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),A()}get beforeUpdateShape(){return this.$$.ctx[42]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),A()}}]};function h8(t){let e,r,n;function i(a){t[52](a)}let o={utilKey:t[1],stores:t[5],locale:t[6],isActive:t[2],isActiveFraction:t[3],isVisible:t[4],mapScreenPointToImagePoint:t[44],mapImagePointToScreenPoint:t[43],shapes:t[46],toolbar:t[20]||t[7],toolShapes:t[21]||t[8],toolRetainStyles:t[9],shapeControls:t[22]||t[10],shapePresets:t[26],enableSelectToolToAddShape:t[29],enableTapToAddText:t[30],enableViewTool:t[31],enableMoveTool:t[32],enableAutoSelectMoveTool:t[33],enableMultiSelect:t[34],snapThreshold:t[16],gridSize:_e(t[18])?t[18]:t[15],enableSnapToContext:sc(t[19])?t[19]:t[17],enableToolShareStyles:t[13],enablePresetSelectImage:t[24],enablePresetDropImage:t[25],enableButtonFlipVertical:t[23],parentRect:t[45],toolSelectRadius:t[11],textInputMode:t[12],willStartInteraction:t[42],willRenderPresetToolbar:t[27]||t[14],willRenderShapeStyleControls:t[28],hooks:{willRenderShapeControls:t[35],willRenderShapeTextControls:t[36],beforeAddShape:t[37],beforeRemoveShape:t[38],beforeDeselectShape:t[39],beforeSelectShape:t[40],beforeUpdateShape:t[41]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new $p({props:o}),jr.push(()=>Ro(e,"toolActive",i)),e.$on("measure",t[53]),{c(){Ht(e.$$.fragment)},m(a,s){Vt(e,a,s),n=!0},p(a,s){const l={};32&s[0]&&(l.stores=a[5]),64&s[0]&&(l.locale=a[6]),4&s[0]&&(l.isActive=a[2]),8&s[0]&&(l.isActiveFraction=a[3]),16&s[0]&&(l.isVisible=a[4]),8192&s[1]&&(l.mapScreenPointToImagePoint=a[44]),4096&s[1]&&(l.mapImagePointToScreenPoint=a[43]),1048704&s[0]&&(l.toolbar=a[20]||a[7]),2097408&s[0]&&(l.toolShapes=a[21]||a[8]),512&s[0]&&(l.toolRetainStyles=a[9]),4195328&s[0]&&(l.shapeControls=a[22]||a[10]),67108864&s[0]&&(l.shapePresets=a[26]),536870912&s[0]&&(l.enableSelectToolToAddShape=a[29]),1073741824&s[0]&&(l.enableTapToAddText=a[30]),1&s[1]&&(l.enableViewTool=a[31]),2&s[1]&&(l.enableMoveTool=a[32]),4&s[1]&&(l.enableAutoSelectMoveTool=a[33]),8&s[1]&&(l.enableMultiSelect=a[34]),65536&s[0]&&(l.snapThreshold=a[16]),294912&s[0]&&(l.gridSize=_e(a[18])?a[18]:a[15]),655360&s[0]&&(l.enableSnapToContext=sc(a[19])?a[19]:a[17]),8192&s[0]&&(l.enableToolShareStyles=a[13]),16777216&s[0]&&(l.enablePresetSelectImage=a[24]),33554432&s[0]&&(l.enablePresetDropImage=a[25]),8388608&s[0]&&(l.enableButtonFlipVertical=a[23]),2048&s[0]&&(l.toolSelectRadius=a[11]),4096&s[0]&&(l.textInputMode=a[12]),2048&s[1]&&(l.willStartInteraction=a[42]),134234112&s[0]&&(l.willRenderPresetToolbar=a[27]||a[14]),268435456&s[0]&&(l.willRenderShapeStyleControls=a[28]),2032&s[1]&&(l.hooks={willRenderShapeControls:a[35],willRenderShapeTextControls:a[36],beforeAddShape:a[37],beforeRemoveShape:a[38],beforeDeselectShape:a[39],beforeSelectShape:a[40],beforeUpdateShape:a[41]}),!r&&1&s[0]&&(r=!0,l.toolActive=a[0],No(()=>r=!1)),e.$set(l)},i(a){n||(I(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){Nt(e,a)}}}function m8(t,e,r){let n,i,o,a,s,{isActive:l}=e,{isActiveFraction:c}=e,{isVisible:u}=e,{stores:d}=e,{locale:p={}}=e,{markupEditorToolbar:h}=e,{markupEditorToolStyles:f}=e,{markupEditorToolRetainStyles:g}=e,{markupEditorShapeStyleControls:$}=e,{markupEditorToolSelectRadius:b}=e,{markupEditorTextInputMode:v}=e,{markupEditorToolShareStyles:w}=e,{willRenderShapePresetToolbar:S}=e,{markupEditorGridSize:P}=e,{markupEditorSnapThreshold:M}=e,{markupEditorSnapToContext:E=!0}=e,{decorateGridSize:C}=e,{decorateSnapToContext:z}=e,{decorateTools:V}=e,{decorateToolShapes:L}=e,{decorateShapeControls:y}=e,{decorateActiveTool:ct}=e,{decorateEnableButtonFlipVertical:j=!1}=e,{decorateEnableSelectImagePreset:k=!1}=e,{decorateEnableDropImagePreset:N=!0}=e,{decoratePresets:nt=[]}=e,{decorateWillRenderShapePresetToolbar:ft}=e,{decorateWillRenderShapeStyleControls:xt}=e,{enableSelectToolToAddShape:H}=e,{enableTapToAddText:Z}=e,{enableViewTool:wt}=e,{enableMoveTool:vt}=e,{enableAutoSelectMoveTool:et}=e,{enableMultiSelect:Pt}=e,{willRenderShapeControls:Et}=e,{willRenderShapeTextControls:kt}=e,{beforeAddShape:st}=e,{beforeRemoveShape:Ut}=e,{beforeDeselectShape:rt}=e,{beforeSelectShape:X}=e,{beforeUpdateShape:q}=e,{markupEditorWillStartInteraction:Ft}=e;const{imageCropRect:zt,imageDecoration:yt,imageSelectionRectPresentation:Dt,imageTransformsInterpolated:Wt}=d;return D(t,Dt,at=>r(50,a=at)),D(t,Wt,at=>r(51,s=at)),t.$$set=at=>{"isActive"in at&&r(2,l=at.isActive),"isActiveFraction"in at&&r(3,c=at.isActiveFraction),"isVisible"in at&&r(4,u=at.isVisible),"stores"in at&&r(5,d=at.stores),"locale"in at&&r(6,p=at.locale),"markupEditorToolbar"in at&&r(7,h=at.markupEditorToolbar),"markupEditorToolStyles"in at&&r(8,f=at.markupEditorToolStyles),"markupEditorToolRetainStyles"in at&&r(9,g=at.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in at&&r(10,$=at.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in at&&r(11,b=at.markupEditorToolSelectRadius),"markupEditorTextInputMode"in at&&r(12,v=at.markupEditorTextInputMode),"markupEditorToolShareStyles"in at&&r(13,w=at.markupEditorToolShareStyles),"willRenderShapePresetToolbar"in at&&r(14,S=at.willRenderShapePresetToolbar),"markupEditorGridSize"in at&&r(15,P=at.markupEditorGridSize),"markupEditorSnapThreshold"in at&&r(16,M=at.markupEditorSnapThreshold),"markupEditorSnapToContext"in at&&r(17,E=at.markupEditorSnapToContext),"decorateGridSize"in at&&r(18,C=at.decorateGridSize),"decorateSnapToContext"in at&&r(19,z=at.decorateSnapToContext),"decorateTools"in at&&r(20,V=at.decorateTools),"decorateToolShapes"in at&&r(21,L=at.decorateToolShapes),"decorateShapeControls"in at&&r(22,y=at.decorateShapeControls),"decorateActiveTool"in at&&r(0,ct=at.decorateActiveTool),"decorateEnableButtonFlipVertical"in at&&r(23,j=at.decorateEnableButtonFlipVertical),"decorateEnableSelectImagePreset"in at&&r(24,k=at.decorateEnableSelectImagePreset),"decorateEnableDropImagePreset"in at&&r(25,N=at.decorateEnableDropImagePreset),"decoratePresets"in at&&r(26,nt=at.decoratePresets),"decorateWillRenderShapePresetToolbar"in at&&r(27,ft=at.decorateWillRenderShapePresetToolbar),"decorateWillRenderShapeStyleControls"in at&&r(28,xt=at.decorateWillRenderShapeStyleControls),"enableSelectToolToAddShape"in at&&r(29,H=at.enableSelectToolToAddShape),"enableTapToAddText"in at&&r(30,Z=at.enableTapToAddText),"enableViewTool"in at&&r(31,wt=at.enableViewTool),"enableMoveTool"in at&&r(32,vt=at.enableMoveTool),"enableAutoSelectMoveTool"in at&&r(33,et=at.enableAutoSelectMoveTool),"enableMultiSelect"in at&&r(34,Pt=at.enableMultiSelect),"willRenderShapeControls"in at&&r(35,Et=at.willRenderShapeControls),"willRenderShapeTextControls"in at&&r(36,kt=at.willRenderShapeTextControls),"beforeAddShape"in at&&r(37,st=at.beforeAddShape),"beforeRemoveShape"in at&&r(38,Ut=at.beforeRemoveShape),"beforeDeselectShape"in at&&r(39,rt=at.beforeDeselectShape),"beforeSelectShape"in at&&r(40,X=at.beforeSelectShape),"beforeUpdateShape"in at&&r(41,q=at.beforeUpdateShape),"markupEditorWillStartInteraction"in at&&r(42,Ft=at.markupEditorWillStartInteraction)},t.$$.update=()=>{1048576&t.$$.dirty[1]&&r(49,n=s?s.scale:1),786432&t.$$.dirty[1]&&r(44,i=at=>{const St=He(at);return St.x-=a.x,St.y-=a.y,St.x/=n,St.y/=n,St}),786432&t.$$.dirty[1]&&r(43,o=at=>{const St=He(at);return St.x*=n,St.y*=n,St.x+=a.x,St.y+=a.y,St})},[ct,"decorate",l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,E,C,z,V,L,y,j,k,N,nt,ft,xt,H,Z,wt,vt,et,Pt,Et,kt,st,Ut,rt,X,q,Ft,o,i,zt,yt,Dt,Wt,n,a,s,function(at){ct=at,r(0,ct)},function(at){Ji.call(this,t,at)}]}var f8={util:["decorate",class extends gr{constructor(t){super(),fr(this,t,m8,h8,cr,{name:1,isActive:2,isActiveFraction:3,isVisible:4,stores:5,locale:6,markupEditorToolbar:7,markupEditorToolStyles:8,markupEditorToolRetainStyles:9,markupEditorShapeStyleControls:10,markupEditorToolSelectRadius:11,markupEditorTextInputMode:12,markupEditorToolShareStyles:13,willRenderShapePresetToolbar:14,markupEditorGridSize:15,markupEditorSnapThreshold:16,markupEditorSnapToContext:17,decorateGridSize:18,decorateSnapToContext:19,decorateTools:20,decorateToolShapes:21,decorateShapeControls:22,decorateActiveTool:0,decorateEnableButtonFlipVertical:23,decorateEnableSelectImagePreset:24,decorateEnableDropImagePreset:25,decoratePresets:26,decorateWillRenderShapePresetToolbar:27,decorateWillRenderShapeStyleControls:28,enableSelectToolToAddShape:29,enableTapToAddText:30,enableViewTool:31,enableMoveTool:32,enableAutoSelectMoveTool:33,enableMultiSelect:34,willRenderShapeControls:35,willRenderShapeTextControls:36,beforeAddShape:37,beforeRemoveShape:38,beforeDeselectShape:39,beforeSelectShape:40,beforeUpdateShape:41,markupEditorWillStartInteraction:42},null,[-1,-1])}get name(){return this.$$.ctx[1]}get isActive(){return this.$$.ctx[2]}set isActive(t){this.$$set({isActive:t}),A()}get isActiveFraction(){return this.$$.ctx[3]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),A()}get isVisible(){return this.$$.ctx[4]}set isVisible(t){this.$$set({isVisible:t}),A()}get stores(){return this.$$.ctx[5]}set stores(t){this.$$set({stores:t}),A()}get locale(){return this.$$.ctx[6]}set locale(t){this.$$set({locale:t}),A()}get markupEditorToolbar(){return this.$$.ctx[7]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),A()}get markupEditorToolStyles(){return this.$$.ctx[8]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),A()}get markupEditorToolRetainStyles(){return this.$$.ctx[9]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),A()}get markupEditorShapeStyleControls(){return this.$$.ctx[10]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),A()}get markupEditorToolSelectRadius(){return this.$$.ctx[11]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),A()}get markupEditorTextInputMode(){return this.$$.ctx[12]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),A()}get markupEditorToolShareStyles(){return this.$$.ctx[13]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),A()}get willRenderShapePresetToolbar(){return this.$$.ctx[14]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),A()}get markupEditorGridSize(){return this.$$.ctx[15]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),A()}get markupEditorSnapThreshold(){return this.$$.ctx[16]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),A()}get markupEditorSnapToContext(){return this.$$.ctx[17]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),A()}get decorateGridSize(){return this.$$.ctx[18]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),A()}get decorateSnapToContext(){return this.$$.ctx[19]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),A()}get decorateTools(){return this.$$.ctx[20]}set decorateTools(t){this.$$set({decorateTools:t}),A()}get decorateToolShapes(){return this.$$.ctx[21]}set decorateToolShapes(t){this.$$set({decorateToolShapes:t}),A()}get decorateShapeControls(){return this.$$.ctx[22]}set decorateShapeControls(t){this.$$set({decorateShapeControls:t}),A()}get decorateActiveTool(){return this.$$.ctx[0]}set decorateActiveTool(t){this.$$set({decorateActiveTool:t}),A()}get decorateEnableButtonFlipVertical(){return this.$$.ctx[23]}set decorateEnableButtonFlipVertical(t){this.$$set({decorateEnableButtonFlipVertical:t}),A()}get decorateEnableSelectImagePreset(){return this.$$.ctx[24]}set decorateEnableSelectImagePreset(t){this.$$set({decorateEnableSelectImagePreset:t}),A()}get decorateEnableDropImagePreset(){return this.$$.ctx[25]}set decorateEnableDropImagePreset(t){this.$$set({decorateEnableDropImagePreset:t}),A()}get decoratePresets(){return this.$$.ctx[26]}set decoratePresets(t){this.$$set({decoratePresets:t}),A()}get decorateWillRenderShapePresetToolbar(){return this.$$.ctx[27]}set decorateWillRenderShapePresetToolbar(t){this.$$set({decorateWillRenderShapePresetToolbar:t}),A()}get decorateWillRenderShapeStyleControls(){return this.$$.ctx[28]}set decorateWillRenderShapeStyleControls(t){this.$$set({decorateWillRenderShapeStyleControls:t}),A()}get enableSelectToolToAddShape(){return this.$$.ctx[29]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),A()}get enableTapToAddText(){return this.$$.ctx[30]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),A()}get enableViewTool(){return this.$$.ctx[31]}set enableViewTool(t){this.$$set({enableViewTool:t}),A()}get enableMoveTool(){return this.$$.ctx[32]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),A()}get enableAutoSelectMoveTool(){return this.$$.ctx[33]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),A()}get enableMultiSelect(){return this.$$.ctx[34]}set enableMultiSelect(t){this.$$set({enableMultiSelect:t}),A()}get willRenderShapeControls(){return this.$$.ctx[35]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),A()}get willRenderShapeTextControls(){return this.$$.ctx[36]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),A()}get beforeAddShape(){return this.$$.ctx[37]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),A()}get beforeRemoveShape(){return this.$$.ctx[38]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),A()}get beforeDeselectShape(){return this.$$.ctx[39]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),A()}get beforeSelectShape(){return this.$$.ctx[40]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),A()}get beforeUpdateShape(){return this.$$.ctx[41]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),A()}get markupEditorWillStartInteraction(){return this.$$.ctx[42]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),A()}}]};function g8(t){let e,r;return e=new $p({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[26],mapImagePointToScreenPoint:t[25],utilKey:"sticker",shapePresets:t[5],shapes:t[6]?t[35]:t[36],toolActive:"preset",imageFlipX:!!t[6]&&t[24],imageFlipY:!!t[6]&&t[23],imageRotation:t[6]?t[31]:0,parentRect:t[6]?t[37]:t[33],snapThreshold:t[29],gridSize:t[28],enableMultiSelect:t[12],enableSnapToContext:t[27],enablePresetDropImage:t[7],enablePresetSelectImage:t[30],enableButtonFlipVertical:t[10]||t[8],toolSelectRadius:t[15],willStartInteraction:t[22],willRenderPresetToolbar:t[11]||t[9]||t[16],hooks:{willRenderShapeControls:t[13],willRenderShapeTextControls:t[14],beforeAddShape:t[17],beforeRemoveShape:t[18],beforeDeselectShape:t[19],beforeSelectShape:t[20],beforeUpdateShape:t[21]}}}),e.$on("measure",t[61]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};8&i[0]&&(o.stores=n[3]),16&i[0]&&(o.locale=n[4]),1&i[0]&&(o.isActive=n[0]),2&i[0]&&(o.isActiveFraction=n[1]),4&i[0]&&(o.isVisible=n[2]),67108864&i[0]&&(o.mapScreenPointToImagePoint=n[26]),33554432&i[0]&&(o.mapImagePointToScreenPoint=n[25]),32&i[0]&&(o.shapePresets=n[5]),64&i[0]&&(o.shapes=n[6]?n[35]:n[36]),16777280&i[0]&&(o.imageFlipX=!!n[6]&&n[24]),8388672&i[0]&&(o.imageFlipY=!!n[6]&&n[23]),64&i[0]|1&i[1]&&(o.imageRotation=n[6]?n[31]:0),64&i[0]&&(o.parentRect=n[6]?n[37]:n[33]),536870912&i[0]&&(o.snapThreshold=n[29]),268435456&i[0]&&(o.gridSize=n[28]),4096&i[0]&&(o.enableMultiSelect=n[12]),134217728&i[0]&&(o.enableSnapToContext=n[27]),128&i[0]&&(o.enablePresetDropImage=n[7]),1073741824&i[0]&&(o.enablePresetSelectImage=n[30]),1280&i[0]&&(o.enableButtonFlipVertical=n[10]||n[8]),32768&i[0]&&(o.toolSelectRadius=n[15]),4194304&i[0]&&(o.willStartInteraction=n[22]),68096&i[0]&&(o.willRenderPresetToolbar=n[11]||n[9]||n[16]),4087808&i[0]&&(o.hooks={willRenderShapeControls:n[13],willRenderShapeTextControls:n[14],beforeAddShape:n[17],beforeRemoveShape:n[18],beforeDeselectShape:n[19],beforeSelectShape:n[20],beforeUpdateShape:n[21]}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function $8(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,{isActive:w}=e,{isActiveFraction:S}=e,{isVisible:P}=e,{stores:M}=e,{locale:E={}}=e,{stickers:C=[]}=e,{stickerForceEnable:z=!1}=e,{stickerStickToImage:V=!1}=e,{stickerEnableSelectImagePreset:L=!0}=e,{stickerEnableDropImagePreset:y=!0}=e,{stickerEnableButtonFlipVertical:ct=!1}=e,{stickerWillRenderShapePresetToolbar:j}=e,{stickerEnableSelectImage:k=!0}=e,{stickersEnableButtonFlipVertical:N=!1}=e,{stickersWillRenderShapePresetToolbar:nt}=e,{markupEditorGridSize:ft=0}=e,{markupEditorSnapThreshold:xt=0}=e,{markupEditorSnapToContext:H=!1}=e,{enableMultiSelect:Z}=e,{annotateGridSize:wt}=e,{annotateSnapToContext:vt}=e,{decorateGridSize:et}=e,{decorateSnapToContext:Pt}=e,{willRenderShapeControls:Et}=e,{willRenderShapeTextControls:kt}=e,{markupEditorToolSelectRadius:st}=e,{willRenderShapePresetToolbar:Ut}=e,{beforeAddShape:rt}=e,{beforeRemoveShape:X}=e,{beforeDeselectShape:q}=e,{beforeSelectShape:Ft}=e,{beforeUpdateShape:zt}=e,{markupEditorWillStartInteraction:yt}=e;const{rootRect:Dt,imageCropRect:Wt,imageSelectionRectPresentation:at,imageAnnotation:St,imageDecoration:pt,imageSize:Xt,imageTransforms:Zt,imageTransformsInterpolated:ie,imageRotation:gt,imageFlipX:te,imageFlipY:xe}=M;return D(t,Dt,_=>r(59,$=_)),D(t,at,_=>r(56,d=_)),D(t,Xt,_=>r(58,g=_)),D(t,Zt,_=>r(60,b=_)),D(t,ie,_=>r(57,f=_)),D(t,gt,_=>r(31,v=_)),D(t,te,_=>r(24,h=_)),D(t,xe,_=>r(23,p=_)),t.$$set=_=>{"isActive"in _&&r(0,w=_.isActive),"isActiveFraction"in _&&r(1,S=_.isActiveFraction),"isVisible"in _&&r(2,P=_.isVisible),"stores"in _&&r(3,M=_.stores),"locale"in _&&r(4,E=_.locale),"stickers"in _&&r(5,C=_.stickers),"stickerForceEnable"in _&&r(44,z=_.stickerForceEnable),"stickerStickToImage"in _&&r(6,V=_.stickerStickToImage),"stickerEnableSelectImagePreset"in _&&r(45,L=_.stickerEnableSelectImagePreset),"stickerEnableDropImagePreset"in _&&r(7,y=_.stickerEnableDropImagePreset),"stickerEnableButtonFlipVertical"in _&&r(8,ct=_.stickerEnableButtonFlipVertical),"stickerWillRenderShapePresetToolbar"in _&&r(9,j=_.stickerWillRenderShapePresetToolbar),"stickerEnableSelectImage"in _&&r(46,k=_.stickerEnableSelectImage),"stickersEnableButtonFlipVertical"in _&&r(10,N=_.stickersEnableButtonFlipVertical),"stickersWillRenderShapePresetToolbar"in _&&r(11,nt=_.stickersWillRenderShapePresetToolbar),"markupEditorGridSize"in _&&r(47,ft=_.markupEditorGridSize),"markupEditorSnapThreshold"in _&&r(48,xt=_.markupEditorSnapThreshold),"markupEditorSnapToContext"in _&&r(49,H=_.markupEditorSnapToContext),"enableMultiSelect"in _&&r(12,Z=_.enableMultiSelect),"annotateGridSize"in _&&r(50,wt=_.annotateGridSize),"annotateSnapToContext"in _&&r(51,vt=_.annotateSnapToContext),"decorateGridSize"in _&&r(52,et=_.decorateGridSize),"decorateSnapToContext"in _&&r(53,Pt=_.decorateSnapToContext),"willRenderShapeControls"in _&&r(13,Et=_.willRenderShapeControls),"willRenderShapeTextControls"in _&&r(14,kt=_.willRenderShapeTextControls),"markupEditorToolSelectRadius"in _&&r(15,st=_.markupEditorToolSelectRadius),"willRenderShapePresetToolbar"in _&&r(16,Ut=_.willRenderShapePresetToolbar),"beforeAddShape"in _&&r(17,rt=_.beforeAddShape),"beforeRemoveShape"in _&&r(18,X=_.beforeRemoveShape),"beforeDeselectShape"in _&&r(19,q=_.beforeDeselectShape),"beforeSelectShape"in _&&r(20,Ft=_.beforeSelectShape),"beforeUpdateShape"in _&&r(21,zt=_.beforeUpdateShape),"markupEditorWillStartInteraction"in _&&r(22,yt=_.markupEditorWillStartInteraction)},t.$$.update=()=>{67108864&t.$$.dirty[1]&&r(54,n=f?f.scale:1),536870912&t.$$.dirty[1]&&r(55,i=b?b.rotation.z:0),49152&t.$$.dirty[1]&&r(30,o=L!==!1&&k),131072&t.$$.dirty[1]&&r(29,a=xt),64&t.$$.dirty[0]|2686976&t.$$.dirty[1]&&r(28,s=V?_e(wt)?wt:ft:_e(et)?et:ft),64&t.$$.dirty[0]|5505024&t.$$.dirty[1]&&r(27,l=V?sc(vt)?vt:H:sc(Pt)?Pt:H),25165888&t.$$.dirty[0]|528482304&t.$$.dirty[1]&&r(26,c=V?_=>D0(_,$,g,f.origin,f.translation,i,f.scale,h,p):_=>{const Kt=He(_);return Kt.x-=d.x,Kt.y-=d.y,Kt.x/=n,Kt.y/=n,Kt}),25165888&t.$$.dirty[0]|528482304&t.$$.dirty[1]&&r(25,u=V?_=>z0(_,$,g,f.origin,f.translation,i,f.scale,h,p):_=>{const Kt=He(_);return Kt.x*=n,Kt.y*=n,Kt.x+=d.x,Kt.y+=d.y,Kt})},[w,S,P,M,E,C,V,y,ct,j,N,nt,Z,Et,kt,st,Ut,rt,X,q,Ft,zt,yt,p,h,u,c,l,s,a,o,v,Dt,Wt,at,St,pt,Xt,Zt,ie,gt,te,xe,"sticker",z,L,k,ft,xt,H,wt,vt,et,Pt,n,i,d,f,g,$,b,function(_){Ji.call(this,t,_)}]}var y8={util:["sticker",class extends gr{constructor(t){super(),fr(this,t,$8,g8,cr,{name:43,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,stickers:5,stickerForceEnable:44,stickerStickToImage:6,stickerEnableSelectImagePreset:45,stickerEnableDropImagePreset:7,stickerEnableButtonFlipVertical:8,stickerWillRenderShapePresetToolbar:9,stickerEnableSelectImage:46,stickersEnableButtonFlipVertical:10,stickersWillRenderShapePresetToolbar:11,markupEditorGridSize:47,markupEditorSnapThreshold:48,markupEditorSnapToContext:49,enableMultiSelect:12,annotateGridSize:50,annotateSnapToContext:51,decorateGridSize:52,decorateSnapToContext:53,willRenderShapeControls:13,willRenderShapeTextControls:14,markupEditorToolSelectRadius:15,willRenderShapePresetToolbar:16,beforeAddShape:17,beforeRemoveShape:18,beforeDeselectShape:19,beforeSelectShape:20,beforeUpdateShape:21,markupEditorWillStartInteraction:22},null,[-1,-1])}get name(){return this.$$.ctx[43]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),A()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),A()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),A()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),A()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),A()}get stickers(){return this.$$.ctx[5]}set stickers(t){this.$$set({stickers:t}),A()}get stickerForceEnable(){return this.$$.ctx[44]}set stickerForceEnable(t){this.$$set({stickerForceEnable:t}),A()}get stickerStickToImage(){return this.$$.ctx[6]}set stickerStickToImage(t){this.$$set({stickerStickToImage:t}),A()}get stickerEnableSelectImagePreset(){return this.$$.ctx[45]}set stickerEnableSelectImagePreset(t){this.$$set({stickerEnableSelectImagePreset:t}),A()}get stickerEnableDropImagePreset(){return this.$$.ctx[7]}set stickerEnableDropImagePreset(t){this.$$set({stickerEnableDropImagePreset:t}),A()}get stickerEnableButtonFlipVertical(){return this.$$.ctx[8]}set stickerEnableButtonFlipVertical(t){this.$$set({stickerEnableButtonFlipVertical:t}),A()}get stickerWillRenderShapePresetToolbar(){return this.$$.ctx[9]}set stickerWillRenderShapePresetToolbar(t){this.$$set({stickerWillRenderShapePresetToolbar:t}),A()}get stickerEnableSelectImage(){return this.$$.ctx[46]}set stickerEnableSelectImage(t){this.$$set({stickerEnableSelectImage:t}),A()}get stickersEnableButtonFlipVertical(){return this.$$.ctx[10]}set stickersEnableButtonFlipVertical(t){this.$$set({stickersEnableButtonFlipVertical:t}),A()}get stickersWillRenderShapePresetToolbar(){return this.$$.ctx[11]}set stickersWillRenderShapePresetToolbar(t){this.$$set({stickersWillRenderShapePresetToolbar:t}),A()}get markupEditorGridSize(){return this.$$.ctx[47]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),A()}get markupEditorSnapThreshold(){return this.$$.ctx[48]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),A()}get markupEditorSnapToContext(){return this.$$.ctx[49]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),A()}get enableMultiSelect(){return this.$$.ctx[12]}set enableMultiSelect(t){this.$$set({enableMultiSelect:t}),A()}get annotateGridSize(){return this.$$.ctx[50]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),A()}get annotateSnapToContext(){return this.$$.ctx[51]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),A()}get decorateGridSize(){return this.$$.ctx[52]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),A()}get decorateSnapToContext(){return this.$$.ctx[53]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),A()}get willRenderShapeControls(){return this.$$.ctx[13]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),A()}get willRenderShapeTextControls(){return this.$$.ctx[14]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),A()}get markupEditorToolSelectRadius(){return this.$$.ctx[15]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),A()}get willRenderShapePresetToolbar(){return this.$$.ctx[16]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),A()}get beforeAddShape(){return this.$$.ctx[17]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),A()}get beforeRemoveShape(){return this.$$.ctx[18]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),A()}get beforeDeselectShape(){return this.$$.ctx[19]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),A()}get beforeSelectShape(){return this.$$.ctx[20]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),A()}get beforeUpdateShape(){return this.$$.ctx[21]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),A()}get markupEditorWillStartInteraction(){return this.$$.ctx[22]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),A()}},({stickers:t,stickerEnableSelectImage:e,stickerEnableSelectImagePreset:r,stickerEnableDropImagePreset:n,stickerForceEnable:i})=>t&&t.length||e||r||n||i]};function b8(t){let e,r,n=(t[14](t[36].value)||"")+"";return{c(){e=new f0(!1),r=Dn(),e.a=r},m(i,o){e.m(n,i,o),tt(i,r,o)},p(i,o){32&o[1]&&n!==(n=(i[14](i[36].value)||"")+"")&&e.p(n)},i:qe,o:qe,d(i){i&&J(r),i&&e.d()}}}function x8(t){let e,r;return e=new Qi({props:{items:t[16](t[36].value)}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};32&i[1]&&(o.items=n[16](n[36].value)),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function v8(t){let e,r,n,i,o,a,s,l,c=(Vr(t[36].label)?t[36].label(t[1]):t[36].label)+"";const u=[x8,b8],d=[];function p(h,f){return 32&f[1]&&(r=null),r==null&&(r=!!h[15](h[36].value)),r?0:1}return n=p(t,[-1,-1]),i=d[n]=u[n](t),{c(){e=mt("div"),i.c(),o=ue(),a=mt("span"),s=Mn(c),T(e,"slot","option")},m(h,f){tt(h,e,f),d[n].m(e,null),Lt(e,o),Lt(e,a),Lt(a,s),l=!0},p(h,f){let g=n;n=p(h,f),n===g?d[n].p(h,f):(Fe(),B(d[g],1,1,()=>{d[g]=null}),ze(),i=d[n],i?i.p(h,f):(i=d[n]=u[n](h),i.c()),I(i,1),i.m(e,o)),(!l||2&f[0]|32&f[1])&&c!==(c=(Vr(h[36].label)?h[36].label(h[1]):h[36].label)+"")&&Gn(s,c)},i(h){l||(I(i),l=!0)},o(h){B(i),l=!1},d(h){h&&J(e),d[n].d()}}}function w8(t){let e,r;return e=new ws({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[6],onchange:t[12],$$slots:{option:[v8,({option:n})=>({36:n}),({option:n})=>[0,n?32:0]]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};2&i[0]&&(o.locale=n[1]),4&i[0]&&(o.options=n[2]),64&i[0]&&(o.selectedIndex=n[6]),2&i[0]|96&i[1]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function S8(t){let e,r,n,i,o;return r=new gp({props:{locale:t[1],class:"PinturaControlPanels",shapeProps:t[4],onchange:t[13],controls:t[3],scrollElasticity:t[7]}}),i=new za({props:{elasticity:t[10],$$slots:{default:[w8]},$$scope:{ctx:t}}}),{c(){e=mt("div"),Ht(r.$$.fragment),n=ue(),Ht(i.$$.fragment),T(e,"slot","footer"),Mt(e,"transform",t[5])},m(a,s){tt(a,e,s),Vt(r,e,null),Lt(e,n),Vt(i,e,null),o=!0},p(a,s){const l={};2&s[0]&&(l.locale=a[1]),16&s[0]&&(l.shapeProps=a[4]),8&s[0]&&(l.controls=a[3]),128&s[0]&&(l.scrollElasticity=a[7]),r.$set(l);const c={};70&s[0]|64&s[1]&&(c.$$scope={dirty:s,ctx:a}),i.$set(c),32&s[0]&&Mt(e,"transform",a[5])},i(a){o||(I(r.$$.fragment,a),I(i.$$.fragment,a),o=!0)},o(a){B(r.$$.fragment,a),B(i.$$.fragment,a),o=!1},d(a){a&&J(e),Nt(r),Nt(i)}}}function k8(t){let e,r;return e=new Tl({props:{$$slots:{footer:[S8]},$$scope:{ctx:t}}}),e.$on("measure",t[25]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};254&i[0]|64&i[1]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function T8(t,e,r){let n,i,o,a,s,l,c,u,d=qe,p=()=>(d(),d=Hi(h,k=>r(22,s=k)),h);t.$$.on_destroy.push(()=>d());let{isActive:h}=e;p();let{stores:f}=e,{locale:g={}}=e,{frameStyles:$={}}=e,{frameOptions:b=[]}=e,{markupEditorShapeStyleControls:v}=e;const w=$n("elasticityMultiplier");D(t,w,k=>r(24,u=k));const{history:S,animation:P,scrollElasticity:M,imageFrame:E,allowPan:C,allowZoom:z,allowZoomControls:V,allowPlayPause:L}=f;D(t,P,k=>r(23,l=k)),D(t,E,k=>r(4,c=k));let y={},ct;const j=hr(l?20:0);return D(t,j,k=>r(21,a=k)),t.$$set=k=>{"isActive"in k&&p(r(0,h=k.isActive)),"stores"in k&&r(19,f=k.stores),"locale"in k&&r(1,g=k.locale),"frameStyles"in k&&r(20,$=k.frameStyles),"frameOptions"in k&&r(2,b=k.frameOptions),"markupEditorShapeStyleControls"in k&&r(3,v=k.markupEditorShapeStyleControls)},t.$$.update=()=>{4194304&t.$$.dirty[0]&&C.set(s),4194304&t.$$.dirty[0]&&z.set(s),4194304&t.$$.dirty[0]&&V.set(s),4194304&t.$$.dirty[0]&&s&&L.set(!0),16777216&t.$$.dirty[0]&&r(7,n=u*M),20&t.$$.dirty[0]&&r(6,i=c?b.findIndex(([k])=>k===c.id):0),12582912&t.$$.dirty[0]&&l&&j.set(s?0:20),2097152&t.$$.dirty[0]&&r(5,o=a?`translateY(${a}px)`:"none")},[h,g,b,v,c,o,i,n,w,P,M,E,({value:k})=>{const N=$[k];if(!N||!N.shape)return E.set(void 0),void S.write();const{shape:nt}=N,ft={id:k,...In(nt),...Object.keys(y).reduce((xt,H)=>(nt[H]&&(xt[H]=y[H]),xt),{})};E.set(ft),S.write()},function(k){Te(k,"frameColor")&&(y.frameColor=k.frameColor),c&&(Ia(c,k),E.set(c),clearTimeout(ct),ct=setTimeout(()=>{S.write()},200))},k=>{const N=$[k];var nt;if(N&&N.thumb)return nt=N.thumb,/div/i.test(nt)||Xb(nt)?nt:/rect|path|circle|line|<g>/i.test(nt)?`<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" stroke-width="1" stroke="currentColor" fill="none" aria-hidden="true" focusable="false" stroke-linecap="round" stroke-linejoin="round">${nt}</svg>`:`<img src="${nt}" alt=""/>`},k=>{const N=$[k];return!(!N||!N.thumb)&&En(N.thumb)},k=>$[k].thumb,j,"frame",f,$,a,s,l,u,function(k){Ji.call(this,t,k)}]}var C8={util:["frame",class extends gr{constructor(t){super(),fr(this,t,T8,k8,cr,{name:18,isActive:0,stores:19,locale:1,frameStyles:20,frameOptions:2,markupEditorShapeStyleControls:3},null,[-1,-1])}get name(){return this.$$.ctx[18]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),A()}get stores(){return this.$$.ctx[19]}set stores(t){this.$$set({stores:t}),A()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),A()}get frameStyles(){return this.$$.ctx[20]}set frameStyles(t){this.$$set({frameStyles:t}),A()}get frameOptions(){return this.$$.ctx[2]}set frameOptions(t){this.$$set({frameOptions:t}),A()}get markupEditorShapeStyleControls(){return this.$$.ctx[3]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),A()}},({src:t})=>t&&!Xs(t)]};function M8(t){let e,r,n,i,o,a,s,l;return{c(){e=mt("div"),r=mt("input"),i=ue(),o=mt("label"),a=Mn(t[1]),T(r,"id",t[0]),T(r,"type","number"),T(r,"min","1"),T(r,"inputmode","numeric"),T(r,"pattern","[0-9]*"),T(r,"data-state",t[3]),T(r,"autocomplete","off"),T(r,"placeholder",t[4]),r.value=n=t[5]===void 0?"":t[7](t[5]+""),T(o,"for",t[0]),T(o,"title",t[2]),T(o,"aria-label",t[2]),T(e,"class","PinturaInputDimension")},m(c,u){tt(c,e,u),Lt(e,r),Lt(e,i),Lt(e,o),Lt(o,a),s||(l=Tt(r,"input",t[8]),s=!0)},p(c,[u]){1&u&&T(r,"id",c[0]),8&u&&T(r,"data-state",c[3]),16&u&&T(r,"placeholder",c[4]),160&u&&n!==(n=c[5]===void 0?"":c[7](c[5]+""))&&r.value!==n&&(r.value=n),2&u&&Gn(a,c[1]),1&u&&T(o,"for",c[0]),4&u&&T(o,"title",c[2]),4&u&&T(o,"aria-label",c[2])},i:qe,o:qe,d(c){c&&J(e),s=!1,l()}}}function P8(t,e,r){let{id:n}=e,{label:i}=e,{title:o}=e,{state:a}=e,{placeholder:s}=e,{value:l}=e,{onchange:c}=e,{format:u=d=>d.replace(/\D/g,"")}=e;return t.$$set=d=>{"id"in d&&r(0,n=d.id),"label"in d&&r(1,i=d.label),"title"in d&&r(2,o=d.title),"state"in d&&r(3,a=d.state),"placeholder"in d&&r(4,s=d.placeholder),"value"in d&&r(5,l=d.value),"onchange"in d&&r(6,c=d.onchange),"format"in d&&r(7,u=d.format)},[n,i,o,a,s,l,c,u,d=>c(u(d.currentTarget.value))]}class Sy extends gr{constructor(e){super(),fr(this,e,P8,M8,cr,{id:0,label:1,title:2,state:3,placeholder:4,value:5,onchange:6,format:7})}}function R8(t){let e;return{c(){e=Li("g")},m(r,n){tt(r,e,n),e.innerHTML=t[2]},p(r,n){4&n&&(e.innerHTML=r[2])},d(r){r&&J(e)}}}function I8(t){let e,r,n,i,o,a,s,l;return o=new Ho({props:{$$slots:{default:[R8]},$$scope:{ctx:t}}}),{c(){e=mt("div"),r=mt("input"),n=ue(),i=mt("label"),Ht(o.$$.fragment),T(r,"id",t[0]),T(r,"class","implicit"),T(r,"type","checkbox"),r.checked=t[1],T(i,"for",t[0]),T(i,"title",t[3])},m(c,u){tt(c,e,u),Lt(e,r),Lt(e,n),Lt(e,i),Vt(o,i,null),a=!0,s||(l=Tt(r,"change",t[5]),s=!0)},p(c,[u]){(!a||1&u)&&T(r,"id",c[0]),(!a||2&u)&&(r.checked=c[1]);const d={};68&u&&(d.$$scope={dirty:u,ctx:c}),o.$set(d),(!a||1&u)&&T(i,"for",c[0]),(!a||8&u)&&T(i,"title",c[3])},i(c){a||(I(o.$$.fragment,c),a=!0)},o(c){B(o.$$.fragment,c),a=!1},d(c){c&&J(e),Nt(o),s=!1,l()}}}function E8(t,e,r){let{id:n}=e,{locked:i}=e,{icon:o}=e,{title:a}=e,{onchange:s}=e;return t.$$set=l=>{"id"in l&&r(0,n=l.id),"locked"in l&&r(1,i=l.locked),"icon"in l&&r(2,o=l.icon),"title"in l&&r(3,a=l.title),"onchange"in l&&r(4,s=l.onchange)},[n,i,o,a,s,l=>s(l.currentTarget.checked)]}class A8 extends gr{constructor(e){super(),fr(this,e,E8,I8,cr,{id:0,locked:1,icon:2,title:3,onchange:4})}}function L8(t){let e;return{c(){e=Mn("Save")},m(r,n){tt(r,e,n)},d(r){r&&J(e)}}}function F8(t){let e,r,n,i,o,a,s,l,c,u,d,p,h,f=t[1].resizeLabelFormCaption+"";return l=new Qi({props:{items:t[4]}}),u=new ks({props:{type:"submit",class:"implicit",$$slots:{default:[L8]},$$scope:{ctx:t}}}),{c(){e=mt("form"),r=mt("div"),n=mt("fieldset"),i=mt("legend"),o=Mn(f),a=ue(),s=mt("div"),Ht(l.$$.fragment),c=ue(),Ht(u.$$.fragment),T(i,"class","implicit"),T(s,"class","PinturaFieldsetInner"),T(r,"class","PinturaFormInner"),T(e,"slot","footer"),Mt(e,"transform",t[3])},m(g,$){tt(g,e,$),Lt(e,r),Lt(r,n),Lt(n,i),Lt(i,o),Lt(n,a),Lt(n,s),Vt(l,s,null),t[66](s),Lt(r,c),Vt(u,r,null),d=!0,p||(h=[Tt(s,"focusin",t[15]),Tt(s,"focusout",t[16]),Tt(e,"submit",Lv(t[17]))],p=!0)},p(g,$){(!d||2&$[0])&&f!==(f=g[1].resizeLabelFormCaption+"")&&Gn(o,f);const b={};16&$[0]&&(b.items=g[4]),l.$set(b);const v={};32&$[3]&&(v.$$scope={dirty:$,ctx:g}),u.$set(v),8&$[0]&&Mt(e,"transform",g[3])},i(g){d||(I(l.$$.fragment,g),I(u.$$.fragment,g),d=!0)},o(g){B(l.$$.fragment,g),B(u.$$.fragment,g),d=!1},d(g){g&&J(e),Nt(l),t[66](null),Nt(u),p=!1,Ur(h)}}}function z8(t){let e,r;return e=new Tl({props:{$$slots:{footer:[F8]},$$scope:{ctx:t}}}),e.$on("measure",t[67]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};30&i[0]|32&i[3]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function D8(t,e,r){let n,i,o,a,s,l,c,u,d,p,h,f,g,$,b,v,w,S,P,M,E,C,z,V,L,y,ct,j,k,N,nt=qe,ft=()=>(nt(),nt=Hi(H,ot=>r(50,h=ot)),H);t.$$.on_destroy.push(()=>nt());const xt=(ot,Yt=0,Ve=9999)=>{if(Ge(ot)&&!(ot=ot.replace(/\D/g,"")).length)return;const Se=Math.round(ot);return Number.isNaN(Se)?void 0:an(Se,Yt,Ve)};let{isActive:H}=e;ft();let{stores:Z}=e,{locale:wt={}}=e,{resizeMinSize:vt=An(1,1)}=e,{resizeMaxSize:et=An(9999,9999)}=e,{resizeAspectRatioLocked:Pt=!1}=e,{resizeEnableButtonLockAspectRatio:Et=!0}=e,{resizeSizePresetOptions:kt}=e,{resizeWidthPresetOptions:st}=e,{resizeHeightPresetOptions:Ut}=e,{resizeWillRenderFooter:rt=tn}=e,{resizeFormatIconButtonMaintainAspectRatio:X=function(ot){const{active:Yt,activeFraction:Ve}=ot;return{active:Yt,activeFraction:3*(Ve-1)}}}=e;const q=hr(0,{stiffness:.15,damping:.3});D(t,q,ot=>r(55,v=ot));const{animation:Ft,imageSize:zt,imageCropRect:yt,imageCropRectAspectRatio:Dt,imageCropAspectRatio:Wt,imageOutputSize:at,imageSelectionZoom:St,imageSelectionPan:pt,history:Xt,env:Zt,allowPan:ie,allowZoom:gt,allowZoomControls:te,allowPlayPause:xe}=Z;D(t,Ft,ot=>r(51,f=ot)),D(t,zt,ot=>r(74,j=ot)),D(t,yt,ot=>r(53,$=ot)),D(t,Dt,ot=>r(54,b=ot)),D(t,Wt,ot=>r(73,V=ot)),D(t,at,ot=>r(62,z=ot)),D(t,St,ot=>r(75,k=ot)),D(t,pt,ot=>r(76,N=ot)),D(t,Zt,ot=>r(52,g=ot));const _=ra();let Kt,qt,le,de,Oe,rr,Ct=dn();const pe=(ot,Yt,Ve,Se,ee)=>ot!=null&&Ve!==Yt?ot>=Se[Yt]&&ot<=ee[Yt]?"valid":"invalid":"undetermined",ar=(ot,Yt,Ve)=>Math.round(ot!=null?ot/Yt:Ve.height),Ke=()=>{Pt&&qt&&le&&(de==="width"?r(40,le=Math.round(qt/b)):de==="height"?r(39,qt=Math.round(le*b)):(Oe==="width"?r(40,le=Math.round(qt/b)):Oe==="height"&&r(39,qt=Math.round(le*b)),Qe()))},Qe=ot=>{let Yt=xt(qt),Ve=xt(le),Se=Yt,ee=Ve,Xe=Se&&ee,Be=ot||b;if(!Se&&!ee)return;Se&&!ee?ee=Math.round(Se/Be):ee&&!Se&&(Se=Math.round(ee*Be)),Be=ot||Xe?ca(Se,ee):b;let yr=An(Se,ee);Gd(et,yr)||(yr=Ki(et,Be)),Gd(yr,vt)||(yr=Zs(vt,Be)),r(39,qt=Yt!=null?Math.round(yr.width):void 0),r(40,le=Ve!=null?Math.round(yr.height):void 0)},Re=()=>{Qe();const{width:ot,height:Yt}=z||{};ot===qt&&Yt===le||(qt||le?(qt&&le&&It(Wt,V=qt/le,V),It(at,z=An(qt,le),z)):(It(Wt,V=j.width/j.height,V),It(Wt,V=void 0,V),It(at,z=void 0,z)),Xt.write())},Je=at.subscribe(ot=>{if(!ot)return r(39,qt=void 0),void r(40,le=void 0);r(39,qt=ot.width),r(40,le=ot.height),Qe()}),ur=Wt.subscribe(ot=>{(qt||le)&&ot&&(qt&&le&&ca(qt,le)!==ot?(r(40,le=qt/ot),Qe(ot)):Qe())}),$r=ot=>Ge(ot[0])?(ot[1]=ot[1].map($r),ot):_e(ot)?[ot,""+ot]:ot,zr=ot=>{if(Ge(ot[0]))return ot[1]=ot[1].map(zr),ot;let[Yt,Ve]=ot;if(_e(Yt)&&_e(Ve)){const[Se,ee]=[Yt,Ve];Ve=`${Se} &times; ${ee}`,Yt=[Se,ee]}return[Yt,Ve]},Dr=ge();D(t,Dr,ot=>r(61,C=ot));const dr=ge();D(t,dr,ot=>r(65,ct=ot));const Y=ge();D(t,Y,ot=>r(59,M=ot));const it=ge();D(t,it,ot=>r(64,y=ot));const G=ge();D(t,G,ot=>r(57,S=ot));const Bt=ge();D(t,Bt,ot=>r(63,L=ot));const ae=Hr([at,dr],([ot,Yt],Ve)=>{if(!Yt)return Ve(-1);const Se=Yt.findIndex(([ee])=>{if(!ee&&!ot)return!0;if(!ee)return!1;const[Xe,Be]=ee;return ot.width===Xe&&ot.height===Be});Ve(Se<0?0:Se)});D(t,ae,ot=>r(60,E=ot));const De=Hr([at,it],([ot,Yt],Ve)=>{if(!Yt)return Ve(-1);const Se=Yt.findIndex(([ee])=>!ee&&!ot||!!ee&&ot.width===ee);Ve(Se<0?0:Se)});D(t,De,ot=>r(58,P=ot));const we=Hr([at,Bt],([ot,Yt],Ve)=>{if(!Yt)return Ve(-1);const Se=Yt.findIndex(([ee])=>!ee&&!ot||!!ee&&ot.height===ee);Ve(Se<0?0:Se)});D(t,we,ot=>r(56,w=ot));let Ot,Ce;const nr=$n("redrawTrigger"),lr=hr(f?20:0);return D(t,lr,ot=>r(49,p=ot)),jo(()=>{Je(),ur()}),t.$$set=ot=>{"isActive"in ot&&ft(r(0,H=ot.isActive)),"stores"in ot&&r(30,Z=ot.stores),"locale"in ot&&r(1,wt=ot.locale),"resizeMinSize"in ot&&r(31,vt=ot.resizeMinSize),"resizeMaxSize"in ot&&r(32,et=ot.resizeMaxSize),"resizeAspectRatioLocked"in ot&&r(28,Pt=ot.resizeAspectRatioLocked),"resizeEnableButtonLockAspectRatio"in ot&&r(33,Et=ot.resizeEnableButtonLockAspectRatio),"resizeSizePresetOptions"in ot&&r(34,kt=ot.resizeSizePresetOptions),"resizeWidthPresetOptions"in ot&&r(35,st=ot.resizeWidthPresetOptions),"resizeHeightPresetOptions"in ot&&r(36,Ut=ot.resizeHeightPresetOptions),"resizeWillRenderFooter"in ot&&r(37,rt=ot.resizeWillRenderFooter),"resizeFormatIconButtonMaintainAspectRatio"in ot&&r(38,X=ot.resizeFormatIconButtonMaintainAspectRatio)},t.$$.update=()=>{524288&t.$$.dirty[1]&&ie.set(!h),524288&t.$$.dirty[1]&&gt.set(!h),524288&t.$$.dirty[1]&&te.set(!h),524288&t.$$.dirty[1]&&h&&xe.set(!0),1073741832&t.$$.dirty[1]&&kt&&(It(Dr,C=kt.map(zr),C),It(dr,ct=_s(C),ct)),1073741824&t.$$.dirty[1]&&r(48,a=!!C),536870912&t.$$.dirty[1]|8&t.$$.dirty[2]&&r(47,n=E>-1&&ct[E][1]),268435472&t.$$.dirty[1]&&st&&(It(Y,M=st.map($r),M),It(it,y=_s(M),y)),268566528&t.$$.dirty[1]&&r(45,s=!a&&M),134217728&t.$$.dirty[1]|4&t.$$.dirty[2]&&r(46,i=P>-1&&y[P][1]),67108896&t.$$.dirty[1]&&Ut&&(It(G,S=Ut.map($r),S),It(Bt,L=_s(S),L)),67239936&t.$$.dirty[1]&&r(44,l=!a&&S),33554432&t.$$.dirty[1]|2&t.$$.dirty[2]&&r(43,o=w>-1&&L[w][1]),155648&t.$$.dirty[1]&&r(42,c=!a&&!s&&!l),268435458&t.$$.dirty[0]|2145648583&t.$$.dirty[1]&&r(4,u=nr&&pu(()=>{return rt([a&&["Dropdown","size-presets",{label:n,options:C,onchange:Se=>{return(ee=Se.value)&&!Ot&&(Ot={...$},Ce=V),ee?(It(Wt,V=ca(ee[0],ee[1]),V),It(at,z=_y(ee),z)):(It(yt,$=Ot,$),It(Wt,V=Ce,V),It(at,z=void 0,z),Ot=void 0,Ce=void 0),void Xt.write();var ee},selectedIndex:E}],s&&["Dropdown","width-presets",{label:i,options:M,onchange:Se=>{r(39,qt=Se.value),Re()},selectedIndex:P}],s&&l&&["span","times",{class:"PinturaResizeLabel",innerHTML:"&times;"}],l&&["Dropdown","height-presets",{label:o,options:S,onchange:Se=>{r(40,le=Se.value),Re()},selectedIndex:w}],c&&[Sy,"width-input",{id:"width-"+_,title:wt.resizeTitleInputWidth,label:wt.resizeLabelInputWidth,placeholder:(ot=xt(le),Yt=b,Ve=$,Math.round(ot!=null?ot*Yt:Ve.width)),value:qt,state:pe(xt(qt),"width",de,vt,et),onchange:Se=>{r(39,qt=Se),Ke()}}],c&&Et&&[A8,"aspect-ratio-lock",{id:"aspect-ratio-lock-"+_,title:wt.resizeTitleButtonMaintainAspectRatio,icon:Vr(wt.resizeIconButtonMaintainAspectRatio)?wt.resizeIconButtonMaintainAspectRatio(Pt,v):Ws(wt.resizeIconButtonMaintainAspectRatio,X({active:Pt,activeFraction:v}),"{","}"),locked:Pt,onchange:Se=>{r(28,Pt=Se),Ke()}}],c&&[Sy,"height-input",{id:"height-"+_,title:wt.resizeTitleInputHeight,label:wt.resizeLabelInputHeight,placeholder:ar(xt(qt),b,$),value:le,state:pe(xt(le),"height",de,vt,et),onchange:Se=>{r(40,le=Se),Ke()}}]].filter(Boolean),{...g},()=>nr.set({}));var ot,Yt,Ve}).filter(Boolean)),268435456&t.$$.dirty[0]&&q.set(Pt?1:0),1024&t.$$.dirty[1]&&de&&(Oe=de),524288&t.$$.dirty[1]&&h&&(Ct=N,rr=k),524288&t.$$.dirty[1]|1&t.$$.dirty[2]&&(h?setTimeout(()=>{return ot=z,It(pt,N=dn(),N),void It(St,k=ot&&$?ot.width/$.width||ot.height/$.height:1,k);var ot},0):(It(pt,N=Ct,N),It(St,k=rr,k))),1572864&t.$$.dirty[1]&&f&&lr.set(h?0:20),262144&t.$$.dirty[1]&&r(3,d=p?`translateY(${p}px)`:"none")},[H,wt,Kt,d,u,q,Ft,zt,yt,Dt,Wt,at,St,pt,Zt,ot=>{const Yt=ot.target.id;/width/.test(Yt)?r(41,de="width"):/height/.test(Yt)?r(41,de="height"):/aspectRatio/i.test(Yt)?r(41,de="lock"):r(41,de=void 0)},ot=>{Kt.contains(ot.relatedTarget)||Re(),r(41,de=void 0)},Re,Dr,dr,Y,it,G,Bt,ae,De,we,lr,Pt,"resize",Z,vt,et,Et,kt,st,Ut,rt,X,qt,le,de,c,o,l,s,i,n,a,p,h,f,g,$,b,v,w,S,P,M,E,C,z,L,y,ct,function(ot){jr[ot?"unshift":"push"](()=>{Kt=ot,r(2,Kt)})},function(ot){Ji.call(this,t,ot)}]}var B8={util:["resize",class extends gr{constructor(t){super(),fr(this,t,D8,z8,cr,{name:29,isActive:0,stores:30,locale:1,resizeMinSize:31,resizeMaxSize:32,resizeAspectRatioLocked:28,resizeEnableButtonLockAspectRatio:33,resizeSizePresetOptions:34,resizeWidthPresetOptions:35,resizeHeightPresetOptions:36,resizeWillRenderFooter:37,resizeFormatIconButtonMaintainAspectRatio:38},null,[-1,-1,-1,-1])}get name(){return this.$$.ctx[29]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),A()}get stores(){return this.$$.ctx[30]}set stores(t){this.$$set({stores:t}),A()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),A()}get resizeMinSize(){return this.$$.ctx[31]}set resizeMinSize(t){this.$$set({resizeMinSize:t}),A()}get resizeMaxSize(){return this.$$.ctx[32]}set resizeMaxSize(t){this.$$set({resizeMaxSize:t}),A()}get resizeAspectRatioLocked(){return this.$$.ctx[28]}set resizeAspectRatioLocked(t){this.$$set({resizeAspectRatioLocked:t}),A()}get resizeEnableButtonLockAspectRatio(){return this.$$.ctx[33]}set resizeEnableButtonLockAspectRatio(t){this.$$set({resizeEnableButtonLockAspectRatio:t}),A()}get resizeSizePresetOptions(){return this.$$.ctx[34]}set resizeSizePresetOptions(t){this.$$set({resizeSizePresetOptions:t}),A()}get resizeWidthPresetOptions(){return this.$$.ctx[35]}set resizeWidthPresetOptions(t){this.$$set({resizeWidthPresetOptions:t}),A()}get resizeHeightPresetOptions(){return this.$$.ctx[36]}set resizeHeightPresetOptions(t){this.$$set({resizeHeightPresetOptions:t}),A()}get resizeWillRenderFooter(){return this.$$.ctx[37]}set resizeWillRenderFooter(t){this.$$set({resizeWillRenderFooter:t}),A()}get resizeFormatIconButtonMaintainAspectRatio(){return this.$$.ctx[38]}set resizeFormatIconButtonMaintainAspectRatio(t){this.$$set({resizeFormatIconButtonMaintainAspectRatio:t}),A()}}]};function O8(t){let e,r;return e=new $p({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[10],mapImagePointToScreenPoint:t[9],enableMultiSelect:t[6],utilKey:"redact",imageRotation:t[11],imageFlipX:t[8],imageFlipY:t[7],shapes:t[12],toolbar:["rect"],toolShapes:{rectangle:[{x:0,y:0,width:0,height:0}]},toolActive:"rectangle",parentRect:t[14],enablePresetDropImage:!1,enablePresetSelectImage:!1,willStartInteraction:t[5],hooks:{willRenderShapeControls:t[26]}}}),e.$on("measure",t[27]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,[i]){const o={};8&i&&(o.stores=n[3]),16&i&&(o.locale=n[4]),1&i&&(o.isActive=n[0]),2&i&&(o.isActiveFraction=n[1]),4&i&&(o.isVisible=n[2]),1024&i&&(o.mapScreenPointToImagePoint=n[10]),512&i&&(o.mapImagePointToScreenPoint=n[9]),64&i&&(o.enableMultiSelect=n[6]),2048&i&&(o.imageRotation=n[11]),256&i&&(o.imageFlipX=n[8]),128&i&&(o.imageFlipY=n[7]),32&i&&(o.willStartInteraction=n[5]),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function W8(t,e,r){let n,i,o,a,s,l,c,u,d,p,{isActive:h}=e,{isActiveFraction:f}=e,{isVisible:g}=e,{stores:$}=e,{locale:b={}}=e,{markupEditorWillStartInteraction:v}=e,{enableMultiSelect:w}=e;const{imageRedaction:S,rootRect:P,imageSize:M,imageRotation:E,imageFlipX:C,imageFlipY:z,imageTransforms:V,imageTransformsInterpolated:L}=$;return D(t,P,y=>r(24,u=y)),D(t,M,y=>r(23,c=y)),D(t,E,y=>r(11,p=y)),D(t,C,y=>r(8,s=y)),D(t,z,y=>r(7,a=y)),D(t,V,y=>r(25,d=y)),D(t,L,y=>r(22,l=y)),t.$$set=y=>{"isActive"in y&&r(0,h=y.isActive),"isActiveFraction"in y&&r(1,f=y.isActiveFraction),"isVisible"in y&&r(2,g=y.isVisible),"stores"in y&&r(3,$=y.stores),"locale"in y&&r(4,b=y.locale),"markupEditorWillStartInteraction"in y&&r(5,v=y.markupEditorWillStartInteraction),"enableMultiSelect"in y&&r(6,w=y.enableMultiSelect)},t.$$.update=()=>{33554432&t.$$.dirty&&r(21,n=d?d.rotation.z:0),31457664&t.$$.dirty&&r(10,i=y=>D0(y,u,c,l.origin,l.translation,n,l.scale,s,a)),31457664&t.$$.dirty&&r(9,o=y=>z0(y,u,c,l.origin,l.translation,n,l.scale,s,a))},[h,f,g,$,b,v,w,a,s,o,i,p,S,P,M,E,C,z,V,L,"redact",n,l,c,u,d,y=>{const ct=H1(y[0]);return uw("to-front",ct),y},function(y){Ji.call(this,t,y)}]}var _8={util:["redact",class extends gr{constructor(t){super(),fr(this,t,W8,O8,cr,{name:20,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,markupEditorWillStartInteraction:5,enableMultiSelect:6})}get name(){return this.$$.ctx[20]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),A()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),A()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),A()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),A()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),A()}get markupEditorWillStartInteraction(){return this.$$.ctx[5]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),A()}get enableMultiSelect(){return this.$$.ctx[6]}set enableMultiSelect(t){this.$$set({enableMultiSelect:t}),A()}},({src:t})=>t&&!Xs(t)]};function V8(t){let e;return{c(){e=mt("div")},m(r,n){tt(r,e,n)},p:qe,d(r){r&&J(e)}}}function N8(t){let e,r,n,i;return{c(){e=mt("div"),T(e,"class","PinturaFillTile")},m(o,a){tt(o,e,a),n||(i=Tr(r=X8.call(null,e,t[31].value)),n=!0)},p(o,a){r&&kr(r.update)&&1&a[1]&&r.update.call(null,o[31].value)},d(o){o&&J(e),n=!1,i()}}}function H8(t){let e,r,n;return{c(){e=mt("div"),r=mt("img"),Rf(r.src,n=t[31].value)||T(r,"src",n),T(r,"alt",""),T(r,"width","48"),T(r,"height","64"),T(e,"class","PinturaFillTile")},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){1&o[1]&&!Rf(r.src,n=i[31].value)&&T(r,"src",n)},d(i){i&&J(e)}}}function ky(t){let e,r,n=(Vr(t[31].label)?t[31].label(t[1]):t[31].label)+"";return{c(){e=mt("span"),r=Mn(n)},m(i,o){tt(i,e,o),Lt(e,r)},p(i,o){2&o[0]|1&o[1]&&n!==(n=(Vr(i[31].label)?i[31].label(i[1]):i[31].label)+"")&&Gn(r,n)},d(i){i&&J(e)}}}function j8(t){let e,r,n,i;function o(c,u){return 1&u[1]&&(r=null),1&u[1]&&(n=null),r==null&&(r=!!Ge(c[31].value)),r?H8:(n==null&&(n=!!En(c[31].value)),n?N8:V8)}let a=o(t,[-1,-1]),s=a(t),l=t[31].label&&ky(t);return{c(){e=mt("div"),s.c(),i=ue(),l&&l.c(),T(e,"slot","option")},m(c,u){tt(c,e,u),s.m(e,null),Lt(e,i),l&&l.m(e,null)},p(c,u){a===(a=o(c,u))&&s?s.p(c,u):(s.d(1),s=a(c),s&&(s.c(),s.m(e,i))),c[31].label?l?l.p(c,u):(l=ky(c),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(c){c&&J(e),s.d(),l&&l.d()}}}function U8(t){let e,r;return e=new ws({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[4],onchange:t[10],$$slots:{option:[j8,({option:n})=>({31:n}),({option:n})=>[0,n?1:0]]},$$scope:{ctx:t}}}),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};2&i[0]&&(o.locale=n[1]),4&i[0]&&(o.options=n[2]),16&i[0]&&(o.selectedIndex=n[4]),2&i[0]|3&i[1]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function G8(t){let e,r,n;return r=new za({props:{elasticity:t[5],$$slots:{default:[U8]},$$scope:{ctx:t}}}),{c(){e=mt("div"),Ht(r.$$.fragment),T(e,"slot","footer"),Mt(e,"transform",t[3])},m(i,o){tt(i,e,o),Vt(r,e,null),n=!0},p(i,o){const a={};32&o[0]&&(a.elasticity=i[5]),22&o[0]|2&o[1]&&(a.$$scope={dirty:o,ctx:i}),r.$set(a),8&o[0]&&Mt(e,"transform",i[3])},i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&J(e),Nt(r)}}}function Z8(t){let e,r;return e=new Tl({props:{$$slots:{footer:[G8]},$$scope:{ctx:t}}}),e.$on("measure",t[21]),{c(){Ht(e.$$.fragment)},m(n,i){Vt(e,n,i),r=!0},p(n,i){const o={};62&i[0]|2&i[1]&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){Nt(e,n)}}}function X8(t){const e=document.createElement("div");return t.append(e),{update(r){const[n,i,o,a]=r.map((s,l)=>l<3?Math.round(255*s):s);t.dataset.transparent=a<1,e.style.backgroundColor=`rgba(${n},${i},${o},${a})`}}}function Y8(t,e,r){let n,i,o,a,s,l,c,u,d,p,h=qe,f=()=>(h(),h=Hi(g,k=>r(16,l=k)),g);t.$$.on_destroy.push(()=>h());let{isActive:g}=e;f();let{stores:$}=e,{locale:b={}}=e,{fillOptions:v=[]}=e;const w=k=>k.map(N=>(nt=>En(nt)&&Ge(nt[0])&&En(nt[1]))(N)?[N[0],w(N[1]),N[2]]:(nt=>[Array.isArray(nt)&&nt.length===3?[...nt,1]:nt,void 0,{disabled:!1}])(N)),S=$n("elasticityMultiplier");D(t,S,k=>r(20,p=k));const{history:P,animation:M,scrollElasticity:E,imageBackgroundColor:C,imageBackgroundImage:z,allowPan:V,allowZoom:L,allowZoomControls:y,allowPlayPause:ct}=$;D(t,M,k=>r(17,c=k)),D(t,C,k=>r(19,d=k)),D(t,z,k=>r(18,u=k));const j=hr(c?20:0);return D(t,j,k=>r(15,s=k)),t.$$set=k=>{"isActive"in k&&f(r(0,g=k.isActive)),"stores"in k&&r(13,$=k.stores),"locale"in k&&r(1,b=k.locale),"fillOptions"in k&&r(14,v=k.fillOptions)},t.$$.update=()=>{16384&t.$$.dirty[0]&&r(2,n=w(v)),65536&t.$$.dirty[0]&&V.set(l),65536&t.$$.dirty[0]&&L.set(l),65536&t.$$.dirty[0]&&y.set(l),65536&t.$$.dirty[0]&&l&&ct.set(!0),1048576&t.$$.dirty[0]&&r(5,i=p*E),786436&t.$$.dirty[0]&&r(4,o=n.findIndex(([k])=>u?k===u:Array.isArray(k)?ys(k,d):void 0)||0),196608&t.$$.dirty[0]&&c&&j.set(l?0:20),32768&t.$$.dirty[0]&&r(3,a=s?`translateY(${s}px)`:"none")},[g,b,n,a,o,i,S,M,C,z,({value:k})=>{Ge(k)&&(It(C,d=void 0,d),It(z,u=k,u)),En(k)&&(It(C,d=k,d),It(z,u=void 0,u)),P.write()},j,"fill",$,v,s,l,c,u,d,p,function(k){Ji.call(this,t,k)}]}var q8={util:["fill",class extends gr{constructor(t){super(),fr(this,t,Y8,Z8,cr,{name:12,isActive:0,stores:13,locale:1,fillOptions:14},null,[-1,-1])}get name(){return this.$$.ctx[12]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),A()}get stores(){return this.$$.ctx[13]}set stores(t){this.$$set({stores:t}),A()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),A()}get fillOptions(){return this.$$.ctx[14]}set fillOptions(t){this.$$set({fillOptions:t}),A()}},({src:t,fillOptions:e})=>t&&!Xs(t)&&e&&e.length]};const Ty='<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"></path></path></g>',y1='<path fill="none" d="M9 15 L12 9 L15 15 M10 13.5 h3" stroke="currentColor" stroke-width=".125em"/>';var K8={labelReset:"Reset",labelDefault:"Default",labelAuto:"Auto",labelNone:"None",labelEdit:"Edit",labelClose:"Close",labelSupportError:"{features} not supported on this browser",labelColor:"Color",labelWidth:"Width",labelSize:"Size",labelOffset:"Offset",labelAmount:"Amount",labelInset:"Inset",labelRadius:"Radius",labelColorPalette:"Color palette",labelSizeExtraSmall:"Extra small",labelSizeSmall:"Small",labelSizeMediumSmall:"Medium small",labelSizeMedium:"Medium",labelSizeMediumLarge:"Medium large",labelSizeLarge:"Large",labelSizeExtraLarge:"Extra large",labelButtonCancel:"Cancel",labelButtonUndo:"Undo",labelButtonRedo:"Redo",labelButtonRevert:"Revert",labelButtonExport:"Done",labelZoom:"Zoom",labelZoomIn:"Zoom in",labelZoomOut:"Zoom out",labelZoomFit:"Fit to view",labelZoomActual:"Actual size",iconZoomIn:'<path stroke="currentColor" stroke-width=".125em" d="M8 12 h8 M12 8 v8" />',iconZoomOut:'<path stroke="currentColor" stroke-width=".125em" d="M9 12 h6" />',iconSupportError:'<g fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><g><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></g>',iconButtonClose:Ty,iconButtonRevert:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M7.388 18.538a8 8 0 10-2.992-9.03"/><path fill="currentColor" d="M2.794 11.696L2.37 6.714l5.088 3.18z"/><path d="M12 8v4M12 12l4 2"/></g>',iconButtonUndo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M10 8h4c2.485 0 5 2 5 5s-2.515 5-5 5h-4"/><path fill="currentColor" d="M5 8l4-3v6z"/></g>',iconButtonRedo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M14 8h-4c-2.485 0-5 2-5 5s2.515 5 5 5h4"/><path fill="currentColor" d="M19 8l-4-3v6z"/></g>',iconButtonExport:'<polyline points="20 6 9 17 4 12" fill="none" stroke="currentColor" stroke-width=".125em"></polyline>',statusLabelButtonClose:"Close",statusIconButtonClose:Ty,statusImageLoadNone:"Waiting for image",statusImageLoadMinSize:"Minimum image size is {minWidth} &times; {minHeight}",statusImageLoadPrepare:"Preparing image&hellip;",statusImageLoadBusy:"Loading image&hellip;",statusImageLoadError:"Error loading image",statusImageProcessBusy:"Processing image&hellip;",statusImageProcessError:"Error processing image",statusImageUploadBusy:"Uploading image&hellip;",statusImageUploadError:"Error uploading image"};const J8={shapeLabelButtonSelectSticker:"Select image",shapeIconButtonSelectSticker:'<g fill="none" stroke="currentColor" stroke-width="0.0625em"><path d="M8 21 L15 11 L19 15"/><path d="M15 2 v5 h5"/><path d="M8 2 h8 l4 4 v12 q0 4 -4 4 h-8 q-4 0 -4 -4 v-12 q0 -4 4 -4z"/></g><circle fill="currentColor" cx="10" cy="8" r="1.5"/>',shapeIconButtonFlipHorizontal:'<g stroke="currentColor" stroke-width=".125em"><path fill="none" d="M6 6.5h5v11H6z"/><path fill="currentColor" d="M15 6.5h3v11h-3z"/><path d="M11 4v16" fill="currentColor"/></g>',shapeIconButtonFlipVertical:'<g stroke="currentColor" stroke-width=".125em"><rect x="7" y="8" width="11" height="5" fill="none"/><rect x="7" y="17" width="11" height="2" fill="currentColor"/><line x1="5" y1="13" x2="20" y2="13"/></g>',shapeIconButtonRemove:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M7.5 7h9z"/><path d="M7.916 9h8.168a1 1 0 01.99 1.14l-.972 6.862a2 2 0 01-1.473 1.653c-.877.23-1.753.345-2.629.345-.876 0-1.752-.115-2.628-.345a2 2 0 01-1.473-1.653l-.973-6.862A1 1 0 017.916 9z" fill="currentColor"/><rect fill="currentColor" x="10" y="5" width="4" height="3" rx="1"/></g>',shapeIconButtonDuplicate:'<g fill="none" fill-rule="evenodd"><path d="M15 13.994V16a2 2 0 01-2 2H8a2 2 0 01-2-2v-5a2 2 0 012-2h2.142" stroke="currentColor" stroke-width=".125em"/><path d="M15 9V8a1 1 0 00-2 0v1h-1a1 1 0 000 2h1v1a1 1 0 002 0v-1h1a1 1 0 000-2h-1zm-4-4h6a2 2 0 012 2v6a2 2 0 01-2 2h-6a2 2 0 01-2-2V7a2 2 0 012-2z" fill="currentColor"/></g>',shapeIconButtonMoveToFront:'<g fill="none" fill-rule="evenodd"><rect fill="currentColor" x="11" y="13" width="8" height="2" rx="1"/><rect fill="currentColor" x="9" y="17" width="10" height="2" rx="1"/><path d="M11.364 8H10a5 5 0 000 10M12 6.5L14.5 8 12 9.5z" stroke="currentColor" stroke-width=".125em" stroke-linecap="round"/></g>',shapeIconButtonTextLayoutAutoWidth:""+y1,shapeIconButtonTextLayoutAutoHeight:'<g fill="currentColor"><circle cx="4" cy="12" r="1.5"/><circle cx="20" cy="12" r="1.5"/></g>'+y1,shapeIconButtonTextLayoutFixedSize:'<g fill="currentColor"><circle cx="5" cy="6" r="1.5"/><circle cx="19" cy="6" r="1.5"/><circle cx="19" cy="19" r="1.5"/><circle cx="5" cy="19" r="1.5"/></g>'+y1,shapeTitleButtonTextLayoutAutoWidth:"Auto width",shapeTitleButtonTextLayoutAutoHeight:"Auto height",shapeTitleButtonTextLayoutFixedSize:"Fixed size",shapeTitleButtonFlipHorizontal:"Flip Horizontal",shapeTitleButtonFlipVertical:"Flip Vertical",shapeTitleButtonRemove:"Remove",shapeTitleButtonDuplicate:"Duplicate",shapeTitleButtonMoveToFront:"Move to front",shapeLabelInputText:"Edit text",shapeIconInputCancel:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"/></g>',shapeIconInputConfirm:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><polyline points="20 6 9 17 4 12"/></g>',shapeLabelInputCancel:"Cancel",shapeLabelInputConfirm:"Confirm",shapeLabelStrokeNone:"No outline",shapeLabelFontStyleNormal:"Normal",shapeLabelFontStyleBold:"Bold",shapeLabelFontStyleItalic:"Italic",shapeLabelFontStyleItalicBold:"Bold Italic",shapeTitleBackgroundColor:"Fill color",shapeTitleCornerRadius:"Corner radius",shapeTitleFontFamily:"Font",shapeTitleFontSize:"Font size",shapeTitleFontStyle:"Font style",shapeTitleLineHeight:"Line height",shapeTitleLineStart:"Start",shapeTitleLineEnd:"End",shapeTitleStrokeWidth:"Line width",shapeTitleStrokeColor:"Line color",shapeTitleLineDecorationBar:"Bar",shapeTitleLineDecorationCircle:"Circle",shapeTitleLineDecorationSquare:"Square",shapeTitleLineDecorationArrow:"Arrow",shapeTitleLineDecorationCircleSolid:"Circle solid",shapeTitleLineDecorationSquareSolid:"Square solid",shapeTitleLineDecorationArrowSolid:"Arrow solid",shapeIconLineDecorationBar:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M16,8 V16"/></g>',shapeIconLineDecorationCircle:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="none" stroke-width=".125em" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquare:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="none" stroke-width=".125em" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrow:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16 M13,7 l6,5 l-6,5" fill="none"/></g>',shapeIconLineDecorationCircleSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="currentColor" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquareSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="currentColor" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrowSolid:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M13,7 l6,5 l-6,5z" fill="currentColor"/></g>',shapeTitleColorTransparent:"Transparent",shapeTitleColorWhite:"White",shapeTitleColorSilver:"Silver",shapeTitleColorGray:"Gray",shapeTitleColorBlack:"Black",shapeTitleColorNavy:"Navy",shapeTitleColorBlue:"Blue",shapeTitleColorAqua:"Aqua",shapeTitleColorTeal:"Teal",shapeTitleColorOlive:"Olive",shapeTitleColorGreen:"Green",shapeTitleColorYellow:"Yellow",shapeTitleColorOrange:"Orange",shapeTitleColorRed:"Red",shapeTitleColorMaroon:"Maroon",shapeTitleColorFuchsia:"Fuchsia",shapeTitleColorPurple:"Purple",shapeTitleTextOutline:"Text outline",shapeTitleTextOutlineWidth:"Width",shapeTitleTextShadow:"Text shadow",shapeTitleTextShadowBlur:"Blur",shapeTitleTextColor:"Font color",shapeTitleTextAlign:"Text align",shapeTitleTextAlignLeft:"Left align text",shapeTitleTextAlignCenter:"Center align text",shapeTitleTextAlignRight:"Right align text",shapeIconTextAlignLeft:'<g stroke-width=".125em" stroke="currentColor"><line x1="5" y1="8" x2="15" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="5" y1="16" x2="14" y2="16"/></g>',shapeIconTextAlignCenter:'<g stroke-width=".125em" stroke="currentColor"><line x1="7" y1="8" x2="17" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="8" y1="16" x2="16" y2="16"/></g>',shapeIconTextAlignRight:'<g stroke-width=".125em" stroke="currentColor"><line x1="9" y1="8" x2="19" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="11" y1="16" x2="19" y2="16"/></g>',shapeLabelToolMove:"Move",shapeLabelToolView:"View",shapeLabelToolSharpie:"Sharpie",shapeLabelToolEraser:"Eraser",shapeLabelToolPath:"Path",shapeLabelToolRectangle:"Rectangle",shapeLabelToolEllipse:"Ellipse",shapeLabelToolArrow:"Arrow",shapeLabelToolLine:"Line",shapeLabelToolText:"Text",shapeLabelToolPreset:"Stickers",shapeIconToolView:'<g stroke-width=".125em" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10.98 9.703V2.567c0-1.19 1.19-1.785 1.784-1.785.595 0 1.784.595 1.784 1.785v3.568"/><path d="M14.548 9.703V4.35c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.594 1.784 1.784v2.973"/><path d="M18.116 10.244V7.271c0-1.19 1.19-1.784 1.784-1.784.595 0 1.785.595 1.785 1.784 0 1.19 0 8.92-1.19 12.488-1.19 3.569-10.704 4.758-13.678 0-2.973-4.757-2.973-4.757-4.163-6.541-1.189-1.784-1.153-2.974-.594-3.568.558-.595 1.784-1.19 2.973.594 1.277 1.916 2.07 2.907 2.379 2.974V5.487c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.595 1.784 1.784V8.46"/></g>',shapeIconToolMove:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M6 2 L6 19 L18 13 Z M13 18 L16 24" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSharpie:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolEraser:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" fill="none"><g transform="translate(3, 15) rotate(-45)"><rect x="0" y="0" width="18" height="10" rx="3"/></g><line x1="11" y1="21" x2="18" y2="21"/><line x1="20" y1="21" x2="22" y2="21"/></g>',shapeIconToolPath:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="21" cy="3" r="2"/><circle cx="9" cy="9" r="2"/><circle cx="3" cy="21" r="2"/><path d="M19 4 11 8 M8 11 4 19"/></g>',shapeIconToolRectangle:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="1" y="1" width="22" height="22" rx="4"/></g>',shapeIconToolEllipse:'<g stroke-width=".125em" stroke="currentColor" fill="none"><circle cx="12" cy="12" r="11"/></g>',shapeIconToolArrow:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/><path d="m10 6 L21.5 1 L20 13.5" fill="currentColor" stroke="none"/></g>',shapeIconToolLine:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/></g>',shapeIconToolText:'<g stroke="none" fill="currentColor" transform="translate(6,0)"><path d="M8.14 20.085c.459 0 .901-.034 1.329-.102a8.597 8.597 0 001.015-.21v1.984c-.281.135-.695.247-1.242.336a9.328 9.328 0 01-1.477.133c-3.312 0-4.968-1.745-4.968-5.235V6.804H.344v-1.25l2.453-1.078L3.89.819h1.5v3.97h4.97v2.015H5.39v10.078c0 1.031.245 1.823.735 2.375s1.161.828 2.015.828z"/>',shapeIconToolPreset:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"></path><path d="M20 17c-3 3-5 5-8 5"></path></g>',shapeTitleSelectionMode:"Selection mode",shapeTitleBrushSize:"Brush size",shapeLabelSelectionModeNew:"New",shapeLabelSelectionModeAdd:"Add",shapeLabelSelectionModeSubtract:"Remove",shapeLabelToolSelectionBrush:"Brush",shapeLabelToolSelectionLassoo:"Lassoo",shapeLabelToolSelectionRectangle:"Rectangle marquee",shapeLabelToolSelectionEllipse:"Ellipse marquee",shapeIconSelectionModeNew:'<g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 17H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1.5"/><rect width="12" height="12" x="9" y="9" fill="currentColor" fill-opacity=".25" rx="2"/></g>',shapeIconSelectionModeAdd:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><path d="M13 15h4M15 13v4"/></g>',shapeIconSelectionModeSubtract:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h-6a2 2 0 0 0-1.995 1.85L9 11v6H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><rect width="12" height="12" x="9" y="9" stroke-linecap="round" stroke-linejoin="round" rx="2"/><path d="M13 15h4"/></g>',shapeIconToolSelectionBrush:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSelectionLassoo:'<g fill="none" fill-rule="evenodd" stroke-width=".125em" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M11.428 17.702a18.46 18.46 0 0 0 4.085-1.595c5.851-3.112 9.019-8.599 7.074-12.256-1.945-3.657-8.265-4.1-14.116-.988C2.619 5.974-.55 11.46 1.396 15.118c.63 1.186 1.72 2.033 3.105 2.532"/><ellipse cx="8" cy="18.5" rx="3.5" ry="2.833" transform="rotate(-15 8 18.5)"/><path stroke-linecap="round" d="M5 18c3.347 1.048 5.514 1.881 6.5 2.5.859.54 1.517.994 1.5 2.364"/></g>',shapeIconToolSelectionRectangle:'<g stroke-width=".125em" stroke="currentColor"><path d="M9 1 h6 m4 0 h4v4 m0 4 v6 m0 4 v4h-4 m-4 0 h-6 m-4 0 h-4v-4 m0 -4 v-6 m0 -4 v-4h4" fill="none" /></g>',shapeIconToolSelectionEllipse:'<path stroke-width=".125em" stroke="currentColor" d="M1.21 9.853a11.054 11.054 0 0 0 0 4.294m1.643 3.965a11.054 11.054 0 0 0 3.035 3.035m3.965 1.644a11.054 11.054 0 0 0 4.294 0m3.965-1.644a11.054 11.054 0 0 0 3.035-3.035m1.644-3.965a11.054 11.054 0 0 0 0-4.294m-1.644-3.965a11.054 11.054 0 0 0-3.035-3.035m-3.965-1.644a11.054 11.054 0 0 0-4.294 0M5.888 2.853a11.054 11.054 0 0 0-3.035 3.035"/>'};var Q8={cropLabel:"Crop",cropIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M23 17H9a2 2 0 0 1-2-2v-5m0-3V1 M1 7h14a2 2 0 0 1 2 2v7m0 4v3"/></g>',cropIconButtonRecenter:'<path stroke="currentColor" fill="none" stroke-width="2" stroke-linejoin="bevel" d="M1.5 7.5v-6h6M1.5 16.5v6h6M22.5 16.5v6h-6M22.5 7.5v-6h-6"/><circle cx="12" cy="12" r="3.5" fill="currentColor" stroke="none"/>',cropIconButtonRotateLeft:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><rect x="3" rx="1" height="12" width="12" y="9"/><path d="M15 5h-1a5 5 0 015 5 1 1 0 002 0 7 7 0 00-7-7h-1.374l.747-.747A1 1 0 0011.958.84L9.603 3.194a1 1 0 000 1.415l2.355 2.355a1 1 0 001.415-1.414l-.55-.55H15z"/></g>',cropIconButtonRotateRight:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><path d="M11.177 5H10a5 5 0 00-5 5 1 1 0 01-2 0 7 7 0 017-7h1.374l-.747-.747A1 1 0 0112.042.84l2.355 2.355a1 1 0 010 1.415l-2.355 2.354a1 1 0 01-1.415-1.414l.55-.55z"/><rect rx="1" height="12" width="12" y="9" x="9"/></g>',cropIconButtonFlipVertical:'<g stroke="none" fill="currentColor"><path d="M19.993 12.143H7a1 1 0 0 1-1-1V5.994a1 1 0 0 1 1.368-.93l12.993 5.15a1 1 0 0 1-.368 1.93z"/><path d="M19.993 14a1 1 0 0 1 .368 1.93L7.368 21.078A1 1 0 0 1 6 20.148V15a1 1 0 0 1 1-1h12.993z" opacity=".6"/></g>',cropIconButtonFlipHorizontal:'<g stroke="none" fill="currentColor"><path d="M11.93 7.007V20a1 1 0 0 1-1 1H5.78a1 1 0 0 1-.93-1.368l5.15-12.993a1 1 0 0 1 1.929.368z"/><path d="M14 7.007V20a1 1 0 0 0 1 1h5.149a1 1 0 0 0 .93-1.368l-5.15-12.993A1 1 0 0 0 14 7.007z" opacity=".6"/></g>',cropIconSelectPreset:`<g fill="currentColor">
        <rect opacity="{a}" x="2" y="4" width="10" height="18" rx="1"/>
        <rect opacity="{b}" x="4" y="8" width="14" height="14" rx="1"/>
        <rect opacity="{c}" x="6" y="12" width="17" height="10" rx="1"/>
    </g>`,cropIconCropBoundary:`<g fill="currentColor">
        <rect opacity="{a}" x="2" y="3" width="20" height="20" rx="1"/>
        <rect opacity="{b}" x="7" y="8" width="10" height="10" rx="1"/>
        <rect opacity="{c}" x="4" y="8" width="14" height="14" rx="1"/>
        <rect opacity="{d}" x="12" y="4" width="10" height="10" rx="1"/>
    </g>`,cropLabelButtonRecenter:"Recenter",cropLabelButtonRotateLeft:"Rotate left",cropLabelButtonRotateRight:"Rotate right",cropLabelButtonFlipHorizontal:"Flip horizontal",cropLabelButtonFlipVertical:"Flip vertical",cropLabelSelectPreset:"Crop shape",cropLabelCropBoundary:"Crop boundary",cropLabelCropBoundaryEdge:"Edge of image",cropLabelCropBoundaryNone:"None",cropLabelTabRotation:"Rotation",cropLabelTabZoom:"Scale"},tk={fillLabel:"Fill",fillIcon:`
    <g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
        <g transform="rotate(60, 12, 12)">
            <rect x="4" y="4" width="14" height="16" rx="3"/>
        </g>
        <path d="M21 13 L21 21"></path>
        <path d="M4.5 12.5 L19 12.5"></path>
    </g>
    `},ek={resizeLabel:"Resize",resizeIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="2" y="12" width="10" height="10" rx="2"/><path d="M4 11.5V4a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5"/><path d="M14 10l3.365-3.365M14 6h4v4"/></g>',resizeLabelFormCaption:"Image output size",resizeLabelInputWidth:"w",resizeTitleInputWidth:"Width",resizeLabelInputHeight:"h",resizeTitleInputHeight:"Height",resizeTitleButtonMaintainAspectRatio:"Maintain aspect ratio",resizeIconButtonMaintainAspectRatio:'<defs><mask id="mask1" x="-2" y="-2" width="24" height="24"><rect x="0" y="0" width="24" height="10" fill="#fff" stroke="none"/></mask></defs><g fill="none" fill-rule="evenodd"><g mask="url(#mask1)"><path transform="translate(0 {activeFraction})" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" d="M9.401 10.205v-.804a2.599 2.599 0 0 1 5.198 0V17"/></g><rect fill="currentColor" x="7" y="10" width="10" height="7" rx="1.5"/></g>'},rk={frameLabel:"Frame",frameIcon:`<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
            <rect x="2" y="2" width="20" height="20" rx="4"/>
            <rect x="6" y="6" width="12" height="12" rx="1"/>
        </g>`,frameLabelMatSharp:"Mat",frameLabelMatRound:"Bevel",frameLabelLineSingle:"Line",frameLabelLineMultiple:"Zebra",frameLabelEdgeSeparate:"Inset",frameLabelEdgeOverlap:"Plus",frameLabelEdgeCross:"Lumber",frameLabelCornerHooks:"Hook",frameLabelPolaroid:"Polaroid"},nk={redactLabel:"Redact",redactIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M 4 5 l 1 -1"/><path d="M 4 10 l 6 -6"/><path d="M 4 15 l 11 -11"/><path d="M 4 20 l 16 -16"/><path d="M 9 20 l 11 -11"/><path d="M 14 20 l 6 -6"/><path d="M 19 20 l 1 -1"/></g>'},op=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t);Object.keys(r).forEach(n=>{r[n].get?Object.defineProperty(e,n,{get:()=>t[n],set:i=>t[n]=i}):e[n]=t[n]})},B0=t=>{const e={},{sub:r,pub:n}=Ka();ni()&&document.doctype!==null||console.warn("Browser is in quirks mode, add <!DOCTYPE html> to page to fix render issues");const i=j2();op(i,e);const o=((c,u)=>{const d={},p=new Map,h=new S$({target:c,props:{stores:u,pluginComponents:Array.from(N1)}});let f=!1;const g=()=>{f||(ni()&&window.removeEventListener("pagehide",g),h&&(f=!0,h.$destroy()))};function $(v,w){return p.get(v)===w||(p.set(v,w),!1)}h1||(h1=new Set(T0(S$).filter(v=>!ow.includes(v)))),h1.forEach(v=>{Object.defineProperty(d,v,{get:()=>h[v],set:aw.includes(v)?w=>{$(v,w)||(h[v]={...h[v],...w})}:w=>{$(v,w)||(h[v]=w)}})}),Object.defineProperty(d,"previewImageData",{get:()=>h.imagePreviewCurrent}),Pb.forEach(v=>{const w=Hd[v],S=w[0];Object.defineProperty(d,v,{get:()=>h.pluginInterface[S][v],set:P=>{if($(v,P))return;const M=w.reduce((E,C)=>(E[C]={...h.pluginOptions[C],[v]:P},E),{});h.pluginOptions={...h.pluginOptions,...M}}})}),Object.defineProperty(d,"element",{get:()=>h.root,set:()=>{}});const b=h.history;return uu(d,{on:(v,w)=>{if(f)return()=>{};if(/undo|redo|revert|writehistory/.test(v))return b.on(v,w);const S=[h.sub(v,w),h.$on(v,P=>w(P instanceof CustomEvent&&!P.detail?void 0:P))].filter(Boolean);return()=>S.forEach(P=>P())},updateImagePreview:v=>{h.imagePreviewSrc=v},close:()=>!f&&h.pub("close"),destroy:g}),Object.defineProperty(d,"history",{get:()=>({undo:()=>b.undo(),redo:()=>b.redo(),revert:()=>b.revert(),get:()=>b.get(),getCollapsed:()=>b.get().splice(0,b.index+1),set:v=>b.set(v),write:v=>b.write(v),get length(){return b.length()},get index(){return b.index},set index(v){b.index=v}})}),ni()&&window.addEventListener("pagehide",g),d})(t,i.stores);op(o,e);const a=["loadImage","processImage","abortProcessImage","abortLoadImage"].map(c=>o.on(c,u=>{const d=i[c](u&&u.detail);d instanceof Promise&&d.catch(se)})),s=(c,u)=>{const d=r(c,u),p=i.on(c,u),h=o.on(c,u);return()=>{d(),p(),h()}};e.handleEvent=se;const l=Ib.map(c=>s(c,u=>e.handleEvent(c,u)));return uu(e,{on:s,updateImage:c=>new Promise((u,d)=>{const p=e.history.get(),h=e.history.index,f=e.imageState;i.loadImage(c).then(g=>{e.history.set(p),e.history.index=h,e.imageState=f,u(g)}).catch(d)}),close:()=>{n("close")},destroy:()=>{[...a,...l].forEach(c=>c()),o.destroy(),i.destroy(),n("destroy")}}),setTimeout(()=>n("init",e),0),e};ni();var qb=(t,e={})=>{const r=Ge(t)?document.querySelector(t):t;if(!nc(r))return;e.class=e.class?"pintura-editor "+e.class:"pintura-editor";const n=B0(r);return Object.assign(n,e)};const{document:Ld,window:jd}=m0;function ik(t){let e,r,n,i,o;return wl(t[32]),{c(){e=ue(),r=ue(),n=mt("div"),T(n,"class",t[4]),T(n,"aria-modal","true"),T(n,"aria-label","Pintura"),T(n,"role","dialog"),T(n,"tabindex","-1"),Mt(n,"--editor-modal",1),Mt(n,"--viewport-pad-footer",t[5]),Mt(n,"opacity",t[7]),Mt(n,"height",t[14]?t[6]:void 0)},m(a,s){tt(a,e,s),tt(a,r,s),tt(a,n,s),t[33](n),i||(o=[Tt(jd,"keydown",t[13]),Tt(jd,"orientationchange",t[16]),Tt(jd,"resize",t[32]),Tt(Ld,"readystatechange",t[15]),Tt(Ld.body,"focusin",function(){kr(!t[1]&&t[10])&&(!t[1]&&t[10]).apply(this,arguments)}),Tt(Ld.body,"focusout",function(){kr(t[2]&&t[11])&&(t[2]&&t[11]).apply(this,arguments)}),Tt(Ld.body,"keydown",t[9]),Tt(n,"wheel",t[12],{passive:!1})],i=!0)},p(a,s){t=a,16&s[0]&&T(n,"class",t[4]),32&s[0]&&Mt(n,"--viewport-pad-footer",t[5]),128&s[0]&&Mt(n,"opacity",t[7]),64&s[0]&&Mt(n,"height",t[14]?t[6]:void 0)},i:qe,o:qe,d(a){a&&J(e),a&&J(r),a&&J(n),t[33](null),i=!1,Ur(o)}}}function ok(t,e,r){let n,i,o,a,s,l,c,u,d;const p=ba();let{root:h}=e,{preventZoomViewport:f=!0}=e,{preventScrollBodyIfNeeded:g=!0}=e,{preventFooterOverlapIfNeeded:$=!0}=e,{preventModalAutoFocus:b=!1}=e,{class:v}=e,w=!0,S=!1,P=!1,M=ni()&&document.documentElement,E=ni()&&document.body,C=ni()&&document.head;const z=hr(0,{precision:.001,damping:.5});D(t,z,st=>r(31,d=st));const V=z.subscribe(st=>{P&&st>=1?(r(25,P=!1),r(1,w=!1),p("show")):S&&st<=0&&(r(24,S=!1),r(1,w=!0),p("hide"))});let L=!1,y,ct,j;const k=()=>document.querySelector("meta[name=viewport]"),N=()=>Array.from(document.querySelectorAll("meta[name=theme-color]")),nt=st=>st.type==="radio"?Array.from(h.querySelectorAll(`input[name="${st.name}"]`)):[st];let ft;const xt=(st,Ut)=>{const rt=()=>{st()?Ut():requestAnimationFrame(rt)};requestAnimationFrame(rt)};let H,Z=0;const wt=!!ni()&&!CSS.supports("height:100dvh");let vt,et;const Pt=()=>{vt||(vt=yn("div",{style:"position:fixed;height:100vh;top:0"}),E.append(vt))};xs(()=>{b||h.focus(),$&&Vo()&&(Pt(),Sb()&&visualViewport.scale>1&&(r(0,h.style.left=visualViewport.offsetLeft+"px",h),r(0,h.style.top=visualViewport.offsetTop+"px",h)))}),A2(()=>{vt&&(r(27,et=vt.offsetHeight),vt.remove(),vt=void 0)});let Et;const kt=()=>M.style.setProperty("--pintura-document-height",window.innerHeight+"px");return jo(()=>{M.classList.remove("PinturaModalBodyLock"),V()}),t.$$set=st=>{"root"in st&&r(0,h=st.root),"preventZoomViewport"in st&&r(17,f=st.preventZoomViewport),"preventScrollBodyIfNeeded"in st&&r(18,g=st.preventScrollBodyIfNeeded),"preventFooterOverlapIfNeeded"in st&&r(19,$=st.preventFooterOverlapIfNeeded),"preventModalAutoFocus"in st&&r(20,b=st.preventModalAutoFocus),"class"in st&&r(21,v=st.class)},t.$$.update=()=>{50331650&t.$$.dirty[0]|1&t.$$.dirty[1]&&r(30,n=P||S?d:w?0:1),131072&t.$$.dirty[0]&&(i="width=device-width,height=device-height,initial-scale=1"+(f?",maximum-scale=1,user-scalable=0":"")),50331650&t.$$.dirty[0]&&r(28,o=!P&&!w&&!S),12&t.$$.dirty[0]&&(L||r(26,H=Z)),1073741824&t.$$.dirty[0]&&r(7,a=n),67108864&t.$$.dirty[0]&&r(6,s=H+"px"),134217736&t.$$.dirty[0]&&r(5,l=_e(et)?"--viewport-pad-footer:"+(et>Z?0:1):void 0),2097152&t.$$.dirty[0]&&r(4,c=br(["pintura-editor","PinturaModal",v])),268435456&t.$$.dirty[0]&&(st=>{st?M.classList.add("PinturaDocumentStyles"):M.classList.remove("PinturaDocumentStyles")})(o),262144&t.$$.dirty[0]&&r(29,u=g&&Vo()&&/15_/.test(navigator.userAgent)),805306368&t.$$.dirty[0]&&u&&(st=>{st?(Et=window.scrollY,M.classList.add("PinturaDocumentLock"),kt(),window.addEventListener("resize",kt)):(window.removeEventListener("resize",kt),M.classList.remove("PinturaDocumentLock"),_e(Et)&&window.scrollTo(0,Et),Et=void 0)})(o)},[h,w,L,Z,c,l,s,a,z,st=>{if(st.key!=="Tab")return;const Ut=document.activeElement,rt=h.querySelectorAll('button:not([disabled]),textarea:not([disabled]),input:not([disabled]),select:not([disabled]),[tabindex="0"]'),X=nt(rt[0]),q=nt(rt[rt.length-1]);let Ft;st.shiftKey&&X.includes(Ut)?Ft=q[0]:!st.shiftKey&&q.includes(Ut)&&(Ft=X[0]),Ft&&(Ft.focus(),st.preventDefault())},st=>{Ja(st.target)&&(r(2,L=!0),ft=Z)},st=>{if(Ja(st.target))if(clearTimeout(void 0),ft===Z)r(2,L=!1);else{const Ut=Z;xt(()=>Z!==Ut,()=>r(2,L=!1))}},st=>{st.target&&/PinturaStage/.test(st.target.className)&&st.preventDefault()},st=>{const{key:Ut}=st;if(!/escape/i.test(Ut))return;const rt=st.target;if(rt&&/input|textarea/i.test(rt.nodeName))return;const X=document.querySelectorAll(".PinturaModal");X[X.length-1]===h&&p("close")},wt,function(){r(3,Z=window.innerHeight)},Pt,f,g,$,b,v,()=>{if(P||!w)return;r(25,P=!0);const st=k()||yn("meta",{name:"viewport"});y=!y&&st.getAttribute("content"),st.setAttribute("content",i+(/cover/.test(y)?",viewport-fit=cover":"")),st.parentNode||C.append(st);const Ut=getComputedStyle(h).getPropertyValue("--color-background"),rt=N();if(rt.length)ct=rt.map(X=>X.getAttribute("content"));else{const X=yn("meta",{name:"theme-color"});C.append(X),rt.push(X)}rt.forEach(X=>X.setAttribute("content",`rgb(${Ut})`)),clearTimeout(j),j=setTimeout(()=>z.set(1),250)},()=>{if(S||w)return;clearTimeout(j),r(24,S=!0);const st=k();y?st.setAttribute("content",y):st.remove();const Ut=N();ct?Ut.forEach((rt,X)=>{rt.setAttribute("content",ct[X])}):Ut.forEach(rt=>rt.remove()),z.set(0)},S,P,H,et,o,u,n,d,function(){r(3,Z=jd.innerHeight)},function(st){jr[st?"unshift":"push"](()=>{h=st,r(0,h)})}]}class ak extends gr{constructor(e){super(),fr(this,e,ok,ik,cr,{root:0,preventZoomViewport:17,preventScrollBodyIfNeeded:18,preventFooterOverlapIfNeeded:19,preventModalAutoFocus:20,class:21,show:22,hide:23},null,[-1,-1])}get root(){return this.$$.ctx[0]}set root(e){this.$$set({root:e}),A()}get preventZoomViewport(){return this.$$.ctx[17]}set preventZoomViewport(e){this.$$set({preventZoomViewport:e}),A()}get preventScrollBodyIfNeeded(){return this.$$.ctx[18]}set preventScrollBodyIfNeeded(e){this.$$set({preventScrollBodyIfNeeded:e}),A()}get preventFooterOverlapIfNeeded(){return this.$$.ctx[19]}set preventFooterOverlapIfNeeded(e){this.$$set({preventFooterOverlapIfNeeded:e}),A()}get preventModalAutoFocus(){return this.$$.ctx[20]}set preventModalAutoFocus(e){this.$$set({preventModalAutoFocus:e}),A()}get class(){return this.$$.ctx[21]}set class(e){this.$$set({class:e}),A()}get show(){return this.$$.ctx[22]}get hide(){return this.$$.ctx[23]}}const Cy=(t,e,r,n=5,i)=>{const o=lt(e.x-t.x,e.y-t.y),a=yo(o),s=n*r;let l;l=i?.5*s:Math.ceil(.5*(s-1));const c=ji(He(a),l);return{anchor:He(t),offset:c,normal:a,solid:i,size:s,sizeHalf:l}},sk=(t,e,r)=>{const{strokeWidth:n,strokeColor:i,strokeJoin:o,strokeCap:a,...s}=t,{anchor:l,offset:c,normal:u,solid:d,size:p,sizeHalf:h}=e,f=l.x,g=l.y,$=ji(He(u),p),b=lt(f+$.x,g+$.y);if(ji($,.55),d&&!t.bitmap){jn(r,c);const P=ji(He(u),.5*h);return[{...s,points:[lt(f-P.x,g-P.y),lt(b.x-$.y,b.y+$.x),lt(b.x+$.y,b.y-$.x)],pathClose:!0,backgroundColor:i}]}const v=ji((P=>{const M=P.x;return P.x=-P.y,P.y=M,P})(He(u)),.5),w=lt(f-v.x,g-v.y),S=lt(f+v.x,g+v.y);return[{...s,points:[lt(b.x+$.y,b.y-$.x),w,lt(f,g),S,lt(b.x-$.y,b.y+$.x)],backgroundColor:d?i:void 0,pathClose:d,strokeWidth:n,strokeColor:i,strokeJoin:o,strokeCap:a}]},lk=(t,e,r)=>{const{strokeWidth:n,strokeColor:i,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:u}=e;return jn(r,l),s&&jn(r,Kl(He(c))),[{...o,x:a.x,y:a.y,rx:u,ry:u,backgroundColor:s?i:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:i}]},ck=(t,e)=>{const{strokeWidth:r,strokeColor:n,strokeJoin:i,strokeCap:o,...a}=t,{anchor:s,offset:l}=e;return[{...a,points:[lt(s.x-l.y,s.y+l.x),lt(s.x+l.y,s.y-l.x)],strokeWidth:r,strokeColor:n,strokeJoin:i,strokeCap:o}]},uk=(t,e,r)=>{const{strokeWidth:n,strokeColor:i,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:u}=e;return jn(r,l),[{...o,x:a.x-u,y:a.y-u,width:2*u,height:2*u,rotation:(d=c,Math.atan2(d.y,d.x)),backgroundColor:s?i:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:i}];var d},dk=(t={})=>e=>{if(!e.lineStart&&!e.lineEnd)return;const r=[],{x1:n,y1:i,x2:o,y2:a,lineStart:s,lineEnd:l,strokeWidth:c,strokeColor:u,strokeJoin:d,strokeCap:p,strokeDash:h,lineStartScalar:f,lineEndScalar:g,bitmap:$,aboveFrame:b,opacity:v}=e,w=lt(n,i),S=lt(o,a),P=[w,S],M={bitmap:$,aboveFrame:b,opacity:v,strokeColor:u,strokeWidth:c,strokeJoin:d,strokeCap:p,lineStartScalar:f,lineEndScalar:g};if(s){const[E,C]=s.split("-"),z=t[E];if(z){const V=Cy(w,S,c,f||g,!!C);r.push(...z(M,V,w))}}if(l){const[E,C]=l.split("-"),z=t[E];if(z){const V=Cy(S,w,c,g,!!C);r.push(...z(M,V,S))}}return[{...M,strokeDash:h,points:P},...r]},pk=()=>({arrow:sk,circle:lk,square:uk,bar:ck}),G1=(t,e)=>{const r=parseFloat(t)*e;return Ge(t)?r+"%":r},ha=(t,e)=>Ge(t)?Jd(t,e):t,hk=t=>[{...t,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:t.frameSize?G1(t.frameSize,2):"2.5%",frameRadius:t.frameRound?G1(t.frameSize,2):0}],mk=({width:t,height:e,frameImage:r,frameSize:n="15%",frameOutset:i=0,frameSlices:o={x1:.15,y1:.15,x2:.85,y2:.85}},{isPreview:a})=>{if(!r)return[];const s=Math.sqrt(t*e),l=ha(n,s),c=a?l:Math.round(l),u=c,d=ha(i,s),p=2*d,{x1:h,x2:f,y1:g,y2:$}=o,b={x0:0,y0:0,x1:c,y1:u,x2:t-c,y2:e-u,cw:c,ch:u,ew:t-c-c,eh:e-u-u},v=a?1:0,w=2*v,S=d>0,P={expandsCanvas:S,width:b.cw,height:b.ch,backgroundImage:r};return[{expandsCanvas:S,x:b.x1-v-d,y:b.y0-d,width:b.ew+w+p,height:b.ch,backgroundCorners:[{x:h,y:0},{x:f,y:0},{x:f,y:g},{x:h,y:g}],backgroundImage:r},{expandsCanvas:S,x:b.x1-v-d,y:b.y2+d,width:b.ew+w+p,height:b.ch,backgroundCorners:[{x:h,y:$},{x:f,y:$},{x:f,y:1},{x:h,y:1}],backgroundImage:r},{expandsCanvas:S,x:b.x0-d,y:b.y1-v-d,width:b.cw,height:b.eh+w+p,backgroundCorners:[{x:0,y:g},{x:h,y:g},{x:h,y:$},{x:0,y:$}],backgroundImage:r},{expandsCanvas:S,x:b.x2+d,y:b.y1-v-d,width:b.cw,height:b.eh+w+p,backgroundCorners:[{x:f,y:g},{x:1,y:g},{x:1,y:$},{x:f,y:$}],backgroundImage:r},{...P,x:b.x0-d,y:b.y0-d,backgroundCorners:[{x:0,y:0},{x:h,y:0},{x:h,y:g},{x:0,y:g}]},{...P,x:b.x2+d,y:b.y0-d,backgroundCorners:[{x:f,y:0},{x:1,y:0},{x:1,y:g},{x:f,y:g}]},{...P,x:b.x2+d,y:b.y2+d,backgroundCorners:[{x:f,y:$},{x:1,y:$},{x:1,y:1},{x:f,y:1}]},{...P,x:b.x0-d,y:b.y2+d,backgroundCorners:[{x:0,y:$},{x:h,y:$},{x:h,y:1},{x:0,y:1}]}]},fk=({x:t,y:e,width:r,height:n,frameInset:i="3.5%",frameSize:o=".25%",frameColor:a=[1,1,1],frameOffset:s="5%",frameAmount:l=1,frameRadius:c=0,expandsCanvas:u=!1},{isPreview:d})=>{const p=Math.sqrt(r*n);let h=ha(o,p);const f=ha(i,p),g=ha(s,p);let $=0;d||(h=Math.max(1,Math.round(h)),$=h%2==0?0:.5);const b=ha(G1(c,l),p);return new Array(l).fill(void 0).map((v,w)=>{const S=g*w;let P=t+f+S,M=e+f+S,E=t+r-f-S,C=e+n-f-S;return d||(P=Math.round(P),M=Math.round(M),E=Math.round(E),C=Math.round(C)),{x:P+$,y:M+$,width:E-P,height:C-M,cornerRadius:b>0?b-S:0,strokeWidth:h,strokeColor:a,expandsCanvas:u}})},gk=({x:t,y:e,width:r,height:n,frameSize:i=".25%",frameOffset:o=0,frameInset:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(r*n);let u=ha(i,c),d=ha(a,c),p=ha(o,c),h=0;l||(u=Math.max(1,Math.round(u)),d=Math.round(d),p=Math.round(p),h=u%2==0?0:.5);const f=p-d,g=t+d+h,$=e+d+h,b=t+r-d-h,v=e+n-d-h;return[{points:[lt(g+f,$),lt(b-f,$)]},{points:[lt(b,$+f),lt(b,v-f)]},{points:[lt(b-f,v),lt(g+f,v)]},{points:[lt(g,v-f),lt(g,$+f)]}].map(w=>(w.strokeWidth=u,w.strokeColor=s,w))},$k=({x:t,y:e,width:r,height:n,frameSize:i=".25%",frameInset:o="2.5%",frameLength:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(r*n);let u=ha(i,c),d=ha(o,c),p=ha(a,c),h=0;l||(u=Math.max(1,Math.round(u)),d=Math.round(d),p=Math.round(p),h=u%2==0?0:.5);const f=t+d+h,g=e+d+h,$=t+r-d-h,b=e+n-d-h;return[{points:[lt(f,g+p),lt(f,g),lt(f+p,g)]},{points:[lt($-p,g),lt($,g),lt($,g+p)]},{points:[lt($,b-p),lt($,b),lt($-p,b)]},{points:[lt(f+p,b),lt(f,b),lt(f,b-p)]}].map(v=>(v.strokeWidth=u,v.strokeColor=s,v))},yk=({x:t,y:e,width:r,height:n,frameColor:i=[1,1,1]},{isPreview:o})=>{const a=Math.sqrt(r*n),s=.1*a;let l=.2*a,c=0;const u=.5*s;return o?c=1:l=Math.ceil(l),i.length=3,[{id:"border",x:t-u+c,y:e-u+c,width:r+s-2*c,height:n+l-2*c,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:s,frameColor:i,expandsCanvas:!0},{id:"chin",x:t-u,y:n-c,width:r+s,height:l,backgroundColor:i,expandsCanvas:!0}].filter(Boolean)},bk=(t={})=>(e,r)=>{if(!Te(e,"frameStyle"))return;const n=e.frameStyle,i=t[n];if(!i)return;const{frameStyle:o,...a}=e;return i(a,r)},xk=()=>({solid:hk,hook:$k,line:fk,edge:gk,polaroid:yk,nine:mk}),vk=t=>{const e=(r,n={isPreview:!0})=>{const i=t.map(o=>{const a=o(r,n);if(a)return a.map(s=>e(s,n))}).filter(Boolean).flat();return i.length?i.flat().map((o,a)=>(o.id=r.id+"_"+a,o)):r};return e};typeof window<"u"&&(t=>{if(!t)return;const[e,r,n,i]=[[108,111,99,97,116,105,111,110],[82,101,103,69,120,112],[116,101,115,116],[112,113,105,110,97,92,46,110,108]].map(o=>o.map(a=>String.fromCharCode(a)).join(""));t._zb8to4f=new t[r](i)[n](t[e])})(window);const wk=nb,My=b0,nT=(t,...e)=>(r,n)=>{var i;i=t,(Array.isArray(i)||Vr(i))&&(e=[t,...e]);const o=bs(t)?t:{};o.testSrcSupport=!0,e=Array.isArray(e)?e.reduce((a,s)=>[...a,...Array.isArray(s)?[...s]:[s]],[]):e;for(let a=0;a<e.length;a++){const s=e[a](r,n,o);if(Array.isArray(s))return s}},Sk=()=>({read:async(t,e)=>{const r=await Bx(t,{exif:[274]},[0,262144],e);return r&&r.exif&&r.exif[274]||1},apply:Ay}),kk=(t={})=>{const{blurAmount:e,dataSizeScalar:r,scrambleAmount:n,backgroundColor:i}=t;return(o,a)=>(async(s,l={})=>{if(!s)return;const{width:c,height:u,colorSpace:d="srgb"}=s,{dataSize:p=96,dataSizeScalar:h=1,scrambleAmount:f=4,blurAmount:g=6,outputFormat:$="canvas",backgroundColor:b=[0,0,0]}=l,v=Math.round(p*h),w=Math.min(v/c,v/u),S=Math.floor(c*w),P=Math.floor(u*w),M=yn("canvas",{width:S,height:P}),E=M.getContext("2d",{willReadFrequently:!0,colorSpace:d});if(b.length=3,E.fillStyle=Ai(b),E.fillRect(0,0,S,P),rc(s)){const L=yn("canvas",{width:c,height:u});L.getContext("2d",{willReadFrequently:!0,colorSpace:d}).putImageData(s,0,0),E.drawImage(L,0,0,S,P),ti(L)}else E.drawImage(s,0,0,S,P);const C=E.getImageData(0,0,S,P),z=[];if(f>0&&z.push([C5,{amount:f}]),g>0)for(let L=0;L<g;L++)z.push([i2,{matrix:M5}]);let V;if(z.length){const L=(j,k)=>`(err, imageData) => {
(${j[k][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${k}]), 
${j[k+1]?L(j,k+1):"done"})
}`,y=`function (options, done) {
const filterInstructions = options.filterInstructions;
const imageData = options.imageData;
(${L(z,0)})(null, imageData)
}`,ct=await mu(y,[{imageData:C,filterInstructions:z.map(j=>j[1])}],[C.data.buffer]);V=i0(ct)}else V=C;return $==="canvas"?(E.putImageData(V,0,0),M):V})(o,{blurAmount:e,scrambleAmount:n,backgroundColor:i,...a,dataSizeScalar:r||a.dataSizeScalar})},Tk=Fb,Ck=Nb,Mk={markupEditorToolbar:Yw(),markupEditorToolStyles:Fb(),markupEditorShapeStyleControls:Nb()},iT=Rb,Pk=e6,Rk=s6,Ik=m6,Ek=p8,Ak=f8,Lk=y8,Fk=C8,zk=_8,Dk=B8,Bk=q8,Ok=zw,Wk=kw,_k=Uw,Vk=K8,Nk=J8,Hk=Q8,jk=tk,Uk={filterLabel:"Filter",filterIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M18.347 9.907a6.5 6.5 0 1 0-1.872 3.306M3.26 11.574a6.5 6.5 0 1 0 2.815-1.417 M10.15 17.897A6.503 6.503 0 0 0 16.5 23a6.5 6.5 0 1 0-6.183-8.51"/></g>',filterLabelChrome:"Chrome",filterLabelFade:"Fade",filterLabelCold:"Cold",filterLabelWarm:"Warm",filterLabelPastel:"Pastel",filterLabelMonoDefault:"Mono",filterLabelMonoNoir:"Noir",filterLabelMonoWash:"Wash",filterLabelMonoStark:"Stark",filterLabelSepiaDefault:"Sepia",filterLabelSepiaBlues:"Blues",filterLabelSepiaRust:"Rust",filterLabelSepiaColor:"Color"},Gk={finetuneLabel:"Finetune",finetuneIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M4 1v5.5m0 3.503V23M12 1v10.5m0 3.5v8M20 1v15.5m0 3.5v3M2 7h4M10 12h4M18 17h4"/></g>',finetuneLabelBrightness:"Brightness",finetuneLabelContrast:"Contrast",finetuneLabelSaturation:"Saturation",finetuneLabelExposure:"Exposure",finetuneLabelTemperature:"Temperature",finetuneLabelGamma:"Gamma",finetuneLabelClarity:"Clarity",finetuneLabelVignette:"Vignette"},Zk=ek,Xk={decorateLabel:"Decorate",decorateIcon:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width=".125em" stroke-linecap="round" stroke-linejoin="round" d="M12 18.5l-6.466 3.4 1.235-7.2-5.23-5.1 7.228-1.05L12 2l3.233 6.55 7.229 1.05-5.231 5.1 1.235 7.2z"/></g>'},Yk={annotateLabel:"Annotate",annotateIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M17.086 2.914a2.828 2.828 0 1 1 4 4l-14.5 14.5-5.5 1.5 1.5-5.5 14.5-14.5z"/></g>'},qk={stickerLabel:"Sticker",stickerIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"/><path d="M20 17c-3 3-5 5-8 5"/></g>'},Kk=rk,Jk=nk,oT=qb,aT=(t={},e)=>{const{sub:r,pub:n}=Ka(),i={},o=((p={},h)=>new ak({target:h||document.body,props:{class:p.class,preventModalAutoFocus:p.preventModalAutoFocus,preventZoomViewport:p.preventZoomViewport,preventScrollBodyIfNeeded:p.preventScrollBodyIfNeeded,preventFooterOverlapIfNeeded:p.preventFooterOverlapIfNeeded}}))(t,e),a=()=>{o.hide&&o.hide()},s=()=>{o.show&&o.show()},l=B0(o.root);op(l,i),i.handleEvent=se,l.handleEvent=(p,h)=>{if(p==="init")return i.handleEvent(p,i);i.handleEvent(p,h)},l.on("close",async()=>{const{willClose:p}=t;if(!p)return a();await p()&&a()});const c=(p,h)=>/show|hide/.test(p)?r(p,h):l.on(p,h),u=["show","hide"].map(p=>c(p,h=>i.handleEvent(p,h))),d=()=>{u.forEach(p=>p()),a(),o.$destroy(),l.destroy()};return uu(i,{on:c,destroy:d,hide:a,show:s}),Object.defineProperty(i,"modal",{get:()=>o.root,set:()=>{}}),o.$on("close",l.close),o.$on("show",()=>n("show")),o.$on("hide",()=>{n("hide"),t.enableAutoDestroy!==!1&&d()}),t.enableAutoHide!==!1&&l.on("process",a),l.on("loadstart",s),t.enableButtonClose!==!1&&(t.enableButtonClose=!0),delete t.class,Object.assign(i,t),i},sT=(t,e)=>qb(t,{...e,layout:"overlay"}),Qk=(t=[])=>vk([bk(xk()),dk(pk()),...t]),tT=(t={})=>{let e,r;Array.isArray(t.imageReader)||(r=t.imageReader,delete t.imageReader),Array.isArray(t.imageWriter)?e=My():(e=Vr(t.imageWriter)?t.imageWriter:My(t.imageWriter),delete t.imageWriter);let n;return Vr(t.imageScrambler)||(n=t.imageScrambler,delete t.imageScrambler),{imageReader:wk(r),imageWriter:e,imageOrienter:Sk(),imageScrambler:kk(n)}},lT=(t={})=>{Rb(Pk,Rk,Ik,Ek,Ak,Lk,Fk,zk,Dk,Bk);const e=tT(t),r={...Vk,...Nk,...Hk,...jk,...Uk,...Gk,...Kk,...Jk,...Zk,...Xk,...Yk,...qk,...t.locale};delete t.locale;const n=typeof t.shapePreprocessor=="function"?t.shapePreprocessor:Qk(t.shapePreprocessor);return delete t.shapePreprocessor,t.markupEditorShapeStyleControls&&Object.entries(t.markupEditorShapeStyleControls).every(([i,o])=>/Options$/.test(i)||!Array.isArray(o))&&(t.markupEditorShapeStyleControls=Ck({...t.markupEditorShapeStyleControls})),t.markupEditorToolStyles&&Object.values(t.markupEditorToolStyles).every(i=>!Array.isArray(i))&&(t.markupEditorToolStyles=Object.entries(t.markupEditorToolStyles).reduce((i,[o,a])=>(i[o]=hs(o,a),i),Tk())),B2([{...e,shapePreprocessor:n,utils:["trim","crop","filter","finetune","retouch","annotate","decorate","sticker","fill","frame","redact","resize"],...Ok,...Wk,..._k,...Mk,stickerStickToImage:!0,locale:r},t])};export{wk as $,Ik as A,Rk as E,Hk as G,rT as H,Pk as I,Yk as J,Ek as L,Wk as N,Mk as P,iT as R,Nk as U,Uk as X,Gk as Y,Ok as _,sT as a,Sk as b,Qk as c,U2 as d,eT as e,My as f,lT as h,Vk as j,oT as n,aT as r,sw as s,nT as y};
