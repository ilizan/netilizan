import{f as V}from"./style-DBYZFAN_.js";import{bO as E,aS as s,aQ as R,u as g,v,t as y,I as x,bi as B,aK as f}from"./index-BAi-_Ng5.js";const M={key:0,style:{position:"relative"}},A={key:1},D=["src"],N={__name:"VueAdvancedCropper2",setup(z){const h=s(null),d=s(null),P=s(null),p=s(!1);let c=s(!1);R([]);let t=s([]);const k=s({aspectRatio:1,size:.5,movable:!0,resizable:!0,transparent:!0}),w=s({background:"rgba(0, 0, 0, 0.5)",borderRadius:"8px"}),_=s({width:100,height:100,x:10,y:10}),C=e=>{const l=e.target.files[0];if(l){const o=new FileReader;o.onload=()=>{h.value=o.result},o.readAsDataURL(l)}},T=()=>{p.value=!p.value,t.value=[],c.value=!c.value};function F(e){if(!p.value||!c.value)return;const l=e.target,o=l.getBoundingClientRect(),i=e.clientX-o.left,a=e.clientY-o.top,n=l.getContext("2d"),u=b(i,a);if(u!==-1)u===0&&t.value.length>2&&(c.value=!1,m(n,l,!0));else{if(n.fillStyle="#409EFF",n.beginPath(),n.arc(i,a,5,0,Math.PI*2),n.fill(),t.value.length>0){const r=t.value[t.value.length-1];n.strokeStyle="#409EFF",n.lineWidth=3,n.beginPath(),n.moveTo(r.x,r.y),n.lineTo(i,a),n.stroke()}c.value=!0,t.value.push({x:i,y:a})}}function S(e){if(!c.value||t.value.length===0)return;const l=e.target,o=l.getBoundingClientRect(),i=e.clientX-o.left,a=e.clientY-o.top,n=l.getContext("2d"),u=b(i,a);m(n,l,!1,u);const r=t.value[t.value.length-1];n.beginPath(),n.moveTo(r.x,r.y),n.lineTo(i,a),n.stroke()}function m(e,l,o=!1,i=-1){if(e.clearRect(0,0,l.width,l.height),e.fillStyle="#409EFF",e.strokeStyle="#409EFF",e.lineWidth=3,o&&t.value.length>2){e.fillStyle="rgba(255, 255, 255, .6)",e.beginPath(),e.moveTo(t.value[0].x,t.value[0].y);for(let a=1;a<t.value.length;a++)e.lineTo(t.value[a].x,t.value[a].y);e.closePath(),e.fill()}for(let a=0;a<t.value.length;a++){const n=t.value[a],u=a===i?8:5;if(e.beginPath(),e.arc(n.x,n.y,u,0,Math.PI*2),e.fill(),a>0){const r=t.value[a-1];e.beginPath(),e.moveTo(r.x,r.y),e.lineTo(n.x,n.y),e.stroke()}}o&&t.value.length>1&&(e.beginPath(),e.moveTo(t.value[t.value.length-1].x,t.value[t.value.length-1].y),e.lineTo(t.value[0].x,t.value[0].y),e.stroke())}function b(e,l){for(let o=0;o<t.value.length;o++){const i=t.value[o],a=i.x-e,n=i.y-l;if(Math.sqrt(a*a+n*n)<=5)return o}return-1}const I=()=>{const e=document.createElement("a");e.href=d.value,e.download="cropped-image.jpg",e.click()};return(e,l)=>(f(),g("div",null,[l[2]||(l[2]=v("h1",null,"钢笔工具绘制裁剪区域",-1)),v("input",{type:"file",onChange:C,accept:"image/*"},null,32),h.value?(f(),g("div",M,[x(B(V),{ref:"cropper",style:{width:"500px",height:"500px"},modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=o=>d.value=o),src:h.value,"stencil-props":k.value,"boundary-props":w.value,"initial-stencil":_.value,"auto-crop":!0},null,8,["modelValue","src","stencil-props","boundary-props","initial-stencil"]),p.value?(f(),g("canvas",{key:0,ref_key:"drawingcanvas",ref:P,class:"drawing_canvas",onClick:F,onMousemove:S,width:"500",height:"500"},null,544)):y("",!0)])):y("",!0),v("button",{onClick:T},"启用钢笔工具"),d.value?(f(),g("div",A,[l[1]||(l[1]=v("h3",null,"裁剪后的图片：",-1)),v("img",{src:d.value,alt:"裁剪后的图片"},null,8,D),v("button",{onClick:I},"下载裁剪图片")])):y("",!0)]))}},U=E(N,[["__scopeId","data-v-50abdb19"]]);export{U as default};
